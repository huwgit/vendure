"use strict";(self.webpackChunkvendure_admin=self.webpackChunkvendure_admin||[]).push([[830],{7830:(Ot,I,d)=>{d.r(I),d.d(I,{DEFAULT_DASHBOARD_WIDGET_LAYOUT:()=>K,DEFAULT_WIDGETS:()=>S,DashboardComponent:()=>m,DashboardModule:()=>b,DashboardWidgetComponent:()=>p,GET_ORDER_CHART_DATA:()=>ht,GET_ORDER_SUMMARY:()=>vt,LatestOrdersWidgetComponent:()=>h,LatestOrdersWidgetModule:()=>O,OrderChartWidgetComponent:()=>v,OrderSummaryWidgetComponent:()=>f,OrderSummaryWidgetModule:()=>C,TestWidgetComponent:()=>M,TestWidgetModule:()=>E,WelcomeWidgetComponent:()=>T,WelcomeWidgetModule:()=>w,dashboardRoutes:()=>$});var j=d(1458),t=d(4386),i=d(6058),F=d(1930),_=d(4369),J=d(2774),R=d(5624),q=d(1788),U=d(2664),A=d(4558),g=d(2493),c=d(3740),y=d(4510),u=d(7062),Z=d(2583),P=d(8570),L=d(6528),N=d(8540),k=d(8714),z=d(9857),B=d(5433);const G=["portal"];function V(a,r){1&a&&t.Hsn(0)}function Y(a,r){}const H=["*"];function Q(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.addWidget(s.id))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&a){const e=r.$implicit;let n;t.xp6(1),t.hij(" ",t.lcZ(2,1,null!==(n=e.config.title)&&void 0!==n?n:e.id)," ")}}const X=function(a){return{width:a}};function tt(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",22),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw(2).$implicit,D=t.oxw(2);return t.KtG(D.setWidgetWidth(l,s))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&a){const e=r.$implicit,n=t.oxw(2).$implicit;t.Q6J("disabled",e===n.width),t.xp6(1),t.hij(" ",t.xi3(2,2,"dashboard.widget-width",t.VKq(5,X,e))," ")}}function et(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"vdr-dashboard-widget",13)(1,"div",14)(2,"div",15),t._UZ(3,"clr-icon",16),t.qZA(),t.TgZ(4,"vdr-dropdown")(5,"button",17),t._UZ(6,"clr-icon",3),t.qZA(),t.TgZ(7,"vdr-dropdown-menu",4)(8,"h4",18),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.YNc(11,tt,3,7,"button",19),t._UZ(12,"div",20),t.TgZ(13,"button",8),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,s=t.oxw(2);return t.KtG(s.removeWidget(o))}),t._UZ(14,"clr-icon",21),t._uU(15),t.ALo(16,"translate"),t.qZA()()()()()}if(2&a){const e=t.oxw().$implicit,n=t.oxw(2);t.Q6J("widgetConfig",e.config),t.xp6(9),t.Oqu(t.lcZ(10,4,"dashboard.widget-resize")),t.xp6(2),t.Q6J("ngForOf",n.getSupportedWidths(e.config)),t.xp6(4),t.hij(" ",t.lcZ(16,6,"dashboard.remove-widget")," ")}}function rt(a,r){if(1&a&&(t.TgZ(0,"div",11),t.YNc(1,et,17,8,"vdr-dashboard-widget",12),t.qZA()),2&a){const e=r.$implicit,n=t.oxw(2);t.Q6J("ngClass",n.getClassForWidth(e.width))("cdkDragData",e),t.xp6(1),t.Q6J("vdrIfPermissions",e.config.requiresPermissions||null)}}const nt=function(a){return{index:a}};function ot(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"div",9),t.NdJ("cdkDropListDropped",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.drop(o))}),t.YNc(1,rt,2,3,"div",10),t.qZA()}if(2&a){const e=r.$implicit,n=r.index,o=t.oxw();t.Q6J("cdkDropListData",t.VKq(3,nt,n)),t.xp6(1),t.Q6J("ngForOf",e)("ngForTrackBy",o.trackRowItem)}}const at=function(a){return["/orders/",a]};function it(a,r){if(1&a&&(t.TgZ(0,"a",6)(1,"span"),t._uU(2),t.qZA(),t._UZ(3,"clr-icon",7),t.qZA()),2&a){const e=r.item;t.Q6J("routerLink",t.VKq(2,at,e.id)),t.xp6(2),t.Oqu(e.code)}}function dt(a,r){if(1&a&&t._UZ(0,"vdr-order-state-label",8),2&a){const e=r.item;t.Q6J("state",e.state)}}function st(a,r){if(1&a&&t._UZ(0,"vdr-customer-label",9),2&a){const e=r.item;t.Q6J("customer",e.customer)}}function ct(a,r){if(1&a&&(t._uU(0),t.ALo(1,"localeCurrency")),2&a){const e=r.item;t.hij(" ",t.xi3(1,1,e.totalWithTax,e.currencyCode)," ")}}function lt(a,r){if(1&a&&(t._uU(0),t.ALo(1,"timeAgo")),2&a){const e=r.item;t.hij(" ",t.lcZ(1,1,e.orderPlacedAt)," ")}}function _t(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"div",2)(1,"button",3),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.metricType$.next(o.MetricType.OrderTotal))}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.metricType$.next(o.MetricType.OrderCount))}),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.metricType$.next(o.MetricType.AverageOrderValue))}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t._UZ(10,"div",5),t.TgZ(11,"button",3),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.refresh())}),t._UZ(12,"clr-icon",6),t.qZA()()}if(2&a){const e=r.ngIf,n=t.oxw();t.xp6(1),t.ekj("active",e===n.MetricType.OrderTotal),t.xp6(1),t.hij(" ",t.lcZ(3,9,"dashboard.metric-order-total-value")," "),t.xp6(2),t.ekj("active",e===n.MetricType.OrderCount),t.xp6(1),t.hij(" ",t.lcZ(6,11,"dashboard.metric-number-of-orders")," "),t.xp6(2),t.ekj("active",e===n.MetricType.AverageOrderValue),t.xp6(1),t.hij(" ",t.lcZ(9,13,"dashboard.metric-average-order-value")," ")}}function gt(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"div",7)(1,"button",8),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.selection$.next({timeframe:"day",date:o.today}))}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.selection$.next({timeframe:"day",date:o.yesterday}))}),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.selection$.next({timeframe:"week"}))}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.selection$.next({timeframe:"month"}))}),t._uU(11),t.ALo(12,"translate"),t.qZA()()}if(2&a){const e=r.ngIf,n=t.oxw();t.xp6(1),t.ekj("active",e.date===n.today),t.xp6(1),t.hij(" ",t.lcZ(3,12,"dashboard.today")," "),t.xp6(2),t.ekj("active",e.date===n.yesterday),t.xp6(1),t.hij(" ",t.lcZ(6,14,"dashboard.yesterday")," "),t.xp6(2),t.ekj("active","week"===e.timeframe),t.xp6(1),t.hij(" ",t.lcZ(9,16,"dashboard.thisWeek")," "),t.xp6(2),t.ekj("active","month"===e.timeframe),t.xp6(1),t.hij(" ",t.lcZ(12,18,"dashboard.thisMonth")," ")}}function ut(a,r){if(1&a&&(t.TgZ(0,"div",10),t._uU(1),t.ALo(2,"localeDate"),t.ALo(3,"localeDate"),t.qZA()),2&a){const e=r.ngIf;t.xp6(1),t.AsE(" ",t.lcZ(2,2,e.start)," - ",t.lcZ(3,4,e.end)," ")}}function pt(a,r){if(1&a&&(t.TgZ(0,"p",4),t._uU(1),t.qZA()),2&a){const e=t.oxw(2);t.xp6(1),t.AsE(" ",e.hideVendureBranding?"":"Vendure"," ",e.hideVersion?"":"Admin UI v"+e.version," ")}}function mt(a,r){if(1&a&&(t.TgZ(0,"div")(1,"h4",3),t._uU(2),t._UZ(3,"br"),t.TgZ(4,"small",4),t._uU(5),t.ALo(6,"timeAgo"),t.qZA()(),t.YNc(7,pt,2,2,"p",5),t.qZA()),2&a){const e=r.ngIf,n=t.oxw();t.xp6(2),t.AsE(" Welcome, ",e.firstName," ",e.lastName,""),t.xp6(3),t.hij("Last login: ",t.lcZ(6,4,e.user.lastLogin),""),t.xp6(2),t.Q6J("ngIf",!n.hideVendureBranding||!n.hideVersion)}}class p{ngAfterViewInit(){this.loadWidget()}loadWidget(){var r=this;return(0,j.Z)(function*(){const e=r.widgetConfig.loadComponent(),n=e instanceof Promise?yield e:e;r.componentRef=r.portal.createComponent(n),r.componentRef.changeDetectorRef.detectChanges()})()}ngOnDestroy(){this.componentRef&&this.componentRef.destroy()}static#t=this.\u0275fac=function(e){return new(e||p)};static#e=this.\u0275cmp=t.Xpm({type:p,selectors:[["vdr-dashboard-widget"]],viewQuery:function(e,n){if(1&e&&t.Gf(G,5,t.s_b),2&e){let o;t.iGM(o=t.CRH())&&(n.portal=o.first)}},inputs:{widgetConfig:"widgetConfig"},ngContentSelectors:H,decls:5,vars:3,consts:[[3,"title"],["vdrCardControls",""],["portal",""]],template:function(e,n){if(1&e&&(t.F$t(),t.TgZ(0,"vdr-card",0),t.ALo(1,"translate"),t.YNc(2,V,1,0,"ng-template",1),t.YNc(3,Y,0,0,"ng-template",null,2,t.W1O),t.qZA()),2&e){let o;t.Q6J("title",t.lcZ(1,1,null!==(o=n.widgetConfig.title)&&void 0!==o?o:""))}},dependencies:[i.AkF,i.D23,u.X$],styles:["[_nghost-%COMP%]{display:block}.card[_ngcontent-%COMP%]{margin-top:0;min-height:200px}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"],changeDetection:0})}class m{constructor(r,e,n,o){this.dashboardWidgetService=r,this.localStorageService=e,this.changedDetectorRef=n,this.dataService=o,this.deletionMarker="__delete__",this.setTitle=(0,i.sZ5)()}ngOnInit(){this.availableWidgets$=this.dataService.client.userStatus().stream$.pipe((0,_.U)(({userStatus:r})=>r.permissions),(0,_.U)(r=>this.dashboardWidgetService.getAvailableWidgets(r)),(0,J.b)(r=>this.widgetLayout=this.initLayout(r.map(e=>e.id)))),this.setTitle("breadcrumb.dashboard")}getClassForWidth(r){switch(r){case 3:return"clr-col-12 clr-col-sm-6 clr-col-lg-3";case 4:return"clr-col-12 clr-col-sm-6 clr-col-lg-4";case 6:return"clr-col-12 clr-col-lg-6";case 8:return"clr-col-12 clr-col-lg-8";case 12:return"clr-col-12";default:(0,F.assertNever)(r)}}getSupportedWidths(r){return r.supportedWidths||[3,4,6,8,12]}setWidgetWidth(r,e){r.width=e,this.recalculateLayout()}trackRow(r,e){return e.map(o=>`${o.id}:${o.width}`).join("|")}trackRowItem(r,e){return e.config}addWidget(r){const e=this.dashboardWidgetService.getWidgetById(r);if(e){const o={id:r,config:e,width:this.getSupportedWidths(e)[0]};let s;this.widgetLayout&&this.widgetLayout.length?s=this.widgetLayout[this.widgetLayout.length-1]:(s=[],this.widgetLayout?.push(s)),s.push(o),this.recalculateLayout()}}removeWidget(r){r.id=this.deletionMarker,this.recalculateLayout()}drop(r){const{currentIndex:e,previousIndex:n,previousContainer:o,container:s}=r;if((n!==e||o.data.index!==s.data.index)&&this.widgetLayout){const l=this.widgetLayout[o.data.index],D=this.widgetLayout[s.data.index];l.splice(n,1),D.splice(e,0,r.item.data),this.recalculateLayout()}}initLayout(r){const e=this.localStorageService.get("dashboardWidgetLayout");let n;return e&&(n=e.filter(o=>r.includes(o.id))),this.dashboardWidgetService.getWidgetLayout(n)}recalculateLayout(){if(this.widgetLayout){const e=this.widgetLayout.reduce((n,o)=>[...n,...o],[]).filter(n=>n.id!==this.deletionMarker).map(n=>({id:n.id,width:n.width}));this.widgetLayout=this.dashboardWidgetService.getWidgetLayout(e),this.localStorageService.set("dashboardWidgetLayout",e),setTimeout(()=>this.changedDetectorRef.markForCheck())}}static#t=this.\u0275fac=function(e){return new(e||m)(t.Y36(i.ayj),t.Y36(i.n2A),t.Y36(t.sBO),t.Y36(i.DoR))};static#e=this.\u0275cmp=t.Xpm({type:m,selectors:[["vdr-dashboard"]],decls:13,vars:8,consts:[[1,"widget-header","mb-1"],["vdrDropdownTrigger","",1,"btn","btn-secondary","btn-sm"],["shape","plus"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["vdrDropdownItem","",3,"click",4,"ngFor","ngForOf"],["cdkDropListGroup",""],["class","clr-row dashboard-row","cdkDropList","","cdkDropListOrientation","horizontal",3,"cdkDropListData","cdkDropListDropped",4,"ngFor","ngForOf","ngForTrackBy"],["vdrDropdownItem","",3,"click"],["cdkDropList","","cdkDropListOrientation","horizontal",1,"clr-row","dashboard-row",3,"cdkDropListData","cdkDropListDropped"],["class","dashboard-item","cdkDrag","",3,"ngClass","cdkDragData",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",1,"dashboard-item",3,"ngClass","cdkDragData"],[3,"widgetConfig",4,"vdrIfPermissions"],[3,"widgetConfig"],[1,"flex"],["cdkDragHandle","",1,"drag-handle"],["shape","drag-handle","size","24"],["vdrDropdownTrigger","",1,"icon-button"],[1,"dropdown-header"],["vdrDropdownItem","",3,"disabled","click",4,"ngFor","ngForOf"],["role","separator",1,"dropdown-divider"],["shape","trash",1,"is-danger"],["vdrDropdownItem","",3,"disabled","click"]],template:function(e,n){1&e&&(t.TgZ(0,"vdr-page-block")(1,"div",0)(2,"vdr-dropdown")(3,"button",1),t._UZ(4,"clr-icon",2),t._uU(5),t.ALo(6,"translate"),t._UZ(7,"clr-icon",3),t.qZA(),t.TgZ(8,"vdr-dropdown-menu",4),t.YNc(9,Q,3,3,"button",5),t.ALo(10,"async"),t.qZA()()(),t.TgZ(11,"div",6),t.YNc(12,ot,2,5,"div",7),t.qZA()()),2&e&&(t.xp6(5),t.hij(" ",t.lcZ(6,4,"dashboard.add-widget")," "),t.xp6(4),t.Q6J("ngForOf",t.lcZ(10,6,n.availableWidgets$)),t.xp6(3),t.Q6J("ngForOf",n.widgetLayout)("ngForTrackBy",n.trackRow))},dependencies:[g.q0d,g.qvL,c.mk,c.sg,y.Wj,y.Fd,y.Zt,y.Bh,i.JOL,i.N9E,i.UaT,i.HH4,i.HAh,i.zJY,p,c.Ov,u.X$],styles:[".widget-header[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.placeholder[_ngcontent-%COMP%]{color:var(--color-grey-300);text-align:center}.placeholder[_ngcontent-%COMP%]   .version[_ngcontent-%COMP%]{font-size:3em;margin:24px;line-height:1em}.placeholder[_ngcontent-%COMP%]     .clr-i-outline{fill:var(--color-grey-200)}vdr-dashboard-widget[_ngcontent-%COMP%]{margin-bottom:24px}.drag-handle[_ngcontent-%COMP%]{cursor:move}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.dashboard-row[_ngcontent-%COMP%]{padding:0;border-width:1;margin-bottom:6px;transition:padding .2s,margin .2s}.dashboard-row.cdk-drop-list-dragging[_ngcontent-%COMP%], .dashboard-row.cdk-drop-list-receiving[_ngcontent-%COMP%]{border:2px dashed var(--color-component-border-200);border-radius:var(--border-radius);padding:6px}.dashboard-row.cdk-drop-list-dragging[_ngcontent-%COMP%]   .dashboard-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"],changeDetection:0})}const $=[{path:"",component:m,pathMatch:"full"}];L.Ps`
    query GetLatestOrders($options: OrderListOptions) {
        orders(options: $options) {
            items {
                id
                createdAt
                updatedAt
                type
                orderPlacedAt
                code
                state
                total
                totalWithTax
                currencyCode
                customer {
                    id
                    firstName
                    lastName
                }
            }
        }
    }
`;class h{constructor(r){this.dataService=r}ngOnInit(){this.latestOrders$=this.dataService.query(i.pUH,{options:{take:10,filter:{active:{eq:!1},state:{notIn:["Cancelled","Draft"]}},sort:{orderPlacedAt:i.Asd.DESC}}}).refetchOnChannelChange().mapStream(r=>r.orders.items)}static#t=this.\u0275fac=function(e){return new(e||h)(t.Y36(i.DoR))};static#e=this.\u0275cmp=t.Xpm({type:h,selectors:[["vdr-latest-orders-widget"]],decls:17,vars:20,consts:[["id","latest-orders-widget-list",3,"items"],["id","code",3,"heading"],["id","state",3,"heading","hiddenByDefault"],["id","customer",3,"heading","hiddenByDefault"],["id","total",3,"heading"],["id","placed-at",3,"heading"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],[3,"state"],[3,"customer"]],template:function(e,n){1&e&&(t.TgZ(0,"vdr-data-table-2",0),t.ALo(1,"async"),t.TgZ(2,"vdr-dt2-column",1),t.ALo(3,"translate"),t.YNc(4,it,4,4,"ng-template"),t.qZA(),t.TgZ(5,"vdr-dt2-column",2),t.ALo(6,"translate"),t.YNc(7,dt,1,1,"ng-template"),t.qZA(),t.TgZ(8,"vdr-dt2-column",3),t.ALo(9,"translate"),t.YNc(10,st,1,1,"ng-template"),t.qZA(),t.TgZ(11,"vdr-dt2-column",4),t.ALo(12,"translate"),t.YNc(13,ct,2,4,"ng-template"),t.qZA(),t.TgZ(14,"vdr-dt2-column",5),t.ALo(15,"translate"),t.YNc(16,lt,2,3,"ng-template"),t.qZA()()),2&e&&(t.Q6J("items",t.lcZ(1,8,n.latestOrders$)),t.xp6(2),t.Q6J("heading",t.lcZ(3,10,"common.code")),t.xp6(3),t.Q6J("heading",t.lcZ(6,12,"order.state"))("hiddenByDefault",!0),t.xp6(3),t.Q6J("heading",t.lcZ(9,14,"customer.customer"))("hiddenByDefault",!0),t.xp6(3),t.Q6J("heading",t.lcZ(12,16,"order.total")),t.xp6(3),t.Q6J("heading",t.lcZ(15,18,"order.placed-at")))},dependencies:[g.qvL,Z.rH,i.d$,i.GXt,i.eJ5,i.Up6,c.Ov,u.X$,i.eGd,i.kgx],styles:["vdr-data-table[_ngcontent-%COMP%]     table{margin-top:0}vdr-order-state-label[_ngcontent-%COMP%]{display:inline-block;margin-top:2px}"],changeDetection:0})}class O{static#t=this.\u0275fac=function(e){return new(e||O)};static#e=this.\u0275mod=t.oAB({type:O});static#r=this.\u0275inj=t.cJS({imports:[i.IR2,i.m81]})}const ht=L.Ps`
    query GetOrderChartData($refresh: Boolean, $types: [MetricType!]!) {
        metricSummary(input: { interval: Daily, types: $types, refresh: $refresh }) {
            interval
            type
            entries {
                label
                value
            }
        }
    }
`;class v{constructor(r){this.dataService=r,this.refresh$=new N.x,this.metricType$=new k.X(i.t0y.OrderTotal),this.MetricType=i.t0y}ngOnInit(){const r=this.dataService.settings.getActiveChannel().refetchOnChannelChange().mapStream(o=>o.activeChannel.defaultCurrencyCode||void 0),e=this.dataService.client.uiState().mapStream(o=>o.uiState),n=this.metricType$.pipe((0,R.x)());this.metrics$=(0,z.a)(n,r,e).pipe((0,A.w)(([o,s,l])=>this.refresh$.pipe((0,q.O)(!1),(0,A.w)(D=>this.dataService.query(i.UZ,{types:[o],refresh:D}).mapSingle(x=>x.metricSummary).pipe((0,_.U)(x=>{const ft=o===i.t0y.OrderCount?"number":"currency",Dt=`${l.language}-${l.locale}`,yt={formatValueAs:ft,currencyCode:s,locale:Dt};return x.find(W=>W.type===o)?.entries.map(W=>({...W,formatOptions:yt}))??[]}))))))}refresh(){this.refresh$.next(!0)}static#t=this.\u0275fac=function(e){return new(e||v)(t.Y36(i.DoR))};static#e=this.\u0275cmp=t.Xpm({type:v,selectors:[["vdr-order-chart-widget"]],decls:4,vars:6,consts:[[3,"entries"],["class","flex",4,"ngIf"],[1,"flex"],[1,"button-small",3,"click"],[1,"ml-1","button-small",3,"click"],[1,"flex-spacer"],["shape","refresh"]],template:function(e,n){1&e&&(t._UZ(0,"vdr-chart",0),t.ALo(1,"async"),t.YNc(2,_t,13,15,"div",1),t.ALo(3,"async")),2&e&&(t.Q6J("entries",t.lcZ(1,2,n.metrics$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(3,4,n.metricType$)))},dependencies:[g.qvL,c.O5,i.xH4,c.Ov,u.X$],styles:[".button-small.active[_ngcontent-%COMP%]{background-color:var(--color-primary-200);color:var(--color-primary-900)}"],changeDetection:0})}const vt=L.Ps`
    query GetOrderSummary($start: DateTime!, $end: DateTime!) {
        orders(options: { filter: { orderPlacedAt: { between: { start: $start, end: $end } } } }) {
            totalItems
            items {
                id
                totalWithTax
                currencyCode
            }
        }
    }
`;class f{constructor(r){this.dataService=r,this.today=new Date,this.yesterday=new Date((new Date).setDate(this.today.getDate()-1)),this.selection$=new k.X({timeframe:"day",date:this.today})}ngOnInit(){this.dateRange$=this.selection$.pipe((0,R.x)(),(0,_.U)(e=>({start:B(e.date).startOf(e.timeframe).toDate(),end:B(e.date).endOf(e.timeframe).toDate()})),(0,U.d)(1));const r=this.dateRange$.pipe((0,A.w)(({start:e,end:n})=>this.dataService.query(i.OY9,{start:e.toISOString(),end:n.toISOString()}).refetchOnChannelChange().mapStream(o=>o.orders)),(0,U.d)(1));this.totalOrderCount$=r.pipe((0,_.U)(e=>e.totalItems)),this.totalOrderValue$=r.pipe((0,_.U)(e=>e.items.reduce((n,o)=>n+o.totalWithTax,0)/100)),this.currencyCode$=this.dataService.settings.getActiveChannel().refetchOnChannelChange().mapStream(e=>e.activeChannel.defaultCurrencyCode||void 0)}static#t=this.\u0275fac=function(e){return new(e||f)(t.Y36(i.DoR))};static#e=this.\u0275cmp=t.Xpm({type:f,selectors:[["vdr-order-summary-widget"]],decls:22,vars:23,consts:[[1,"stats"],[1,"stat"],[1,"stat-figure"],[1,"stat-label"],[1,"footer"],["class","flex",4,"ngIf"],["class","date-range p5",4,"ngIf"],[1,"flex"],[1,"button-small",3,"click"],[1,"ml-1","button-small",3,"click"],[1,"date-range","p5"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3),t.ALo(4,"async"),t.qZA(),t.TgZ(5,"div",3),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t.TgZ(8,"div",1)(9,"div",2),t._uU(10),t.ALo(11,"currency"),t.ALo(12,"async"),t.ALo(13,"async"),t.qZA(),t.TgZ(14,"div",3),t._uU(15),t.ALo(16,"translate"),t.qZA()()(),t.TgZ(17,"div",4),t.YNc(18,gt,13,20,"div",5),t.ALo(19,"async"),t.YNc(20,ut,4,6,"div",6),t.ALo(21,"async"),t.qZA()),2&e&&(t.xp6(3),t.Oqu(t.lcZ(4,6,n.totalOrderCount$)),t.xp6(3),t.Oqu(t.lcZ(7,8,"dashboard.total-orders")),t.xp6(4),t.hij(" ",t.xi3(11,10,t.lcZ(12,13,n.totalOrderValue$),t.lcZ(13,15,n.currencyCode$)||void 0)," "),t.xp6(5),t.Oqu(t.lcZ(16,17,"dashboard.total-order-value")),t.xp6(3),t.Q6J("ngIf",t.lcZ(19,19,n.selection$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(21,21,n.dateRange$)))},dependencies:[c.O5,c.Ov,c.H9,u.X$,i.HbD],styles:[".stats[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly}.stat[_ngcontent-%COMP%]{text-align:center}.stat-figure[_ngcontent-%COMP%]{font-size:2rem;line-height:3rem}.stat-label[_ngcontent-%COMP%]{text-transform:uppercase}.date-range[_ngcontent-%COMP%]{margin-top:0}.footer[_ngcontent-%COMP%]{margin-top:24px;display:flex;flex-direction:column;justify-content:space-between}.button-small.active[_ngcontent-%COMP%]{background-color:var(--color-primary-200);color:var(--color-primary-900)}"],changeDetection:0})}class C{static#t=this.\u0275fac=function(e){return new(e||C)};static#e=this.\u0275mod=t.oAB({type:C});static#r=this.\u0275inj=t.cJS({imports:[i.IR2]})}const K=[{id:"metrics",width:12},{id:"orderSummary",width:6},{id:"latestOrders",width:6}],S={metrics:{title:(0,P.J)("dashboard.metrics"),supportedWidths:[6,8,12],loadComponent:()=>v,requiresPermissions:[i.y3$.ReadOrder]},orderSummary:{title:(0,P.J)("dashboard.orders-summary"),loadComponent:()=>f,supportedWidths:[4,6,8,12],requiresPermissions:[i.y3$.ReadOrder]},latestOrders:{title:(0,P.J)("dashboard.latest-orders"),loadComponent:()=>h,supportedWidths:[6,8,12],requiresPermissions:[i.y3$.ReadOrder]}};class b{constructor(r){Object.entries(S).map(([e,n])=>{r.getWidgetById(e)||r.registerWidget(e,n)}),0===r.getDefaultLayout().length&&r.setDefaultLayout(K)}static#t=this.\u0275fac=function(e){return new(e||b)(t.LFG(i.ayj))};static#e=this.\u0275mod=t.oAB({type:b});static#r=this.\u0275inj=t.cJS({imports:[i.m81,Z.Bz.forChild($)]})}class M{static#t=this.\u0275fac=function(e){return new(e||M)};static#e=this.\u0275cmp=t.Xpm({type:M,selectors:[["vdr-test-widget"]],decls:2,vars:0,template:function(e,n){1&e&&(t.TgZ(0,"p"),t._uU(1,"This is a test widget!"),t.qZA())},changeDetection:0})}class E{static#t=this.\u0275fac=function(e){return new(e||E)};static#e=this.\u0275mod=t.oAB({type:E});static#r=this.\u0275inj=t.cJS({})}class T{constructor(r){this.dataService=r,this.version=i.s5M,this.brand=(0,i.hq7)().brand,this.hideVendureBranding=(0,i.hq7)().hideVendureBranding,this.hideVersion=(0,i.hq7)().hideVersion}ngOnInit(){this.administrator$=this.dataService.administrator.getActiveAdministrator().mapStream(r=>r.activeAdministrator||null)}static#t=this.\u0275fac=function(e){return new(e||T)(t.Y36(i.DoR))};static#e=this.\u0275cmp=t.Xpm({type:T,selectors:[["vdr-welcome-widget"]],decls:4,vars:3,consts:[[4,"ngIf"],[1,"placeholder"],["shape","line-chart","size","128"],[1,""],[1,"p5"],["class","p5",4,"ngIf"]],template:function(e,n){1&e&&(t.YNc(0,mt,8,6,"div",0),t.ALo(1,"async"),t.TgZ(2,"div",1),t._UZ(3,"clr-icon",2),t.qZA()),2&e&&t.Q6J("ngIf",t.lcZ(1,1,n.administrator$))},dependencies:[g.qvL,c.O5,c.Ov,i.eGd],styles:["[_nghost-%COMP%]{display:flex;justify-content:space-between}.placeholder[_ngcontent-%COMP%]{color:var(--color-grey-200)}"],changeDetection:0})}class w{static#t=this.\u0275fac=function(e){return new(e||w)};static#e=this.\u0275mod=t.oAB({type:w});static#r=this.\u0275inj=t.cJS({imports:[i.IR2]})}}}]);
//# sourceMappingURL=830.5dd92e51efc12b04.js.map