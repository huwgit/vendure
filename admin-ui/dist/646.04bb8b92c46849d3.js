"use strict";(self.webpackChunkvendure_admin=self.webpackChunkvendure_admin||[]).push([[646],{3646:(xa,Ce,m)=>{m.r(Ce),m.d(Ce,{AddManualPaymentDialogComponent:()=>H,CancelOrderDialogComponent:()=>G,CouponCodeSelectorComponent:()=>D,DraftOrderDetailComponent:()=>J,DraftOrderVariantSelectorComponent:()=>W,FulfillOrderDialogComponent:()=>X,FulfillmentCardComponent:()=>te,FulfillmentDetailComponent:()=>N,FulfillmentStateLabelComponent:()=>ee,GET_COUPON_CODE_SELECTOR_PROMOTION_LIST:()=>fa,GET_CUSTOMER_ADDRESSES:()=>va,GET_SELLER_ORDERS:()=>qe,LineFulfillmentComponent:()=>q,LineRefundsComponent:()=>I,ModificationDetailComponent:()=>ne,NODE_HEIGHT:()=>be,ORDER_DETAIL_QUERY:()=>ha,OrderCustomFieldsCardComponent:()=>z,OrderDataTableComponent:()=>k,OrderDetailComponent:()=>ge,OrderEditResultType:()=>b,OrderEditorComponent:()=>fe,OrderEditsPreviewDialogComponent:()=>_e,OrderGuard:()=>A,OrderHistoryComponent:()=>ue,OrderHistoryEntryHostComponent:()=>pe,OrderListComponent:()=>he,OrderModule:()=>Y,OrderPaymentCardComponent:()=>se,OrderProcessEdgeComponent:()=>re,OrderProcessGraphComponent:()=>oe,OrderProcessGraphDialogComponent:()=>ie,OrderProcessNodeComponent:()=>Q,OrderResolver:()=>E,OrderStateSelectDialogComponent:()=>K,OrderTableComponent:()=>F,OrderTotalColumnComponent:()=>w,OrderTransitionService:()=>Z,PaymentDetailComponent:()=>U,PaymentStateLabelComponent:()=>de,RefundOrderDialogComponent:()=>ae,RefundStateLabelComponent:()=>ce,SelectAddressDialogComponent:()=>P,SelectCustomerDialogComponent:()=>B,SelectShippingMethodDialogComponent:()=>V,SellerOrdersCardComponent:()=>me,SettleRefundDialogComponent:()=>le,SimpleItemListComponent:()=>M,createRoutes:()=>ke,modifyingOrderBreadcrumb:()=>Ne,orderBreadcrumb:()=>Je});var e=m(4386),d=m(9348),a=m(6058),R=m(6528),C=m(5074),s=m(3740),g=m(7062),u=m(8570),p=m(6193),L=m(8540),Oe=m(8369),v=m(4624),O=m(4162),Ue=m(9857),ye=m(8714),xe=m(7738),Te=m(5624),_=m(4558),y=m(4369),Ze=m(1788),j=m(2774),Ae=m(7402),Ee=m(2169),Ye=m(1106),Ie=m(4740);var je=m(4389),T=m(3311),we=m(1899),ve=m(9883),Fe=m(2664),Me=m(7341),$e=m(5846),h=m(2583),x=m(1930),Le=m(9571),He=m(3888),Ge=m(307),Be=m(7809);function Ve(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"order.add-payment-to-order"))}function Ke(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",8),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.submit())}),e._uU(4),e.ALo(5,"translate"),e.ALo(6,"localeCurrency"),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,4,"common.cancel")),e.xp6(2),e.Q6J("disabled",t.form.invalid||t.form.pristine),e.xp6(1),e.AsE(" ",e.lcZ(5,6,"order.add-payment")," (",e.xi3(6,8,t.outstandingAmount,t.currencyCode),") ")}}function ze(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"order.cancel-order"))}function We(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"input",19),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw().$implicit,c=e.oxw();return e.KtG(c.lineQuantities[l.id]=i)})("input",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.checkIfAllSelected())}),e.qZA()}if(2&o){const t=e.oxw().$implicit,r=e.oxw();e.Q6J("ngModel",r.lineQuantities[t.id])("disabled",r.cancelAll)("max",t.quantity)}}function Xe(o,n){if(1&o&&e._uU(0),2&o){const t=e.oxw().$implicit;e.Oqu(t.quantity)}}function et(o,n){if(1&o&&(e.TgZ(0,"tr",10)(1,"td",11),e._UZ(2,"img",12),e.ALo(3,"assetPreview"),e.qZA(),e.TgZ(4,"td",13),e._uU(5),e.qZA(),e.TgZ(6,"td",14),e._uU(7),e.qZA(),e.TgZ(8,"td",15),e._uU(9),e.qZA(),e.TgZ(10,"td",15),e._uU(11),e.ALo(12,"localeCurrency"),e.qZA(),e.TgZ(13,"td",16),e.YNc(14,We,1,3,"input",17),e.YNc(15,Xe,1,1,"ng-template",null,18,e.W1O),e.qZA()()),2&o){const t=n.$implicit,r=e.MAs(16),i=e.oxw();e.ekj("is-disabled",i.cancelAll)("is-cancelled",0===t.quantity),e.xp6(2),e.Q6J("src",e.xi3(3,11,t.featuredAsset,"tiny"),e.LSH),e.xp6(3),e.Oqu(t.productVariant.name),e.xp6(2),e.Oqu(t.productVariant.sku),e.xp6(2),e.Oqu(t.quantity),e.xp6(2),e.hij(" ",e.xi3(12,14,t.unitPriceWithTax,i.order.currencyCode)," "),e.xp6(3),e.Q6J("ngIf",t.quantity>0&&!i.order.active)("ngIfElse",r)}}function tt(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"clr-radio-wrapper")(2,"input",20),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.cancelAll=i)})("ngModelChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.radioChanged())}),e.qZA(),e.TgZ(3,"label"),e._uU(4),e.ALo(5,"translate"),e.qZA()(),e.TgZ(6,"clr-radio-wrapper")(7,"input",20),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.cancelAll=i)})("ngModelChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.radioChanged())}),e.qZA(),e.TgZ(8,"label"),e._uU(9),e.ALo(10,"translate"),e.qZA()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("value",!0)("ngModel",t.cancelAll),e.xp6(2),e.Oqu(e.lcZ(5,6,"order.cancel-entire-order")),e.xp6(3),e.Q6J("value",!1)("ngModel",t.cancelAll),e.xp6(2),e.Oqu(e.lcZ(10,8,"order.cancel-specified-items"))}}function nt(o,n){1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.cancel-selected-items")," "))}function rt(o,n){1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.cancel-order")," "))}function ot(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",22),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.select())}),e.YNc(4,nt,3,3,"ng-container",6),e.YNc(5,rt,3,3,"ng-container",6),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,4,"common.cancel")),e.xp6(2),e.Q6J("disabled",!t.reason||!t.order.active&&0===t.selectionCount),e.xp6(1),e.Q6J("ngIf",!t.order.active),e.xp6(1),e.Q6J("ngIf",t.order.active)}}function it(o,n){if(1&o&&(e.TgZ(0,"vdr-chip"),e._uU(1),e.qZA(),e._uU(2)),2&o){const t=n.item;e.xp6(1),e.Oqu(t.code),e.xp6(1),e.hij(" ",t.promotionName," ")}}function at(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"order.select-address"))}function lt(o,n){if(1&o&&(e.TgZ(0,"vdr-radio-card",7),e._UZ(1,"vdr-formatted-address",8),e.qZA()),2&o){const t=n.$implicit;e.Q6J("item",t),e.xp6(1),e.Q6J("address",t)}}function dt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"clr-tab-content")(1,"vdr-radio-card-fieldset",5),e.NdJ("selectItem",function(i){e.CHM(t);const l=e.oxw(3);return e.KtG(l.selectedAddress=i)}),e.YNc(2,lt,2,2,"vdr-radio-card",6),e.qZA()()}if(2&o){const t=e.oxw(2).ngIf,r=e.oxw();e.xp6(1),e.Q6J("idFn",r.addressIdFn)("selectedItemId",r.selectedAddress&&r.addressIdFn(r.selectedAddress)),e.xp6(1),e.Q6J("ngForOf",t)}}function ct(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"clr-tab")(1,"button",3),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,dt,3,3,"ng-template",4),e.NdJ("clrIfActiveChange",function(i){e.CHM(t);const l=e.oxw(2);return e.KtG(l.useExisting=i)}),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,2,"order.existing-address")),e.xp6(2),e.Q6J("clrIfActive",t.useExisting)}}function st(o,n){if(1&o&&(e.TgZ(0,"clr-tab-content"),e._UZ(1,"vdr-address-form",9),e.ALo(2,"async"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("formGroup",t.addressForm)("availableCountries",e.lcZ(2,2,t.availableCountries$))}}function pt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"clr-tabs"),e.YNc(1,ct,5,4,"clr-tab",1),e.TgZ(2,"clr-tab")(3,"button",3),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.YNc(6,st,3,4,"ng-template",4),e.NdJ("clrIfActiveChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.createNew=i)}),e.qZA()()}if(2&o){const t=n.ngIf,r=e.oxw();e.xp6(1),e.Q6J("ngIf",r.customerId&&t.length),e.xp6(3),e.Oqu(e.lcZ(5,3,"customer.create-new-address")),e.xp6(2),e.Q6J("clrIfActive",r.createNew)}}function ut(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.select())}),e._uU(4),e.ALo(5,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,3,"common.cancel")),e.xp6(2),e.Q6J("disabled",t.useExisting&&!t.selectedAddress||t.createNew&&t.addressForm.invalid),e.xp6(1),e.hij(" ",e.lcZ(5,5,"common.okay")," ")}}function mt(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"order.set-customer-for-order"))}function gt(o,n){if(1&o&&(e.TgZ(0,"span",8),e._UZ(1,"clr-icon",9),e.TgZ(2,"span",10),e._uU(3),e.qZA(),e.TgZ(4,"vdr-chip"),e._uU(5),e.qZA()()),2&o){const t=n.item;e.xp6(3),e.AsE("",t.firstName," ",t.lastName,""),e.xp6(2),e.Oqu(t.emailAddress)}}function _t(o,n){if(1&o&&(e.TgZ(0,"span",8),e._UZ(1,"clr-icon",9),e.TgZ(2,"span",10),e._uU(3),e.qZA(),e.TgZ(4,"vdr-chip"),e._uU(5),e.qZA()()),2&o){const t=n.item;e.xp6(3),e.AsE("",t.firstName," ",t.lastName,""),e.xp6(2),e.Oqu(t.emailAddress)}}function ft(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"clr-tab-content")(1,"div",4)(2,"ng-select",5),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.selectedCustomer=i)}),e.ALo(3,"async"),e.YNc(4,gt,6,3,"ng-template",6),e.YNc(5,_t,6,3,"ng-template",7),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("items",e.lcZ(3,9,t.customers$))("addTag",!1)("multiple",!0)("hideSelected",!0)("trackByFn",t.trackByFn)("minTermLength",2)("loading",t.isLoading)("typeahead",t.input$)("ngModel",t.selectedCustomer)}}function ht(o,n){if(1&o&&(e.TgZ(0,"clr-tab-content")(1,"form",11)(2,"vdr-form-field",12),e.ALo(3,"translate"),e._UZ(4,"input",13),e.qZA(),e.TgZ(5,"vdr-form-field",14),e.ALo(6,"translate"),e._UZ(7,"input",15),e.qZA(),e.TgZ(8,"vdr-form-field",16),e.ALo(9,"translate"),e._UZ(10,"input",17),e.qZA(),e.TgZ(11,"vdr-form-field",18),e.ALo(12,"translate"),e._UZ(13,"input",19),e.qZA(),e.TgZ(14,"vdr-form-field",20),e.ALo(15,"translate"),e._UZ(16,"input",21),e.qZA()()()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.customerForm),e.xp6(1),e.Q6J("label",e.lcZ(3,6,"customer.title")),e.xp6(3),e.Q6J("label",e.lcZ(6,8,"customer.first-name")),e.xp6(3),e.Q6J("label",e.lcZ(9,10,"customer.last-name")),e.xp6(3),e.Q6J("label",e.lcZ(12,12,"customer.email-address")),e.xp6(3),e.Q6J("label",e.lcZ(15,14,"customer.phone-number"))}}function vt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",23),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.select())}),e._uU(4),e.ALo(5,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,3,"common.cancel")),e.xp6(2),e.Q6J("disabled",t.useExisting&&0===t.selectedCustomer.length||t.createNew&&t.customerForm.invalid),e.xp6(1),e.hij(" ",e.lcZ(5,5,"common.okay")," ")}}function yt(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"order.select-shipping-method"))}function xt(o,n){if(1&o&&e._UZ(0,"vdr-object-tree",9),2&o){const t=e.oxw().$implicit;e.Q6J("value",t.metadata)}}function bt(o,n){if(1&o&&(e.TgZ(0,"vdr-radio-card",4)(1,"div",5)(2,"vdr-labeled-data",6),e.ALo(3,"translate"),e._uU(4),e.qZA(),e.TgZ(5,"div",7)(6,"vdr-labeled-data",6),e.ALo(7,"translate"),e._uU(8),e.ALo(9,"localeCurrency"),e.qZA(),e.TgZ(10,"vdr-labeled-data",6),e.ALo(11,"translate"),e._uU(12),e.ALo(13,"localeCurrency"),e.qZA()(),e.YNc(14,xt,1,1,"vdr-object-tree",8),e.qZA()()),2&o){const t=n.$implicit,r=e.oxw();e.Q6J("item",t),e.xp6(2),e.Q6J("label",e.lcZ(3,8,"settings.shipping-method")),e.xp6(2),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("label",e.lcZ(7,10,"common.price")),e.xp6(2),e.hij(" ",e.xi3(9,12,t.price,r.currencyCode)," "),e.xp6(2),e.Q6J("label",e.lcZ(11,15,"common.price-with-tax")),e.xp6(2),e.hij(" ",e.xi3(13,17,t.priceWithTax,r.currencyCode)," "),e.xp6(2),e.Q6J("ngIf",t.metadata)}}function Ct(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.select())}),e._uU(4),e.ALo(5,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,3,"common.cancel")),e.xp6(2),e.Q6J("disabled",!t.selectedMethod),e.xp6(1),e.hij(" ",e.lcZ(5,5,"common.okay")," ")}}function Ot(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"order.select-state"))}function Tt(o,n){if(1&o&&(e.TgZ(0,"option",4),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"stateI18nToken"),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",e.lcZ(2,2,e.lcZ(3,4,t))," ")}}function Zt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"common.cancel")," "))}const $=function(o){return{state:o}};function At(o,n){if(1&o){const t=e.EpF();e.YNc(0,Zt,3,3,"button",5),e.TgZ(1,"button",6),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.select())}),e._uU(2),e.ALo(3,"translate"),e.ALo(4,"translate"),e.ALo(5,"stateI18nToken"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("ngIf",t.cancellable),e.xp6(1),e.Q6J("disabled",!t.selectedState),e.xp6(1),e.hij(" ",e.xi3(3,3,"order.transition-to-state",e.VKq(10,$,e.lcZ(4,6,e.lcZ(5,8,t.selectedState))))," ")}}function It(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.editable=!0)}),e._UZ(1,"clr-icon",10),e._uU(2),e.ALo(3,"translate"),e.qZA()}2&o&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"common.edit")," "))}function wt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onUpdateClick())}),e._UZ(1,"clr-icon",12),e._uU(2),e.ALo(3,"translate"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",t.customFieldForm.pristine||t.customFieldForm.invalid),e.xp6(2),e.hij(" ",e.lcZ(3,2,"common.update")," ")}}function Ft(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onCancelClick())}),e._UZ(1,"clr-icon",13),e._uU(2),e.ALo(3,"translate"),e.qZA()}2&o&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"common.cancel")," "))}function Mt(o,n){if(1&o&&(e.TgZ(0,"div",1)(1,"div",2),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",3)(5,"div",4),e._UZ(6,"vdr-tabbed-custom-fields",5),e.qZA()(),e.TgZ(7,"div",6),e.YNc(8,It,4,3,"button",7),e.YNc(9,wt,4,4,"button",8),e.YNc(10,Ft,4,3,"button",7),e.qZA()()),2&o){const t=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,10,"common.custom-fields")," "),e.xp6(3),e.ekj("editable",t.editable),e.xp6(1),e.Q6J("customFields",t.customFieldsConfig)("customFieldsFormGroup",t.customFieldForm)("readonly",!t.editable)("compact",!0),e.xp6(2),e.Q6J("ngIf",!t.editable),e.xp6(1),e.Q6J("ngIf",t.editable),e.xp6(1),e.Q6J("ngIf",t.editable)}}function Lt(o,n){1&o&&e._UZ(0,"clr-icon",9)}function St(o,n){1&o&&e._UZ(0,"clr-icon",10)}function Dt(o,n){1&o&&e._UZ(0,"clr-icon",11)}function Pt(o,n){1&o&&(e.TgZ(0,"label",12),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.line-fulfillment-all")," "))}const qt=function(o,n){return{total:o,count:n}};function kt(o,n){if(1&o&&(e.TgZ(0,"label",12),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,"order.line-fulfillment-partial",e.WLB(4,qt,t.line.quantity,t.fulfilledCount))," ")}}function Jt(o,n){1&o&&(e.TgZ(0,"label",12),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.line-fulfillment-none")," "))}function Nt(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",15),e.ALo(1,"translate"),e._uU(2),e.qZA()),2&o){const t=e.oxw().$implicit;e.Q6J("label",e.lcZ(1,2,"order.tracking-code")),e.xp6(2),e.hij(" ",t.fulfillment.trackingCode," ")}}const S=function(o){return{count:o}};function Qt(o,n){if(1&o&&(e.TgZ(0,"div",13)(1,"div",14),e._uU(2),e.ALo(3,"translate"),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"vdr-labeled-data",15),e.ALo(6,"translate"),e._uU(7),e.ALo(8,"localeDate"),e.qZA(),e.TgZ(9,"vdr-labeled-data",15),e.ALo(10,"translate"),e._uU(11),e.qZA(),e.YNc(12,Nt,3,4,"vdr-labeled-data",16),e.qZA()),2&o){const t=n.$implicit;e.xp6(2),e.lnq(" ",e.lcZ(3,8,"order.fulfillment")," #",t.fulfillment.id," (",e.xi3(4,10,"order.item-count",e.VKq(20,S,t.count)),") "),e.xp6(3),e.Q6J("label",e.lcZ(6,13,"common.created-at")),e.xp6(2),e.hij(" ",e.xi3(8,15,t.fulfillment.createdAt,"medium")," "),e.xp6(2),e.Q6J("label",e.lcZ(10,18,"order.fulfillment-method")),e.xp6(2),e.hij(" ",t.fulfillment.method," "),e.xp6(1),e.Q6J("ngIf",t.fulfillment.trackingCode)}}function Ut(o,n){if(1&o&&(e.TgZ(0,"vdr-dropdown",1)(1,"button",2),e.YNc(2,Lt,1,0,"clr-icon",3),e.YNc(3,St,1,0,"clr-icon",4),e.YNc(4,Dt,1,0,"clr-icon",5),e.qZA(),e.TgZ(5,"vdr-dropdown-menu",6),e.YNc(6,Pt,3,3,"label",7),e.YNc(7,kt,3,7,"label",7),e.YNc(8,Jt,3,3,"label",7),e.YNc(9,Qt,13,22,"div",8),e.qZA()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngIf","full"===t.fulfillmentStatus),e.xp6(1),e.Q6J("ngIf","partial"===t.fulfillmentStatus),e.xp6(1),e.Q6J("ngIf","none"===t.fulfillmentStatus),e.xp6(2),e.Q6J("ngIf","full"===t.fulfillmentStatus),e.xp6(1),e.Q6J("ngIf","partial"===t.fulfillmentStatus),e.xp6(1),e.Q6J("ngIf","none"===t.fulfillmentStatus),e.xp6(1),e.Q6J("ngForOf",t.fulfillments)}}function Et(o,n){if(1&o&&(e.TgZ(0,"span",1),e.ALo(1,"translate"),e._UZ(2,"clr-icon",2),e.qZA()),2&o){const t=e.oxw();e.Q6J("title",e.xi3(1,1,"order.refunded-count",e.VKq(4,S,t.getRefundedCount())))}}function Yt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"th",18)(1,"input",19),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onToggleAllClick())}),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("checked",null==t.selectionManager?null:t.selectionManager.areAllCurrentItemsSelected())}}function Rt(o,n){1&o&&e._UZ(0,"clr-icon",29)}function jt(o,n){1&o&&e._UZ(0,"clr-icon",30)}function $t(o,n){1&o&&e._UZ(0,"clr-icon",31)}function Ht(o,n){if(1&o&&(e.TgZ(0,"div",32),e._uU(1),e.qZA()),2&o){const t=e.oxw().ngIf;e.xp6(1),e.Oqu(t.sortOrder)}}function Gt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",23)(1,"button",24),e.NdJ("click",function(){const l=e.CHM(t).ngIf;return e.KtG(l.toggleSortOrder())}),e.YNc(2,Rt,1,0,"clr-icon",25),e.YNc(3,jt,1,0,"clr-icon",26),e.YNc(4,$t,1,0,"clr-icon",27),e.qZA(),e.YNc(5,Ht,2,1,"div",28),e.qZA()}if(2&o){const t=n.ngIf;e.xp6(1),e.ekj("active",t.sortOrder),e.xp6(1),e.Q6J("ngIf",!t.sortOrder),e.xp6(1),e.Q6J("ngIf","ASC"===t.sortOrder),e.xp6(1),e.Q6J("ngIf","DESC"===t.sortOrder),e.xp6(1),e.Q6J("ngIf",t.sortOrder)}}function Bt(o,n){if(1&o&&(e.TgZ(0,"th")(1,"div",20)(2,"vdr-ui-extension-point",21)(3,"span"),e._uU(4),e.qZA()(),e.YNc(5,Gt,6,6,"div",22),e.qZA()()),2&o){const t=n.$implicit,r=e.oxw();e.ekj("expand",t.expand),e.xp6(1),e.Q6J("ngClass",t.align),e.xp6(1),e.Q6J("locationId",r.id)("metadata",t.id)("topPx",-6)("leftPx",-24),e.xp6(2),e.Oqu(t.heading),e.xp6(1),e.Q6J("ngIf",t.sort)}}function Vt(o,n){1&o&&e.GkF(0)}function Kt(o,n){1&o&&e.GkF(0)}function zt(o,n){if(1&o&&e._UZ(0,"vdr-data-table-filters",41),2&o){const t=n.$implicit,r=e.oxw(3);e.Q6J("filterWithValue",t)("filters",r.filters)}}function Wt(o,n){if(1&o&&e._UZ(0,"vdr-data-table-filters",42),2&o){const t=e.oxw(3);e.Q6J("filters",t.filters)}}function Xt(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",38),e.YNc(2,zt,1,2,"vdr-data-table-filters",39),e.YNc(3,Wt,1,1,"vdr-data-table-filters",40),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.filters.activeFilters),e.xp6(1),e.Q6J("ngIf",t.filters.length)}}function en(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"th",33)(2,"button",34),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.toggleSearchFilterRow())}),e.ALo(3,"translate"),e._UZ(4,"clr-icon",35),e.qZA(),e.TgZ(5,"div",36),e.YNc(6,Vt,1,0,"ng-container",37),e.YNc(7,Kt,1,0,"ng-container",37),e.YNc(8,Xt,4,2,"ng-container",8),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(1),e.ekj("active",t.showSearchFilterRow),e.uIk("colspan",t.visibleSortedColumns.length+(t.selectionManager?2:1)),e.xp6(1),e.ekj("active",t.showSearchFilterRow),e.Q6J("title",e.lcZ(3,11,"common.search-and-filter-list")),e.xp6(3),e.ekj("hidden",!t.showSearchFilterRow),e.xp6(1),e.Q6J("ngTemplateOutlet",null==t.searchComponent?null:t.searchComponent.template),e.xp6(1),e.Q6J("ngTemplateOutlet",t.customSearchTemplate),e.xp6(1),e.Q6J("ngIf",t.filters)}}function tn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"td",18)(1,"input",45),e.NdJ("click",function(i){e.CHM(t);const l=e.oxw().$implicit,c=e.oxw();return e.KtG(c.onRowClick(l,i))}),e.qZA()()}if(2&o){const t=e.oxw(),r=t.index,i=t.$implicit,l=e.oxw();e.ekj("active",l.activeIndex===r),e.xp6(1),e.Q6J("checked",null==l.selectionManager?null:l.selectionManager.isSelected(i))}}function nn(o,n){1&o&&e.GkF(0)}const rn=function(o){return{rowItem:o}};function on(o,n){if(1&o&&(e.ynx(0),e.YNc(1,nn,1,0,"ng-container",48),e.BQk()),2&o){const t=n.ngIf,r=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngComponentOutlet",t.config.component)("ngComponentOutletInputs",e.VKq(3,rn,r))("ngComponentOutletInjector",t.injector)}}function an(o,n){1&o&&e.GkF(0)}const ln=function(o,n){return{item:o,index:n}};function dn(o,n){if(1&o&&e.YNc(0,an,1,0,"ng-container",49),2&o){const t=e.oxw().$implicit,r=e.oxw(),i=r.$implicit,l=r.index;e.Q6J("ngTemplateOutlet",t.template)("ngTemplateOutletContext",e.WLB(2,ln,i,l))}}function cn(o,n){if(1&o&&(e.TgZ(0,"td")(1,"div",20),e.YNc(2,on,2,5,"ng-container",46),e.YNc(3,dn,1,5,"ng-template",null,47,e.W1O),e.qZA()()),2&o){const t=n.$implicit,r=e.MAs(4),i=e.oxw().index,l=e.oxw();e.ekj("active",l.activeIndex===i),e.xp6(1),e.Q6J("ngClass",t.align),e.xp6(1),e.Q6J("ngIf",l.customComponents.get(t.id))("ngIfElse",r)}}function sn(o,n){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,tn,2,3,"td",43),e.YNc(2,cn,5,5,"td",44),e._UZ(3,"td"),e.qZA()),2&o){const t=n.index,r=e.oxw();e.xp6(1),e.Q6J("ngIf",r.selectionManager),e.xp6(1),e.Q6J("ngForOf",r.visibleSortedColumns),e.xp6(1),e.ekj("active",r.activeIndex===t)}}function pn(o,n){if(1&o&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"vdr-empty-placeholder",50),e.ALo(3,"translate"),e.qZA()()),2&o){const t=e.oxw();e.xp6(1),e.uIk("colspan",t.visibleSortedColumns.length+(t.selectionManager?2:1)),e.xp6(1),e.Q6J("emptyStateLabel",e.lcZ(3,2,"order.order-is-empty"))}}function un(o,n){if(1&o&&(e.TgZ(0,"tr",51)(1,"td",52),e._uU(2),e.qZA(),e.TgZ(3,"td",53),e._uU(4),e.qZA(),e._UZ(5,"td",54),e.TgZ(6,"td",55),e._uU(7),e.ALo(8,"localeCurrency"),e.TgZ(9,"div",14),e.ALo(10,"translate"),e._uU(11),e.ALo(12,"localeCurrency"),e.qZA()(),e._UZ(13,"td"),e.qZA()),2&o){const t=n.$implicit,r=e.oxw();e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Oqu(t.sku),e.xp6(1),e.uIk("colspan",r.visibleSortedColumns.length-4),e.xp6(2),e.hij(" ",e.xi3(8,6,t.priceWithTax,r.order.currencyCode)," "),e.xp6(2),e.Q6J("title",e.lcZ(10,9,"order.net-price")),e.xp6(2),e.hij(" ",e.xi3(12,11,t.price,r.order.currencyCode)," ")}}function mn(o,n){if(1&o&&(e.TgZ(0,"vdr-chip"),e._uU(1),e.qZA()),2&o){const t=n.ngIf;e.xp6(1),e.Oqu(t)}}function gn(o,n){if(1&o&&(e.TgZ(0,"tr",57)(1,"td",2)(2,"a",58),e._uU(3),e.qZA(),e.YNc(4,mn,2,1,"vdr-chip",8),e.qZA(),e.TgZ(5,"td",2),e._uU(6),e.ALo(7,"localeCurrency"),e.TgZ(8,"div",14),e.ALo(9,"translate"),e._uU(10),e.ALo(11,"localeCurrency"),e.qZA()(),e._UZ(12,"td"),e.qZA()),2&o){const t=e.oxw().$implicit,r=e.oxw();e.xp6(1),e.uIk("colspan",r.visibleSortedColumns.length-1),e.xp6(1),e.Q6J("routerLink",r.getPromotionLink(t)),e.xp6(1),e.Oqu(t.description),e.xp6(1),e.Q6J("ngIf",r.getCouponCodeForAdjustment(r.order,t)),e.xp6(2),e.hij(" ",e.xi3(7,7,t.amountWithTax,r.order.currencyCode)," "),e.xp6(2),e.Q6J("title",e.lcZ(9,10,"order.net-price")),e.xp6(2),e.hij(" ",e.xi3(11,12,t.amount,r.order.currencyCode)," ")}}function _n(o,n){if(1&o&&(e.ynx(0),e.YNc(1,gn,13,15,"tr",56),e.BQk()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf","OTHER"!==t.type)}}function fn(o,n){if(1&o&&(e.TgZ(0,"vdr-chip",59),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.shippingMethod.name," ")}}const hn=[[["vdr-bulk-action-menu"]]],vn=function(o,n,t,r){return{id:o,itemsPerPage:n,currentPage:t,totalItems:r}},yn=["vdr-bulk-action-menu"];function xn(o,n){if(1&o&&(e._UZ(0,"img",11),e.ALo(1,"assetPreview")),2&o){const t=n.ngIf;e.Q6J("src",e.xi3(1,1,t,"tiny"),e.LSH)}}function bn(o,n){1&o&&(e.TgZ(0,"div",12),e._UZ(1,"clr-icon",13),e.qZA())}function Cn(o,n){if(1&o&&(e.TgZ(0,"div",8),e.YNc(1,xn,2,4,"img",9),e.YNc(2,bn,2,0,"ng-template",null,10,e.W1O),e.qZA()),2&o){const t=n.item,r=e.MAs(3);e.xp6(1),e.Q6J("ngIf",t.featuredAsset)("ngIfElse",r)}}function On(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.productVariant.name," ")}}function Tn(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.productVariant.sku," ")}}function Zn(o,n){if(1&o&&(e.TgZ(0,"div",14),e._uU(1),e.ALo(2,"localeCurrency"),e.TgZ(3,"div",15),e.ALo(4,"translate"),e._uU(5),e.ALo(6,"localeCurrency"),e.qZA()()),2&o){const t=n.item,r=e.oxw();e.xp6(1),e.hij(" ",e.xi3(2,3,t.unitPriceWithTax,r.order.currencyCode)," "),e.xp6(2),e.Q6J("title",e.lcZ(4,6,"order.net-price")),e.xp6(2),e.hij(" ",e.xi3(6,8,t.unitPrice,r.order.currencyCode)," ")}}function An(o,n){if(1&o&&(e.TgZ(0,"div",22),e.ALo(1,"translate"),e._uU(2),e.qZA()),2&o){const t=e.oxw(2).item;e.Q6J("title",e.lcZ(1,2,"order.original-quantity-at-checkout")),e.xp6(2),e.hij(" ",t.orderPlacedQuantity," ")}}function In(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",20),e.YNc(2,An,3,4,"div",21),e.TgZ(3,"div"),e._uU(4),e.qZA()(),e.BQk()),2&o){const t=e.oxw().item;e.xp6(2),e.Q6J("ngIf",t.orderPlacedQuantity&&t.quantity!==t.orderPlacedQuantity),e.xp6(2),e.Oqu(t.quantity)}}function wn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",20)(1,"input",23,24),e.NdJ("blur",function(){e.CHM(t);const i=e.MAs(2),l=e.oxw().item,c=e.oxw();return e.KtG(c.draftInputBlur(l,i.valueAsNumber))}),e.qZA(),e.TgZ(3,"button",25),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().item,l=e.oxw();return e.KtG(l.remove.emit({lineId:i.id}))}),e._UZ(4,"clr-icon",26),e.qZA()()}if(2&o){const t=e.oxw().item;e.xp6(1),e.Q6J("value",t.quantity)}}function Fn(o,n){if(1&o&&(e.YNc(0,In,5,2,"ng-container",16),e.YNc(1,wn,5,1,"ng-template",null,17,e.W1O),e._UZ(3,"vdr-line-refunds",18)(4,"vdr-line-fulfillment",19)),2&o){const t=n.item,r=e.MAs(2),i=e.oxw();e.Q6J("ngIf",!i.isDraft)("ngIfElse",r),e.xp6(3),e.Q6J("line",t)("payments",i.order.payments),e.xp6(1),e.Q6J("line",t)("orderState",i.order.state)("allOrderFulfillments",i.order.fulfillments)}}function Mn(o,n){if(1&o&&e._UZ(0,"vdr-dt2-custom-field-column",27),2&o){const t=n.$implicit;e.Q6J("customField",t)}}function Ln(o,n){if(1&o&&(e.TgZ(0,"div",31)(1,"a",32),e._uU(2),e.qZA(),e.TgZ(3,"div",33),e._uU(4),e.ALo(5,"localeCurrency"),e.TgZ(6,"div",15),e.ALo(7,"translate"),e._uU(8),e.ALo(9,"localeCurrency"),e.qZA()()()),2&o){const t=n.$implicit,r=e.oxw(4);e.xp6(1),e.Q6J("routerLink",r.getPromotionLink(t)),e.xp6(1),e.Oqu(t.description),e.xp6(2),e.hij(" ",e.xi3(5,5,t.amountWithTax,r.order.currencyCode)," "),e.xp6(2),e.Q6J("title",e.lcZ(7,8,"order.net-price")),e.xp6(2),e.hij(" ",e.xi3(9,10,t.amount,r.order.currencyCode)," ")}}function Sn(o,n){if(1&o&&(e.TgZ(0,"vdr-dropdown")(1,"div",29),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"vdr-dropdown-menu"),e.YNc(5,Ln,10,13,"div",30),e.qZA()()),2&o){const t=e.oxw().ngIf;e.xp6(2),e.hij(" ",e.lcZ(3,2,"order.promotions-applied")," "),e.xp6(3),e.Q6J("ngForOf",t)}}function Dn(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Sn,6,4,"vdr-dropdown",28),e.BQk()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("ngIf",t.length)}}function Pn(o,n){if(1&o&&(e.TgZ(0,"div",14),e._uU(1),e.ALo(2,"localeCurrency"),e.TgZ(3,"div",15),e.ALo(4,"translate"),e._uU(5),e.ALo(6,"localeCurrency"),e.qZA()(),e.YNc(7,Dn,2,1,"ng-container",28)),2&o){const t=n.item,r=e.oxw();e.xp6(1),e.hij(" ",e.xi3(2,4,t.linePriceWithTax,r.order.currencyCode)," "),e.xp6(2),e.Q6J("title",e.lcZ(4,7,"order.net-price")),e.xp6(2),e.hij(" ",e.xi3(6,9,t.linePrice,r.order.currencyCode)," "),e.xp6(2),e.Q6J("ngIf",r.getLineDiscounts(t))}}function qn(o,n){if(1&o&&(e.TgZ(0,"div",16),e._UZ(1,"vdr-custom-field-control",17),e.qZA()),2&o){const t=n.$implicit,r=e.oxw(3);e.xp6(1),e.Q6J("compact",!0)("readonly",!1)("customField",t)("customFieldsFormGroup",r.customFieldsFormGroup)}}function kn(o,n){if(1&o&&(e.ynx(0),e.YNc(1,qn,2,4,"div",15),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.orderLineCustomFields)}}function Jn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",5),e._UZ(2,"img",6),e.ALo(3,"assetPreview"),e.TgZ(4,"div",7)(5,"div"),e._uU(6),e.qZA(),e.TgZ(7,"div",8),e._uU(8),e.qZA()(),e.TgZ(9,"div",9)(10,"div",8),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"div",8),e._uU(14),e.ALo(15,"translate"),e.qZA()(),e._UZ(16,"div",10),e.TgZ(17,"div",7)(18,"div"),e._uU(19),e.ALo(20,"localeCurrency"),e.qZA(),e.TgZ(21,"div",11),e.ALo(22,"translate"),e._uU(23),e.ALo(24,"localeCurrency"),e.qZA()(),e.TgZ(25,"div")(26,"input",12),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.quantity=i)}),e.qZA()(),e.TgZ(27,"button",13),e.NdJ("click",function(){const l=e.CHM(t).ngIf,c=e.oxw();return e.KtG(c.addItemClick(l))}),e._uU(28),e.ALo(29,"translate"),e.qZA()(),e.YNc(30,kn,2,1,"ng-container",14),e.qZA()}if(2&o){const t=n.ngIf,r=e.oxw();e.xp6(2),e.Q6J("src",e.xi3(3,15,t.featuredAsset||t.product.featuredAsset,32),e.LSH),e.xp6(4),e.Oqu(null==t?null:t.name),e.xp6(2),e.Oqu(null==t?null:t.sku),e.xp6(3),e.AsE(" ",e.lcZ(12,18,"catalog.stock-on-hand"),": ",t.stockOnHand," "),e.xp6(3),e.AsE(" ",e.lcZ(15,20,"catalog.stock-allocated"),": ",t.stockAllocated," "),e.xp6(5),e.Oqu(e.xi3(20,22,null==t?null:t.priceWithTax,r.currencyCode)),e.xp6(2),e.Q6J("title",e.lcZ(22,25,"order.net-price")),e.xp6(2),e.hij(" ",e.xi3(24,27,null==t?null:t.price,r.currencyCode)," "),e.xp6(3),e.Q6J("disabled",!t)("ngModel",r.quantity),e.xp6(1),e.Q6J("disabled",!t),e.xp6(1),e.hij(" ",e.lcZ(29,30,"order.add-item-to-order")," "),e.xp6(2),e.Q6J("ngIf",r.orderLineCustomFields.length)}}function Nn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-action-bar")(1,"vdr-ab-left")(2,"div",1),e._UZ(3,"vdr-order-state-label",2),e.qZA()(),e.TgZ(4,"vdr-ab-right"),e._UZ(5,"vdr-action-bar-items",3),e.TgZ(6,"button",4),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.completeOrder())}),e._UZ(7,"clr-icon",5),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"vdr-dropdown")(11,"button",6),e._UZ(12,"clr-icon",7),e.qZA(),e.TgZ(13,"vdr-dropdown-menu",8)(14,"button",9),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.deleteOrder())}),e._UZ(15,"clr-icon",10),e._uU(16),e.ALo(17,"translate"),e.qZA()()()()()}if(2&o){const t=n.ngIf;e.xp6(3),e.Q6J("state",t.state),e.xp6(3),e.Q6J("disabled",!t.customer||!t.lines.length||!t.shippingLines.length),e.xp6(2),e.hij(" ",e.lcZ(9,4,"order.complete-draft-order")," "),e.xp6(8),e.hij(" ",e.lcZ(17,6,"order.delete-draft-order")," ")}}function Qn(o,n){1&o&&e._UZ(0,"clr-icon",26)}function Un(o,n){1&o&&e._UZ(0,"clr-icon",27)}function En(o,n){if(1&o&&(e.YNc(0,Qn,1,0,"clr-icon",24),e.YNc(1,Un,1,0,"clr-icon",25)),2&o){const t=e.oxw().ngIf;e.Q6J("ngIf",!t.customer),e.xp6(1),e.Q6J("ngIf",t.customer)}}function Yn(o,n){if(1&o&&e._UZ(0,"vdr-customer-label",28),2&o){const t=e.oxw().ngIf;e.Q6J("customer",t.customer)}}function Rn(o,n){1&o&&e._UZ(0,"clr-icon",26)}function jn(o,n){1&o&&e._UZ(0,"clr-icon",27)}function $n(o,n){if(1&o&&(e.YNc(0,Rn,1,0,"clr-icon",24),e.YNc(1,jn,1,0,"clr-icon",25)),2&o){const t=e.oxw().ngIf;e.Q6J("ngIf",!t.billingAddress.streetLine1),e.xp6(1),e.Q6J("ngIf",t.billingAddress.streetLine1)}}function Hn(o,n){if(1&o&&e._UZ(0,"vdr-formatted-address",29),2&o){const t=e.oxw().ngIf;e.Q6J("address",t.billingAddress)}}function Gn(o,n){1&o&&e._UZ(0,"clr-icon",26)}function Bn(o,n){1&o&&e._UZ(0,"clr-icon",27)}function Vn(o,n){if(1&o&&(e.YNc(0,Gn,1,0,"clr-icon",24),e.YNc(1,Bn,1,0,"clr-icon",25)),2&o){const t=e.oxw().ngIf;e.Q6J("ngIf",!t.shippingAddress.streetLine1||!t.shippingLines.length),e.xp6(1),e.Q6J("ngIf",t.shippingAddress.streetLine1&&t.shippingLines.length)}}function Kn(o,n){if(1&o&&e._UZ(0,"vdr-formatted-address",29),2&o){const t=e.oxw().ngIf;e.Q6J("address",t.shippingAddress)}}function zn(o,n){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.shippingMethod.name," ")}}function Wn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.displayCouponCodeInput=!i.displayCouponCodeInput)}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.set-coupon-codes")," "))}function Xn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"label"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"vdr-coupon-code-selector",30),e.NdJ("addCouponCode",function(i){e.CHM(t);const l=e.oxw(2);return e.KtG(l.applyCouponCode(i))})("removeCouponCode",function(i){e.CHM(t);const l=e.oxw(2);return e.KtG(l.removeCouponCode(i))}),e.qZA()()}if(2&o){const t=e.oxw().ngIf;e.xp6(2),e.Oqu(e.lcZ(3,2,"order.set-coupon-codes")),e.xp6(2),e.Q6J("couponCodes",t.couponCodes)}}function er(o,n){if(1&o&&e._UZ(0,"vdr-page-entity-info",31),2&o){const t=n.ngIf;e.Q6J("entity",t)}}function tr(o,n){if(1&o&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"percent"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"localeCurrency"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"localeCurrency"),e.qZA()()),2&o){const t=n.$implicit,r=e.oxw(2).ngIf;e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Oqu(e.lcZ(5,4,t.taxRate/100)),e.xp6(3),e.Oqu(e.xi3(8,6,t.taxBase,r.currencyCode)),e.xp6(3),e.Oqu(e.xi3(11,9,t.taxTotal,r.currencyCode))}}function nr(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"table",32)(2,"thead")(3,"tr")(4,"th"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"th"),e._uU(14),e.ALo(15,"translate"),e.qZA()()(),e.TgZ(16,"tbody"),e.YNc(17,tr,12,12,"tr",17),e.qZA()(),e.BQk()),2&o){const t=e.oxw().ngIf;e.xp6(5),e.Oqu(e.lcZ(6,5,"common.description")),e.xp6(3),e.Oqu(e.lcZ(9,7,"order.tax-rate")),e.xp6(3),e.Oqu(e.lcZ(12,9,"order.tax-base")),e.xp6(3),e.Oqu(e.lcZ(15,11,"order.tax-total")),e.xp6(3),e.Q6J("ngForOf",t.taxSummary)}}function rr(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-page-detail-layout")(1,"vdr-page-detail-sidebar")(2,"vdr-card",11),e.ALo(3,"translate"),e.YNc(4,En,2,2,"ng-template",12),e.YNc(5,Yn,1,1,"vdr-customer-label",13),e.TgZ(6,"button",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.setCustomer())}),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"vdr-card",11),e.ALo(10,"translate"),e.YNc(11,$n,2,2,"ng-template",12),e.YNc(12,Hn,1,1,"vdr-formatted-address",15),e.TgZ(13,"button",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.setBillingAddress())}),e._uU(14),e.ALo(15,"translate"),e.qZA()(),e.TgZ(16,"vdr-card",11),e.ALo(17,"translate"),e.YNc(18,Vn,2,2,"ng-template",12),e.YNc(19,Kn,1,1,"vdr-formatted-address",15),e.TgZ(20,"button",16),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.setShippingAddress())}),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.YNc(23,zn,2,1,"div",17),e.TgZ(24,"button",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.setShippingMethod())}),e._uU(25),e.ALo(26,"translate"),e.qZA()(),e.TgZ(27,"vdr-card"),e.YNc(28,Wn,3,3,"button",18),e.YNc(29,Xn,5,4,"div",0),e.qZA(),e.TgZ(30,"vdr-card"),e.YNc(31,er,1,1,"vdr-page-entity-info",19),e.ALo(32,"async"),e.qZA()(),e.TgZ(33,"vdr-page-block")(34,"vdr-card")(35,"vdr-draft-order-variant-selector",20),e.NdJ("addItem",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.addItemToOrder(i))}),e.qZA(),e.TgZ(36,"vdr-order-table",21),e.NdJ("adjust",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.adjustOrderLine(i))})("remove",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.removeOrderLine(i))}),e.qZA()(),e.TgZ(37,"vdr-card",11),e.ALo(38,"translate"),e.YNc(39,nr,18,13,"ng-container",0),e.qZA(),e._UZ(40,"vdr-custom-detail-component-host",22),e.TgZ(41,"vdr-order-custom-fields-card",23),e.NdJ("updateClick",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.updateCustomFields(i))}),e.qZA()()()}if(2&o){const t=n.ngIf,r=e.oxw();e.xp6(2),e.Q6J("title",e.lcZ(3,25,"order.customer")),e.xp6(3),e.Q6J("ngIf",t.customer),e.xp6(2),e.hij(" ",e.lcZ(8,27,"order.set-customer-for-order")," "),e.xp6(2),e.Q6J("title",e.lcZ(10,29,"order.billing-address")),e.xp6(3),e.Q6J("ngIf",t.billingAddress),e.xp6(2),e.hij(" ",e.lcZ(15,31,"order.set-billing-address")," "),e.xp6(2),e.Q6J("title",e.lcZ(17,33,"order.shipping")),e.xp6(3),e.Q6J("ngIf",t.shippingAddress),e.xp6(2),e.hij(" ",e.lcZ(22,35,"order.set-shipping-address")," "),e.xp6(2),e.Q6J("ngForOf",t.shippingLines),e.xp6(2),e.hij(" ",e.lcZ(26,37,"order.set-shipping-method")," "),e.xp6(3),e.Q6J("ngIf",0===t.couponCodes.length&&!r.displayCouponCodeInput),e.xp6(1),e.Q6J("ngIf",t.couponCodes.length||r.displayCouponCodeInput),e.xp6(2),e.Q6J("ngIf",e.lcZ(32,39,r.entity$)),e.xp6(4),e.Q6J("orderLineCustomFields",r.orderLineCustomFields)("currencyCode",t.currencyCode),e.xp6(1),e.Q6J("order",t)("orderLineCustomFields",r.orderLineCustomFields)("isDraft",!0),e.xp6(1),e.Q6J("title",e.lcZ(38,41,"order.tax-summary")),e.xp6(2),e.Q6J("ngIf",t.taxSummary.length),e.xp6(1),e.Q6J("entity$",r.entity$)("detailForm",r.detailForm),e.xp6(1),e.Q6J("customFieldsConfig",r.customFields)("customFieldValues",t.customFields)}}function or(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"order.fulfill-order"))}function ir(o,n){if(1&o&&(e._UZ(0,"img",17),e.ALo(1,"assetPreview")),2&o){const t=e.oxw().$implicit;e.Q6J("src",e.xi3(1,1,t.featuredAsset,"tiny"),e.LSH)}}function ar(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"input",18),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw().$implicit,c=e.oxw();return e.KtG(c.fulfillmentQuantities[l.id].fulfillCount=i)}),e.qZA()}if(2&o){const t=e.oxw().$implicit,r=e.oxw();e.Q6J("disabled",0===r.getUnfulfilledCount(t))("ngModel",r.fulfillmentQuantities[t.id].fulfillCount)("max",r.fulfillmentQuantities[t.id].max)}}function lr(o,n){if(1&o&&(e.TgZ(0,"tr",9)(1,"td",10),e.YNc(2,ir,2,4,"img",11),e.qZA(),e.TgZ(3,"td",12),e._uU(4),e.qZA(),e.TgZ(5,"td",13),e._uU(6),e.qZA(),e.TgZ(7,"td",14),e._uU(8),e.qZA(),e.TgZ(9,"td",14),e._uU(10),e.qZA(),e.TgZ(11,"td",15),e.YNc(12,ar,1,3,"input",16),e.qZA()()),2&o){const t=n.$implicit,r=e.oxw();e.ekj("ignore",0===r.getUnfulfilledCount(t)),e.xp6(2),e.Q6J("ngIf",t.featuredAsset),e.xp6(2),e.Oqu(t.productVariant.name),e.xp6(2),e.Oqu(t.productVariant.sku),e.xp6(2),e.Oqu(r.getUnfulfilledCount(t)),e.xp6(2),e.Oqu(t.productVariant.stockOnHand),e.xp6(2),e.Q6J("ngIf",r.fulfillmentQuantities[t.id])}}function dr(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",20),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.select())}),e._uU(4),e.ALo(5,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,3,"common.cancel")),e.xp6(2),e.Q6J("disabled",!t.canSubmit()),e.xp6(1),e.hij(" ",e.lcZ(5,5,"order.create-fulfillment")," ")}}function cr(o,n){if(1&o&&(e.TgZ(0,"li",2)(1,"div",3),e._uU(2),e.qZA(),e._UZ(3,"clr-icon",4),e._uU(4),e.qZA()),2&o){const t=n.$implicit;e.Q6J("title",t.name),e.xp6(2),e.Oqu(t.quantity),e.xp6(2),e.hij(" ",t.name," ")}}function sr(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",0),e.ALo(1,"translate"),e._uU(2),e.qZA()),2&o){const t=e.oxw();e.Q6J("label",e.lcZ(1,2,"order.tracking-code")),e.xp6(2),e.hij(" ",null==t.fulfillment?null:t.fulfillment.trackingCode,"\n")}}function pr(o,n){if(1&o&&e._UZ(0,"vdr-custom-field-control",5),2&o){const t=e.oxw().$implicit,r=e.oxw();e.Q6J("readonly",!0)("compact",!0)("customField",t)("customFieldsFormGroup",r.customFieldFormGroup)}}function ur(o,n){if(1&o&&(e.ynx(0),e.YNc(1,pr,1,4,"vdr-custom-field-control",4),e.BQk()),2&o){const t=n.$implicit,r=e.oxw();e.xp6(1),e.Q6J("ngIf",r.customFieldFormGroup.get(t.name))}}function mr(o,n){1&o&&e._UZ(0,"clr-icon",2)}function gr(o,n){if(1&o&&e._UZ(0,"vdr-fulfillment-detail",7),2&o){const t=e.oxw();e.Q6J("fulfillmentId",null==t.fulfillment?null:t.fulfillment.id)("order",t.order)}}function _r(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",14),e.NdJ("click",function(){const l=e.CHM(t).ngIf,c=e.oxw(2);return e.KtG(c.transitionState.emit(l))}),e._uU(2),e.ALo(3,"translate"),e.ALo(4,"translate"),e.ALo(5,"stateI18nToken"),e.qZA(),e.BQk()}if(2&o){const t=n.ngIf;e.xp6(2),e.hij(" ",e.xi3(3,1,"order.set-fulfillment-state",e.VKq(8,$,e.lcZ(4,4,e.lcZ(5,6,t))))," ")}}function fr(o,n){if(1&o&&(e.ynx(0),e._UZ(1,"clr-icon",18),e._uU(2),e.ALo(3,"translate"),e.ALo(4,"translate"),e.ALo(5,"stateI18nToken"),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",e.xi3(3,1,"order.transition-to-state",e.VKq(8,$,e.lcZ(4,4,e.lcZ(5,6,t))))," ")}}function hr(o,n){1&o&&(e._UZ(0,"clr-icon",19),e._uU(1),e.ALo(2,"translate")),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.cancel-fulfillment")," "))}function vr(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",15),e.NdJ("click",function(){const l=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.transitionState.emit(l))}),e.YNc(2,fr,6,10,"ng-container",16),e.YNc(3,hr,3,3,"ng-template",null,17,e.W1O),e.qZA(),e.BQk()}if(2&o){const t=n.$implicit,r=e.MAs(4);e.xp6(2),e.Q6J("ngIf","Cancelled"!==t)("ngIfElse",r)}}function yr(o,n){if(1&o&&(e.TgZ(0,"div",8),e.YNc(1,_r,6,10,"ng-container",9),e.TgZ(2,"vdr-dropdown")(3,"button",10),e._UZ(4,"clr-icon",11),e.qZA(),e.TgZ(5,"vdr-dropdown-menu",12),e.YNc(6,vr,5,2,"ng-container",13),e.qZA()()()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.nextSuggestedState()),e.xp6(5),e.Q6J("ngForOf",t.nextOtherStates())}}function xr(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",0),e.ALo(1,"translate"),e._uU(2),e.qZA()),2&o){const t=e.oxw();e.Q6J("label",e.lcZ(1,2,"order.note")),e.xp6(2),e.Oqu(t.modification.note)}}function br(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",0),e.ALo(1,"translate"),e._uU(2),e.ALo(3,"localeCurrency"),e.qZA()),2&o){const t=n.$implicit,r=e.oxw();let i;e.Q6J("label",e.lcZ(1,3,"order.surcharges")),e.xp6(2),e.AsE(" ",null==(i=r.getSurcharge(t.id))?null:i.description," ",e.xi3(3,5,null==(i=r.getSurcharge(t.id))?null:i.priceWithTax,r.order.currencyCode),"")}}function Cr(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",0),e.ALo(1,"translate"),e._UZ(2,"vdr-simple-item-list",3),e.qZA()),2&o){const t=e.oxw();e.Q6J("label",e.lcZ(1,2,"order.added-items")),e.xp6(2),e.Q6J("items",t.getAddedItems())}}function Or(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",0),e.ALo(1,"translate"),e._UZ(2,"vdr-simple-item-list",3),e.qZA()),2&o){const t=e.oxw();e.Q6J("label",e.lcZ(1,2,"order.removed-items")),e.xp6(2),e.Q6J("items",t.getRemovedItems())}}function Tr(o,n){if(1&o&&(e.TgZ(0,"div",3),e._UZ(1,"div",4)(2,"clr-icon",5),e.TgZ(3,"div",6),e._uU(4),e.ALo(5,"translate"),e.ALo(6,"stateI18nToken"),e.qZA()()),2&o){const t=e.oxw();e.xp6(4),e.hij(" ",e.lcZ(5,1,e.lcZ(6,3,t.cancelledState))," ")}}function Zr(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"vdr-order-process-node",1),e.NdJ("mouseenter",function(){const l=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.onMouseOver(l.name))})("mouseleave",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onMouseOut())}),e.ALo(2,"async"),e.qZA(),e.BQk()}if(2&o){const t=n.$implicit,r=n.index,i=e.oxw();e.xp6(1),e.Q6J("node",t)("index",r)("active",e.lcZ(2,3,i.activeState$)===t.name)}}function Ar(o,n){if(1&o&&(e.ynx(0),e._UZ(1,"vdr-order-process-edge",2),e.BQk()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("from",t.from)("to",t.to)("index",t.index)}}function Ir(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"order.order-state-diagram"))}function wr(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"order.refund-and-cancel-order"))}function Fr(o,n){if(1&o&&(e.TgZ(0,"div",36),e._uU(1),e.TgZ(2,"div",37),e._uU(3),e.ALo(4,"currency"),e.ALo(5,"number"),e.qZA()()),2&o){const t=n.$implicit,r=e.oxw(3).$implicit,i=e.oxw();e.xp6(1),e.hij(" ",t.description," "),e.xp6(2),e.hij(" ",e.xi3(4,2,e.xi3(5,5,t.amount/100/r.quantity,"1.0-2"),i.order.currencyCode)," ")}}function Mr(o,n){if(1&o&&(e.TgZ(0,"vdr-dropdown")(1,"div",32)(2,"button",33),e._UZ(3,"clr-icon",34),e.qZA()(),e.TgZ(4,"vdr-dropdown-menu"),e.YNc(5,Fr,6,8,"div",35),e.qZA()()),2&o){const t=e.oxw().ngIf;e.xp6(5),e.Q6J("ngForOf",t)}}function Lr(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Mr,6,1,"vdr-dropdown",26),e.BQk()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("ngIf",t.length)}}function Sr(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"input",38),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw().$implicit,c=e.oxw();return e.KtG(c.lineQuantities[l.id].quantity=i)})("input",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw();return e.KtG(l.handleZeroQuantity(l.lineQuantities[i.id]))}),e.qZA()}if(2&o){const t=e.oxw().$implicit,r=e.oxw();e.Q6J("ngModel",r.lineQuantities[t.id].quantity)("max",t.quantity)}}function Dr(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"input",39),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw().$implicit,c=e.oxw();return e.KtG(c.lineQuantities[l.id].refund=i)}),e.qZA()}if(2&o){const t=e.oxw().$implicit,r=e.oxw();e.Q6J("disabled",0===r.lineQuantities[t.id].quantity)("ngModel",r.lineQuantities[t.id].refund)}}function Pr(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"input",39),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw().$implicit,c=e.oxw();return e.KtG(c.lineQuantities[l.id].cancel=i)}),e.qZA()}if(2&o){const t=e.oxw().$implicit,r=e.oxw();e.Q6J("disabled",0===r.lineQuantities[t.id].quantity)("ngModel",r.lineQuantities[t.id].cancel)}}function qr(o,n){if(1&o&&(e.TgZ(0,"tr",18)(1,"td",19),e._UZ(2,"img",20),e.ALo(3,"assetPreview"),e.qZA(),e.TgZ(4,"td",21),e._uU(5),e.qZA(),e.TgZ(6,"td",22),e._uU(7),e.qZA(),e.TgZ(8,"td",23),e._uU(9),e._UZ(10,"vdr-line-refunds",24),e.qZA(),e.TgZ(11,"td",23),e._uU(12),e.ALo(13,"localeCurrency"),e.qZA(),e.TgZ(14,"td",23)(15,"div",25),e._uU(16),e.ALo(17,"localeCurrency"),e.YNc(18,Lr,2,1,"ng-container",26),e.qZA()(),e.TgZ(19,"td",27),e.YNc(20,Sr,1,2,"input",28),e.qZA(),e.TgZ(21,"td",29)(22,"div",30),e.YNc(23,Dr,1,2,"input",31),e.qZA()(),e.TgZ(24,"td",29)(25,"div",30),e.YNc(26,Pr,1,2,"input",31),e.qZA()()()),2&o){const t=n.$implicit,r=e.oxw();e.xp6(2),e.Q6J("src",e.xi3(3,12,t.featuredAsset,"tiny"),e.LSH),e.xp6(3),e.Oqu(t.productVariant.name),e.xp6(2),e.Oqu(t.productVariant.sku),e.xp6(2),e.hij(" ",t.quantity," "),e.xp6(1),e.Q6J("line",t)("payments",r.order.payments),e.xp6(2),e.hij(" ",e.xi3(13,15,t.unitPriceWithTax,r.order.currencyCode)," "),e.xp6(4),e.hij(" ",e.xi3(17,18,t.proratedUnitPriceWithTax,r.order.currencyCode)," "),e.xp6(2),e.Q6J("ngIf",t.discounts),e.xp6(2),e.Q6J("ngIf",r.lineCanBeRefundedOrCancelled(t)),e.xp6(3),e.Q6J("ngIf",r.lineCanBeRefundedOrCancelled(t)),e.xp6(3),e.Q6J("ngIf",r.lineCanBeRefundedOrCancelled(t))}}function kr(o,n){if(1&o&&(e.TgZ(0,"option",40),e._uU(1),e.ALo(2,"localeCurrency"),e.qZA()),2&o){const t=n.$implicit,r=e.oxw();e.Q6J("ngValue",t)("disabled","Settled"!==t.state),e.xp6(1),e.lnq(" #",t.id," ",t.method,": ",e.xi3(2,5,t.amount,r.order.currencyCode)," ")}}const Jr=function(o,n){return{min:o,max:n}};function Nr(o,n){if(1&o&&(e.TgZ(0,"div",41),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"currency"),e.ALo(4,"localeCurrency"),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",e.xi3(2,1,"order.refund-total-error",e.WLB(10,Jr,e.xi3(3,4,0,t.order.currencyCode),e.xi3(4,7,t.settledPaymentsTotal,t.order.currencyCode)))," ")}}function Qr(o,n){1&o&&(e.TgZ(0,"div",42),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.refund-total-warning")," "))}const Ur=function(o){return{amount:o}};function Er(o,n){if(1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"localeCurrency"),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,"order.refund-with-amount",e.VKq(7,Ur,e.xi3(3,4,t.refundTotal,t.order.currencyCode)))," ")}}function Yr(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.hij(" ",e.lcZ(1,1,"order.cancel-selected-items")," ")}function Rr(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",44),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.select())}),e.YNc(4,Er,4,9,"ng-container",45),e.YNc(5,Yr,2,3,"ng-template",null,46,e.W1O),e.qZA()}if(2&o){const t=e.MAs(6),r=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,4,"common.cancel")),e.xp6(2),e.Q6J("disabled",!r.canSubmit()),e.xp6(1),e.Q6J("ngIf",r.isRefunding())("ngIfElse",t)}}function jr(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"order.settle-refund"))}function $r(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",4),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",5),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.submit())}),e._uU(4),e.ALo(5,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,3,"common.cancel")),e.xp6(2),e.Q6J("disabled",!t.transactionId),e.xp6(1),e.hij(" ",e.lcZ(5,5,"order.settle-refund")," ")}}const Hr=function(o){return{method:o}};function Gr(o,n){1&o&&e._UZ(0,"clr-icon",2)}function Br(o,n){1&o&&e._UZ(0,"clr-icon",2)}function Vr(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",0),e.ALo(1,"translate"),e._uU(2),e.qZA()),2&o){const t=e.oxw();e.Q6J("label",e.lcZ(1,2,"order.error-message")),e.xp6(2),e.hij(" ",t.payment.errorMessage,"\n")}}function Kr(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",0),e.ALo(1,"translate"),e._uU(2),e.qZA()),2&o){const t=e.oxw();e.Q6J("label",e.lcZ(1,2,"order.transaction-id")),e.xp6(2),e.hij(" ",t.payment.transactionId,"\n")}}function zr(o,n){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.hij("#",t.payment.transactionId,"")}}function Wr(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",11),e.ALo(1,"translate"),e._uU(2),e.qZA()),2&o){const t=e.oxw().$implicit;e.Q6J("label",e.lcZ(1,2,"order.transaction-id")),e.xp6(2),e.hij(" ",t.transactionId," ")}}function Xr(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",11),e.ALo(1,"translate"),e._uU(2),e.qZA()),2&o){const t=e.oxw().$implicit;e.Q6J("label",e.lcZ(1,2,"order.refund-reason")),e.xp6(2),e.hij(" ",t.reason," ")}}function eo(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",11),e.ALo(1,"translate"),e._UZ(2,"vdr-object-tree",13),e.qZA()),2&o){const t=e.oxw().$implicit;e.Q6J("label",e.lcZ(1,2,"order.refund-metadata")),e.xp6(2),e.Q6J("value",t.metadata)}}function to(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",14)(1,"button",15),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw();return e.KtG(l.settleRefund.emit(i))}),e._uU(2),e.ALo(3,"translate"),e.qZA()()}2&o&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"order.settle-refund")," "))}function no(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",1),e._UZ(2,"clr-icon",9),e._uU(3),e.ALo(4,"translate"),e._UZ(5,"div",10)(6,"vdr-refund-state-label",4),e.qZA(),e.TgZ(7,"div",5)(8,"vdr-labeled-data",11),e.ALo(9,"translate"),e._uU(10),e.ALo(11,"localeDate"),e.qZA(),e.TgZ(12,"vdr-labeled-data",11),e.ALo(13,"translate"),e._uU(14),e.ALo(15,"localeCurrency"),e.qZA(),e.YNc(16,Wr,3,4,"vdr-labeled-data",12),e.YNc(17,Xr,3,4,"vdr-labeled-data",12),e.YNc(18,eo,3,4,"vdr-labeled-data",12),e.qZA(),e.YNc(19,to,4,3,"div",8),e.BQk()),2&o){const t=n.$implicit,r=e.oxw();e.xp6(3),e.AsE(" ",e.lcZ(4,11,"order.refund")," #",t.id," "),e.xp6(3),e.Q6J("state",t.state),e.xp6(2),e.Q6J("label",e.lcZ(9,13,"common.created-at")),e.xp6(2),e.hij(" ",e.xi3(11,15,t.createdAt,"medium")," "),e.xp6(2),e.Q6J("label",e.lcZ(13,18,"order.refund-total")),e.xp6(2),e.hij(" ",e.xi3(15,20,t.total,r.currencyCode)," "),e.xp6(2),e.Q6J("ngIf",t.transactionId),e.xp6(1),e.Q6J("ngIf",t.reason),e.xp6(1),e.Q6J("ngIf",r.refundHasMetadata(t)),e.xp6(1),e.Q6J("ngIf","Pending"===t.state)}}function ro(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.settlePayment.emit(i.payment))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.settle-payment")," "))}function oo(o,n){if(1&o&&(e.ynx(0),e._UZ(1,"clr-icon",23),e._uU(2),e.ALo(3,"translate"),e.ALo(4,"translate"),e.ALo(5,"stateI18nToken"),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",e.xi3(3,1,"order.transition-to-state",e.VKq(8,$,e.lcZ(4,4,e.lcZ(5,6,t))))," ")}}function io(o,n){1&o&&(e._UZ(0,"clr-icon",24),e._uU(1),e.ALo(2,"translate")),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.cancel-payment")," "))}function ao(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",20),e.NdJ("click",function(){const l=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.transitionPaymentState.emit({payment:c.payment,state:l}))}),e.YNc(2,oo,6,10,"ng-container",21),e.YNc(3,io,3,3,"ng-template",null,22,e.W1O),e.qZA(),e.BQk()}if(2&o){const t=n.$implicit,r=e.MAs(4);e.xp6(2),e.Q6J("ngIf","Cancelled"!==t)("ngIfElse",r)}}function lo(o,n){if(1&o&&(e.TgZ(0,"div",14),e.YNc(1,ro,3,3,"button",16),e.TgZ(2,"vdr-dropdown")(3,"button",17),e._UZ(4,"clr-icon",18),e.qZA(),e.TgZ(5,"vdr-dropdown-menu",19),e.YNc(6,ao,5,2,"ng-container",7),e.qZA()()()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.payment.nextStates.includes("Settled")),e.xp6(5),e.Q6J("ngForOf",t.nextOtherStates())}}const co=["portal"];function so(o,n){1&o&&(e.TgZ(0,"span",12),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.note-only-visible-to-administrators")," "))}function po(o,n){1&o&&(e.TgZ(0,"span",13),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.note-visible-to-customer")," "))}function uo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-order-history-entry-host",16),e.NdJ("expandClick",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.expanded=!i.expanded)}),e.qZA()}if(2&o){const t=e.oxw().$implicit,r=e.oxw();e.Q6J("order",r.order)("entry",t)("expanded",r.expanded)}}function mo(o,n){1&o&&(e.TgZ(0,"div",11),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.history-order-fulfilled")," "))}function go(o,n){1&o&&(e.TgZ(0,"div",11),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.history-order-cancelled")," "))}const Se=function(o,n){return{from:o,to:n}};function _o(o,n){if(1&o&&(e._uU(0),e.ALo(1,"translate")),2&o){const t=e.oxw(3).$implicit;e.hij(" ",e.xi3(1,1,"order.history-order-transition",e.WLB(4,Se,t.data.from,t.data.to))," ")}}function fo(o,n){if(1&o&&(e.ynx(0),e.YNc(1,mo,3,3,"div",21),e.YNc(2,go,3,3,"div",21),e.YNc(3,_o,2,7,"ng-template",22),e.BQk()),2&o){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf","Delivered"===t.data.to),e.xp6(1),e.Q6J("ngIf","Cancelled"===t.data.to),e.xp6(1),e.Q6J("ngIf","Cancelled"!==t.data.to&&"Delivered"!==t.data.to)}}function ho(o,n){1&o&&(e.TgZ(0,"vdr-chip",27),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"order.modification-settled")))}function vo(o,n){1&o&&(e.TgZ(0,"vdr-chip",28),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"order.modification-not-settled")))}function yo(o,n){if(1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.TgZ(3,"strong"),e._uU(4),e.ALo(5,"localeCurrency"),e.qZA(),e.YNc(6,ho,3,3,"vdr-chip",24),e.YNc(7,vo,3,3,"vdr-chip",25),e.TgZ(8,"vdr-history-entry-detail"),e._UZ(9,"vdr-modification-detail",26),e.qZA(),e.BQk()),2&o){const t=n.ngIf,r=e.oxw(4);e.xp6(1),e.hij(" ",e.lcZ(2,6,"order.modify-order-price-difference"),": "),e.xp6(3),e.Oqu(e.xi3(5,8,t.priceChange,r.order.currencyCode)),e.xp6(2),e.Q6J("ngIf",t.isSettled),e.xp6(1),e.Q6J("ngIf",!t.isSettled),e.xp6(2),e.Q6J("order",r.order)("modification",t)}}function xo(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",11),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,yo,10,11,"ng-container",23),e.BQk()),2&o){const t=e.oxw(2).$implicit,r=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,2,"order.history-order-modified")," "),e.xp6(2),e.Q6J("ngIf",r.getModification(t.data.modificationId))}}function bo(o,n){if(1&o&&(e.TgZ(0,"vdr-history-entry-detail"),e._UZ(1,"vdr-payment-detail",31),e.qZA()),2&o){const t=n.ngIf,r=e.oxw(5);e.xp6(1),e.Q6J("payment",t)("currencyCode",r.order.currencyCode)}}function Co(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",11),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.YNc(6,bo,2,2,"vdr-history-entry-detail",23),e.BQk()),2&o){const t=e.oxw(3).$implicit,r=e.oxw();let i;e.xp6(2),e.hij(" ",e.lcZ(3,4,"order.history-payment-settled")," "),e.xp6(2),e.AsE(" ",e.lcZ(5,6,"order.transaction-id"),": ",null==(i=r.getPayment(t))?null:i.transactionId," "),e.xp6(2),e.Q6J("ngIf",r.getPayment(t))}}const De=function(o,n,t){return{from:o,to:n,id:t}};function Oo(o,n){if(1&o&&(e._uU(0),e.ALo(1,"translate")),2&o){const t=e.oxw(3).$implicit,r=e.oxw();let i;e.hij(" ",e.xi3(1,1,"order.history-payment-transition",e.kEZ(4,De,t.data.from,t.data.to,null==(i=r.getPayment(t))?null:i.transactionId))," ")}}function To(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Co,7,8,"ng-container",29),e.YNc(2,Oo,2,8,"ng-template",null,30,e.W1O),e.BQk()),2&o){const t=e.MAs(3),r=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf","Settled"===r.data.to)("ngIfElse",t)}}function Zo(o,n){if(1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&o){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,"order.history-refund-transition",e.kEZ(4,De,t.data.from,t.data.to,t.data.refundId))," ")}}function Ao(o,n){if(1&o&&(e.TgZ(0,"vdr-history-entry-detail")(1,"vdr-labeled-data",32),e.ALo(2,"translate"),e._uU(3),e.qZA(),e.TgZ(4,"vdr-labeled-data",32),e.ALo(5,"translate"),e._UZ(6,"vdr-simple-item-list",33),e.qZA(),e.TgZ(7,"vdr-labeled-data",32),e.ALo(8,"translate"),e._uU(9),e.qZA()()),2&o){const t=n.ngIf,r=e.oxw(3).$implicit;e.xp6(1),e.Q6J("label",e.lcZ(2,6,"order.cancellation-reason")),e.xp6(2),e.hij(" ",r.data.reason," "),e.xp6(1),e.Q6J("label",e.lcZ(5,8,"order.contents")),e.xp6(2),e.Q6J("items",t),e.xp6(1),e.Q6J("label",e.lcZ(8,10,"order.shipping-cancelled")),e.xp6(2),e.hij(" ",r.data.shippingCancelled," ")}}function Io(o,n){if(1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.YNc(3,Ao,10,12,"vdr-history-entry-detail",23),e.BQk()),2&o){const t=e.oxw(2).$implicit,r=e.oxw();e.xp6(1),e.hij(" ",e.xi3(2,2,"order.history-items-cancelled",e.VKq(5,S,r.getCancelledQuantity(t)))," "),e.xp6(2),e.Q6J("ngIf",r.getCancelledItems(t))}}function wo(o,n){if(1&o&&(e.TgZ(0,"vdr-history-entry-detail"),e._UZ(1,"vdr-fulfillment-detail",34),e.qZA()),2&o){const t=n.ngIf,r=e.oxw(4);e.xp6(1),e.Q6J("fulfillmentId",t.id)("order",r.order)}}function Fo(o,n){if(1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.YNc(3,wo,2,2,"vdr-history-entry-detail",23),e.BQk()),2&o){const t=e.oxw(2).$implicit,r=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,2,"order.history-fulfillment-created")," "),e.xp6(2),e.Q6J("ngIf",r.getFulfillment(t))}}function Mo(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",11),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.BQk()),2&o){const t=e.oxw(3).$implicit,r=e.oxw();let i;e.xp6(2),e.hij(" ",e.lcZ(3,3,"order.history-fulfillment-delivered")," "),e.xp6(2),e.AsE(" ",e.lcZ(5,5,"order.tracking-code"),": ",null==(i=r.getFulfillment(t))?null:i.trackingCode," ")}}function Lo(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",11),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.BQk()),2&o){const t=e.oxw(3).$implicit,r=e.oxw();let i;e.xp6(2),e.hij(" ",e.lcZ(3,3,"order.history-fulfillment-shipped")," "),e.xp6(2),e.AsE(" ",e.lcZ(5,5,"order.tracking-code"),": ",null==(i=r.getFulfillment(t))?null:i.trackingCode," ")}}function So(o,n){if(1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&o){const t=e.oxw(3).$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,"order.history-fulfillment-transition",e.WLB(4,Se,t.data.from,t.data.to))," ")}}function Do(o,n){if(1&o&&(e.TgZ(0,"vdr-history-entry-detail"),e._UZ(1,"vdr-fulfillment-detail",34),e.qZA()),2&o){const t=n.ngIf,r=e.oxw(4);e.xp6(1),e.Q6J("fulfillmentId",t.id)("order",r.order)}}function Po(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Mo,6,7,"ng-container",23),e.YNc(2,Lo,6,7,"ng-container",23),e.YNc(3,So,3,7,"ng-container",23),e.YNc(4,Do,2,2,"vdr-history-entry-detail",23),e.BQk()),2&o){const t=e.oxw(2).$implicit,r=e.oxw();e.xp6(1),e.Q6J("ngIf","Delivered"===t.data.to),e.xp6(1),e.Q6J("ngIf","Shipped"===t.data.to),e.xp6(1),e.Q6J("ngIf","Delivered"!==t.data.to&&"Shipped"!==t.data.to),e.xp6(1),e.Q6J("ngIf",r.getFulfillment(t))}}function qo(o,n){1&o&&(e.TgZ(0,"span",47),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.public")))}function ko(o,n){1&o&&(e.TgZ(0,"span",48),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.private")))}function Jo(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",35)(2,"div",36),e.YNc(3,qo,3,3,"span",37),e.YNc(4,ko,3,3,"span",38),e._uU(5),e.qZA(),e._UZ(6,"div",39),e.TgZ(7,"vdr-dropdown")(8,"button",40),e._UZ(9,"clr-icon",41),e.qZA(),e.TgZ(10,"vdr-dropdown-menu",42)(11,"button",43),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2).$implicit,l=e.oxw();return e.KtG(l.updateNote.emit(i))}),e.ALo(12,"hasPermission"),e._UZ(13,"clr-icon",44),e._uU(14),e.ALo(15,"translate"),e.qZA(),e._UZ(16,"div",45),e.TgZ(17,"button",43),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2).$implicit,l=e.oxw();return e.KtG(l.deleteNote.emit(i))}),e.ALo(18,"hasPermission"),e._UZ(19,"clr-icon",46),e._uU(20),e.ALo(21,"translate"),e.qZA()()()(),e.BQk()}if(2&o){const t=e.oxw(2).$implicit;e.xp6(3),e.Q6J("ngIf",t.isPublic),e.xp6(1),e.Q6J("ngIf",!t.isPublic),e.xp6(1),e.hij(" ",t.data.note," "),e.xp6(6),e.Q6J("disabled",!e.lcZ(12,7,"UpdateOrder")),e.xp6(3),e.hij(" ",e.lcZ(15,9,"common.edit")," "),e.xp6(3),e.Q6J("disabled",!e.lcZ(18,11,"UpdateOrder")),e.xp6(3),e.hij(" ",e.lcZ(21,13,"common.delete")," ")}}const No=function(o){return["/marketing","promotions",o]};function Qo(o,n){if(1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.TgZ(3,"vdr-chip")(4,"a",49),e._uU(5),e.qZA()(),e.BQk()),2&o){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,3,"order.history-coupon-code-applied"),": "),e.xp6(3),e.Q6J("routerLink",e.VKq(5,No,t.data.promotionId)),e.xp6(1),e.Oqu(t.data.couponCode)}}function Uo(o,n){if(1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.TgZ(3,"vdr-chip")(4,"span",50),e._uU(5),e.qZA()(),e.BQk()),2&o){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,2,"order.history-coupon-code-removed"),": "),e.xp6(4),e.Oqu(t.data.couponCode)}}function Eo(o,n){if(1&o&&(e.TgZ(0,"vdr-history-entry-detail"),e._UZ(1,"vdr-object-tree",51),e.qZA()),2&o){const t=e.oxw(3).$implicit;e.xp6(1),e.Q6J("value",t.data)}}function Yo(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",11),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,Eo,2,1,"vdr-history-entry-detail",23),e.BQk()),2&o){const t=e.oxw(2).$implicit;e.xp6(2),e.hij(" ",e.lcZ(3,2,t.type)," "),e.xp6(2),e.Q6J("ngIf",t.data)}}function Ro(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-timeline-entry",17),e.NdJ("expandClick",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.expanded=!i.expanded)}),e.ynx(1,18),e.YNc(2,fo,4,3,"ng-container",19),e.YNc(3,xo,5,4,"ng-container",19),e.YNc(4,To,4,2,"ng-container",19),e.YNc(5,Zo,3,8,"ng-container",19),e.YNc(6,Io,4,7,"ng-container",19),e.YNc(7,Fo,4,4,"ng-container",19),e.YNc(8,Po,5,4,"ng-container",19),e.YNc(9,Jo,22,15,"ng-container",19),e.YNc(10,Qo,6,7,"ng-container",19),e.YNc(11,Uo,6,4,"ng-container",19),e.YNc(12,Yo,5,4,"ng-container",20),e.BQk(),e.qZA()}if(2&o){const t=e.oxw().$implicit,r=e.oxw();e.Q6J("displayType",r.getDisplayType(t))("iconShape",r.getTimelineIcon(t))("createdAt",t.createdAt)("name",r.getName(t))("featured",r.isFeatured(t))("collapsed",!r.expanded&&!r.isFeatured(t)),e.xp6(1),e.Q6J("ngSwitch",t.type),e.xp6(1),e.Q6J("ngSwitchCase",r.type.ORDER_STATE_TRANSITION),e.xp6(1),e.Q6J("ngSwitchCase",r.type.ORDER_MODIFIED),e.xp6(1),e.Q6J("ngSwitchCase",r.type.ORDER_PAYMENT_TRANSITION),e.xp6(1),e.Q6J("ngSwitchCase",r.type.ORDER_REFUND_TRANSITION),e.xp6(1),e.Q6J("ngSwitchCase",r.type.ORDER_CANCELLATION),e.xp6(1),e.Q6J("ngSwitchCase",r.type.ORDER_FULFILLMENT),e.xp6(1),e.Q6J("ngSwitchCase",r.type.ORDER_FULFILLMENT_TRANSITION),e.xp6(1),e.Q6J("ngSwitchCase",r.type.ORDER_NOTE),e.xp6(1),e.Q6J("ngSwitchCase",r.type.ORDER_COUPON_APPLIED),e.xp6(1),e.Q6J("ngSwitchCase",r.type.ORDER_COUPON_REMOVED)}}function jo(o,n){if(1&o&&(e.ynx(0),e.YNc(1,uo,1,3,"vdr-order-history-entry-host",14),e.YNc(2,Ro,13,17,"ng-template",null,15,e.W1O),e.BQk()),2&o){const t=n.$implicit,r=e.MAs(3),i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.hasCustomComponent(t.type))("ngIfElse",r)}}function $o(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",5),e.ALo(1,"translate"),e._uU(2),e.qZA()),2&o){const t=n.ngIf;e.Q6J("label",e.lcZ(1,2,"common.seller")),e.xp6(2),e.hij(" ",t.name," ")}}function Ho(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",5),e.ALo(1,"translate"),e._uU(2),e.ALo(3,"localeCurrency"),e.qZA()),2&o){const t=e.oxw().$implicit;e.Q6J("label",e.lcZ(1,2,"order.total")),e.xp6(2),e.hij(" ",e.xi3(3,4,t.totalWithTax,t.currencyCode)," ")}}const Go=function(o){return["seller-orders",o]};function Bo(o,n){if(1&o&&(e.TgZ(0,"div")(1,"a",3),e._uU(2),e._UZ(3,"clr-icon",4),e.qZA(),e.TgZ(4,"vdr-labeled-data",5),e.ALo(5,"translate"),e._UZ(6,"vdr-order-state-label",6),e.qZA(),e.YNc(7,$o,3,4,"vdr-labeled-data",7),e.YNc(8,Ho,4,7,"vdr-labeled-data",7),e.qZA()),2&o){const t=n.$implicit,r=e.oxw();e.xp6(1),e.Q6J("routerLink",e.VKq(8,Go,t.id)),e.xp6(1),e.hij("",t.code," "),e.xp6(2),e.Q6J("label",e.lcZ(5,6,"order.state")),e.xp6(2),e.Q6J("state",t.state),e.xp6(1),e.Q6J("ngIf",r.getSeller(t)),e.xp6(1),e.Q6J("ngIf",r.getSeller(t))}}function Vo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().ngIf,l=e.oxw();return e.KtG(l.addManualPayment(i))}),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"localeCurrency"),e.qZA()}if(2&o){const t=e.oxw().ngIf,r=e.oxw();e.xp6(1),e.AsE(" ",e.lcZ(2,2,"order.add-payment-to-order")," (",e.xi3(3,4,r.outstandingPaymentAmount(t),t.currencyCode),") ")}}function Ko(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.transitionToState("ArrangingAdditionalPayment"))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.arrange-additional-payment")," "))}function zo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.fulfillOrder())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw().ngIf,r=e.oxw();e.Q6J("disabled",!r.canAddFulfillment(t)),e.xp6(1),e.hij(" ",e.lcZ(2,2,"order.fulfill-order")," ")}}function Wo(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",9),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.transitionToModifying())}),e._UZ(2,"clr-icon",13),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"div",8),e.BQk()}2&o&&(e.xp6(3),e.hij(" ",e.lcZ(4,1,"order.modify-order")," "))}function Xo(o,n){1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.refund-and-cancel-order")," "))}function ei(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.hij(" ",e.lcZ(1,1,"order.cancel-order")," ")}function ti(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().ngIf,l=e.oxw();return e.KtG(l.cancelOrRefund(i))}),e._UZ(1,"clr-icon",14),e.YNc(2,Xo,3,3,"ng-container",15),e.YNc(3,ei,2,3,"ng-template",null,16,e.W1O),e.qZA()}if(2&o){const t=e.MAs(4),r=e.oxw().ngIf,i=e.oxw();e.xp6(2),e.Q6J("ngIf",i.orderHasSettledPayments(r))("ngIfElse",t)}}function ni(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){const l=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.transitionToState(l))}),e._UZ(1,"clr-icon",18),e._uU(2),e.ALo(3,"translate"),e.ALo(4,"translate"),e.ALo(5,"stateI18nToken"),e.qZA()}if(2&o){const t=n.$implicit;e.xp6(2),e.hij(" ",e.xi3(3,1,"order.transition-to-state",e.VKq(8,$,e.lcZ(4,4,e.lcZ(5,6,t))))," ")}}function ri(o,n){if(1&o&&(e.ynx(0),e._UZ(1,"div",8),e.YNc(2,ni,6,10,"button",17),e.ALo(3,"async"),e.BQk()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",e.lcZ(3,1,t.nextStates$))}}function oi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-action-bar"),e._UZ(1,"vdr-ab-left"),e.TgZ(2,"vdr-ab-right"),e._UZ(3,"vdr-action-bar-items",1),e.YNc(4,Vo,4,7,"button",2),e.YNc(5,Ko,3,3,"button",2),e.YNc(6,zo,3,4,"button",3),e.TgZ(7,"vdr-dropdown")(8,"button",4),e._UZ(9,"clr-icon",5),e.qZA(),e.TgZ(10,"vdr-dropdown-menu",6),e.YNc(11,Wo,6,3,"ng-container",0),e.YNc(12,ti,5,2,"button",7),e.YNc(13,ri,4,3,"ng-container",0),e.ALo(14,"async"),e._UZ(15,"div",8),e.TgZ(16,"button",9),e.NdJ("click",function(){const l=e.CHM(t).ngIf,c=e.oxw();return e.KtG(c.manuallyTransitionToState(l))}),e._UZ(17,"clr-icon",10),e._uU(18),e.ALo(19,"translate"),e.qZA()()()()()}if(2&o){const t=n.ngIf,r=e.oxw();let i;e.xp6(4),e.Q6J("ngIf","Aggregate"!==t.type&&("ArrangingPayment"===t.state||"ArrangingAdditionalPayment"===t.state)&&(r.hasUnsettledModifications(t)||0<r.outstandingPaymentAmount(t))),e.xp6(1),e.Q6J("ngIf","Aggregate"!==t.type&&!1===t.active&&"ArrangingAdditionalPayment"!==t.state&&"ArrangingPayment"!==t.state&&0<r.outstandingPaymentAmount(t)),e.xp6(1),e.Q6J("ngIf","Aggregate"!==t.type),e.xp6(5),e.Q6J("ngIf","Aggregate"!==t.type&&t.nextStates.includes("Modifying")),e.xp6(1),e.Q6J("ngIf","Aggregate"!==t.type&&t.nextStates.includes("Cancelled")),e.xp6(1),e.Q6J("ngIf",null==(i=e.lcZ(14,7,r.nextStates$))?null:i.length),e.xp6(5),e.hij(" ",e.lcZ(19,9,"order.manually-transition-to-state")," ")}}function ii(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",36),e.ALo(1,"translate"),e._UZ(2,"vdr-formatted-address",37),e.qZA()),2&o){const t=e.oxw().ngIf;e.Q6J("label",e.lcZ(1,2,"order.shipping-address")),e.xp6(2),e.Q6J("address",t.shippingAddress)}}function ai(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",38),e.ALo(1,"translate"),e._UZ(2,"vdr-formatted-address",37),e.qZA()),2&o){const t=e.oxw().ngIf;e.Q6J("label",e.lcZ(1,2,"order.billing-address")),e.xp6(2),e.Q6J("address",t.billingAddress)}}function li(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-order-payment-card",40),e.NdJ("settlePayment",function(i){e.CHM(t);const l=e.oxw(3);return e.KtG(l.settlePayment(i))})("transitionPaymentState",function(i){e.CHM(t);const l=e.oxw(3);return e.KtG(l.transitionPaymentState(i))})("settleRefund",function(i){e.CHM(t);const l=e.oxw(3);return e.KtG(l.settleRefund(i))}),e.qZA()}if(2&o){const t=n.$implicit,r=e.oxw(2).ngIf;e.Q6J("currencyCode",r.currencyCode)("payment",t)}}function di(o,n){if(1&o&&(e.TgZ(0,"vdr-card",22),e.ALo(1,"translate"),e.YNc(2,li,1,2,"vdr-order-payment-card",39),e.qZA()),2&o){const t=e.oxw().ngIf;e.Q6J("title",e.lcZ(1,2,"order.payments")),e.xp6(2),e.Q6J("ngForOf",t.payments)}}function ci(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-fulfillment-card",42),e.NdJ("transitionState",function(i){const c=e.CHM(t).$implicit,f=e.oxw(3);return e.KtG(f.transitionFulfillment(c.id,i))}),e.qZA()}if(2&o){const t=n.$implicit,r=e.oxw(2).ngIf;e.Q6J("fulfillment",t)("order",r)}}function si(o,n){if(1&o&&(e.TgZ(0,"vdr-card"),e.YNc(1,ci,1,2,"vdr-fulfillment-card",41),e.qZA()),2&o){const t=e.oxw().ngIf;e.xp6(1),e.Q6J("ngForOf",t.fulfillments)}}function pi(o,n){if(1&o&&e._UZ(0,"vdr-page-entity-info",43),2&o){const t=n.ngIf;e.Q6J("entity",t)}}function ui(o,n){if(1&o&&e._UZ(0,"vdr-seller-orders-card",44),2&o){const t=e.oxw().ngIf;e.Q6J("orderId",t.id)}}function mi(o,n){if(1&o&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"percent"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"localeCurrency"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"localeCurrency"),e.qZA()()),2&o){const t=n.$implicit,r=e.oxw().ngIf;e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Oqu(e.xi3(5,4,t.taxRate/100,"0.0-2")),e.xp6(3),e.Oqu(e.xi3(8,7,t.taxBase,r.currencyCode)),e.xp6(3),e.Oqu(e.xi3(11,10,t.taxTotal,r.currencyCode))}}function gi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-card",22),e.ALo(1,"translate"),e._UZ(2,"vdr-tabbed-custom-fields",45),e.ALo(3,"hasPermission"),e.TgZ(4,"button",46),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.updateCustomFields())}),e._uU(5),e.ALo(6,"translate"),e.qZA()()}if(2&o){const t=e.oxw(2);let r;e.Q6J("title",e.lcZ(1,6,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.detailForm.get("customFields"))("readonly",!e.lcZ(3,8,"UpdateOrder")),e.xp6(2),e.Q6J("disabled",(null==(r=t.detailForm.get("customFields"))?null:r.pristine)||(null==(r=t.detailForm.get("customFields"))?null:r.invalid)),e.xp6(1),e.hij(" ",e.lcZ(6,10,"common.update")," ")}}function _i(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-page-detail-layout")(1,"vdr-page-detail-sidebar")(2,"vdr-card")(3,"vdr-order-state-label",19)(4,"button",20),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.openStateDiagram())}),e.ALo(5,"translate"),e._UZ(6,"clr-icon",21),e.qZA()()(),e.TgZ(7,"vdr-card",22),e.ALo(8,"translate"),e._UZ(9,"vdr-customer-label",23),e.YNc(10,ii,3,4,"vdr-labeled-data",24),e.YNc(11,ai,3,4,"vdr-labeled-data",25),e.qZA(),e.YNc(12,di,3,4,"vdr-card",26),e.YNc(13,si,2,1,"vdr-card",0),e.TgZ(14,"vdr-card"),e.YNc(15,pi,1,1,"vdr-page-entity-info",27),e.ALo(16,"async"),e.qZA()(),e.TgZ(17,"vdr-page-block"),e.YNc(18,ui,1,1,"vdr-seller-orders-card",28),e.TgZ(19,"vdr-card",29),e._UZ(20,"vdr-order-table",30),e.qZA(),e.TgZ(21,"vdr-card",31),e.ALo(22,"translate"),e.TgZ(23,"table",32)(24,"thead")(25,"tr")(26,"th"),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"th"),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"th"),e._uU(33),e.ALo(34,"translate"),e.qZA(),e.TgZ(35,"th"),e._uU(36),e.ALo(37,"translate"),e.qZA()()(),e.TgZ(38,"tbody"),e.YNc(39,mi,12,13,"tr",33),e.qZA()()(),e.YNc(40,gi,7,12,"vdr-card",26),e._UZ(41,"vdr-custom-detail-component-host",34),e.TgZ(42,"vdr-card",22),e.ALo(43,"translate"),e.TgZ(44,"vdr-order-history",35),e.NdJ("addNote",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.addNote(i))})("updateNote",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.updateNote(i))})("deleteNote",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.deleteNote(i))}),e.ALo(45,"async"),e.qZA()()()()}if(2&o){const t=n.ngIf,r=e.oxw();e.xp6(3),e.Q6J("state",t.state),e.xp6(1),e.Q6J("title",e.lcZ(5,26,"order.order-state-diagram")),e.xp6(3),e.Q6J("title",e.lcZ(8,28,"order.customer")),e.xp6(2),e.Q6J("customer",t.customer),e.xp6(1),e.Q6J("ngIf",r.getOrderAddressLines(t.shippingAddress).length),e.xp6(1),e.Q6J("ngIf",r.getOrderAddressLines(t.billingAddress).length),e.xp6(1),e.Q6J("ngIf",null==t.payments?null:t.payments.length),e.xp6(1),e.Q6J("ngIf",null==t.fulfillments?null:t.fulfillments.length),e.xp6(2),e.Q6J("ngIf",e.lcZ(16,30,r.entity$)),e.xp6(3),e.Q6J("ngIf",t.sellerOrders.length),e.xp6(1),e.Q6J("paddingX",!1),e.xp6(1),e.Q6J("order",t)("orderLineCustomFields",r.orderLineCustomFields),e.xp6(1),e.Q6J("title",e.lcZ(22,32,"order.tax-summary"))("paddingX",!1),e.xp6(6),e.Oqu(e.lcZ(28,34,"common.description")),e.xp6(3),e.Oqu(e.lcZ(31,36,"order.tax-rate")),e.xp6(3),e.Oqu(e.lcZ(34,38,"order.tax-base")),e.xp6(3),e.Oqu(e.lcZ(37,40,"order.tax-total")),e.xp6(3),e.Q6J("ngForOf",t.taxSummary),e.xp6(1),e.Q6J("ngIf",r.customFields.length),e.xp6(1),e.Q6J("entity$",r.entity$)("detailForm",r.detailForm),e.xp6(1),e.Q6J("title",e.lcZ(43,42,"order.order-history")),e.xp6(2),e.Q6J("order",t)("history",e.lcZ(45,44,r.history$))}}function fi(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"order.confirm-modifications"))}function hi(o,n){if(1&o&&(e.TgZ(0,"option",9),e._uU(1),e.ALo(2,"localeCurrency"),e.qZA()),2&o){const t=n.$implicit,r=e.oxw(2);e.Q6J("ngValue",t),e.xp6(1),e.lnq(" #",t.id," ",t.method,": ",e.xi3(2,4,t.amount,r.order.currencyCode)," ")}}function vi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"clr-select-container")(2,"label"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"select",5),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.selectedPayment=i)}),e.YNc(6,hi,3,7,"option",6),e.qZA()(),e.TgZ(7,"label",7),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"textarea",8),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.refundNote=i)}),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,5,"order.payment-to-refund")),e.xp6(2),e.Q6J("ngModel",t.selectedPayment),e.xp6(1),e.Q6J("ngForOf",t.order.payments),e.xp6(2),e.Oqu(e.lcZ(9,7,"order.refund-cancellation-reason")),e.xp6(2),e.Q6J("ngModel",t.refundNote)}}function yi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.submit())}),e._uU(4),e.ALo(5,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,3,"common.cancel")),e.xp6(2),e.Q6J("disabled",t.priceDifference<0&&!t.selectedPayment),e.xp6(1),e.hij(" ",e.lcZ(5,5,"common.confirm")," ")}}function xi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-action-bar")(1,"vdr-ab-left")(2,"div",1),e._UZ(3,"vdr-order-state-label",2),e.qZA()(),e.TgZ(4,"vdr-ab-right")(5,"button",3),e.NdJ("click",function(){const l=e.CHM(t).ngIf,c=e.oxw();return e.KtG(c.transitionToPriorState(l))}),e._uU(6),e.ALo(7,"translate"),e.qZA()()()}if(2&o){const t=n.ngIf;e.xp6(3),e.Q6J("state",t.state),e.xp6(3),e.hij(" ",e.lcZ(7,2,"order.cancel-modification")," ")}}function bi(o,n){1&o&&(e.TgZ(0,"th"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"common.custom-fields")," "))}function Ci(o,n){if(1&o&&(e._UZ(0,"img",40),e.ALo(1,"assetPreview")),2&o){const t=e.oxw().$implicit;e.Q6J("src",e.xi3(1,1,t.featuredAsset,"tiny"),e.LSH)}}const Pe=function(o){return[o]};function Oi(o,n){if(1&o&&(e.TgZ(0,"td",41),e._UZ(1,"vdr-tabbed-custom-fields",42),e.qZA()),2&o){const t=e.oxw().index,r=e.oxw(2);e.xp6(1),e.Q6J("customFields",r.orderLineCustomFields)("customFieldsFormGroup",r.orderLineCustomFieldsFormArray.get(e.VKq(3,Pe,t)))("compact",!0)}}function Ti(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"tr",28)(1,"td",29),e.YNc(2,Ci,2,4,"img",30),e.qZA(),e.TgZ(3,"td",31),e._uU(4),e.qZA(),e.TgZ(5,"td",32),e._uU(6),e.qZA(),e.TgZ(7,"td",33),e._uU(8),e.ALo(9,"localeCurrency"),e.TgZ(10,"div",15),e.ALo(11,"translate"),e._uU(12),e.ALo(13,"localeCurrency"),e.qZA()(),e.TgZ(14,"td",34)(15,"input",35),e.NdJ("input",function(i){const c=e.CHM(t).$implicit,f=e.oxw(2);return e.KtG(f.updateLineQuantity(c,i.target.value))}),e.qZA(),e._UZ(16,"vdr-line-refunds",36)(17,"vdr-line-fulfillment",37),e.qZA(),e.YNc(18,Oi,2,5,"td",38),e.TgZ(19,"td",39),e._uU(20),e.ALo(21,"localeCurrency"),e.TgZ(22,"div",15),e.ALo(23,"translate"),e._uU(24),e.ALo(25,"localeCurrency"),e.qZA()()()}if(2&o){const t=n.$implicit,r=e.oxw().ngIf,i=e.oxw();e.ekj("is-cancelled",0===t.quantity)("modified",i.isLineModified(t)),e.xp6(2),e.Q6J("ngIf",t.featuredAsset),e.xp6(2),e.Oqu(t.productVariant.name),e.xp6(2),e.Oqu(t.productVariant.sku),e.xp6(2),e.hij(" ",e.xi3(9,20,t.unitPriceWithTax,r.currencyCode)," "),e.xp6(2),e.Q6J("title",e.lcZ(11,23,"order.net-price")),e.xp6(2),e.hij(" ",e.xi3(13,25,t.unitPrice,r.currencyCode)," "),e.xp6(3),e.Q6J("value",t.quantity),e.xp6(1),e.Q6J("line",t)("payments",r.payments),e.xp6(1),e.Q6J("line",t)("allOrderFulfillments",r.fulfillments)("orderState",r.state),e.xp6(1),e.Q6J("ngIf",i.orderLineCustomFields.length),e.xp6(2),e.hij(" ",e.xi3(21,28,t.linePriceWithTax,r.currencyCode)," "),e.xp6(2),e.Q6J("title",e.lcZ(23,31,"order.net-price")),e.xp6(2),e.hij(" ",e.xi3(25,33,t.linePrice,r.currencyCode)," ")}}function Zi(o,n){if(1&o&&(e._UZ(0,"img",40),e.ALo(1,"assetPreview")),2&o){const t=e.oxw().$implicit;e.Q6J("src",e.xi3(1,1,t.productAsset,"tiny"),e.LSH)}}function Ai(o,n){if(1&o&&(e.ynx(0),e._UZ(1,"vdr-custom-field-control",47),e.BQk()),2&o){const t=n.$implicit,r=e.oxw(2).index,i=e.oxw(2);e.xp6(1),e.Q6J("customField",t)("customFieldsFormGroup",i.addItemCustomFieldsFormArray.get(e.VKq(3,Pe,r)))("compact",!0)}}function Ii(o,n){if(1&o&&(e.TgZ(0,"td",41),e.YNc(1,Ai,2,5,"ng-container",46),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.orderLineCustomFields)}}function wi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"tr",43)(1,"td",29),e.YNc(2,Zi,2,4,"img",30),e.qZA(),e.TgZ(3,"td",31),e._uU(4),e.qZA(),e.TgZ(5,"td",32),e._uU(6),e.qZA(),e.TgZ(7,"td",33),e._uU(8),e.ALo(9,"localeCurrency"),e.TgZ(10,"div",15),e.ALo(11,"translate"),e._uU(12),e.ALo(13,"localeCurrency"),e.qZA()(),e.TgZ(14,"td",34)(15,"input",35),e.NdJ("input",function(i){const c=e.CHM(t).$implicit,f=e.oxw(2);return e.KtG(f.updateAddedItemQuantity(c,i.target.value))}),e.qZA(),e.TgZ(16,"button",44),e.NdJ("click",function(){const l=e.CHM(t).index,c=e.oxw(2);return e.KtG(c.removeAddedItem(l))}),e._UZ(17,"clr-icon",45),e.qZA()(),e.YNc(18,Ii,2,1,"td",38),e.TgZ(19,"td",39),e._uU(20),e.ALo(21,"currency"),e.TgZ(22,"div",15),e.ALo(23,"translate"),e._uU(24),e.ALo(25,"currency"),e.qZA()()()}if(2&o){const t=n.$implicit,r=e.oxw().ngIf,i=e.oxw();e.xp6(2),e.Q6J("ngIf",t.productAsset),e.xp6(2),e.Oqu(t.productVariantName),e.xp6(2),e.Oqu(t.sku),e.xp6(2),e.hij(" ",e.xi3(9,11,t.priceWithTax,r.currencyCode)," "),e.xp6(2),e.Q6J("title",e.lcZ(11,14,"order.net-price")),e.xp6(2),e.hij(" ",e.xi3(13,16,t.price,r.currencyCode)," "),e.xp6(3),e.Q6J("value",t.quantity),e.xp6(3),e.Q6J("ngIf",i.orderLineCustomFields.length),e.xp6(2),e.hij(" ",e.xi3(21,19,t.priceWithTax*t.quantity/100,r.currencyCode)," "),e.xp6(2),e.Q6J("title",e.lcZ(23,22,"order.net-price")),e.xp6(2),e.hij(" ",e.xi3(25,24,t.price*t.quantity/100,r.currencyCode)," ")}}function Fi(o,n){1&o&&e._UZ(0,"td")}function Mi(o,n){if(1&o&&(e.TgZ(0,"tr",48)(1,"td",49),e._uU(2),e.qZA(),e.TgZ(3,"td",32),e._uU(4),e.qZA(),e._UZ(5,"td",50)(6,"td"),e.YNc(7,Fi,1,0,"td",0),e.TgZ(8,"td",39),e._uU(9),e.ALo(10,"localeCurrency"),e.TgZ(11,"div",15),e.ALo(12,"translate"),e._uU(13),e.ALo(14,"localeCurrency"),e.qZA()()()),2&o){const t=n.$implicit,r=e.oxw().ngIf,i=e.oxw();e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Oqu(t.sku),e.xp6(3),e.Q6J("ngIf",i.orderLineCustomFields.length),e.xp6(2),e.hij(" ",e.xi3(10,6,t.priceWithTax,r.currencyCode)," "),e.xp6(2),e.Q6J("title",e.lcZ(12,9,"order.net-price")),e.xp6(2),e.hij(" ",e.xi3(14,11,t.price,r.currencyCode)," ")}}function Li(o,n){1&o&&e._UZ(0,"td")}function Si(o,n){if(1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"localeCurrency"),e.TgZ(3,"div",15),e.ALo(4,"translate"),e._uU(5),e.ALo(6,"localeCurrency"),e.qZA(),e.BQk()),2&o){const t=n.ngIf,r=e.oxw(2).ngIf;e.xp6(1),e.hij(" ",e.xi3(2,3,t.priceWithTax,r.currencyCode)," "),e.xp6(2),e.Q6J("title",e.lcZ(4,6,"order.net-price")),e.xp6(2),e.hij(" ",e.xi3(6,8,t.price,r.currencyCode)," ")}}function Di(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"tr",51)(1,"td",49),e._uU(2),e.TgZ(3,"button",44),e.NdJ("click",function(){const l=e.CHM(t).index,c=e.oxw(2);return e.KtG(c.removeSurcharge(l))}),e._UZ(4,"clr-icon",45),e.qZA()(),e.TgZ(5,"td",32),e._uU(6),e.qZA(),e._UZ(7,"td",50)(8,"td"),e.YNc(9,Li,1,0,"td",0),e.TgZ(10,"td",39),e.YNc(11,Si,7,11,"ng-container",0),e.qZA()()}if(2&o){const t=n.$implicit,r=e.oxw(2);e.xp6(2),e.hij(" ",t.description," "),e.xp6(4),e.Oqu(t.sku),e.xp6(3),e.Q6J("ngIf",r.orderLineCustomFields.length),e.xp6(2),e.Q6J("ngIf",r.getSurchargePrices(t))}}function Pi(o,n){1&o&&e._UZ(0,"td")}function qi(o,n){if(1&o&&(e._UZ(0,"img",58),e.ALo(1,"assetPreview")),2&o){const t=n.ngIf;e.Q6J("src",e.xi3(1,1,t,"tiny"),e.LSH)}}function ki(o,n){if(1&o&&(e.TgZ(0,"div",55),e.YNc(1,qi,2,4,"img",56),e.TgZ(2,"div")(3,"strong",57),e._uU(4),e.qZA(),e.TgZ(5,"small"),e._uU(6),e.qZA(),e.TgZ(7,"div"),e._uU(8),e.ALo(9,"localeCurrency"),e.qZA()()()),2&o){const t=e.oxw(2).ngIf,r=e.oxw();e.xp6(1),e.Q6J("ngIf",r.addItemSelectedVariant.productAsset),e.xp6(3),e.Oqu(r.addItemSelectedVariant.productVariantName),e.xp6(2),e.Oqu(r.addItemSelectedVariant.sku),e.xp6(2),e.hij(" ",e.xi3(9,4,r.getSelectedItemPrice(r.addItemSelectedVariant),t.currencyCode)," ")}}function Ji(o,n){if(1&o&&(e.ynx(0),e._UZ(1,"vdr-custom-field-control",59),e.BQk()),2&o){const t=n.$implicit,r=e.oxw(3);e.xp6(1),e.Q6J("readonly",!r.addItemSelectedVariant)("customField",t)("customFieldsFormGroup",r.addItemCustomFieldsForm)("compact",!0)}}function Ni(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"clr-accordion-content")(1,"vdr-product-variant-selector",52),e.NdJ("productSelected",function(i){e.CHM(t);const l=e.oxw(2);return e.KtG(l.addItemSelectedVariant=i)}),e.qZA(),e.YNc(2,ki,10,7,"div",53),e.YNc(3,Ji,2,4,"ng-container",46),e.TgZ(4,"button",54),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.addItemToOrder(i.addItemSelectedVariant))}),e._uU(5),e.ALo(6,"translate"),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.addItemSelectedVariant),e.xp6(1),e.Q6J("ngForOf",t.orderLineCustomFields),e.xp6(1),e.Q6J("disabled",!t.addItemSelectedVariant||t.addItemCustomFieldsForm.invalid),e.xp6(1),e.hij(" ",e.lcZ(6,4,"order.add-item-to-order")," ")}}function Qi(o,n){if(1&o&&(e.TgZ(0,"clr-accordion-content"),e._UZ(1,"vdr-coupon-code-selector",60),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("control",t.couponCodesControl)}}const Ui=function(o){return{rate:o}};function Ei(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"clr-accordion-content")(1,"form",61),e.NdJ("submit",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.addSurcharge(i.surchargeForm.value))}),e.TgZ(2,"vdr-form-field",62),e.ALo(3,"translate"),e._UZ(4,"input",63),e.qZA(),e.TgZ(5,"vdr-form-field",64),e.ALo(6,"translate"),e._UZ(7,"input",65),e.qZA(),e.TgZ(8,"vdr-form-field",66),e.ALo(9,"translate"),e._UZ(10,"vdr-currency-input",67),e.qZA(),e.TgZ(11,"vdr-form-field",68),e.ALo(12,"translate"),e._UZ(13,"input",69),e.qZA(),e.TgZ(14,"vdr-form-field",70),e.ALo(15,"translate"),e.TgZ(16,"vdr-affixed-input",71),e._UZ(17,"input",72),e.qZA()(),e.TgZ(18,"vdr-form-field",73),e.ALo(19,"translate"),e._UZ(20,"input",74),e.qZA(),e.TgZ(21,"button",75),e._uU(22),e.ALo(23,"translate"),e.qZA()()()}if(2&o){const t=e.oxw().ngIf,r=e.oxw();let i,l;e.xp6(1),e.Q6J("formGroup",r.surchargeForm),e.xp6(1),e.Q6J("label",e.lcZ(3,10,"common.description")),e.xp6(3),e.Q6J("label",e.lcZ(6,12,"order.product-sku")),e.xp6(3),e.Q6J("label",e.lcZ(9,14,"common.price")),e.xp6(2),e.Q6J("currencyCode",t.currencyCode),e.xp6(1),e.Q6J("label",e.xi3(12,16,"catalog.price-includes-tax-at",e.VKq(25,Ui,null==(i=r.surchargeForm.get("taxRate"))?null:i.value))),e.xp6(3),e.Q6J("label",e.lcZ(15,19,"order.tax-rate")),e.xp6(4),e.Q6J("label",e.lcZ(19,21,"order.tax-description")),e.xp6(3),e.Q6J("disabled",r.surchargeForm.invalid||r.surchargeForm.pristine||0===(null==(l=r.surchargeForm.get("price"))?null:l.value)),e.xp6(1),e.hij(" ",e.lcZ(23,23,"order.add-surcharge")," ")}}function Yi(o,n){if(1&o&&(e.TgZ(0,"clr-accordion-content"),e._UZ(1,"vdr-address-form",76),e.ALo(2,"async"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("formGroup",t.shippingAddressForm)("availableCountries",e.lcZ(2,3,t.availableCountries$))("customFields",t.addressCustomFields)}}function Ri(o,n){if(1&o&&(e.TgZ(0,"clr-accordion-content"),e._UZ(1,"vdr-address-form",76),e.ALo(2,"async"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("formGroup",t.billingAddressForm)("availableCountries",e.lcZ(2,3,t.availableCountries$))("customFields",t.addressCustomFields)}}function ji(o,n){if(1&o&&(e.TgZ(0,"li"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,"order.modification-adding-items",e.VKq(4,S,null==t.modifyOrderInput.addItems?null:t.modifyOrderInput.addItems.length))," ")}}function $i(o,n){if(1&o&&(e.TgZ(0,"li"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,"order.modification-adjusting-lines",e.VKq(4,S,null==t.modifyOrderInput.adjustOrderLines?null:t.modifyOrderInput.adjustOrderLines.length))," ")}}function Hi(o,n){if(1&o&&(e.TgZ(0,"li"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,"order.modification-adding-surcharges",e.VKq(4,S,null==t.modifyOrderInput.surcharges?null:t.modifyOrderInput.surcharges.length))," ")}}function Gi(o,n){1&o&&(e.TgZ(0,"li"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.modification-updating-shipping-address")," "))}function Bi(o,n){1&o&&(e.TgZ(0,"li"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"order.modification-updating-billing-address")," "))}function Vi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",4)(2,"div",5)(3,"table",6)(4,"thead")(5,"tr"),e._UZ(6,"th"),e.TgZ(7,"th"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"th"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.YNc(19,bi,3,3,"th",0),e.TgZ(20,"th"),e._uU(21),e.ALo(22,"translate"),e.qZA()()(),e.TgZ(23,"tbody"),e.YNc(24,Ti,26,36,"tr",7),e.YNc(25,wi,26,27,"tr",8),e.YNc(26,Mi,15,14,"tr",9),e.YNc(27,Di,12,4,"tr",10),e.TgZ(28,"tr",11)(29,"td",12),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"td",13),e._uU(33),e.qZA(),e._UZ(34,"td",14),e.YNc(35,Pi,1,0,"td",0),e.TgZ(36,"td",13),e._uU(37),e.ALo(38,"localeCurrency"),e.TgZ(39,"div",15),e.ALo(40,"translate"),e._uU(41),e.ALo(42,"localeCurrency"),e.qZA()()()()(),e.TgZ(43,"h4",16),e._uU(44),e.ALo(45,"translate"),e.qZA(),e.TgZ(46,"clr-accordion")(47,"clr-accordion-panel")(48,"clr-accordion-title"),e._uU(49),e.ALo(50,"translate"),e.qZA(),e.YNc(51,Ni,7,6,"clr-accordion-content",17),e.qZA(),e.TgZ(52,"clr-accordion-panel")(53,"clr-accordion-title"),e._uU(54),e.ALo(55,"translate"),e.qZA(),e.YNc(56,Qi,2,1,"clr-accordion-content",17),e.qZA(),e.TgZ(57,"clr-accordion-panel")(58,"clr-accordion-title"),e._uU(59),e.ALo(60,"translate"),e.qZA(),e.YNc(61,Ei,24,27,"clr-accordion-content",17),e.qZA(),e.TgZ(62,"clr-accordion-panel")(63,"clr-accordion-title"),e._uU(64),e.ALo(65,"translate"),e.qZA(),e.YNc(66,Yi,3,5,"clr-accordion-content",17),e.qZA(),e.TgZ(67,"clr-accordion-panel")(68,"clr-accordion-title"),e._uU(69),e.ALo(70,"translate"),e.qZA(),e.YNc(71,Ri,3,5,"clr-accordion-content",17),e.qZA()()(),e.TgZ(72,"div",18)(73,"div",19)(74,"div",20),e._uU(75),e.ALo(76,"translate"),e.qZA(),e.TgZ(77,"div",21)(78,"ul"),e.YNc(79,ji,3,6,"li",0),e.YNc(80,$i,3,6,"li",0),e.YNc(81,Hi,3,6,"li",0),e.YNc(82,Gi,3,3,"li",0),e.YNc(83,Bi,3,3,"li",0),e.qZA()(),e.TgZ(84,"div",21)(85,"label",22),e._uU(86),e.ALo(87,"translate"),e.qZA(),e.TgZ(88,"textarea",23),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.note=i)}),e.qZA(),e.TgZ(89,"clr-checkbox-wrapper",24)(90,"input",25),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.recalculateShipping=i)}),e.qZA(),e.TgZ(91,"label"),e._uU(92),e.ALo(93,"translate"),e.qZA()()(),e.TgZ(94,"div",26)(95,"button",27),e.NdJ("click",function(){const l=e.CHM(t).ngIf,c=e.oxw();return e.KtG(c.previewAndModify(l))}),e._uU(96),e.ALo(97,"translate"),e.qZA()()()()()()}if(2&o){const t=n.ngIf,r=e.oxw();e.xp6(8),e.Oqu(e.lcZ(9,35,"order.product-name")),e.xp6(3),e.Oqu(e.lcZ(12,37,"order.product-sku")),e.xp6(3),e.Oqu(e.lcZ(15,39,"order.unit-price")),e.xp6(3),e.Oqu(e.lcZ(18,41,"order.quantity")),e.xp6(2),e.Q6J("ngIf",r.orderLineCustomFields.length),e.xp6(2),e.Oqu(e.lcZ(22,43,"order.total")),e.xp6(3),e.Q6J("ngForOf",t.lines),e.xp6(1),e.Q6J("ngForOf",r.addedLines)("ngForTrackBy",r.trackByProductVariantId),e.xp6(1),e.Q6J("ngForOf",t.surcharges),e.xp6(1),e.Q6J("ngForOf",r.modifyOrderInput.surcharges),e.xp6(3),e.Oqu(e.lcZ(31,45,"order.shipping")),e.xp6(3),e.hij(" ",null==t.shippingLines[0]||null==t.shippingLines[0].shippingMethod?null:t.shippingLines[0].shippingMethod.name," "),e.xp6(2),e.Q6J("ngIf",r.orderLineCustomFields.length),e.xp6(2),e.hij(" ",e.xi3(38,47,t.shippingWithTax,t.currencyCode)," "),e.xp6(2),e.Q6J("title",e.lcZ(40,50,"order.net-price")),e.xp6(2),e.hij(" ",e.xi3(42,52,t.shipping,t.currencyCode)," "),e.xp6(3),e.Oqu(e.lcZ(45,55,"order.modifications")),e.xp6(5),e.Oqu(e.lcZ(50,57,"order.add-item-to-order")),e.xp6(5),e.Oqu(e.lcZ(55,59,"order.set-coupon-codes")),e.xp6(5),e.Oqu(e.lcZ(60,61,"order.add-surcharge")),e.xp6(5),e.Oqu(e.lcZ(65,63,"order.edit-shipping-address")),e.xp6(5),e.Oqu(e.lcZ(70,65,"order.edit-billing-address")),e.xp6(6),e.hij(" ",e.lcZ(76,67,"order.modification-summary")," "),e.xp6(4),e.Q6J("ngIf",null==r.modifyOrderInput.addItems?null:r.modifyOrderInput.addItems.length),e.xp6(1),e.Q6J("ngIf",null==r.modifyOrderInput.adjustOrderLines?null:r.modifyOrderInput.adjustOrderLines.length),e.xp6(1),e.Q6J("ngIf",null==r.modifyOrderInput.surcharges?null:r.modifyOrderInput.surcharges.length),e.xp6(1),e.Q6J("ngIf",r.shippingAddressForm.dirty),e.xp6(1),e.Q6J("ngIf",r.billingAddressForm.dirty),e.xp6(3),e.Oqu(e.lcZ(87,69,"order.note")),e.xp6(2),e.Q6J("ngModel",r.note),e.xp6(2),e.Q6J("ngModel",r.recalculateShipping),e.xp6(2),e.Oqu(e.lcZ(93,71,"order.modification-recalculate-shipping")),e.xp6(3),e.Q6J("disabled",!r.canPreviewChanges()),e.xp6(1),e.hij(" ",e.lcZ(97,73,"order.preview-changes")," ")}}const Ki=function(){return["./draft/create"]};function zi(o,n){1&o&&(e.TgZ(0,"a",17),e._UZ(1,"clr-icon",18),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,Ki)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"catalog.create-draft-order")," "))}const Wi=function(){return["CreateOrder"]};function Xi(o,n){1&o&&(e.ynx(0),e.YNc(1,zi,4,5,"a",16),e.BQk()),2&o&&(e.xp6(1),e.Q6J("vdrIfPermissions",e.DdM(1,Wi)))}function ea(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function ta(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}const na=function(o){return["./draft",o]},ra=function(o){return["./",o]};function oa(o,n){if(1&o&&(e.TgZ(0,"a",19)(1,"span"),e._uU(2),e.qZA(),e._UZ(3,"clr-icon",20),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink","Draft"===t.state?e.VKq(2,na,t.id):e.VKq(4,ra,t.id)),e.xp6(2),e.Oqu(t.code)}}function ia(o,n){if(1&o&&(e.TgZ(0,"vdr-customer-label",21),e.NdJ("click",function(r){return r.stopPropagation()}),e.qZA()),2&o){const t=n.item;e.Q6J("customer",t.customer)}}function aa(o,n){1&o&&(e.TgZ(0,"vdr-chip"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"order.order-type-regular")))}function la(o,n){1&o&&(e.TgZ(0,"vdr-chip"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"order.order-type-aggregate")))}function da(o,n){1&o&&(e.TgZ(0,"vdr-chip"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"order.order-type-seller")))}function ca(o,n){if(1&o&&(e.YNc(0,aa,3,3,"vdr-chip",1),e.YNc(1,la,3,3,"vdr-chip",1),e.YNc(2,da,3,3,"vdr-chip",1)),2&o){const t=n.item,r=e.oxw();e.Q6J("ngIf",t.type===r.OrderType.Regular),e.xp6(1),e.Q6J("ngIf",t.type===r.OrderType.Aggregate),e.xp6(1),e.Q6J("ngIf",t.type===r.OrderType.Seller)}}function sa(o,n){if(1&o&&e._UZ(0,"vdr-order-state-label",22),2&o){const t=n.item;e.Q6J("state",t.state)}}function pa(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeCurrency")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.totalWithTax,t.currencyCode)," ")}}function ua(o,n){if(1&o&&(e._uU(0),e.ALo(1,"timeAgo")),2&o){const t=n.item;e.hij(" ",e.lcZ(1,1,t.updatedAt)," ")}}function ma(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.orderPlacedAt,"short")," ")}}function ga(o,n){if(1&o&&e._uU(0),2&o){const t=n.item,r=e.oxw();e.hij(" ",r.getShippingNames(t)," ")}}function _a(o,n){if(1&o&&e._UZ(0,"vdr-dt2-custom-field-column",23),2&o){const t=n.$implicit,r=e.oxw();e.Q6J("customField",t)("sorts",r.sorts)}}R.Ps`
    query GetAddManualPaymentMethodList($options: PaymentMethodListOptions!) {
        paymentMethods(options: $options) {
            items {
                id
                createdAt
                updatedAt
                name
                code
                description
                enabled
            }
            totalItems
        }
    }
`;class H{constructor(n){this.dataService=n,this.form=new d.nJ({method:new d.p4("",d.kI.required),transactionId:new d.p4("",d.kI.required)})}ngOnInit(){this.paymentMethods$=this.dataService.query(a.nv3,{options:{take:999}}).mapSingle(n=>n.paymentMethods.items)}submit(){const n=this.form.value;this.resolveWith({method:n.method,transactionId:n.transactionId})}cancel(){this.resolveWith()}static#e=this.\u0275fac=function(t){return new(t||H)(e.Y36(a.DoR))};static#t=this.\u0275cmp=e.Xpm({type:H,selectors:[["vdr-add-manual-payment-dialog"]],decls:10,vars:11,consts:[["vdrDialogTitle",""],[3,"formGroup"],["for","method",3,"label"],["bindLabel","code","appendTo","body","autofocus","","bindValue","code","formControlName","method",3,"items","addTag"],["for","transactionId",3,"label"],["id","transactionId","type","text","formControlName","transactionId"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,r){1&t&&(e.YNc(0,Ve,2,3,"ng-template",0),e.TgZ(1,"form",1)(2,"vdr-form-field",2),e.ALo(3,"translate"),e._UZ(4,"ng-select",3),e.ALo(5,"async"),e.qZA(),e.TgZ(6,"vdr-form-field",4),e.ALo(7,"translate"),e._UZ(8,"input",5),e.qZA()(),e.YNc(9,Ke,7,11,"ng-template",6)),2&t&&(e.xp6(1),e.Q6J("formGroup",r.form),e.xp6(1),e.Q6J("label",e.lcZ(3,5,"order.payment-method")),e.xp6(2),e.Q6J("items",e.lcZ(5,7,r.paymentMethods$))("addTag",!0),e.xp6(2),e.Q6J("label",e.lcZ(7,9,"order.transaction-id")))},dependencies:[d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,C.w9,a.hgI,a.y_K,a.nPI,a.q6K,s.Ov,g.X$,a.kgx],styles:[".ng-select[_ngcontent-%COMP%]{min-width:100%}"],changeDetection:0})}class G{get selectionCount(){return Object.values(this.lineQuantities).reduce((n,t)=>n+t,0)}constructor(n){this.i18nService=n,this.cancelAll=!0,this.lineQuantities={},this.reasons=(0,a.hq7)().cancellationReasons??[(0,u.J)("order.cancel-reason-customer-request"),(0,u.J)("order.cancel-reason-not-available")],this.reasons=this.reasons.map(t=>this.i18nService.translate(t))}ngOnInit(){this.lineQuantities=this.order.lines.reduce((n,t)=>({...n,[t.id]:t.quantity}),{})}radioChanged(){if(this.cancelAll)for(const n of this.order.lines)this.lineQuantities[n.id]=n.quantity;else for(const n of this.order.lines)this.lineQuantities[n.id]=0}checkIfAllSelected(){for(const[n,t]of Object.entries(this.lineQuantities)){const r=this.order.lines.find(i=>i.id===n)?.quantity;if(r&&t<r)return}this.cancelAll=!0}select(){this.resolveWith({orderId:this.order.id,lines:this.getLineInputs(),reason:this.reason,cancelShipping:this.cancelAll})}cancel(){this.resolveWith()}getLineInputs(){if(!this.order.active)return Object.entries(this.lineQuantities).map(([n,t])=>({orderLineId:n,quantity:t})).filter(n=>0<n.quantity)}static#e=this.\u0275fac=function(t){return new(t||G)(e.Y36(a.Dp7))};static#t=this.\u0275cmp=e.Xpm({type:G,selectors:[["vdr-cancel-order-dialog"]],decls:30,vars:23,consts:[["vdrDialogTitle",""],[1,"fulfillment-wrapper"],[1,"order-lines"],[1,"table"],["class","order-line",3,"is-disabled","is-cancelled",4,"ngFor","ngForOf"],[1,"cancellation-details"],[4,"ngIf"],[1,"clr-control-label"],["bindLabel","name","autofocus","","bindValue","id",3,"items","addTag","ngModel","ngModelChange"],["vdrDialogButtons",""],[1,"order-line"],[1,"align-middle","thumb"],[3,"src"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","quantity"],[1,"align-middle","fulfil"],["type","number","min","0",3,"ngModel","disabled","max","ngModelChange","input",4,"ngIf","ngIfElse"],["nonEditable",""],["type","number","min","0",3,"ngModel","disabled","max","ngModelChange","input"],["type","radio","clrRadio","","name","options",3,"value","ngModel","ngModelChange"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,r){1&t&&(e.YNc(0,ze,2,3,"ng-template",0),e.TgZ(1,"div",1)(2,"div",2)(3,"table",3)(4,"thead")(5,"tr"),e._UZ(6,"th"),e.TgZ(7,"th"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"th"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"th"),e._uU(20),e.ALo(21,"translate"),e.qZA()()(),e.YNc(22,et,17,17,"tr",4),e.qZA()(),e.TgZ(23,"div",5),e.YNc(24,tt,11,10,"ng-container",6),e.TgZ(25,"label",7),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"ng-select",8),e.NdJ("ngModelChange",function(l){return r.reason=l}),e.qZA()()(),e.YNc(29,ot,6,6,"ng-template",9)),2&t&&(e.xp6(8),e.Oqu(e.lcZ(9,11,"order.product-name")),e.xp6(3),e.Oqu(e.lcZ(12,13,"order.product-sku")),e.xp6(3),e.Oqu(e.lcZ(15,15,"order.quantity")),e.xp6(3),e.Oqu(e.lcZ(18,17,"order.unit-price")),e.xp6(3),e.Oqu(e.lcZ(21,19,"order.cancel")),e.xp6(2),e.Q6J("ngForOf",r.order.lines),e.xp6(2),e.Q6J("ngIf",!0!==r.order.active),e.xp6(2),e.Oqu(e.lcZ(27,21,"order.cancellation-reason")),e.xp6(2),e.Q6J("items",r.reasons)("addTag",!0)("ngModel",r.reason))},dependencies:[p.MgK,p.asN,p.EeQ,s.sg,s.O5,d.Fj,d.wV,d._,d.JJ,d.qQ,d.Fd,d.On,C.w9,a.y_K,a.nPI,a.q6K,g.X$,a.Mgf,a.kgx],styles:["[_nghost-%COMP%]{height:100%;display:flex;min-height:64vh}.fulfillment-wrapper[_ngcontent-%COMP%]{flex:1}@media screen and (min-width: 768px){.fulfillment-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row}}@media screen and (min-width: 768px){.fulfillment-wrapper[_ngcontent-%COMP%]   .cancellation-details[_ngcontent-%COMP%]{margin-top:0;margin-inline-start:24px;width:250px}}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-lines[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-lines[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin-top:0}.fulfillment-wrapper[_ngcontent-%COMP%]   tr.ignore[_ngcontent-%COMP%]{color:var(--color-grey-300)}.fulfillment-wrapper[_ngcontent-%COMP%]   .is-cancelled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-decoration:line-through;background-color:var(--color-component-bg-200)}.fulfillment-wrapper[_ngcontent-%COMP%]   .is-disabled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .fulfillment-wrapper[_ngcontent-%COMP%]   .is-disabled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}"],changeDetection:0})}const fa=R.Ps`
    query GetCouponCodeSelectorPromotionList($options: PromotionListOptions) {
        promotions(options: $options) {
            items {
                id
                name
                couponCode
            }
            totalItems
        }
    }
`;class D{constructor(n){this.dataService=n,this.addCouponCode=new e.vpe,this.removeCouponCode=new e.vpe,this.couponCodeInput$=new L.x}ngOnInit(){this.availableCouponCodes$=(0,Oe.z)(this.couponCodeInput$.pipe((0,xe.b)(200),(0,Te.x)(),(0,_.w)(n=>this.dataService.query(a.RZZ,{options:{take:10,skip:0,filter:{couponCode:{contains:n}}}}).single$),(0,y.U)(({promotions:n})=>n.items.map(t=>({code:t.couponCode,promotionName:t.name}))),(0,Ze.O)([]))),this.control||(this.control=new d.p4(this.couponCodes??[]))}static#e=this.\u0275fac=function(t){return new(t||D)(e.Y36(a.DoR))};static#t=this.\u0275cmp=e.Xpm({type:D,selectors:[["vdr-coupon-code-selector"]],inputs:{couponCodes:"couponCodes",control:"control"},outputs:{addCouponCode:"addCouponCode",removeCouponCode:"removeCouponCode"},decls:3,vars:9,consts:[["appendTo","body","bindLabel","code","bindValue","code","typeToSearchText","",3,"items","addTag","multiple","hideSelected","minTermLength","typeahead","formControl","add","remove"],["ng-option-tmp",""]],template:function(t,r){1&t&&(e.TgZ(0,"ng-select",0),e.NdJ("add",function(l){return r.addCouponCode.emit(l.code)})("remove",function(l){return r.removeCouponCode.emit(null==l.value?null:l.value.code)}),e.ALo(1,"async"),e.YNc(2,it,3,2,"ng-template",1),e.qZA()),2&t&&e.Q6J("items",e.lcZ(1,7,r.availableCouponCodes$))("addTag",!1)("multiple",!0)("hideSelected",!0)("minTermLength",2)("typeahead",r.couponCodeInput$)("formControl",r.control)},dependencies:[d.JJ,d.oH,C.w9,C.ir,a.Ywx,s.Ov],changeDetection:0})}class P{constructor(n,t){this.dataService=n,this.formBuilder=t,this.useExisting=!0,this.createNew=!1}ngOnInit(){this.addressForm=this.formBuilder.group({fullName:[this.currentAddress?.fullName??""],company:[this.currentAddress?.company??""],streetLine1:[this.currentAddress?.streetLine1??"",d.kI.required],streetLine2:[this.currentAddress?.streetLine2??""],city:[this.currentAddress?.city??"",d.kI.required],province:[this.currentAddress?.province??""],postalCode:[this.currentAddress?.postalCode??"",d.kI.required],countryCode:[this.currentAddress?.countryCode??"",d.kI.required],phoneNumber:[this.currentAddress?.phoneNumber??""]}),this.useExisting=!!this.customerId,this.addresses$=this.customerId?this.dataService.query(a.lii,{customerId:this.customerId}).mapSingle(({customer:n})=>n?.addresses??[]).pipe((0,j.b)(n=>{this.currentAddress&&(this.selectedAddress=n.find(t=>t.streetLine1===this.currentAddress?.streetLine1&&t.postalCode===this.currentAddress?.postalCode)),0===n.length&&(this.createNew=!0,this.useExisting=!1)})):(0,v.of)([]),this.availableCountries$=this.dataService.settings.getAvailableCountries().mapSingle(({countries:n})=>n.items)}trackByFn(n){return n.id}addressIdFn(n){return n.streetLine1+n.postalCode}cancel(){this.resolveWith()}select(){if(this.useExisting&&this.selectedAddress&&this.resolveWith({...(0,$e.e)(this.selectedAddress,["fullName","company","streetLine1","streetLine2","city","province","phoneNumber","postalCode"]),countryCode:this.selectedAddress.country.code}),this.createNew&&this.addressForm.valid){const n=this.addressForm.value;this.resolveWith(n)}}static#e=this.\u0275fac=function(t){return new(t||P)(e.Y36(a.DoR),e.Y36(d.QS))};static#t=this.\u0275cmp=e.Xpm({type:P,selectors:[["vdr-select-address-dialog"]],decls:4,vars:3,consts:[["vdrDialogTitle",""],[4,"ngIf"],["vdrDialogButtons",""],["clrTabLink",""],[3,"clrIfActive","clrIfActiveChange"],[1,"block","mt-4",3,"idFn","selectedItemId","selectItem"],[3,"item",4,"ngFor","ngForOf"],[3,"item"],[3,"address"],[3,"formGroup","availableCountries"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,r){1&t&&(e.YNc(0,at,2,3,"ng-template",0),e.YNc(1,pt,7,5,"clr-tabs",1),e.ALo(2,"async"),e.YNc(3,ut,6,7,"ng-template",2)),2&t&&(e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,r.addresses$)))},dependencies:[p.tam,p.UkA,p.S4y,p.gKI,p.Iq$,p.dl,p.Qs7,s.sg,s.O5,d.JL,d.sg,a.nPI,a.q6K,a.b28,a.CY4,a.C9C,a.myM,s.Ov,g.X$],changeDetection:0})}class B{constructor(n,t){this.dataService=n,this.formBuilder=t,this.isLoading=!1,this.input$=new L.x,this.selectedCustomer=[],this.useExisting=!0,this.createNew=!1,this.customerForm=this.formBuilder.group({title:"",firstName:["",d.kI.required],lastName:["",d.kI.required],phoneNumber:"",emailAddress:["",[d.kI.required,d.kI.email]]})}ngOnInit(){this.customers$=(0,Oe.z)((0,v.of)([]),this.input$.pipe((0,xe.b)(200),(0,Te.x)(),(0,j.b)(()=>this.isLoading=!0),(0,_.w)(n=>this.dataService.customer.getCustomerList(10,0,n).mapStream(({customers:t})=>t.items).pipe((0,Ae.K)(()=>(0,v.of)([])),(0,j.b)(()=>this.isLoading=!1)))))}trackByFn(n){return n.id}cancel(){this.resolveWith()}select(){if(this.useExisting&&1===this.selectedCustomer.length&&this.resolveWith(this.selectedCustomer[0]),this.createNew&&this.customerForm.valid){const n=this.customerForm.value;this.resolveWith(n)}}static#e=this.\u0275fac=function(t){return new(t||B)(e.Y36(a.DoR),e.Y36(d.QS))};static#t=this.\u0275cmp=e.Xpm({type:B,selectors:[["vdr-select-customer-dialog"]],decls:13,vars:8,consts:[["vdrDialogTitle",""],["clrTabLink",""],[3,"clrIfActive","clrIfActiveChange"],["vdrDialogButtons",""],[1,"mt-4"],["appendTo","body","bindLabel","name",3,"items","addTag","multiple","hideSelected","trackByFn","minTermLength","loading","typeahead","ngModel","ngModelChange"],["ng-label-tmp",""],["ng-option-tmp",""],[1,"item-row"],["shape","user",1,"is-solid"],[1,"mx-1"],[3,"formGroup"],["for","title",3,"label"],["id","title","type","text","formControlName","title"],["for","firstName",3,"label"],["id","firstName","type","text","formControlName","firstName"],["for","lastName",3,"label"],["id","lastName","type","text","formControlName","lastName"],["for","emailAddress",3,"label"],["id","emailAddress","type","text","formControlName","emailAddress"],["for","phoneNumber",3,"label"],["id","phoneNumber","type","text","formControlName","phoneNumber"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,r){1&t&&(e.YNc(0,mt,2,3,"ng-template",0),e.TgZ(1,"clr-tabs")(2,"clr-tab")(3,"button",1),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.YNc(6,ft,6,11,"ng-template",2),e.NdJ("clrIfActiveChange",function(l){return r.useExisting=l}),e.qZA(),e.TgZ(7,"clr-tab")(8,"button",1),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.YNc(11,ht,17,16,"ng-template",2),e.NdJ("clrIfActiveChange",function(l){return r.createNew=l}),e.qZA()(),e.YNc(12,vt,6,7,"ng-template",3)),2&t&&(e.xp6(4),e.Oqu(e.lcZ(5,4,"order.existing-customer")),e.xp6(2),e.Q6J("clrIfActive",r.useExisting),e.xp6(3),e.Oqu(e.lcZ(10,6,"customer.create-new-customer")),e.xp6(2),e.Q6J("clrIfActive",r.createNew))},dependencies:[p.qvL,p.tam,p.UkA,p.S4y,p.gKI,p.Iq$,p.dl,p.Qs7,d._Y,d.Fj,d.JJ,d.JL,d.On,d.sg,d.u,C.w9,C.ir,C.mR,a.Ywx,a.hgI,a.y_K,a.nPI,a.q6K,s.Ov,g.X$],styles:[".item-row[_ngcontent-%COMP%]{display:flex;align-items:center}"],changeDetection:0})}class V{ngOnInit(){this.currentSelectionId&&(this.selectedMethod=this.eligibleShippingMethods.find(n=>n.id===this.currentSelectionId))}methodIdFn(n){return n.id}cancel(){this.resolveWith()}select(){this.selectedMethod&&this.resolveWith(this.selectedMethod.id)}static#e=this.\u0275fac=function(t){return new(t||V)};static#t=this.\u0275cmp=e.Xpm({type:V,selectors:[["vdr-select-shipping-method-dialog"]],decls:4,vars:3,consts:[["vdrDialogTitle",""],[3,"idFn","selectedItemId","selectItem"],[3,"item",4,"ngFor","ngForOf"],["vdrDialogButtons",""],[3,"item"],[1,"result-details"],[3,"label"],[1,"price-row"],[3,"value",4,"ngIf"],[3,"value"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,r){1&t&&(e.YNc(0,yt,2,3,"ng-template",0),e.TgZ(1,"vdr-radio-card-fieldset",1),e.NdJ("selectItem",function(l){return r.selectedMethod=l}),e.YNc(2,bt,15,20,"vdr-radio-card",2),e.qZA(),e.YNc(3,Ct,6,7,"ng-template",3)),2&t&&(e.xp6(1),e.Q6J("idFn",r.methodIdFn)("selectedItemId",null==r.selectedMethod?null:r.selectedMethod.id),e.xp6(1),e.Q6J("ngForOf",r.eligibleShippingMethods))},dependencies:[s.sg,s.O5,a.nPI,a.q6K,a.WGc,a._8q,a.C9C,a.myM,g.X$,a.kgx],changeDetection:0})}class K{constructor(){this.nextStates=[],this.message="",this.selectedState=""}select(){this.selectedState&&this.resolveWith(this.selectedState)}cancel(){this.resolveWith()}static#e=this.\u0275fac=function(t){return new(t||K)};static#t=this.\u0275cmp=e.Xpm({type:K,selectors:[["vdr-order-state-select-dialog"]],decls:8,vars:5,consts:[["vdrDialogTitle",""],["name","state",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["vdrDialogButtons",""],[3,"value"],["type","submit","class","btn btn-secondary",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["type","submit",1,"btn","btn-secondary",3,"click"]],template:function(t,r){1&t&&(e.YNc(0,Ot,2,3,"ng-template",0),e.TgZ(1,"p"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"vdr-form-field")(5,"select",1),e.NdJ("ngModelChange",function(l){return r.selectedState=l}),e.YNc(6,Tt,4,6,"option",2),e.qZA()(),e.YNc(7,At,6,12,"ng-template",3)),2&t&&(e.xp6(2),e.Oqu(e.lcZ(3,3,r.message)),e.xp6(3),e.Q6J("ngModel",r.selectedState),e.xp6(1),e.Q6J("ngForOf",r.nextStates))},dependencies:[s.sg,s.O5,d.YN,d.Kr,d.EJ,d.JJ,d.On,a.hgI,a.y_K,a.nPI,a.q6K,g.X$,a.Nir],changeDetection:0})}class Z{constructor(n,t,r,i){this.dataService=n,this.modalService=t,this.notificationService=r,this.i18nService=i}transitionToPreModifyingState(n,t){return this.getPreModifyingState(n).pipe((0,_.w)(r=>{const i={orderId:n,nextStates:t,message:this.i18nService.translate((0,u.J)("order.unable-to-transition-to-state-try-another"),{state:r}),cancellable:!1,retry:10};return r?this.transitionToStateOrThrow(n,r).pipe((0,Ae.K)(l=>this.manuallyTransitionToState(i))):this.manuallyTransitionToState(i)}))}manuallyTransitionToState(n){return this.modalService.fromComponent(K,{locals:{nextStates:n.nextStates,cancellable:n.cancellable,message:n.message},closable:!1,size:"md"}).pipe((0,_.w)(t=>{if(t)return this.transitionToStateOrThrow(n.orderId,t);if(n.cancellable)return O.E;throw new Error("An order state must be selected")}),function Re(o){return(0,Ye.e)((n,t)=>{let r,l,i=!1;const c=()=>{r=n.subscribe((0,Ie.x)(t,void 0,void 0,f=>{l||(l=new L.x,(0,Ee.Xf)(o(l)).subscribe((0,Ie.x)(t,()=>r?c():i=!0))),l&&l.next(f)})),i&&(r.unsubscribe(),r=null,i=!1,c())};c()})}(t=>t.pipe((0,je.g)(2e3),(0,T.q)(n.retry))))}getPreModifyingState(n){return this.dataService.order.getOrderHistory(n,{filter:{type:{eq:a.iYD.ORDER_STATE_TRANSITION}},sort:{createdAt:a.Asd.DESC}}).mapSingle(t=>t.order).pipe((0,y.U)(t=>{const r=t?.history.items.find(i=>"Modifying"===i.data.to);if(r)return r.data.from}))}transitionToStateOrThrow(n,t){return this.dataService.order.transitionToState(n,t).pipe((0,y.U)(({transitionOrderToState:r})=>{switch(r?.__typename){case"Order":return r?.state;case"OrderStateTransitionError":throw this.notificationService.error(r?.transitionError),new Error(r?.transitionError)}}))}static#e=this.\u0275fac=function(t){return new(t||Z)(e.LFG(a.DoR),e.LFG(a.Z7U),e.LFG(a.gqp),e.LFG(a.Dp7))};static#t=this.\u0275prov=e.Yz7({token:Z,factory:Z.\u0275fac,providedIn:"root"})}class z{constructor(n,t){this.formBuilder=n,this.modalService=t,this.customFieldsConfig=[],this.customFieldValues={},this.updateClick=new e.vpe,this.editable=!1}ngOnInit(){this.customFieldForm=this.formBuilder.group({});for(const n of this.customFieldsConfig)this.customFieldForm.addControl(n.name,this.formBuilder.control(this.customFieldValues[n.name]))}onUpdateClick(){this.updateClick.emit(this.customFieldForm.value),this.customFieldForm.markAsPristine(),this.editable=!1}onCancelClick(){this.customFieldForm.dirty?this.modalService.dialog({title:(0,u.J)("catalog.confirm-cancel"),buttons:[{type:"secondary",label:(0,u.J)("common.keep-editing")},{type:"danger",label:(0,u.J)("common.discard-changes"),returnValue:!0}]}).subscribe(n=>{n&&(this.customFieldForm.reset(),this.customFieldForm.markAsPristine(),this.editable=!1)}):this.editable=!1}static#e=this.\u0275fac=function(t){return new(t||z)(e.Y36(d.QS),e.Y36(a.Z7U))};static#t=this.\u0275cmp=e.Xpm({type:z,selectors:[["vdr-order-custom-fields-card"]],inputs:{customFieldsConfig:"customFieldsConfig",customFieldValues:"customFieldValues"},outputs:{updateClick:"updateClick"},decls:1,vars:1,consts:[["class","card",4,"ngIf"],[1,"card"],[1,"card-header"],[1,"card-block"],[1,"card-text","custom-field-form"],["entityName","Order",3,"customFields","customFieldsFormGroup","readonly","compact"],[1,"card-footer"],["class","btn btn-sm btn-secondary",3,"click",4,"ngIf"],["class","btn btn-sm btn-primary",3,"disabled","click",4,"ngIf"],[1,"btn","btn-sm","btn-secondary",3,"click"],["shape","pencil"],[1,"btn","btn-sm","btn-primary",3,"disabled","click"],["shape","check"],["shape","times"]],template:function(t,r){1&t&&e.YNc(0,Mt,11,12,"div",0),2&t&&e.Q6J("ngIf",r.customFieldsConfig.length)},dependencies:[p.qvL,s.O5,a.yc0,g.X$],styles:["vdr-custom-field-control[_ngcontent-%COMP%]{margin-bottom:6px;display:block}.custom-field-form[_ngcontent-%COMP%]     .clr-control-label{color:var(--color-grey-400)}.custom-field-form.editable[_ngcontent-%COMP%]     .clr-control-label{color:inherit}"],changeDetection:0})}class q{constructor(){this.fulfilledCount=0,this.fulfillments=[]}ngOnChanges(n){this.line&&(this.fulfilledCount=this.getDeliveredCount(this.line),this.fulfillmentStatus=this.getFulfillmentStatus(this.fulfilledCount,this.line.quantity),this.fulfillments=this.getFulfillments(this.line))}getDeliveredCount(n){return n.fulfillmentLines?.reduce((t,r)=>t+r.quantity,0)??0}getFulfillmentStatus(n,t){return n===t?"full":0<n&&n<t?"partial":"none"}getFulfillments(n){return n.fulfillmentLines?.map(t=>{const r=this.allOrderFulfillments?.find(i=>i.id===t.fulfillmentId);if(r)return{count:t.quantity,fulfillment:r}}).filter(x.notNullOrUndefined)??[]}static#e=this.\u0275fac=function(t){return new(t||q)};static#t=this.\u0275cmp=e.Xpm({type:q,selectors:[["vdr-line-fulfillment"]],inputs:{line:"line",allOrderFulfillments:"allOrderFulfillments",orderState:"orderState"},features:[e.TTD],decls:1,vars:1,consts:[["class","search-settings-menu",4,"ngIf"],[1,"search-settings-menu"],["type","button","vdrDropdownTrigger","",1,"icon-button"],["class","item-fulfilled","shape","check-circle",4,"ngIf"],["class","item-partially-fulfilled","shape","check-circle",4,"ngIf"],["class","item-not-fulfilled","shape","exclamation-circle",4,"ngIf"],["vdrPosition","bottom-right"],["class","dropdown-header",4,"ngIf"],["class","fulfillment-detail",4,"ngFor","ngForOf"],["shape","check-circle",1,"item-fulfilled"],["shape","check-circle",1,"item-partially-fulfilled"],["shape","exclamation-circle",1,"item-not-fulfilled"],[1,"dropdown-header"],[1,"fulfillment-detail"],[1,"fulfillment-title"],[3,"label"],[3,"label",4,"ngIf"]],template:function(t,r){1&t&&e.YNc(0,Ut,10,7,"vdr-dropdown",0),2&t&&e.Q6J("ngIf",r.fulfilledCount||"PartiallyDelivered"===r.orderState)},dependencies:[p.qvL,p.MgK,s.sg,s.O5,a.JOL,a.N9E,a.UaT,a.WGc,g.X$,a.HbD],styles:[".item-fulfilled[_ngcontent-%COMP%]{color:var(--color-success-700)}.item-partially-fulfilled[_ngcontent-%COMP%]{color:var(--color-warning-700)}.item-not-fulfilled[_ngcontent-%COMP%]{color:var(--color-error-700)}.fulfillment-detail[_ngcontent-%COMP%]{margin:6px 12px}.fulfillment-detail[_ngcontent-%COMP%]:not(:last-of-type){border-bottom:1px dashed var(--color-component-border-200)}"],changeDetection:0})}class I{getRefundedCount(){return(this.payments?.reduce((t,r)=>[...t,...r.refunds],[]).filter(t=>"Failed"!==t.state).reduce((t,r)=>[...t,...r.lines],[])??[]).filter(t=>t.orderLineId===this.line.id).reduce((t,r)=>t+r.quantity,0)}static#e=this.\u0275fac=function(t){return new(t||I)};static#t=this.\u0275cmp=e.Xpm({type:I,selectors:[["vdr-line-refunds"]],inputs:{line:"line",payments:"payments"},decls:1,vars:1,consts:[[3,"title",4,"ngIf"],[3,"title"],["shape","redo","dir","down",1,"is-solid"]],template:function(t,r){1&t&&e.YNc(0,Et,3,6,"span",0),2&t&&e.Q6J("ngIf",r.getRefundedCount())},dependencies:[p.qvL,s.O5,Le.Lv,g.X$],styles:["[_nghost-%COMP%]{color:var(--color-error-500)}"],changeDetection:0})}class w extends a.Up6{constructor(){super(...arguments),this.orderable=!1}static#e=this.\u0275fac=function(){let n;return function(r){return(n||(n=e.n5z(w)))(r||w)}}();static#t=this.\u0275cmp=e.Xpm({type:w,selectors:[["vdr-order-total-column"]],exportAs:["row"],features:[e.qOj],decls:0,vars:0,template:function(t,r){},encapsulation:2})}class k extends a.eJ5{get allColumns(){return[...this.columns??[],...this.customFieldColumns??[],...this.totalColumns??[]]}get sortedColumns(){const n=this.allColumns,t=this.getDataTableConfig();for(const[r,i]of Object.entries(t[this.id].order)){const l=n.find(f=>f.id===r),c=n.findIndex(f=>f.id===r);-1!==c&&l&&(n.splice(c,1),n.splice(i,0,l))}return n}getPromotionLink(n){return["/marketing","promotions",n.adjustmentSource.split(":")[1]]}getCouponCodeForAdjustment(n,t){const r=t.adjustmentSource.split(":")[1],i=n.promotions.find(l=>l.id===r);if(i)return i.couponCode||void 0}getShippingNames(n){return n.shippingLines.length?n.shippingLines.map(t=>t.shippingMethod.name).join(", "):""}static#e=this.\u0275fac=function(){let n;return function(r){return(n||(n=e.n5z(k)))(r||k)}}();static#t=this.\u0275cmp=e.Xpm({type:k,selectors:[["vdr-order-data-table"]],contentQueries:function(t,r,i){if(1&t&&e.Suo(i,w,4),2&t){let l;e.iGM(l=e.CRH())&&(r.totalColumns=l)}},inputs:{order:"order"},features:[e.qOj],ngContentSelectors:yn,decls:60,vars:70,consts:[[1,"bulk-actions"],[1,"table-wrapper"],[1,""],[1,"heading-row"],["class","selection-col",4,"ngIf"],[3,"expand",4,"ngFor","ngForOf"],[1,"column-picker"],[3,"uiLanguage","columns","reorder","resetColumns"],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","surcharge",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"sub-total"],[1,"clr-align-middle"],[1,"net-price",3,"title"],[1,"shipping"],["class","shipping-method-name",4,"ngFor","ngForOf"],[1,"total"],[1,"selection-col"],["type","checkbox","clrCheckbox","",3,"checked","change"],[1,"cell-content",3,"ngClass"],["api","dataTable","display","block",3,"locationId","metadata","topPx","leftPx"],["class","sort-toggle",4,"ngIf"],[1,"sort-toggle"],[3,"click"],["shape","two-way-arrows left",4,"ngIf"],["shape","arrow up",4,"ngIf"],["shape","arrow down",4,"ngIf"],["class","sort-label",4,"ngIf"],["shape","two-way-arrows left"],["shape","arrow up"],["shape","arrow down"],[1,"sort-label"],[1,"filter-row"],[1,"button-ghost","toggle-search-filter-row",3,"title","click"],["shape","search"],[1,"filter-row-wrapper"],[4,"ngTemplateOutlet"],[1,"filters"],["class","mt-1",3,"filterWithValue","filters",4,"ngFor","ngForOf"],["class","mt-1",3,"filters",4,"ngIf"],[1,"mt-1",3,"filterWithValue","filters"],[1,"mt-1",3,"filters"],["class","selection-col",3,"active",4,"ngIf"],[3,"active",4,"ngFor","ngForOf"],["type","checkbox","clrCheckbox","",3,"checked","click"],[4,"ngIf","ngIfElse"],["defaultComponent",""],[4,"ngComponentOutlet","ngComponentOutletInputs","ngComponentOutletInjector"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"emptyStateLabel"],[1,"surcharge"],["colspan","2",1,"align-middle","name","left"],[1,"align-middle","sku"],[1,"align-middle"],[1,"align-middle","total"],["class","order-adjustment",4,"ngIf"],[1,"order-adjustment"],[3,"routerLink"],[1,"shipping-method-name"]],template:function(t,r){1&t&&(e.F$t(hn),e.TgZ(0,"div",0),e.Hsn(1),e.qZA(),e.TgZ(2,"div",1)(3,"table",2)(4,"thead")(5,"tr",3),e.YNc(6,Yt,2,1,"th",4),e.YNc(7,Bt,6,9,"th",5),e.TgZ(8,"th")(9,"div",6)(10,"vdr-data-table-colum-picker",7),e.NdJ("reorder",function(l){return r.onColumnReorder(l)})("resetColumns",function(){return r.onColumnsReset()}),e.ALo(11,"async"),e.qZA()()()(),e.YNc(12,en,9,13,"tr",8),e.qZA(),e.TgZ(13,"tbody"),e.YNc(14,sn,4,4,"tr",9),e.ALo(15,"paginate"),e.ynx(16),e.YNc(17,pn,4,4,"tr",8),e.BQk(),e.YNc(18,un,14,14,"tr",10),e.YNc(19,_n,2,1,"ng-container",11),e.TgZ(20,"tr",12)(21,"td",2),e._uU(22),e.ALo(23,"translate"),e.qZA(),e._UZ(24,"td"),e.TgZ(25,"td",13),e._uU(26),e.ALo(27,"localeCurrency"),e.TgZ(28,"div",14),e.ALo(29,"translate"),e._uU(30),e.ALo(31,"localeCurrency"),e.qZA()(),e._UZ(32,"td"),e.qZA(),e.TgZ(33,"tr",15)(34,"td",2),e._uU(35),e.ALo(36,"translate"),e.qZA(),e.TgZ(37,"td"),e.YNc(38,fn,2,1,"vdr-chip",16),e.qZA(),e.TgZ(39,"td",13),e._uU(40),e.ALo(41,"localeCurrency"),e.TgZ(42,"div",14),e.ALo(43,"translate"),e._uU(44),e.ALo(45,"localeCurrency"),e.qZA()(),e._UZ(46,"td"),e.qZA(),e.TgZ(47,"tr",17)(48,"td",2),e._uU(49),e.ALo(50,"translate"),e.qZA(),e._UZ(51,"td"),e.TgZ(52,"td",13),e._uU(53),e.ALo(54,"localeCurrency"),e.TgZ(55,"div",14),e.ALo(56,"translate"),e._uU(57),e.ALo(58,"localeCurrency"),e.qZA()(),e._UZ(59,"td"),e.qZA()()()()),2&t&&(e.xp6(3),e.ekj("no-select",r.disableSelect),e.xp6(1),e.ekj("items-selected",null==r.selectionManager?null:r.selectionManager.selection.length),e.xp6(2),e.Q6J("ngIf",r.selectionManager),e.xp6(1),e.Q6J("ngForOf",r.visibleSortedColumns),e.xp6(3),e.Q6J("uiLanguage",e.lcZ(11,30,r.uiLanguage$))("columns",r.sortedColumns),e.xp6(2),e.Q6J("ngIf",r.searchComponent||r.customSearchTemplate||(null==r.filters?null:r.filters.length)),e.xp6(2),e.Q6J("ngForOf",e.xi3(15,32,r.items,e.l5B(65,vn,r.id,r.itemsPerPage,r.currentPage,r.totalItems)))("ngForTrackBy",r.trackByFn),e.xp6(3),e.Q6J("ngIf",!(null!=r.items&&r.items.length)),e.xp6(1),e.Q6J("ngForOf",r.order.surcharges),e.xp6(1),e.Q6J("ngForOf",r.order.discounts),e.xp6(3),e.Oqu(e.lcZ(23,35,"order.sub-total")),e.xp6(2),e.uIk("colspan",r.visibleSortedColumns.length-2),e.xp6(2),e.hij(" ",e.xi3(27,37,r.order.subTotalWithTax,r.order.currencyCode)," "),e.xp6(2),e.Q6J("title",e.lcZ(29,40,"order.net-price")),e.xp6(2),e.hij(" ",e.xi3(31,42,r.order.subTotal,r.order.currencyCode)," "),e.xp6(5),e.Oqu(e.lcZ(36,45,"order.shipping")),e.xp6(2),e.uIk("colspan",r.visibleSortedColumns.length-2),e.xp6(1),e.Q6J("ngForOf",r.order.shippingLines),e.xp6(2),e.hij(" ",e.xi3(41,47,r.order.shippingWithTax,r.order.currencyCode)," "),e.xp6(2),e.Q6J("title",e.lcZ(43,50,"order.net-price")),e.xp6(2),e.hij(" ",e.xi3(45,52,r.order.shipping,r.order.currencyCode)," "),e.xp6(5),e.Oqu(e.lcZ(50,55,"order.total")),e.xp6(2),e.uIk("colspan",r.visibleSortedColumns.length-2),e.xp6(2),e.hij(" ",e.xi3(54,57,r.order.totalWithTax,r.order.currencyCode)," "),e.xp6(2),e.Q6J("title",e.lcZ(56,60,"order.net-price")),e.xp6(2),e.hij(" ",e.xi3(58,62,r.order.total,r.order.currencyCode)," "))},dependencies:[p.q0d,p.qvL,p.KKC,s.mk,s.$G,s.sg,s.O5,s.tP,h.rH,a.Ywx,a.y_K,a.jw0,a.rak,a.IYn,a.Lo_,s.Ov,He._s,g.X$,a.kgx],styles:["[_nghost-%COMP%]{display:block;max-width:100%;position:relative;margin-bottom:calc(var(--space-unit) * 4);container-type:inline-size}th[_ngcontent-%COMP%]{border-bottom:1px solid var(--color-table-header-border);font-size:var(--font-size-xs);font-weight:600;text-transform:uppercase;position:relative;white-space:nowrap}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:calc(var(--space-unit) * 1.5) calc(var(--space-unit) * 1)}tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-of-type, tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-of-type{text-align:center}@media screen and (min-width: 992px){tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-of-type, tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-of-type{padding-inline-start:var(--surface-margin-left);text-align:start}}th[_ngcontent-%COMP%]:last-of-type, td[_ngcontent-%COMP%]:last-of-type{border-inline-end:1px solid var(--color-table-header-border)}tr[_ngcontent-%COMP%]:first-of-type   th[_ngcontent-%COMP%]:last-of-type{border-image:linear-gradient(0deg,var(--color-table-header-border),transparent) 1}tr[_ngcontent-%COMP%]:last-of-type   td[_ngcontent-%COMP%]:last-of-type{border-image:linear-gradient(180deg,var(--color-table-header-border),transparent) 1}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid var(--color-table-row-separator)}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:var(--color-table-row-hover-bg)}.bulk-actions[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * 5);background-color:var(--color-surface-bg);z-index:10;display:flex;position:absolute;top:5px;height:40px}@media screen and (min-width: 992px){.bulk-actions[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * 8.5)}}@media screen and (min-width: 1280px){.bulk-actions[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * 10.5)}}.table-wrapper[_ngcontent-%COMP%]{display:block;overflow-y:hidden;overflow-x:auto;position:relative;width:100%;max-width:var(--surface-width)}table[_ngcontent-%COMP%]{width:100%}table.no-select[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.column-picker[_ngcontent-%COMP%]{width:24px}.sort-toggle[_ngcontent-%COMP%]{display:flex;align-items:center;margin-inline-start:calc(var(--space-unit) * .5)}.sort-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;border-radius:var(--border-radius-lg);color:var(--color-weight-500);padding:0 2px;cursor:pointer;background-color:transparent}.sort-toggle[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{color:var(--color-primary-700)}.sort-toggle[_ngcontent-%COMP%]   .sort-label[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * .5);font-size:10px;color:var(--color-primary-600);font-weight:400}.toggle-search-filter-row[_ngcontent-%COMP%]{position:absolute;top:-12px;left:4px}@media screen and (min-width: 1280px){.toggle-search-filter-row[_ngcontent-%COMP%]{left:8px}}.toggle-search-filter-row.active[_ngcontent-%COMP%]{background-color:var(--color-primary-700);color:var(--color-primary-100);border-color:var(--color-primary-700)}th.filter-row[_ngcontent-%COMP%]{position:relative;font-size:var(--font-size-base);font-weight:400;background-color:var(--color-weight-100);box-shadow:var(--data-table-filter-box-shadow);border-left-width:0;border-right-width:0;text-align:initial;padding:0}th.filter-row[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}th.filter-row.active[_ngcontent-%COMP%]{border-bottom:1px solid var(--color-table-header-border)}th.filter-row[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{margin-top:calc(var(--space-unit) * 1);display:flex;flex-wrap:wrap;gap:calc(var(--space-unit) * .5)}.filter-row-wrapper[_ngcontent-%COMP%]{padding:calc(var(--space-unit) * 4);padding-inline-start:0;max-height:150px;transition:max-height .2s,padding .2s,opacity .2s}.filter-row-wrapper.hidden[_ngcontent-%COMP%]{max-height:0px;padding-top:0;padding-bottom:0;overflow:hidden;opacity:0}.cell-link[_ngcontent-%COMP%]{display:block;width:100%;height:100%}td.active[_ngcontent-%COMP%]{background-color:var(--color-table-row-active-bg)}.cell-content[_ngcontent-%COMP%]{display:flex;align-items:center;line-height:var(--font-size-sm);color:var(--color-weight-700)}.cell-content.left[_ngcontent-%COMP%]{justify-content:flex-start}.cell-content.center[_ngcontent-%COMP%]{justify-content:center}.cell-content.right[_ngcontent-%COMP%]{justify-content:flex-end}.selection-col[_ngcontent-%COMP%]{width:calc(var(--space-unit) * 8)}vdr-empty-placeholder[_ngcontent-%COMP%]{width:100%}.table-footer[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:space-between;margin-top:var(--space-unit);margin-inline-start:var(--surface-margin-left);margin-inline-end:var(--space-unit)}.total-items-count[_ngcontent-%COMP%]{font-size:var(--font-size-xs)}@container (max-width: 500px){.total-items-count[_ngcontent-%COMP%]{display:none}}","[_nghost-%COMP%]   .is-cancelled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-decoration:line-through;background-color:var(--color-component-bg-200)}[_nghost-%COMP%]   .sub-total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:1px dashed var(--color-component-border-200)}[_nghost-%COMP%]   .total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:700;border-top:1px dashed var(--color-component-border-200)}[_nghost-%COMP%]   td.custom-fields-row[_ngcontent-%COMP%]{border-top-style:dashed;border-top-color:var(--color-grey-200)}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{border-radius:var(--border-radius-img)}[_nghost-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]   .custom-field[_ngcontent-%COMP%]{text-align:start;max-width:200px;overflow:hidden;text-overflow:ellipsis;margin-bottom:6px;margin-inline-end:18px}[_nghost-%COMP%]   .draft-qty[_ngcontent-%COMP%]{max-width:48px}[_nghost-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100)}[_nghost-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]   .custom-field-ellipsis[_ngcontent-%COMP%]{color:var(--color-text-300)}[_nghost-%COMP%]   .net-price[_ngcontent-%COMP%]{font-size:11px;color:var(--color-text-300);line-height:14px}[_nghost-%COMP%]   .promotions-label[_ngcontent-%COMP%]{-webkit-text-decoration:underline dotted var(--color-text-200);text-decoration:underline dotted var(--color-text-200);font-size:11px;margin-top:6px;cursor:pointer;text-transform:lowercase}[_nghost-%COMP%]   .thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px}[_nghost-%COMP%]   .shipping-method-name[_ngcontent-%COMP%]{font-size:var(--font-size-xs);margin-inline-end:2px}[_nghost-%COMP%]   .order-placed-quantity[_ngcontent-%COMP%]{text-decoration:line-through;color:var(--color-text-300);margin-inline-end:2px}"],changeDetection:0})}class F{constructor(){this.isDraft=!1,this.adjust=new e.vpe,this.remove=new e.vpe,this.orderLineCustomFieldsVisible=!1,this.customFieldsForLine={}}get visibleOrderLineCustomFields(){return this.orderLineCustomFieldsVisible?this.orderLineCustomFields:[]}get showElided(){return!this.orderLineCustomFieldsVisible&&0<this.orderLineCustomFields.length}ngOnInit(){this.orderLineCustomFieldsVisible=this.orderLineCustomFields.length<2,this.getLineCustomFields()}draftInputBlur(n,t){n.quantity!==t&&this.adjust.emit({lineId:n.id,quantity:t})}toggleOrderLineCustomFields(){this.orderLineCustomFieldsVisible=!this.orderLineCustomFieldsVisible}getLineDiscounts(n){return n.discounts.filter(t=>t.type===a.S2X.PROMOTION)}getLineCustomFields(){for(const n of this.order.lines){const t=new d.nJ({}),r=this.orderLineCustomFields.map(i=>{const l=n.customFields[i.name];return t.addControl(i.name,new d.p4(l)),{config:i,formGroup:t,value:l}}).filter(i=>!!this.orderLineCustomFieldsVisible||null!=i.value);this.customFieldsForLine[n.id]=r}}getPromotionLink(n){return["/marketing","promotions",n.adjustmentSource.split(":")[1]]}getCouponCodeForAdjustment(n,t){const r=t.adjustmentSource.split(":")[1],i=n.promotions.find(l=>l.id===r);if(i)return i.couponCode||void 0}getShippingNames(n){return n.shippingLines.length?n.shippingLines.map(t=>t.shippingMethod.name).join(", "):""}static#e=this.\u0275fac=function(t){return new(t||F)};static#t=this.\u0275cmp=e.Xpm({type:F,selectors:[["vdr-order-table"]],inputs:{order:"order",orderLineCustomFields:"orderLineCustomFields",isDraft:"isDraft"},outputs:{adjust:"adjust",remove:"remove"},decls:20,vars:24,consts:[["id","order-detail-list",3,"items","order"],["id","image",3,"heading"],["id","product-name",3,"heading"],["id","product-sku",3,"heading","optional"],["id","unit-price",3,"heading"],["id","quantity",3,"heading","optional"],[3,"customField",4,"ngFor","ngForOf"],["id","total",3,"heading","optional"],[1,"image-placeholder"],[3,"src",4,"ngIf","ngIfElse"],["imagePlaceholder",""],[3,"src"],[1,"placeholder"],["shape","image","size","48"],[1,"unit-price"],[1,"net-price",3,"title"],[4,"ngIf","ngIfElse"],["draft",""],[3,"line","payments"],[3,"line","orderState","allOrderFulfillments"],[1,"flex"],["class","order-placed-quantity",3,"title",4,"ngIf"],[1,"order-placed-quantity",3,"title"],["type","number","min","0",1,"draft-qty",3,"value","blur"],["qtyInput",""],[1,"icon-button",3,"click"],["shape","trash"],[3,"customField"],[4,"ngIf"],["vdrDropdownTrigger","",1,"promotions-label"],["class","line-promotion",4,"ngFor","ngForOf"],[1,"line-promotion"],[1,"promotion-name",3,"routerLink"],[1,"promotion-amount"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-order-data-table",0)(1,"vdr-dt2-column",1),e.ALo(2,"translate"),e.YNc(3,Cn,4,2,"ng-template"),e.qZA(),e.TgZ(4,"vdr-dt2-column",2),e.ALo(5,"translate"),e.YNc(6,On,1,1,"ng-template"),e.qZA(),e.TgZ(7,"vdr-dt2-column",3),e.ALo(8,"translate"),e.YNc(9,Tn,1,1,"ng-template"),e.qZA(),e.TgZ(10,"vdr-dt2-column",4),e.ALo(11,"translate"),e.YNc(12,Zn,7,11,"ng-template"),e.qZA(),e.TgZ(13,"vdr-dt2-column",5),e.ALo(14,"translate"),e.YNc(15,Fn,5,7,"ng-template"),e.qZA(),e.YNc(16,Mn,1,1,"vdr-dt2-custom-field-column",6),e.TgZ(17,"vdr-order-total-column",7),e.ALo(18,"translate"),e.YNc(19,Pn,8,12,"ng-template"),e.qZA()()),2&t&&(e.Q6J("items",r.order.lines)("order",r.order),e.xp6(1),e.Q6J("heading",e.lcZ(2,12,"common.image")),e.xp6(3),e.Q6J("heading",e.lcZ(5,14,"order.product-name")),e.xp6(3),e.Q6J("heading",e.lcZ(8,16,"order.product-sku"))("optional",!1),e.xp6(3),e.Q6J("heading",e.lcZ(11,18,"order.unit-price")),e.xp6(3),e.Q6J("heading",e.lcZ(14,20,"order.quantity"))("optional",!1),e.xp6(3),e.Q6J("ngForOf",r.orderLineCustomFields),e.xp6(1),e.Q6J("heading",e.lcZ(18,22,"order.total"))("optional",!1))},dependencies:[p.qvL,s.sg,s.O5,h.rH,a.y_K,a.JOL,a.N9E,a.UaT,a.Up6,a.jrk,q,I,k,w,g.X$,a.Mgf,a.kgx],styles:["[_nghost-%COMP%]   .is-cancelled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-decoration:line-through;background-color:var(--color-component-bg-200)}[_nghost-%COMP%]   .sub-total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:1px dashed var(--color-component-border-200)}[_nghost-%COMP%]   .total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:700;border-top:1px dashed var(--color-component-border-200)}[_nghost-%COMP%]   td.custom-fields-row[_ngcontent-%COMP%]{border-top-style:dashed;border-top-color:var(--color-grey-200)}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{border-radius:var(--border-radius-img)}[_nghost-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]   .custom-field[_ngcontent-%COMP%]{text-align:start;max-width:200px;overflow:hidden;text-overflow:ellipsis;margin-bottom:6px;margin-inline-end:18px}[_nghost-%COMP%]   .draft-qty[_ngcontent-%COMP%]{max-width:48px}[_nghost-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100)}[_nghost-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]   .custom-field-ellipsis[_ngcontent-%COMP%]{color:var(--color-text-300)}[_nghost-%COMP%]   .net-price[_ngcontent-%COMP%]{font-size:11px;color:var(--color-text-300);line-height:14px}[_nghost-%COMP%]   .promotions-label[_ngcontent-%COMP%]{-webkit-text-decoration:underline dotted var(--color-text-200);text-decoration:underline dotted var(--color-text-200);font-size:11px;margin-top:6px;cursor:pointer;text-transform:lowercase}[_nghost-%COMP%]   .thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px}[_nghost-%COMP%]   .shipping-method-name[_ngcontent-%COMP%]{font-size:var(--font-size-xs);margin-inline-end:2px}[_nghost-%COMP%]   .order-placed-quantity[_ngcontent-%COMP%]{text-decoration:line-through;color:var(--color-text-300);margin-inline-end:2px}  .line-promotion{display:flex;justify-content:space-between;padding:6px 12px}  .line-promotion .promotion-amount{margin-inline-start:12px}  .line-promotion .net-price{font-size:11px;color:var(--color-text-300)}"],changeDetection:0})}class W{constructor(n){this.dataService=n,this.addItem=new e.vpe,this.customFieldsFormGroup=new d.nJ({}),this.selectedVariantId$=new L.x,this.quantity=1}ngOnInit(){this.selectedVariant$=this.selectedVariantId$.pipe((0,_.w)(n=>n?this.dataService.product.getProductVariant(n).mapSingle(({productVariant:t})=>t):[void 0]));for(const n of this.orderLineCustomFields)this.customFieldsFormGroup.addControl(n.name,new d.p4(""))}addItemClick(n){n&&(this.addItem.emit({productVariantId:n.id,quantity:this.quantity,customFields:this.orderLineCustomFields.length?this.customFieldsFormGroup.value:void 0}),this.selectedVariantId$.next(void 0),this.customFieldsFormGroup.reset())}static#e=this.\u0275fac=function(t){return new(t||W)(e.Y36(a.DoR))};static#t=this.\u0275cmp=e.Xpm({type:W,selectors:[["vdr-draft-order-variant-selector"]],inputs:{currencyCode:"currencyCode",orderLineCustomFields:"orderLineCustomFields"},outputs:{addItem:"addItem"},decls:8,vars:6,consts:[[1,"card"],[1,"card-block"],[1,"card-title"],[3,"productSelected"],["class","card-block",4,"ngIf"],[1,"variant-details"],[1,"mr-2",3,"src"],[1,"details"],[1,"small"],[1,"details","ml-4"],[1,"flex-spacer"],[1,"small",3,"title"],["type","number","min","0",3,"disabled","ngModel","ngModelChange"],[1,"btn","btn-small","btn-primary",3,"disabled","click"],[4,"ngIf"],["class","custom-field",4,"ngFor","ngForOf"],[1,"custom-field"],[3,"compact","readonly","customField","customFieldsFormGroup"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h4",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"vdr-product-variant-selector",3),e.NdJ("productSelected",function(l){return r.selectedVariantId$.next(l.productVariantId)}),e.qZA()(),e.YNc(6,Jn,31,32,"div",4),e.ALo(7,"async"),e.qZA()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,2,"order.add-item-to-order")),e.xp6(3),e.Q6J("ngIf",e.lcZ(7,4,r.selectedVariant$)))},dependencies:[s.sg,s.O5,d.Fj,d.wV,d.JJ,d.qQ,d.On,a.M1s,a.y_K,a.elg,s.Ov,g.X$,a.Mgf,a.kgx],styles:[".variant-details[_ngcontent-%COMP%]{display:flex;align-items:center}.variant-details[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:var(--border-radius-img);width:32px;height:32px}.variant-details[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{font-size:.65rem;line-height:.7rem}.variant-details[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:48px;margin:0 6px}.variant-details[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{font-size:11px;color:var(--color-text-300)}"],changeDetection:0})}class J extends a.VE7{constructor(n,t,r,i,l){super(),this.changeDetector=n,this.dataService=t,this.notificationService=r,this.modalService=i,this.orderTransitionService=l,this.customFields=this.getCustomFieldConfig("Order"),this.orderLineCustomFields=this.getCustomFieldConfig("OrderLine"),this.detailForm=new d.nJ({}),this.fetchHistory=new L.x,this.displayCouponCodeInput=!1}ngOnInit(){this.init(),this.orderLineCustomFields=this.getCustomFieldConfig("OrderLine"),this.eligibleShippingMethods$=this.entity$.pipe((0,_.w)(n=>this.dataService.order.getDraftOrderEligibleShippingMethods(n.id).mapSingle(({eligibleShippingMethodsForDraftOrder:t})=>t)))}ngOnDestroy(){this.destroy()}addItemToOrder(n){this.dataService.order.addItemToDraftOrder(this.id,n).subscribe(t=>{"Order"!==t.addItemToDraftOrder.__typename&&this.notificationService.error(t.addItemToDraftOrder.message)})}adjustOrderLine(n){this.dataService.order.adjustDraftOrderLine(this.id,{orderLineId:n.lineId,quantity:n.quantity}).subscribe(t=>{"Order"!==t.adjustDraftOrderLine.__typename&&this.notificationService.error(t.adjustDraftOrderLine.message)})}removeOrderLine(n){this.dataService.order.removeDraftOrderLine(this.id,n.lineId).subscribe(t=>{"Order"!==t.removeDraftOrderLine.__typename&&this.notificationService.error(t.removeDraftOrderLine.message)})}getOrderAddressLines(n){return n?Object.values(n).filter(t=>"OrderAddress"!==t).filter(t=>!!t):[]}setCustomer(){this.modalService.fromComponent(B).subscribe(n=>{this.hasId(n)?this.dataService.order.setCustomerForDraftOrder(this.id,{customerId:n.id}).subscribe():n&&this.dataService.order.setCustomerForDraftOrder(this.id,{input:n}).subscribe()})}setShippingAddress(){this.entity$.pipe((0,T.q)(1),(0,_.w)(n=>this.modalService.fromComponent(P,{locals:{customerId:n.customer?.id,currentAddress:n.shippingAddress??void 0}}))).subscribe(n=>{n&&this.dataService.order.setDraftOrderShippingAddress(this.id,n).subscribe()})}setBillingAddress(){this.entity$.pipe((0,T.q)(1),(0,_.w)(n=>this.modalService.fromComponent(P,{locals:{customerId:n.customer?.id,currentAddress:n.billingAddress??void 0}}))).subscribe(n=>{n&&this.dataService.order.setDraftOrderBillingAddress(this.id,n).subscribe()})}applyCouponCode(n){this.dataService.order.applyCouponCodeToDraftOrder(this.id,n).subscribe()}removeCouponCode(n){this.dataService.order.removeCouponCodeFromDraftOrder(this.id,n).subscribe()}setShippingMethod(){(0,Ue.a)(this.entity$,this.eligibleShippingMethods$).pipe((0,T.q)(1),(0,_.w)(([n,t])=>this.modalService.fromComponent(V,{locals:{eligibleShippingMethods:t,currencyCode:n.currencyCode,currentSelectionId:n.shippingLines?.[0]?.shippingMethod.id}}))).subscribe(n=>{n&&this.dataService.order.setDraftOrderShippingMethod(this.id,n).subscribe()})}updateCustomFields(n){this.dataService.order.updateOrderCustomFields({id:this.id,customFields:n}).subscribe()}deleteOrder(){this.dataService.order.deleteDraftOrder(this.id).subscribe(({deleteDraftOrder:n})=>{n.result===a.PcR.DELETED?(this.notificationService.success((0,u.J)("common.notify-delete-success"),{entity:"Order"}),this.router.navigate(["/orders"])):n.message&&this.notificationService.error(n.message)})}completeOrder(){this.dataService.order.transitionToState(this.id,"ArrangingPayment").subscribe(({transitionOrderToState:n})=>{"Order"===n?.__typename?this.router.navigate(["/orders",this.id]):"OrderStateTransitionError"===n?.__typename&&this.notificationService.error(n.transitionError)})}hasId(n){return"object"==typeof n&&!!n.id}setFormValues(n){}static#e=this.\u0275fac=function(t){return new(t||J)(e.Y36(e.sBO),e.Y36(a.DoR),e.Y36(a.gqp),e.Y36(a.Z7U),e.Y36(Z))};static#t=this.\u0275cmp=e.Xpm({type:J,selectors:[["vdr-draft-order-detail"]],features:[e.qOj],decls:5,vars:6,consts:[[4,"ngIf"],[1,"flex","clr-align-items-center"],[3,"state"],["locationId","draft-order-detail"],[1,"btn","btn-primary",3,"disabled","click"],["shape","check"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",3,"click"],["shape","trash",1,"is-danger"],[3,"title"],["vdrCardControls",""],["class","block mb-2",3,"customer",4,"ngIf"],[1,"button-small",3,"click"],["class","block mb-2",3,"address",4,"ngIf"],[1,"button-small","mr-2",3,"click"],[4,"ngFor","ngForOf"],["class","button-small",3,"click",4,"ngIf"],[3,"entity",4,"ngIf"],[3,"orderLineCustomFields","currencyCode","addItem"],[3,"order","orderLineCustomFields","isDraft","adjust","remove"],["locationId","draft-order-detail",3,"entity$","detailForm"],[3,"customFieldsConfig","customFieldValues","updateClick"],["shape","unknown-status","class","is-warning",4,"ngIf"],["shape","check","class","is-success",4,"ngIf"],["shape","unknown-status",1,"is-warning"],["shape","check",1,"is-success"],[1,"block","mb-2",3,"customer"],[1,"block","mb-2",3,"address"],[3,"couponCodes","addCouponCode","removeCouponCode"],[3,"entity"],[1,"table"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-page-block"),e.YNc(1,Nn,18,8,"vdr-action-bar",0),e.ALo(2,"async"),e.qZA(),e.YNc(3,rr,42,43,"vdr-page-detail-layout",0),e.ALo(4,"async")),2&t&&(e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,r.entity$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(4,4,r.entity$)))},dependencies:[p.qvL,p.MgK,s.sg,s.O5,a.KkL,a.BND,a.mz,a.d$,a.JOL,a.N9E,a.UaT,a.HH4,a.GXt,a.b28,a.WWO,a.CWh,a.zJY,a.DME,a.TeL,a.W1W,a.AkF,a.D23,z,F,W,D,s.Ov,s.Zx,g.X$,a.kgx],changeDetection:0})}class X{constructor(n,t){this.dataService=n,this.changeDetector=t,this.fulfillmentHandlerControl=new d.p4,this.fulfillmentQuantities={}}ngOnInit(){this.dataService.settings.getGlobalSettings().single$.subscribe(({globalSettings:n})=>{this.fulfillmentQuantities=this.order.lines.reduce((t,r)=>{const i=this.getFulfillableCount(r,n.trackInventory);return{...t,[r.id]:{fulfillCount:i,max:i}}},{}),this.changeDetector.markForCheck()}),this.dataService.shippingMethod.getShippingMethodOperations().mapSingle(n=>n.fulfillmentHandlers).subscribe(n=>{this.fulfillmentHandlerDef=n.find(t=>t.code===this.order.shippingLines[0]?.shippingMethod?.fulfillmentHandlerCode)||n[0],this.fulfillmentHandler=(0,a.miO)(this.fulfillmentHandlerDef),this.fulfillmentHandlerControl.patchValue(this.fulfillmentHandler),this.changeDetector.markForCheck()})}getFulfillableCount(n,t){const{trackInventory:r,stockOnHand:i}=n.productVariant,l=r===a.TvZ.INHERIT?t:r===a.TvZ.TRUE,c=this.getUnfulfilledCount(n);return l?Math.min(c,i):c}getUnfulfilledCount(n){const t=this.order.fulfillments?.filter(r=>"Cancelled"!==r.state).map(r=>r.lines).flat().filter(r=>r.orderLineId===n.id).reduce((r,i)=>r+i.quantity,0)??0;return n.quantity-t}canSubmit(){const n=Object.values(this.fulfillmentQuantities).reduce((i,{fulfillCount:l})=>i+l,0),t=Object.values(this.fulfillmentQuantities).every(({fulfillCount:i,max:l})=>i<=l);return(0,a.dOS)(this.fulfillmentHandlerDef,this.fulfillmentHandlerControl.value)&&this.fulfillmentHandlerControl.valid&&0<n&&t}select(){const n=Object.entries(this.fulfillmentQuantities).map(([t,{fulfillCount:r}])=>({orderLineId:t,quantity:r}));this.resolveWith({lines:n,handler:(0,a.RnJ)(this.fulfillmentHandler,this.fulfillmentHandlerControl.value)})}cancel(){this.resolveWith()}static#e=this.\u0275fac=function(t){return new(t||X)(e.Y36(a.DoR),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:X,selectors:[["vdr-fulfill-order-dialog"]],decls:34,vars:29,consts:[["vdrDialogTitle",""],[1,"fulfillment-wrapper"],[1,"order-table"],[1,"table"],["class","order-line",3,"ignore",4,"ngFor","ngForOf"],[1,"shipping-details"],[3,"address"],[3,"operationDefinition","operation","formControl","removable"],["vdrDialogButtons",""],[1,"order-line"],[1,"align-middle","thumb"],[3,"src",4,"ngIf"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","quantity"],[1,"align-middle","fulfil"],["type","number","min","0",3,"disabled","ngModel","max","ngModelChange",4,"ngIf"],[3,"src"],["type","number","min","0",3,"disabled","ngModel","max","ngModelChange"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,r){1&t&&(e.YNc(0,or,2,3,"ng-template",0),e.TgZ(1,"div",1)(2,"div",2)(3,"table",3)(4,"thead")(5,"tr"),e._UZ(6,"th"),e.TgZ(7,"th"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"th"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"th"),e._uU(20),e.ALo(21,"translate"),e.qZA()()(),e.YNc(22,lr,13,8,"tr",4),e.qZA()(),e.TgZ(23,"div",5),e._UZ(24,"vdr-formatted-address",6),e.TgZ(25,"h6"),e._uU(26),e.ALo(27,"translate"),e.qZA(),e._uU(28),e.TgZ(29,"strong"),e._uU(30),e.ALo(31,"localeCurrency"),e.qZA(),e._UZ(32,"vdr-configurable-input",7),e.qZA()(),e.YNc(33,dr,6,7,"ng-template",8)),2&t&&(e.xp6(8),e.Oqu(e.lcZ(9,14,"order.product-name")),e.xp6(3),e.Oqu(e.lcZ(12,16,"order.product-sku")),e.xp6(3),e.Oqu(e.lcZ(15,18,"order.unfulfilled")),e.xp6(3),e.Oqu(e.lcZ(18,20,"catalog.stock-on-hand")),e.xp6(3),e.Oqu(e.lcZ(21,22,"order.fulfill")),e.xp6(2),e.Q6J("ngForOf",r.order.lines),e.xp6(2),e.Q6J("address",r.order.shippingAddress),e.xp6(2),e.Oqu(e.lcZ(27,24,"order.shipping-method")),e.xp6(2),e.hij(" ",null==r.order.shippingLines[0]||null==r.order.shippingLines[0].shippingMethod?null:r.order.shippingLines[0].shippingMethod.name," "),e.xp6(2),e.Oqu(e.xi3(31,26,r.order.shipping,r.order.currencyCode)),e.xp6(2),e.Q6J("operationDefinition",r.fulfillmentHandlerDef)("operation",r.fulfillmentHandler)("formControl",r.fulfillmentHandlerControl)("removable",!1))},dependencies:[s.sg,s.O5,d.Fj,d.wV,d.JJ,d.qQ,d.Fd,d.On,d.oH,a.qq8,a.y_K,a.nPI,a.q6K,a.b28,g.X$,a.Mgf,a.kgx],styles:["[_nghost-%COMP%]{height:100%;display:flex;min-height:64vh}[_nghost-%COMP%]   .is-cancelled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-decoration:line-through;background-color:var(--color-component-bg-200)}[_nghost-%COMP%]   .sub-total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:1px dashed var(--color-component-border-200)}[_nghost-%COMP%]   .total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:700;border-top:1px dashed var(--color-component-border-200)}[_nghost-%COMP%]   td.custom-fields-row[_ngcontent-%COMP%]{border-top-style:dashed;border-top-color:var(--color-grey-200)}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{border-radius:var(--border-radius-img)}[_nghost-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]   .custom-field[_ngcontent-%COMP%]{text-align:start;max-width:200px;overflow:hidden;text-overflow:ellipsis;margin-bottom:6px;margin-inline-end:18px}[_nghost-%COMP%]   .draft-qty[_ngcontent-%COMP%]{max-width:48px}[_nghost-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100)}[_nghost-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]   .custom-field-ellipsis[_ngcontent-%COMP%]{color:var(--color-text-300)}[_nghost-%COMP%]   .net-price[_ngcontent-%COMP%]{font-size:11px;color:var(--color-text-300);line-height:14px}[_nghost-%COMP%]   .promotions-label[_ngcontent-%COMP%]{-webkit-text-decoration:underline dotted var(--color-text-200);text-decoration:underline dotted var(--color-text-200);font-size:11px;margin-top:6px;cursor:pointer;text-transform:lowercase}[_nghost-%COMP%]   .thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px}[_nghost-%COMP%]   .shipping-method-name[_ngcontent-%COMP%]{font-size:var(--font-size-xs);margin-inline-end:2px}[_nghost-%COMP%]   .order-placed-quantity[_ngcontent-%COMP%]{text-decoration:line-through;color:var(--color-text-300);margin-inline-end:2px}.fulfillment-wrapper[_ngcontent-%COMP%]{flex:1}@media screen and (min-width: 768px){.fulfillment-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row}}.fulfillment-wrapper[_ngcontent-%COMP%]   .shipping-details[_ngcontent-%COMP%]{margin-top:24px}@media screen and (min-width: 768px){.fulfillment-wrapper[_ngcontent-%COMP%]   .shipping-details[_ngcontent-%COMP%]{margin-top:0;margin-inline-start:24px;width:250px}}.fulfillment-wrapper[_ngcontent-%COMP%]   .shipping-details[_ngcontent-%COMP%]   clr-input-container[_ngcontent-%COMP%]{margin-top:24px}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin-top:0}.fulfillment-wrapper[_ngcontent-%COMP%]   tr.ignore[_ngcontent-%COMP%]{color:var(--color-grey-300)}"],changeDetection:0})}class M{static#e=this.\u0275fac=function(t){return new(t||M)};static#t=this.\u0275cmp=e.Xpm({type:M,selectors:[["vdr-simple-item-list"]],inputs:{items:"items"},decls:3,vars:1,consts:[[1,"items-list"],[3,"title",4,"ngFor","ngForOf"],[3,"title"],[1,"quantity"],["shape","times","size","12"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"ul"),e.YNc(2,cr,5,3,"li",1),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("ngForOf",r.items))},dependencies:[p.qvL,s.sg],styles:[".items-list[_ngcontent-%COMP%]{font-size:12px}.items-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:6px;list-style-type:none;margin-inline-start:2px}.items-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{line-height:14px;text-overflow:ellipsis;overflow:hidden}.items-list[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]{min-width:16px;display:inline-block}"],changeDetection:0})}class N{constructor(n){this.serverConfigService=n,this.customFieldConfig=[],this.customFieldFormGroup=new d.nJ({})}ngOnInit(){this.customFieldConfig=this.serverConfigService.getCustomFieldsFor("Fulfillment")}ngOnChanges(n){this.buildCustomFieldsFormGroup()}get fulfillment(){return this.order.fulfillments&&this.order.fulfillments.find(n=>n.id===this.fulfillmentId)}get items(){return this.fulfillment?.lines.map(n=>({name:this.order.lines.find(t=>t.id===n.orderLineId)?.productVariant.name??"",quantity:n.quantity}))??[]}buildCustomFieldsFormGroup(){const n=this.fulfillment.customFields;for(const t of this.serverConfigService.getCustomFieldsFor("Fulfillment"))this.customFieldFormGroup.addControl(t.name,new d.p4(n[t.name]))}customFieldIsObject(n){return Array.isArray(n)||(0,x.isObject)(n)}static#e=this.\u0275fac=function(t){return new(t||N)(e.Y36(a.iHG))};static#t=this.\u0275cmp=e.Xpm({type:N,selectors:[["vdr-fulfillment-detail"]],inputs:{fulfillmentId:"fulfillmentId",order:"order"},features:[e.TTD],decls:12,vars:17,consts:[[3,"label"],[3,"label",4,"ngIf"],[3,"items"],[4,"ngFor","ngForOf"],[3,"readonly","compact","customField","customFieldsFormGroup",4,"ngIf"],[3,"readonly","compact","customField","customFieldsFormGroup"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-labeled-data",0),e.ALo(1,"translate"),e._uU(2),e.ALo(3,"localeDate"),e.qZA(),e.TgZ(4,"vdr-labeled-data",0),e.ALo(5,"translate"),e._uU(6),e.qZA(),e.YNc(7,sr,3,4,"vdr-labeled-data",1),e.TgZ(8,"vdr-labeled-data",0),e.ALo(9,"translate"),e._UZ(10,"vdr-simple-item-list",2),e.qZA(),e.YNc(11,ur,2,1,"ng-container",3)),2&t&&(e.Q6J("label",e.lcZ(1,8,"common.created-at")),e.xp6(2),e.hij(" ",e.xi3(3,10,null==r.fulfillment?null:r.fulfillment.createdAt,"medium"),"\n"),e.xp6(2),e.Q6J("label",e.lcZ(5,13,"order.fulfillment-method")),e.xp6(2),e.hij(" ",null==r.fulfillment?null:r.fulfillment.method,"\n"),e.xp6(1),e.Q6J("ngIf",null==r.fulfillment?null:r.fulfillment.trackingCode),e.xp6(1),e.Q6J("label",e.lcZ(9,15,"order.contents")),e.xp6(2),e.Q6J("items",r.items),e.xp6(1),e.Q6J("ngForOf",r.customFieldConfig))},dependencies:[s.sg,s.O5,a.M1s,a.WGc,M,g.X$,a.HbD],changeDetection:0})}class ee{get chipColorType(){switch(this.state){case"Pending":case"Shipped":return"warning";case"Delivered":return"success";case"Cancelled":return"error"}}static#e=this.\u0275fac=function(t){return new(t||ee)};static#t=this.\u0275cmp=e.Xpm({type:ee,selectors:[["vdr-fulfillment-state-label"]],inputs:{state:"state"},decls:6,vars:10,consts:[[3,"title","colorType"],["shape","check-circle",4,"ngIf"],["shape","check-circle"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-chip",0),e.ALo(1,"translate"),e.YNc(2,mr,1,0,"clr-icon",1),e._uU(3),e.ALo(4,"translate"),e.ALo(5,"stateI18nToken"),e.qZA()),2&t&&(e.Q6J("title",e.lcZ(1,4,"order.payment-state"))("colorType",r.chipColorType),e.xp6(2),e.Q6J("ngIf","Delivered"===r.state),e.xp6(1),e.hij(" ",e.lcZ(4,6,e.lcZ(5,8,r.state)),"\n"))},dependencies:[p.qvL,s.O5,a.Ywx,g.X$,a.Nir],styles:["[_nghost-%COMP%]{font-size:14px}"],changeDetection:0})}class te{constructor(){this.transitionState=new e.vpe}nextSuggestedState(){if(!this.fulfillment)return;const{nextStates:n}=this.fulfillment,t=r=>n.includes(r)?r:n[0];switch(this.fulfillment?.state){case"Pending":return t("Shipped");case"Shipped":return t("Delivered");default:return n.find(r=>"Cancelled"!==r)}}nextOtherStates(){if(!this.fulfillment)return[];const n=this.nextSuggestedState();return this.fulfillment.nextStates.filter(t=>t!==n)}static#e=this.\u0275fac=function(t){return new(t||te)};static#t=this.\u0275cmp=e.Xpm({type:te,selectors:[["vdr-fulfillment-card"]],inputs:{fulfillment:"fulfillment",order:"order"},outputs:{transitionState:"transitionState"},decls:10,vars:6,consts:[[1,"card"],[1,"card-header","fulfillment-header"],[1,"fulfillment-state"],[3,"state"],[1,"card-block"],[3,"fulfillmentId","order",4,"ngIf"],["class","card-footer",4,"ngIf"],[3,"fulfillmentId","order"],[1,"card-footer"],[4,"ngIf"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-primary",3,"click"],["type","button","vdrDropdownItem","",3,"click"],[4,"ngIf","ngIfElse"],["cancel",""],["shape","step-forward-2"],["shape","error-standard",1,"is-error"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",2),e._UZ(6,"vdr-fulfillment-state-label",3),e.qZA()(),e.TgZ(7,"div",4),e.YNc(8,gr,1,2,"vdr-fulfillment-detail",5),e.qZA(),e.YNc(9,yr,7,2,"div",6),e.qZA()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,4,"order.fulfillment")),e.xp6(3),e.Q6J("state",null==r.fulfillment?null:r.fulfillment.state),e.xp6(2),e.Q6J("ngIf",!!r.fulfillment),e.xp6(1),e.Q6J("ngIf",null==r.fulfillment?null:r.fulfillment.nextStates.length))},dependencies:[p.qvL,s.sg,s.O5,a.JOL,a.N9E,a.UaT,a.HH4,N,ee,g.X$,a.Nir],styles:[".fulfillment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.card-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end}"],changeDetection:0})}class ne{constructor(){this.addedItems=new Map,this.removedItems=new Map}ngOnChanges(){const{added:n,removed:t}=this.getModifiedLines();this.addedItems=n,this.removedItems=t}getSurcharge(n){return this.order.surcharges.find(t=>t.id===n)}getAddedItems(){return[...this.addedItems.entries()].map(([n,t])=>({name:n.productVariant.name,quantity:t}))}getRemovedItems(){return[...this.removedItems.entries()].map(([n,t])=>({name:n.productVariant.name,quantity:t}))}getModifiedLines(){const n=new Map,t=new Map;for(const r of this.modification.lines||[]){const i=this.order.lines.find(l=>l.id===r.orderLineId);i&&(r.quantity<0?t.set(i,-r.quantity):n.set(i,r.quantity))}return{added:n,removed:t}}static#e=this.\u0275fac=function(t){return new(t||ne)};static#t=this.\u0275cmp=e.Xpm({type:ne,selectors:[["vdr-modification-detail"]],inputs:{order:"order",modification:"modification"},features:[e.TTD],decls:7,vars:8,consts:[[3,"label"],[3,"label",4,"ngIf"],[3,"label",4,"ngFor","ngForOf"],[3,"items"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-labeled-data",0),e.ALo(1,"translate"),e._uU(2),e.qZA(),e.YNc(3,xr,3,4,"vdr-labeled-data",1),e.YNc(4,br,4,8,"vdr-labeled-data",2),e.YNc(5,Cr,3,4,"vdr-labeled-data",1),e.YNc(6,Or,3,4,"vdr-labeled-data",1)),2&t&&(e.Q6J("label",e.lcZ(1,6,"common.ID")),e.xp6(2),e.Oqu(r.modification.id),e.xp6(1),e.Q6J("ngIf",r.modification.note),e.xp6(1),e.Q6J("ngForOf",r.modification.surcharges),e.xp6(1),e.Q6J("ngIf",r.getAddedItems().length),e.xp6(1),e.Q6J("ngIf",r.getRemovedItems().length))},dependencies:[s.sg,s.O5,a.WGc,M,g.X$,a.kgx],changeDetection:0})}const be=72;class Q{constructor(n){this.elementRef=n,this.active$=new ye.X(!1),this.activeTarget$=new ye.X(!1),this.isCancellable=!1,this.cancelledState="Cancelled"}ngOnChanges(n){this.isCancellable=!!this.node.to.find(t=>"Cancelled"===t.name),n.active&&this.active$.next(this.active)}getPos(n="top"){this.elementRef.nativeElement.getBoundingClientRect();const r=this.elementRef.nativeElement.querySelector(".node")?.getBoundingClientRect().height??0;return{x:10,y:this.index*be+("bottom"===n?r:0)}}getStyle(){const n=this.getPos();return{"top.px":n.y,"left.px":n.x}}static#e=this.\u0275fac=function(t){return new(t||Q)(e.Y36(e.SBq))};static#t=this.\u0275cmp=e.Xpm({type:Q,selectors:[["vdr-order-process-node"]],inputs:{node:"node",index:"index",active:"active"},features:[e.TTD],decls:8,vars:15,consts:[[1,"node-wrapper",3,"ngStyle"],[1,"node"],["class","cancelled-wrapper",4,"ngIf"],[1,"cancelled-wrapper"],[1,"cancelled-edge"],["shape","dot-circle"],[1,"cancelled-node"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0),e.ALo(1,"async"),e.TgZ(2,"div",1),e.ALo(3,"async"),e._uU(4),e.ALo(5,"translate"),e.ALo(6,"stateI18nToken"),e.qZA(),e.YNc(7,Tr,7,5,"div",2),e.qZA()),2&t&&(e.ekj("active",e.lcZ(1,7,r.active$)),e.Q6J("ngStyle",r.getStyle()),e.xp6(2),e.ekj("active-target",e.lcZ(3,9,r.activeTarget$)),e.xp6(2),e.hij(" ",e.lcZ(5,11,e.lcZ(6,13,r.node.name))," "),e.xp6(3),e.Q6J("ngIf",r.isCancellable))},dependencies:[p.qvL,s.O5,s.PC,s.Ov,g.X$,a.Nir],styles:["[_nghost-%COMP%]{display:block}.node-wrapper[_ngcontent-%COMP%]{position:absolute;z-index:1;display:flex;align-items:center}.node[_ngcontent-%COMP%]{display:inline-block;border:2px solid var(--color-component-border-200);border-radius:3px;padding:3px 6px;z-index:1;background-color:var(--color-component-bg-100);opacity:.7;transition:opacity .2s,background-color .2s,color .2s;cursor:default}.node.active-target[_ngcontent-%COMP%]{border-color:var(--color-primary-500);opacity:.9}.cancelled-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--color-grey-300);transition:color .2s,opacity .2s;opacity:.7}.cancelled-edge[_ngcontent-%COMP%]{width:48px;height:2px;background-color:var(--color-component-bg-300);transition:background-color .2s}clr-icon[_ngcontent-%COMP%]{margin-inline-start:-1px}.cancelled-node[_ngcontent-%COMP%]{margin-inline-start:6px}.active[_ngcontent-%COMP%]   .cancelled-wrapper[_ngcontent-%COMP%]{opacity:1}.active[_ngcontent-%COMP%]   .node[_ngcontent-%COMP%]{opacity:1;background-color:var(--color-primary-600);border-color:var(--color-primary-600);color:var(--color-primary-100)}.active[_ngcontent-%COMP%]   .cancelled-wrapper[_ngcontent-%COMP%]{color:var(--color-error-500)}.active[_ngcontent-%COMP%]   .cancelled-edge[_ngcontent-%COMP%]{background-color:var(--color-error-500)}"],changeDetection:0})}class re{ngOnInit(){this.active$=this.from.active$.asObservable().pipe((0,j.b)(n=>this.to.activeTarget$.next(n)))}getStyle(){const n=this.from.index<this.to.index?"down":"up",t=this.from.getPos("down"===n?"bottom":"top"),r=this.to.getPos("down"===n?"top":"bottom"),i=Math.abs(t.x-r.x),l=Math.abs(t.y-r.y),c=Math.sqrt(i**2+l**2);return{"top.px":t.y,"left.px":t.x+("down"===n?10:40)+12*this.index,"height.px":c,"width.px":1,..."up"===n?{transform:"rotateZ(180deg)","transform-origin":"top"}:{}}}static#e=this.\u0275fac=function(t){return new(t||re)};static#t=this.\u0275cmp=e.Xpm({type:re,selectors:[["vdr-order-process-edge"]],inputs:{from:"from",to:"to",index:"index"},decls:3,vars:7,consts:[[1,"edge",3,"ngStyle"],["shape","arrow","flip","vertical",1,"arrow"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0),e.ALo(1,"async"),e._UZ(2,"clr-icon",1),e.qZA()),2&t&&(e.ekj("active",e.lcZ(1,5,r.active$)),e.Q6J("ngStyle",r.getStyle()),e.uIk("data-from",r.from.node.name)("data-to",r.to.node.name))},dependencies:[p.qvL,s.PC,s.Ov],styles:[".edge[_ngcontent-%COMP%]{position:absolute;border:1px solid var(--color-component-border-200);background-color:var(--color-component-bg-300);opacity:.3;transition:border .2s,opacity .2s,background-color .2s}.edge.active[_ngcontent-%COMP%]{border-color:var(--color-primary-500);background-color:var(--color-primary-500);opacity:1}.edge.active[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{color:var(--color-primary-500)}.edge[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{position:absolute;bottom:-4px;left:-8px;color:var(--color-grey-300)}"],changeDetection:0})}class oe{constructor(n){this.changeDetector=n,this.setActiveState$=new ye.X(void 0),this.nodes=[],this.edges=[]}get outerHeight(){return this.nodes.length*be}ngOnInit(){this.setActiveState$.next(this.initialState),this.activeState$=this.setActiveState$.pipe((0,xe.b)(150))}ngOnChanges(n){this.populateNodes()}ngAfterViewInit(){setTimeout(()=>this.populateEdges())}onMouseOver(n){this.setActiveState$.next(n)}onMouseOut(){this.setActiveState$.next(this.initialState)}getNodeFor(n){if(this.nodeComponents)return this.nodeComponents.find(t=>t.node.name===n)}populateNodes(){const n=new Map;for(const t of this.states)n.set(t.name,{name:t.name,to:[]});for(const[t,r]of n.entries()){const i=this.states.find(l=>l.name===t)?.to??[];for(const l of i){const c=n.get(l);c&&r.to.push(c)}}this.nodes=[...n.values()].filter(t=>"Cancelled"!==t.name)}populateEdges(){for(const n of this.nodes){const t=this.getNodeFor(n.name);let r=0;for(const i of n.to){const l=this.getNodeFor(i.name);t&&l&&t!==l&&(this.edges.push({to:l,from:t,index:r}),r++)}}this.edges=[...this.edges],this.changeDetector.markForCheck()}static#e=this.\u0275fac=function(t){return new(t||oe)(e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:oe,selectors:[["vdr-order-process-graph"]],viewQuery:function(t,r){if(1&t&&e.Gf(Q,5),2&t){let i;e.iGM(i=e.CRH())&&(r.nodeComponents=i)}},hostVars:2,hostBindings:function(t,r){2&t&&e.Udp("height",r.outerHeight,"px")},inputs:{states:"states",initialState:"initialState"},features:[e.TTD],decls:2,vars:2,consts:[[4,"ngFor","ngForOf"],[3,"node","index","active","mouseenter","mouseleave"],[3,"from","to","index"]],template:function(t,r){1&t&&(e.YNc(0,Zr,3,5,"ng-container",0),e.YNc(1,Ar,2,3,"ng-container",0)),2&t&&(e.Q6J("ngForOf",r.nodes),e.xp6(1),e.Q6J("ngForOf",r.edges))},dependencies:[s.sg,Q,re,s.Ov],styles:["[_nghost-%COMP%]{display:block;border:1px hotpink;margin:20px;padding:12px;position:relative}.state-row[_ngcontent-%COMP%]{display:flex}"],changeDetection:0})}class ie{constructor(n){this.serverConfigService=n,this.states=[]}ngOnInit(){this.states=this.serverConfigService.getOrderProcessStates()}static#e=this.\u0275fac=function(t){return new(t||ie)(e.Y36(a.iHG))};static#t=this.\u0275cmp=e.Xpm({type:ie,selectors:[["vdr-order-process-graph-dialog"]],decls:2,vars:2,consts:[["vdrDialogTitle",""],[3,"states","initialState"]],template:function(t,r){1&t&&(e.YNc(0,Ir,2,3,"ng-template",0),e._UZ(1,"vdr-order-process-graph",1)),2&t&&(e.xp6(1),e.Q6J("states",r.states)("initialState",r.activeState))},dependencies:[a.q6K,oe,g.X$],changeDetection:0})}class ae{constructor(n){this.i18nService=n,this.lineQuantities={},this.refundShipping=!1,this.adjustment=0,this.reasons=(0,a.hq7)().cancellationReasons??[(0,u.J)("order.refund-reason-customer-request"),(0,u.J)("order.refund-reason-not-available")],this.reasons=this.reasons.map(t=>this.i18nService.translate(t))}get refundTotal(){return this.order.lines.reduce((t,r)=>{const i=this.lineQuantities[r.id],l=i.refund&&i.quantity||0;return t+r.proratedUnitPriceWithTax*l},0)+(this.refundShipping?this.order.shippingWithTax:0)+this.adjustment}get settledPaymentsTotal(){return this.settledPayments.map(n=>n.amount-(0,x.summate)(n.refunds.filter(i=>"Failed"!==i.state),"total")).reduce((n,t)=>n+t,0)}lineCanBeRefundedOrCancelled(n){return(this.order.payments?.reduce((r,i)=>[...r,...i.refunds],[]).filter(r=>"Failed"!==r.state).reduce((r,i)=>[...r,...i.lines],[]).filter(r=>r.orderLineId===n.id).reduce((r,i)=>r+i.quantity,0)??0)<n.quantity}ngOnInit(){this.lineQuantities=this.order.lines.reduce((n,t)=>({...n,[t.id]:{quantity:0,refund:!1,cancel:!1}}),{}),this.settledPayments=(this.order.payments||[]).filter(n=>"Settled"===n.state),this.settledPayments.length&&(this.selectedPayment=this.settledPayments[0])}handleZeroQuantity(n){0===n?.quantity&&(n.cancel=!1,n.refund=!1)}isRefunding(){return Object.values(this.lineQuantities).reduce((t,r)=>t||0<r.quantity&&r.refund,!1)}isCancelling(){return Object.values(this.lineQuantities).reduce((t,r)=>t||0<r.quantity&&r.cancel,!1)}canSubmit(){return this.isRefunding()?!!(this.selectedPayment&&this.reason&&0<this.refundTotal&&this.refundTotal<=this.settledPaymentsTotal):!!this.isCancelling()&&!!this.reason}select(){const n=this.selectedPayment;if(n){const t=this.getOrderLineInput(i=>i.refund),r=this.getOrderLineInput(i=>i.cancel);this.resolveWith({refund:{lines:t,reason:this.reason,shipping:this.refundShipping?this.order.shippingWithTax:0,adjustment:this.adjustment,paymentId:n.id},cancel:{lines:r,orderId:this.order.id,reason:this.reason,cancelShipping:this.refundShipping}})}}cancel(){this.resolveWith()}getOrderLineInput(n){return Object.entries(this.lineQuantities).filter(([t,r])=>0<r.quantity&&n(r)).map(([t,r])=>({orderLineId:t,quantity:r.quantity}))}static#e=this.\u0275fac=function(t){return new(t||ae)(e.Y36(a.Dp7))};static#t=this.\u0275cmp=e.Xpm({type:ae,selectors:[["vdr-refund-order-dialog"]],decls:69,vars:76,consts:[["vdrDialogTitle",""],[1,"refund-wrapper"],[1,"order-table"],[1,"table"],["class","order-line",4,"ngFor","ngForOf"],[1,"refund-details","mt-4"],[1,"clr-control-label"],["bindLabel","name","autofocus","","bindValue","id",3,"disabled","items","placeholder","addTag","ngModel","ngModelChange"],["clrSelect","","name","options",3,"ngModel","disabled","ngModelChange"],[3,"ngValue","disabled",4,"ngFor","ngForOf"],["type","checkbox","clrCheckbox","",3,"ngModel","disabled","ngModelChange"],["clrInput","",3,"disabled","currencyCode","ngModel","ngModelChange"],[1,"totals"],[1,"order-total"],[1,"refund-total"],["class","refund-total-error",4,"ngIf"],["class","refund-total-warning",4,"ngIf"],["vdrDialogButtons",""],[1,"order-line"],[1,"align-middle","thumb"],[3,"src"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","quantity"],[3,"line","payments"],[1,"prorated-wrapper"],[4,"ngIf"],[1,"align-middle","quantity-col"],["type","number","min","0",3,"ngModel","max","ngModelChange","input",4,"ngIf"],[1,"align-middle"],[1,"cancel-checkbox-wrapper"],["type","checkbox","clrCheckbox","",3,"disabled","ngModel","ngModelChange",4,"ngIf"],["vdrDropdownTrigger","",1,"promotions-label"],[1,"icon-button"],["shape","info"],["class","line-promotion",4,"ngFor","ngForOf"],[1,"line-promotion"],[1,"promotion-amount"],["type","number","min","0",3,"ngModel","max","ngModelChange","input"],["type","checkbox","clrCheckbox","",3,"disabled","ngModel","ngModelChange"],[3,"ngValue","disabled"],[1,"refund-total-error"],[1,"refund-total-warning"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],[4,"ngIf","ngIfElse"],["cancelling",""]],template:function(t,r){1&t&&(e.YNc(0,wr,2,3,"ng-template",0),e.TgZ(1,"div",1)(2,"div",2)(3,"table",3)(4,"thead")(5,"tr"),e._UZ(6,"th"),e.TgZ(7,"th"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"th"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"th"),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"th"),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"th"),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"th"),e._uU(29),e.ALo(30,"translate"),e.qZA()()(),e.YNc(31,qr,27,21,"tr",4),e.qZA()(),e.TgZ(32,"div",5)(33,"div")(34,"label",6),e._uU(35),e.ALo(36,"translate"),e.qZA(),e.TgZ(37,"ng-select",7),e.NdJ("ngModelChange",function(l){return r.reason=l}),e.ALo(38,"translate"),e.qZA()(),e.TgZ(39,"div")(40,"clr-select-container")(41,"label"),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"select",8),e.NdJ("ngModelChange",function(l){return r.selectedPayment=l}),e.YNc(45,kr,3,8,"option",9),e.qZA()(),e.TgZ(46,"clr-checkbox-wrapper")(47,"input",10),e.NdJ("ngModelChange",function(l){return r.refundShipping=l}),e.qZA(),e.TgZ(48,"label"),e._uU(49),e.ALo(50,"translate"),e.ALo(51,"localeCurrency"),e.qZA()(),e.TgZ(52,"clr-input-container")(53,"label"),e._uU(54),e.ALo(55,"translate"),e.qZA(),e.TgZ(56,"vdr-currency-input",11),e.NdJ("ngModelChange",function(l){return r.adjustment=l}),e.qZA()(),e.TgZ(57,"div",12)(58,"div",13),e._uU(59),e.ALo(60,"translate"),e.ALo(61,"localeCurrency"),e.qZA(),e.TgZ(62,"div",14),e._uU(63),e.ALo(64,"translate"),e.ALo(65,"localeCurrency"),e.qZA(),e.YNc(66,Nr,5,13,"div",15),e.YNc(67,Qr,3,3,"div",16),e.qZA()()()(),e.YNc(68,Rr,7,6,"ng-template",17)),2&t&&(e.xp6(8),e.Oqu(e.lcZ(9,37,"order.product-name")),e.xp6(3),e.Oqu(e.lcZ(12,39,"order.product-sku")),e.xp6(3),e.Oqu(e.lcZ(15,41,"order.quantity")),e.xp6(3),e.Oqu(e.lcZ(18,43,"order.unit-price")),e.xp6(3),e.Oqu(e.lcZ(21,45,"order.prorated-unit-price")),e.xp6(3),e.Oqu(e.lcZ(24,47,"order.quantity")),e.xp6(3),e.Oqu(e.lcZ(27,49,"order.refund")),e.xp6(3),e.Oqu(e.lcZ(30,51,"order.cancel")),e.xp6(2),e.Q6J("ngForOf",r.order.lines),e.xp6(1),e.ekj("faded",!r.isRefunding()&&!r.isCancelling()),e.xp6(3),e.Oqu(e.lcZ(36,53,"order.refund-cancellation-reason")),e.xp6(2),e.Q6J("disabled",!r.isRefunding()&&!r.isCancelling())("items",r.reasons)("placeholder",e.lcZ(38,55,"order.refund-cancellation-reason-required"))("addTag",!0)("ngModel",r.reason),e.xp6(5),e.Oqu(e.lcZ(43,57,"order.payment-to-refund")),e.xp6(2),e.Q6J("ngModel",r.selectedPayment)("disabled",!r.isRefunding()),e.xp6(1),e.Q6J("ngForOf",r.settledPayments),e.xp6(2),e.Q6J("ngModel",r.refundShipping)("disabled",!r.isRefunding()),e.xp6(2),e.AsE(" ",e.lcZ(50,59,"order.refund-shipping")," (",e.xi3(51,61,r.order.shippingWithTax,r.order.currencyCode),") "),e.xp6(5),e.Oqu(e.lcZ(55,64,"order.refund-adjustment")),e.xp6(2),e.Q6J("disabled",!r.isRefunding())("currencyCode",r.order.currencyCode)("ngModel",r.adjustment),e.xp6(1),e.ekj("disabled",!r.isRefunding()),e.xp6(2),e.AsE(" ",e.lcZ(60,66,"order.payment-amount"),": ",e.xi3(61,68,r.selectedPayment.amount,r.order.currencyCode)," "),e.xp6(4),e.AsE(" ",e.lcZ(64,71,"order.refund-total"),": ",e.xi3(65,73,r.refundTotal,r.order.currencyCode)," "),e.xp6(3),e.Q6J("ngIf",r.refundTotal<0||r.settledPaymentsTotal<r.refundTotal),e.xp6(1),e.Q6J("ngIf",r.selectedPayment.amount<r.refundTotal))},dependencies:[p.qvL,p.MgK,p.KKC,p.PEh,p.xRP,p.G55,p.otW,p.dTv,s.sg,s.O5,d.YN,d.Kr,d.Fj,d.wV,d.Wl,d.EJ,d.JJ,d.qQ,d.Fd,d.On,C.w9,a.KQz,a.y_K,a.nPI,a.q6K,a.JOL,a.N9E,a.UaT,I,s.JJ,s.H9,g.X$,a.Mgf,a.kgx],styles:["[_nghost-%COMP%]{height:100%;display:flex;min-height:64vh}.refund-wrapper[_ngcontent-%COMP%]{flex:1;flex-direction:column}.refund-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.refund-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin-top:0}.refund-wrapper[_ngcontent-%COMP%]   tr.ignore[_ngcontent-%COMP%]{color:var(--color-grey-300)}.quantity-col[_ngcontent-%COMP%]{background-color:var(--color-warning-100)}.cancel-checkbox-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}clr-checkbox-wrapper[_ngcontent-%COMP%]{margin-top:12px;margin-bottom:12px;display:block}.refund-details[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.refund-details.faded[_ngcontent-%COMP%]{opacity:.5}.totals[_ngcontent-%COMP%]{margin-top:48px}.totals[_ngcontent-%COMP%]   .refund-total[_ngcontent-%COMP%]{font-size:18px}.totals[_ngcontent-%COMP%]   .refund-total-error[_ngcontent-%COMP%]{color:var(--color-error-500)}.totals[_ngcontent-%COMP%]   .refund-total-warning[_ngcontent-%COMP%]{color:var(--color-warning-600);max-width:250px}.totals.disabled[_ngcontent-%COMP%]{color:var(--color-grey-300)}.prorated-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center}.line-promotion[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:12px;padding:3px 6px}.line-promotion[_ngcontent-%COMP%]   .promotion-amount[_ngcontent-%COMP%]{margin-inline-start:12px}"],changeDetection:0})}class le{constructor(){this.transactionId=""}submit(){this.resolveWith(this.transactionId)}cancel(){this.resolveWith()}static#e=this.\u0275fac=function(t){return new(t||le)};static#t=this.\u0275cmp=e.Xpm({type:le,selectors:[["vdr-settle-refund-dialog"]],decls:10,vars:10,consts:[["vdrDialogTitle",""],[1,"instruction"],["clrInput","","name","transactionId",3,"ngModel","ngModelChange"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,r){1&t&&(e.YNc(0,jr,2,3,"ng-template",0),e.TgZ(1,"p",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"clr-input-container")(5,"label"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"input",2),e.NdJ("ngModelChange",function(l){return r.transactionId=l}),e.qZA()(),e.YNc(9,$r,6,7,"ng-template",3)),2&t&&(e.xp6(2),e.hij(" ",e.xi3(3,3,"order.settle-refund-manual-instructions",e.VKq(8,Hr,r.refund.method)),"\n"),e.xp6(4),e.Oqu(e.lcZ(7,6,"order.transaction-id")),e.xp6(2),e.Q6J("ngModel",r.transactionId))},dependencies:[p.MgK,p.xRP,p.G55,d.Fj,d.JJ,d.On,a.y_K,a.nPI,a.q6K,g.X$],styles:["[_nghost-%COMP%]{padding-bottom:32px}.instruction[_ngcontent-%COMP%]{margin-top:0;margin-bottom:24px}"],changeDetection:0})}class de{get chipColorType(){switch(this.state){case"Authorized":return"warning";case"Settled":return"success";case"Declined":case"Cancelled":return"error"}}static#e=this.\u0275fac=function(t){return new(t||de)};static#t=this.\u0275cmp=e.Xpm({type:de,selectors:[["vdr-payment-state-label"]],inputs:{state:"state"},decls:6,vars:10,consts:[[3,"title","colorType"],["shape","check-circle",4,"ngIf"],["shape","check-circle"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-chip",0),e.ALo(1,"translate"),e.YNc(2,Gr,1,0,"clr-icon",1),e._uU(3),e.ALo(4,"translate"),e.ALo(5,"stateI18nToken"),e.qZA()),2&t&&(e.Q6J("title",e.lcZ(1,4,"order.payment-state"))("colorType",r.chipColorType),e.xp6(2),e.Q6J("ngIf","Settled"===r.state),e.xp6(1),e.hij(" ",e.lcZ(4,6,e.lcZ(5,8,r.state)),"\n"))},dependencies:[p.qvL,s.O5,a.Ywx,g.X$,a.Nir],styles:["[_nghost-%COMP%]{font-size:14px}"],changeDetection:0})}class ce{get chipColorType(){switch(this.state){case"Pending":return"warning";case"Settled":return"success";case"Failed":return"error"}}static#e=this.\u0275fac=function(t){return new(t||ce)};static#t=this.\u0275cmp=e.Xpm({type:ce,selectors:[["vdr-refund-state-label"]],inputs:{state:"state"},decls:6,vars:10,consts:[[3,"title","colorType"],["shape","check-circle",4,"ngIf"],["shape","check-circle"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-chip",0),e.ALo(1,"translate"),e.YNc(2,Br,1,0,"clr-icon",1),e._uU(3),e.ALo(4,"translate"),e.ALo(5,"stateI18nToken"),e.qZA()),2&t&&(e.Q6J("title",e.lcZ(1,4,"order.payment-state"))("colorType",r.chipColorType),e.xp6(2),e.Q6J("ngIf","Settled"===r.state),e.xp6(1),e.hij(" ",e.lcZ(4,6,e.lcZ(5,8,r.state)),"\n"))},dependencies:[p.qvL,s.O5,a.Ywx,g.X$,a.Nir],styles:["[_nghost-%COMP%]{font-size:14px}"],changeDetection:0})}class U{static#e=this.\u0275fac=function(t){return new(t||U)};static#t=this.\u0275cmp=e.Xpm({type:U,selectors:[["vdr-payment-detail"]],inputs:{payment:"payment",currencyCode:"currencyCode"},decls:12,vars:17,consts:[[3,"label"],[3,"label",4,"ngIf"],[3,"value"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-labeled-data",0),e.ALo(1,"translate"),e._uU(2),e.qZA(),e.TgZ(3,"vdr-labeled-data",0),e.ALo(4,"translate"),e._uU(5),e.ALo(6,"localeCurrency"),e.qZA(),e.YNc(7,Vr,3,4,"vdr-labeled-data",1),e.YNc(8,Kr,3,4,"vdr-labeled-data",1),e.TgZ(9,"vdr-labeled-data",0),e.ALo(10,"translate"),e._UZ(11,"vdr-object-tree",2),e.qZA()),2&t&&(e.Q6J("label",e.lcZ(1,8,"order.payment-method")),e.xp6(2),e.hij(" ",r.payment.method,"\n"),e.xp6(1),e.Q6J("label",e.lcZ(4,10,"order.amount")),e.xp6(2),e.hij(" ",e.xi3(6,12,r.payment.amount,r.currencyCode),"\n"),e.xp6(2),e.Q6J("ngIf",r.payment.errorMessage),e.xp6(1),e.Q6J("ngIf",r.payment.transactionId),e.xp6(1),e.Q6J("label",e.lcZ(10,15,"order.payment-metadata")),e.xp6(2),e.Q6J("value",r.payment.metadata))},dependencies:[s.O5,a.WGc,a._8q,g.X$,a.kgx],changeDetection:0})}class se{constructor(){this.settlePayment=new e.vpe,this.transitionPaymentState=new e.vpe,this.settleRefund=new e.vpe}refundHasMetadata(n){return!!n&&Object.keys(n.metadata).length>0}nextOtherStates(){return this.payment?this.payment.nextStates.filter(n=>"Settled"!==n&&"Error"!==n):[]}static#e=this.\u0275fac=function(t){return new(t||se)};static#t=this.\u0275cmp=e.Xpm({type:se,selectors:[["vdr-order-payment-card"]],inputs:{payment:"payment",currencyCode:"currencyCode"},outputs:{settlePayment:"settlePayment",transitionPaymentState:"transitionPaymentState",settleRefund:"settleRefund"},decls:12,vars:9,consts:[[1,"card"],[1,"card-header","payment-header"],[4,"ngIf"],[1,"payment-state"],[3,"state"],[1,"card-block"],[3,"payment","currencyCode"],[4,"ngFor","ngForOf"],["class","card-footer",4,"ngIf"],["shape","redo","dir","down",1,"refund-icon"],[1,"clr-flex-fill"],[3,"label"],[3,"label",4,"ngIf"],[3,"value"],[1,"card-footer"],[1,"btn","btn-sm","btn-primary",3,"click"],["class","btn btn-sm btn-primary",3,"click",4,"ngIf"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",3,"click"],[4,"ngIf","ngIfElse"],["cancel",""],["shape","step-forward-2"],["shape","error-standard",1,"is-error"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div"),e._uU(3),e.ALo(4,"translate"),e.YNc(5,zr,2,1,"ng-container",2),e.qZA(),e.TgZ(6,"div",3),e._UZ(7,"vdr-payment-state-label",4),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"vdr-payment-detail",6),e.qZA(),e.YNc(10,no,20,23,"ng-container",7),e.YNc(11,lo,7,2,"div",8),e.qZA()),2&t&&(e.xp6(3),e.hij(" ",e.lcZ(4,7,"order.payment")," "),e.xp6(2),e.Q6J("ngIf",r.payment.transactionId),e.xp6(2),e.Q6J("state",r.payment.state),e.xp6(2),e.Q6J("payment",r.payment)("currencyCode",r.currencyCode),e.xp6(1),e.Q6J("ngForOf",r.payment.refunds),e.xp6(1),e.Q6J("ngIf",r.payment.nextStates.length))},dependencies:[p.qvL,s.sg,s.O5,Le.Lv,a.JOL,a.N9E,a.UaT,a.HH4,a.WGc,a._8q,de,ce,U,g.X$,a.Nir,a.HbD,a.kgx],styles:[".payment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.refund-icon[_ngcontent-%COMP%]{margin-inline-end:6px;color:var(--color-grey-400)}.card-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end}"],changeDetection:0})}class pe{constructor(n){this.historyEntryComponentService=n,this.expandClick=new e.vpe}ngOnInit(){const n=this.historyEntryComponentService.getComponent(this.entry.type),t=this.portalRef.createComponent(n);t.instance.entry=this.entry,t.instance.order=this.order,this.instance=t.instance,this.componentRef=t}ngOnDestroy(){this.componentRef?.destroy()}static#e=this.\u0275fac=function(t){return new(t||pe)(e.Y36(a.GwB))};static#t=this.\u0275cmp=e.Xpm({type:pe,selectors:[["vdr-order-history-entry-host"]],viewQuery:function(t,r){if(1&t&&e.Gf(co,7,e.s_b),2&t){let i;e.iGM(i=e.CRH())&&(r.portalRef=i.first)}},inputs:{entry:"entry",order:"order",expanded:"expanded"},outputs:{expandClick:"expandClick"},exportAs:["historyEntry"],decls:3,vars:6,consts:[[3,"displayType","iconShape","createdAt","name","featured","collapsed","expandClick"],["portal",""]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-timeline-entry",0),e.NdJ("expandClick",function(){return r.expandClick.emit()}),e._UZ(1,"div",null,1),e.qZA()),2&t&&e.Q6J("displayType",r.instance.getDisplayType(r.entry))("iconShape",r.instance.getIconShape&&r.instance.getIconShape(r.entry))("createdAt",r.entry.createdAt)("name",r.instance.getName&&r.instance.getName(r.entry))("featured",r.instance.isFeatured(r.entry))("collapsed",!r.expanded&&!r.instance.isFeatured(r.entry))},dependencies:[a._hU],encapsulation:2})}class ue{constructor(n){this.historyEntryComponentService=n,this.addNote=new e.vpe,this.updateNote=new e.vpe,this.deleteNote=new e.vpe,this.note="",this.noteIsPrivate=!0,this.expanded=!1,this.type=a.iYD}hasCustomComponent(n){return!!this.historyEntryComponentService.getComponent(n)}getDisplayType(n){if(n.type===a.iYD.ORDER_STATE_TRANSITION){if("Delivered"===n.data.to)return"success";if("Cancelled"===n.data.to)return"error"}return n.type===a.iYD.ORDER_FULFILLMENT_TRANSITION&&"Delivered"===n.data.to?"success":n.type===a.iYD.ORDER_PAYMENT_TRANSITION&&("Declined"===n.data.to||"Cancelled"===n.data.to)||n.type===a.iYD.ORDER_CANCELLATION?"error":n.type===a.iYD.ORDER_REFUND_TRANSITION?"warning":"default"}getTimelineIcon(n){if(n.type===a.iYD.ORDER_STATE_TRANSITION){if("Delivered"===n.data.to)return["success-standard","is-solid"];if("Cancelled"===n.data.to)return"ban"}return n.type===a.iYD.ORDER_PAYMENT_TRANSITION&&"Settled"===n.data.to?"credit-card":n.type===a.iYD.ORDER_NOTE?"note":n.type===a.iYD.ORDER_MODIFIED?"pencil":n.type!==a.iYD.ORDER_FULFILLMENT_TRANSITION||"Shipped"!==n.data.to&&"Delivered"!==n.data.to?void 0:"truck"}isFeatured(n){switch(n.type){case a.iYD.ORDER_STATE_TRANSITION:return"Delivered"===n.data.to||"Cancelled"===n.data.to||"Settled"===n.data.to;case a.iYD.ORDER_PAYMENT_TRANSITION:return"Settled"===n.data.to||"Cancelled"===n.data.to;case a.iYD.ORDER_FULFILLMENT_TRANSITION:return"Delivered"===n.data.to||"Shipped"===n.data.to;case a.iYD.ORDER_NOTE:case a.iYD.ORDER_MODIFIED:return!0;default:return!1}}getFulfillment(n){if((n.type===a.iYD.ORDER_FULFILLMENT||n.type===a.iYD.ORDER_FULFILLMENT_TRANSITION)&&this.order.fulfillments)return this.order.fulfillments.find(t=>t.id===n.data.fulfillmentId)}getPayment(n){if(n.type===a.iYD.ORDER_PAYMENT_TRANSITION&&this.order.payments)return this.order.payments.find(t=>t.id===n.data.paymentId)}getCancelledQuantity(n){return n.data.lines.reduce((t,r)=>t+r.quantity,0)}getCancelledItems(n){const t=new Map,r=n.data.lines;for(const i of this.order.lines){const l=r.find(c=>c.orderLineId===i.id);if(l){t.get(i.productVariant.name);t.set(i.productVariant.name,l.quantity)}}return Array.from(t.entries()).map(([i,l])=>({name:i,quantity:l}))}getModification(n){return this.order.modifications.find(t=>t.id===n)}getName(n){const{administrator:t}=n;if(t)return`${t.firstName} ${t.lastName}`;{const r=this.order.customer;if(r)return`${r.firstName} ${r.lastName}`}return""}addNoteToOrder(){this.addNote.emit({note:this.note,isPublic:!this.noteIsPrivate}),this.note="",this.noteIsPrivate=!0}static#e=this.\u0275fac=function(t){return new(t||ue)(e.Y36(a.GwB))};static#t=this.\u0275cmp=e.Xpm({type:ue,selectors:[["vdr-order-history"]],inputs:{order:"order",history:"history"},outputs:{addNote:"addNote",updateNote:"updateNote",deleteNote:"deleteNote"},decls:20,vars:21,consts:[[1,"entry-list"],["iconShape","note","displayType","muted",3,"featured"],[1,"note-entry"],["name","note",1,"note",3,"ngModel","ngModelChange"],[1,"btn","btn-secondary",3,"disabled","click"],[1,"visibility-select"],["type","checkbox","clrCheckbox","",3,"ngModel","ngModelChange"],["class","private",4,"ngIf"],["class","public",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"isLast","createdAt","featured"],[1,"title"],[1,"private"],[1,"public"],[3,"order","entry","expanded","expandClick",4,"ngIf","ngIfElse"],["defaultComponents",""],[3,"order","entry","expanded","expandClick"],[3,"displayType","iconShape","createdAt","name","featured","collapsed","expandClick"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["class","title",4,"ngIf"],[3,"ngIf"],[4,"ngIf"],["colorType","success",4,"ngIf"],["colorType","error",4,"ngIf"],[3,"order","modification"],["colorType","success"],["colorType","error"],[4,"ngIf","ngIfElse"],["regularPaymentTransition",""],[3,"payment","currencyCode"],[3,"label"],[3,"items"],[3,"fulfillmentId","order"],[1,"flex"],[1,"note-text"],["class","note-visibility public",4,"ngIf"],["class","note-visibility private",4,"ngIf"],[1,"flex-spacer"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["vdrDropdownItem","",3,"disabled","click"],["shape","edit"],[1,"dropdown-divider"],["shape","trash",1,"is-danger"],[1,"note-visibility","public"],[1,"note-visibility","private"],[3,"routerLink"],[1,"cancelled-coupon-code"],[3,"value"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"vdr-timeline-entry",1)(2,"div",2)(3,"textarea",3),e.NdJ("ngModelChange",function(l){return r.note=l}),e.qZA(),e.TgZ(4,"button",4),e.NdJ("click",function(){return r.addNoteToOrder()}),e._uU(5),e.ALo(6,"translate"),e.qZA()(),e.TgZ(7,"div",5)(8,"clr-checkbox-wrapper")(9,"input",6),e.NdJ("ngModelChange",function(l){return r.noteIsPrivate=l}),e.qZA(),e.TgZ(10,"label"),e._uU(11),e.ALo(12,"translate"),e.qZA()(),e.YNc(13,so,3,3,"span",7),e.YNc(14,po,3,3,"span",8),e.qZA()(),e.YNc(15,jo,4,2,"ng-container",9),e.TgZ(16,"vdr-timeline-entry",10)(17,"div",11),e._uU(18),e.ALo(19,"translate"),e.qZA()()()),2&t&&(e.ekj("expanded",r.expanded),e.xp6(1),e.Q6J("featured",!0),e.xp6(2),e.Q6J("ngModel",r.note),e.xp6(1),e.Q6J("disabled",!r.note),e.xp6(1),e.hij(" ",e.lcZ(6,15,"common.add-note")," "),e.xp6(4),e.Q6J("ngModel",r.noteIsPrivate),e.xp6(2),e.Oqu(e.lcZ(12,17,"order.note-is-private")),e.xp6(2),e.Q6J("ngIf",r.noteIsPrivate),e.xp6(1),e.Q6J("ngIf",!r.noteIsPrivate),e.xp6(1),e.Q6J("ngForOf",r.history),e.xp6(1),e.Q6J("isLast",!0)("createdAt",r.order.createdAt)("featured",!0),e.xp6(2),e.hij(" ",e.lcZ(19,19,"order.history-order-created")," "))},dependencies:[p.qvL,p.MgK,p.KKC,p.PEh,s.sg,s.O5,s.RF,s.n9,s.ED,d.Fj,d.Wl,d.JJ,d.On,h.rH,a.Ywx,a.y_K,a.JOL,a.N9E,a.UaT,a.HH4,a.WGc,a._8q,a._hU,a.CS9,N,U,M,ne,pe,g.X$,a.j$k,a.kgx],styles:["[_nghost-%COMP%]{display:block}.entry-list[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * 2)}.note-entry[_ngcontent-%COMP%]{display:flex;align-items:center}.note-entry[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{flex:1}.note-entry[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0}.visibility-select[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:baseline}.visibility-select[_ngcontent-%COMP%]   .public[_ngcontent-%COMP%]{color:var(--color-warning-700)}.visibility-select[_ngcontent-%COMP%]   .private[_ngcontent-%COMP%]{color:var(--color-success-700)}textarea.note[_ngcontent-%COMP%]{flex:1;height:36px;border-radius:3px;margin-inline-end:6px}.note-text[_ngcontent-%COMP%]{color:var(--color-grey-800);white-space:pre-wrap}.cancelled-coupon-code[_ngcontent-%COMP%]{text-decoration:line-through}.note-visibility[_ngcontent-%COMP%]{text-transform:lowercase}.note-visibility.public[_ngcontent-%COMP%]{color:var(--color-warning-700)}.note-visibility.private[_ngcontent-%COMP%]{color:var(--color-success-700)}"],changeDetection:0})}const qe=R.Ps`
    query GetSellerOrders($orderId: ID!) {
        order(id: $orderId) {
            id
            sellerOrders {
                id
                code
                state
                orderPlacedAt
                currencyCode
                totalWithTax
                channels {
                    id
                    code
                    seller {
                        id
                        name
                    }
                }
            }
        }
    }
`;class me{constructor(n,t,r){this.router=n,this.dataService=t,this.channelService=r}ngOnInit(){this.sellerOrders$=this.dataService.query(qe,{orderId:this.orderId}).mapSingle(({order:n})=>n?.sellerOrders??[])}getSeller(n){return n.channels.find(r=>r.code!==Ge.z$)?.seller}navigateToSellerOrder(n){this.router.navigate(["/orders",n.id])}static#e=this.\u0275fac=function(t){return new(t||me)(e.Y36(h.F0),e.Y36(a.DoR),e.Y36(a.Tjy))};static#t=this.\u0275cmp=e.Xpm({type:me,selectors:[["vdr-seller-orders-card"]],inputs:{orderId:"orderId"},decls:5,vars:6,consts:[[3,"title"],[1,"form-grid"],[4,"ngFor","ngForOf"],[1,"button-ghost","mb-1",3,"routerLink"],["shape","arrow right"],[3,"label"],[3,"state"],[3,"label",4,"ngIf"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-card",0),e.ALo(1,"translate"),e.TgZ(2,"div",1),e.YNc(3,Bo,9,10,"div",2),e.ALo(4,"async"),e.qZA()()),2&t&&(e.Q6J("title",e.lcZ(1,2,"order.seller-orders")),e.xp6(3),e.Q6J("ngForOf",e.lcZ(4,4,r.sellerOrders$)))},dependencies:[p.qvL,s.sg,s.O5,h.rH,a.GXt,a.WGc,a.AkF,s.Ov,g.X$,a.kgx],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})}const ha=R.Ps`
    query OrderDetailQuery($id: ID!) {
        order(id: $id) {
            ...OrderDetail
        }
    }
    ${a.gfD}
`;class ge extends a.VE7{constructor(n,t,r,i,l,c){super(),this.changeDetector=n,this.dataService=t,this.notificationService=r,this.modalService=i,this.orderTransitionService=l,this.formBuilder=c,this.customFields=this.getCustomFieldConfig("Order"),this.orderLineCustomFields=this.getCustomFieldConfig("OrderLine"),this.detailForm=new d.cw({customFields:this.formBuilder.group((0,a.Lrj)(this.customFields))}),this.fetchHistory=new L.x,this.defaultStates=["AddingItems","ArrangingPayment","PaymentAuthorized","PaymentSettled","PartiallyShipped","Shipped","PartiallyDelivered","Delivered","Cancelled","Modifying","ArrangingAdditionalPayment"]}ngOnInit(){this.init(),this.entity$.pipe((0,T.q)(1)).subscribe(n=>{"Modifying"===n.state&&this.router.navigate(["./","modify"],{relativeTo:this.route})}),this.history$=this.fetchHistory.pipe((0,Ze.O)(null),(0,_.w)(()=>this.dataService.order.getOrderHistory(this.id,{sort:{createdAt:a.Asd.DESC}}).mapStream(n=>n.order?.history.items))),this.nextStates$=this.entity$.pipe((0,y.U)(n=>this.defaultStates.includes(n.state)?n.nextStates.filter(r=>!this.defaultStates.includes(r)):n.nextStates))}ngOnDestroy(){this.destroy()}openStateDiagram(){this.entity$.pipe((0,T.q)(1),(0,_.w)(n=>this.modalService.fromComponent(ie,{closable:!0,locals:{activeState:n.state}}))).subscribe()}transitionToState(n){this.dataService.order.transitionToState(this.id,n).subscribe(({transitionOrderToState:t})=>{switch(t?.__typename){case"Order":this.notificationService.success((0,u.J)("order.transitioned-to-state-success"),{state:n}),this.fetchHistory.next();break;case"OrderStateTransitionError":this.notificationService.error(t.transitionError)}})}manuallyTransitionToState(n){this.orderTransitionService.manuallyTransitionToState({orderId:n.id,nextStates:n.nextStates,cancellable:!0,message:(0,u.J)("order.manually-transition-to-state-message"),retry:0}).subscribe()}transitionToModifying(){this.dataService.order.transitionToState(this.id,"Modifying").subscribe(({transitionOrderToState:n})=>{switch(n?.__typename){case"Order":this.router.navigate(["./modify"],{relativeTo:this.route});break;case"OrderStateTransitionError":this.notificationService.error(n.transitionError)}})}updateCustomFields(){this.dataService.order.updateOrderCustomFields({id:this.id,customFields:this.detailForm.value.customFields}).subscribe(()=>{this.notificationService.success((0,u.J)("common.notify-update-success"),{entity:"Order"})})}getOrderAddressLines(n){return n?Object.values(n).filter(t=>"OrderAddress"!==t).filter(t=>!!t):[]}settlePayment(n){this.dataService.order.settlePayment(n.id).subscribe(({settlePayment:t})=>{switch(t.__typename){case"Payment":"Settled"===t.state?this.notificationService.success((0,u.J)("order.settle-payment-success")):this.notificationService.error((0,u.J)("order.settle-payment-error")),this.dataService.order.getOrder(this.id).single$.subscribe(),this.fetchHistory.next();break;case"OrderStateTransitionError":case"PaymentStateTransitionError":case"SettlePaymentError":this.notificationService.error(t.message)}})}transitionPaymentState({payment:n,state:t}){"Cancelled"===t?this.dataService.order.cancelPayment(n.id).subscribe(({cancelPayment:r})=>{switch(r.__typename){case"Payment":this.notificationService.success((0,u.J)("order.transitioned-payment-to-state-success"),{state:t}),this.dataService.order.getOrder(this.id).single$.subscribe(),this.fetchHistory.next();break;case"PaymentStateTransitionError":this.notificationService.error(r.transitionError);break;case"CancelPaymentError":this.notificationService.error(r.paymentErrorMessage)}}):this.dataService.order.transitionPaymentToState(n.id,t).subscribe(({transitionPaymentToState:r})=>{switch(r.__typename){case"Payment":this.notificationService.success((0,u.J)("order.transitioned-payment-to-state-success"),{state:t}),this.dataService.order.getOrder(this.id).single$.subscribe(),this.fetchHistory.next();break;case"PaymentStateTransitionError":this.notificationService.error(r.message)}})}canAddFulfillment(n){const t=(n.fulfillments??[]).filter(i=>"Cancelled"!==i.state).reduce((i,l)=>[...i,...l.lines],[]);let r=!0;for(const i of n.lines)t.filter(c=>c.orderLineId===i.id).reduce((c,f)=>c+f.quantity,0)<i.quantity&&(r=!1);return!r&&!this.hasUnsettledModifications(n)&&0===this.outstandingPaymentAmount(n)&&(n.nextStates.includes("Shipped")||n.nextStates.includes("PartiallyShipped")||n.nextStates.includes("Delivered"))}hasUnsettledModifications(n){return 0<n.modifications.filter(t=>!t.isSettled).length}getOutstandingModificationAmount(n){return(0,x.summate)(n.modifications.filter(t=>!t.isSettled),"priceChange")}outstandingPaymentAmount(n){const t=i=>"Cancelled"!==i.state&&"Declined"!==i.state&&"Error"!==i.state;let r=0;for(const i of n.payments?.filter(t)??[]){const l=i.refunds.filter(f=>"Failed"!==f.state)??[],c=(0,x.summate)(l,"total");r+=i.amount-c}return n.totalWithTax-r}addManualPayment(n){const t=n.state;this.modalService.fromComponent(H,{closable:!0,locals:{outstandingAmount:this.outstandingPaymentAmount(n),currencyCode:n.currencyCode}}).pipe((0,_.w)(r=>r?this.dataService.order.addManualPaymentToOrder({orderId:this.id,transactionId:r.transactionId,method:r.method,metadata:r.metadata||{}}):O.E),(0,_.w)(({addManualPaymentToOrder:r})=>{switch(r.__typename){case"Order":return this.notificationService.success((0,u.J)("order.add-payment-to-order-success")),"ArrangingAdditionalPayment"===t?this.orderTransitionService.transitionToPreModifyingState(n.id,n.nextStates):(0,v.of)("PaymentSettled");case"ManualPaymentStateError":return this.notificationService.error(r.message),O.E;default:return O.E}})).subscribe(r=>{r&&this.refetchOrder({result:r})})}fulfillOrder(){this.entity$.pipe((0,T.q)(1),(0,_.w)(n=>this.modalService.fromComponent(X,{size:"xl",locals:{order:n}})),(0,_.w)(n=>n?this.dataService.order.createFulfillment(n):(0,v.of)(void 0)),(0,_.w)(n=>this.refetchOrder(n).pipe((0,we.h)(n)))).subscribe(n=>{if(n){const{addFulfillmentToOrder:t}=n;switch(t.__typename){case"Fulfillment":this.notificationService.success((0,u.J)("order.create-fulfillment-success"));break;case"EmptyOrderLineSelectionError":case"InsufficientStockOnHandError":case"ItemsAlreadyFulfilledError":case"InvalidFulfillmentHandlerError":this.notificationService.error(t.message);break;case"FulfillmentStateTransitionError":this.notificationService.error(t.transitionError);break;case"CreateFulfillmentError":this.notificationService.error(t.fulfillmentHandlerError);break;case void 0:this.notificationService.error(JSON.stringify(t));break;default:(0,x.assertNever)(t)}}})}transitionFulfillment(n,t){this.dataService.order.transitionFulfillmentToState(n,t).pipe((0,_.w)(r=>this.refetchOrder(r))).subscribe(()=>{this.notificationService.success((0,u.J)("order.successfully-updated-fulfillment"))})}cancelOrRefund(n){const t=this.orderHasSettledPayments(n);"PaymentAuthorized"!==n.state&&!0!==n.active&&t?this.refundOrder(n):this.cancelOrder(n)}settleRefund(n){this.modalService.fromComponent(le,{size:"md",locals:{refund:n}}).pipe((0,_.w)(t=>t?this.dataService.order.settleRefund({transactionId:t,id:n.id},this.id):(0,v.of)(void 0))).subscribe(t=>{t&&this.notificationService.success((0,u.J)("order.settle-refund-success"))})}addNote(n){const{note:t,isPublic:r}=n;this.dataService.order.addNoteToOrder({id:this.id,note:t,isPublic:r}).pipe((0,_.w)(i=>this.refetchOrder(i))).subscribe(i=>{this.notificationService.success((0,u.J)("common.notify-create-success"),{entity:"Note"})})}updateNote(n){this.modalService.fromComponent(a.UlA,{closable:!0,locals:{displayPrivacyControls:!0,note:n.data.note,noteIsPrivate:!n.isPublic}}).pipe((0,_.w)(t=>t?this.dataService.order.updateOrderNote({noteId:n.id,isPublic:!t.isPrivate,note:t.note}):O.E)).subscribe(t=>{this.fetchHistory.next(),this.notificationService.success((0,u.J)("common.notify-update-success"),{entity:"Note"})})}deleteNote(n){return this.modalService.dialog({title:(0,u.J)("common.confirm-delete-note"),body:n.data.note,buttons:[{type:"secondary",label:(0,u.J)("common.cancel")},{type:"danger",label:(0,u.J)("common.delete"),returnValue:!0}]}).pipe((0,_.w)(t=>t?this.dataService.order.deleteOrderNote(n.id):O.E)).subscribe(()=>{this.fetchHistory.next(),this.notificationService.success((0,u.J)("common.notify-delete-success"),{entity:"Note"})})}orderHasSettledPayments(n){return!!n.payments?.find(t=>"Settled"===t.state)}cancelOrder(n){this.modalService.fromComponent(G,{size:"xl",locals:{order:n}}).pipe((0,_.w)(t=>t?this.dataService.order.cancelOrder(t):(0,v.of)(void 0)),(0,_.w)(t=>this.refetchOrder(t))).subscribe(t=>{t&&this.notificationService.success((0,u.J)("order.cancelled-order-success"))})}refundOrder(n){this.modalService.fromComponent(ae,{size:"xl",locals:{order:n}}).pipe((0,_.w)(t=>t?t.cancel.lines?.length?this.dataService.order.cancelOrder(t.cancel).pipe((0,y.U)(r=>{const i=r.cancelOrder;switch(i.__typename){case"Order":return this.refetchOrder(i).subscribe(),this.notificationService.success((0,u.J)("order.cancelled-order-success")),t;case"CancelActiveOrderError":case"QuantityTooGreatError":case"MultipleOrderError":case"OrderStateTransitionError":case"EmptyOrderLineSelectionError":return void this.notificationService.error(i.message)}})):[t]:(0,v.of)(void 0)),(0,_.w)(t=>t?t.refund.lines.length?this.dataService.order.refundOrder(t.refund).pipe((0,y.U)(r=>r.refundOrder)):[void 0]:(0,v.of)(void 0))).subscribe(t=>{if(t)switch(t.__typename){case"Refund":this.refetchOrder(t).subscribe(),"Failed"===t.state?this.notificationService.error((0,u.J)("order.refund-order-failed")):this.notificationService.success((0,u.J)("order.refund-order-success"));break;case"AlreadyRefundedError":case"NothingToRefundError":case"PaymentOrderMismatchError":case"RefundOrderStateError":case"RefundStateTransitionError":this.notificationService.error(t.message)}})}refetchOrder(n){return this.fetchHistory.next(),n?this.dataService.order.getOrder(this.id).single$:(0,v.of)(void 0)}setFormValues(n){this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["customFields"]),n)}static#e=this.\u0275fac=function(t){return new(t||ge)(e.Y36(e.sBO),e.Y36(a.DoR),e.Y36(a.gqp),e.Y36(a.Z7U),e.Y36(Z),e.Y36(d.qu))};static#t=this.\u0275cmp=e.Xpm({type:ge,selectors:[["vdr-order-detail"]],features:[e.qOj],decls:5,vars:6,consts:[[4,"ngIf"],["locationId","order-detail"],["class","button primary mr-1",3,"click",4,"ngIf"],["class","button primary mr-1",3,"disabled","click",4,"ngIf"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",3,"click",4,"ngIf"],[1,"dropdown-divider"],["type","button","vdrDropdownItem","",3,"click"],["shape","step-forward-2",1,"is-warning"],[1,"button","primary","mr-1",3,"click"],[1,"button","primary","mr-1",3,"disabled","click"],["shape","pencil"],["shape","error-standard",1,"is-error"],[4,"ngIf","ngIfElse"],["cancelOnly",""],["type","button","vdrDropdownItem","",3,"click",4,"ngFor","ngForOf"],["shape","step-forward-2"],[3,"state"],[1,"icon-button",3,"title","click"],["shape","list"],[3,"title"],[3,"customer"],["class","mt-2",3,"label",4,"ngIf"],[3,"label",4,"ngIf"],[3,"title",4,"ngIf"],[3,"entity",4,"ngIf"],["class","mb-2",3,"orderId",4,"ngIf"],[3,"paddingX"],[3,"order","orderLineCustomFields"],[3,"title","paddingX"],[1,"table"],[4,"ngFor","ngForOf"],["locationId","order-detail",3,"entity$","detailForm"],[3,"order","history","addNote","updateNote","deleteNote"],[1,"mt-2",3,"label"],[1,"mt-1",3,"address"],[3,"label"],[3,"currencyCode","payment","settlePayment","transitionPaymentState","settleRefund",4,"ngFor","ngForOf"],[3,"currencyCode","payment","settlePayment","transitionPaymentState","settleRefund"],[3,"fulfillment","order","transitionState",4,"ngFor","ngForOf"],[3,"fulfillment","order","transitionState"],[3,"entity"],[1,"mb-2",3,"orderId"],["entityName","Order",3,"customFields","customFieldsFormGroup","readonly"],[1,"button","primary",3,"disabled","click"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-page-block"),e.YNc(1,oi,20,11,"vdr-action-bar",0),e.ALo(2,"async"),e.qZA(),e.YNc(3,_i,46,46,"vdr-page-detail-layout",0),e.ALo(4,"async")),2&t&&(e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,r.entity$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(4,4,r.entity$)))},dependencies:[p.qvL,s.sg,s.O5,a.KkL,a.BND,a.mz,a.d$,a.JOL,a.N9E,a.UaT,a.HH4,a.GXt,a.b28,a.WGc,a.WWO,a.yc0,a.CWh,a.zJY,a.DME,a.TeL,a.W1W,a.AkF,se,ue,te,F,me,s.Ov,s.Zx,g.X$,a.j$k,a.Nir,a.kgx],styles:[".shipping-address[_ngcontent-%COMP%]{list-style-type:none;line-height:1.3em}.order-cards[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin-top:6px;color:var(--color-text-200)}"],changeDetection:0})}var b,o;(o=b||(b={}))[o.Refund=0]="Refund",o[o.Payment=1]="Payment",o[o.PriceUnchanged=2]="PriceUnchanged",o[o.Cancel=3]="Cancel";class _e{get priceDifference(){return this.order.totalWithTax-this.originalTotalWithTax}ngOnInit(){this.refundNote=this.modifyOrderInput.note||""}cancel(){this.resolveWith({result:b.Cancel})}submit(){0<this.priceDifference?this.resolveWith({result:b.Payment}):this.priceDifference<0?this.resolveWith({result:b.Refund,refundPaymentId:this.selectedPayment.id,refundNote:this.refundNote}):this.resolveWith({result:b.PriceUnchanged})}static#e=this.\u0275fac=function(t){return new(t||_e)};static#t=this.\u0275cmp=e.Xpm({type:_e,selectors:[["vdr-order-edits-preview-dialog"]],decls:10,vars:10,consts:[["vdrDialogTitle",""],[3,"order","orderLineCustomFields"],[1,"h4"],[4,"ngIf"],["vdrDialogButtons",""],["clrSelect","","name","options",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"clr-control-label"],["name","refundNote","clrTextarea","","required","",3,"ngModel","ngModelChange"],[3,"ngValue"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,r){1&t&&(e.YNc(0,fi,2,3,"ng-template",0),e._UZ(1,"vdr-order-table",1),e.TgZ(2,"h4",2),e._uU(3),e.ALo(4,"translate"),e.TgZ(5,"strong"),e._uU(6),e.ALo(7,"localeCurrency"),e.qZA()(),e.YNc(8,vi,11,9,"div",3),e.YNc(9,yi,6,7,"ng-template",4)),2&t&&(e.xp6(1),e.Q6J("order",r.order)("orderLineCustomFields",r.orderLineCustomFields),e.xp6(2),e.hij(" ",e.lcZ(4,5,"order.modify-order-price-difference"),": "),e.xp6(3),e.Oqu(e.xi3(7,7,r.priceDifference,r.order.currencyCode)),e.xp6(2),e.Q6J("ngIf",r.priceDifference<0))},dependencies:[p.MgK,p.otW,p.dTv,p.XE5,s.sg,s.O5,d.YN,d.Kr,d.Fj,d.EJ,d.JJ,d.Q7,d.On,a.y_K,a.nPI,a.q6K,F,g.X$,a.kgx],changeDetection:0})}class fe extends a.UT_{constructor(n,t,r,i,l,c,f,Qe){super(t,n,r,l),this.changeDetector=i,this.dataService=l,this.notificationService=c,this.modalService=f,this.orderTransitionService=Qe,this.detailForm=new d.nJ({}),this.couponCodesControl=new d.p4,this.modifyOrderInput={dryRun:!0,orderId:"",addItems:[],adjustOrderLines:[],surcharges:[],note:"",updateShippingAddress:{},updateBillingAddress:{}},this.note="",this.recalculateShipping=!0,this.addedVariants=new Map}get addedLines(){const n=t=>"SinglePrice"===t.__typename?t.value:0;return(this.modifyOrderInput.addItems||[]).map(t=>{const r=this.addedVariants.get(t.productVariantId);if(r)return{...r,price:n(r.price),priceWithTax:n(r.priceWithTax),quantity:t.quantity}}).filter(x.notNullOrUndefined)}ngOnInit(){this.init(),this.addressCustomFields=this.getCustomFieldConfig("Address"),this.modifyOrderInput.orderId=this.route.snapshot.paramMap.get("id"),this.orderLineCustomFields=this.getCustomFieldConfig("OrderLine"),this.entity$.pipe((0,ve.R)(this.destroy$)).subscribe(n=>{n.couponCodes.length&&this.couponCodesControl.setValue(n.couponCodes),this.surchargeForm=new d.nJ({description:new d.p4("",d.kI.required),sku:new d.p4(""),price:new d.p4(0,d.kI.required),priceIncludesTax:new d.p4(!0),taxRate:new d.p4(0),taxDescription:new d.p4("")}),this.shippingAddressForm||(this.shippingAddressForm=new d.nJ({fullName:new d.p4(n.shippingAddress?.fullName),company:new d.p4(n.shippingAddress?.company),streetLine1:new d.p4(n.shippingAddress?.streetLine1),streetLine2:new d.p4(n.shippingAddress?.streetLine2),city:new d.p4(n.shippingAddress?.city),province:new d.p4(n.shippingAddress?.province),postalCode:new d.p4(n.shippingAddress?.postalCode),countryCode:new d.p4(n.shippingAddress?.countryCode),phoneNumber:new d.p4(n.shippingAddress?.phoneNumber)}),this.addAddressCustomFieldsFormGroup(this.shippingAddressForm,n.shippingAddress)),this.billingAddressForm||(this.billingAddressForm=new d.nJ({fullName:new d.p4(n.billingAddress?.fullName),company:new d.p4(n.billingAddress?.company),streetLine1:new d.p4(n.billingAddress?.streetLine1),streetLine2:new d.p4(n.billingAddress?.streetLine2),city:new d.p4(n.billingAddress?.city),province:new d.p4(n.billingAddress?.province),postalCode:new d.p4(n.billingAddress?.postalCode),countryCode:new d.p4(n.billingAddress?.countryCode),phoneNumber:new d.p4(n.billingAddress?.phoneNumber)}),this.addAddressCustomFieldsFormGroup(this.billingAddressForm,n.billingAddress)),this.orderLineCustomFieldsFormArray=new d.vC([]);for(const t of n.lines){const r=new d.nJ({});for(const{name:i}of this.orderLineCustomFields)r.addControl(i,new d.p4(t.customFields[i]));r.valueChanges.pipe((0,ve.R)(this.destroy$)).subscribe(i=>{let l=this.modifyOrderInput.adjustOrderLines.find(c=>c.orderLineId===t.id);l||(l={orderLineId:t.id,quantity:t.quantity},this.modifyOrderInput.adjustOrderLines.push(l)),this.orderLineCustomFields.length&&(l.customFields=i)}),this.orderLineCustomFieldsFormArray.push(r)}}),this.addItemCustomFieldsFormArray=new d.vC([]),this.addItemCustomFieldsForm=new d.nJ({});for(const n of this.orderLineCustomFields)this.addItemCustomFieldsForm.addControl(n.name,new d.p4);this.availableCountries$=this.dataService.settings.getAvailableCountries().mapSingle(n=>n.countries.items).pipe((0,Fe.d)(1)),this.dataService.order.getOrderHistory(this.id,{take:1,sort:{createdAt:a.Asd.DESC},filter:{type:{eq:a.iYD.ORDER_STATE_TRANSITION}}}).single$.subscribe(({order:n})=>{this.previousState=n?.history.items[0].data.from})}ngOnDestroy(){this.destroy()}transitionToPriorState(n){this.orderTransitionService.transitionToPreModifyingState(n.id,n.nextStates).subscribe(t=>{this.router.navigate([".."],{relativeTo:this.route})})}canPreviewChanges(){const{addItems:n,adjustOrderLines:t,surcharges:r}=this.modifyOrderInput;return!!n?.length||!!r?.length||!!t?.length||this.shippingAddressForm.dirty&&this.shippingAddressForm.valid||this.billingAddressForm.dirty&&this.billingAddressForm.valid||this.couponCodesControl.dirty}isLineModified(n){return!!this.modifyOrderInput.adjustOrderLines?.find(t=>t.orderLineId===n.id&&t.quantity!==n.quantity)}updateLineQuantity(n,t){const{adjustOrderLines:r}=this.modifyOrderInput;let i=r?.find(l=>l.orderLineId===n.id);i&&+t===n.quantity&&r?.splice(r?.indexOf(i),1),i||(i={orderLineId:n.id,quantity:+t},r?.push(i)),i.quantity=+t}updateAddedItemQuantity(n,t){const r=this.modifyOrderInput.addItems?.find(i=>i.productVariantId===n.productVariantId);r&&(r.quantity=+t)}trackByProductVariantId(n,t){return t.productVariantId}getSelectedItemPrice(n){return"SinglePrice"===n?.priceWithTax.__typename?n.priceWithTax.value:0}addItemToOrder(n){if(!n)return;const t=this.orderLineCustomFields.length?this.addItemCustomFieldsForm.value:void 0;let r=this.modifyOrderInput.addItems?.find(i=>this.isMatchingAddItemRow(i,n,t));if(r?r.quantity++:(r={productVariantId:n.productVariantId,quantity:1},t&&(r.customFields=t),this.modifyOrderInput.addItems?.push(r)),t){const i=new d.nJ({});for(const[l,c]of Object.entries(t))i.addControl(l,new d.p4(c));this.addItemCustomFieldsFormArray.push(i),i.valueChanges.pipe((0,ve.R)(this.destroy$)).subscribe(l=>{r&&(r.customFields=l)})}this.addItemCustomFieldsForm.reset({}),this.addItemSelectedVariant=void 0,this.addedVariants.set(n.productVariantId,n)}isMatchingAddItemRow(n,t,r){return n.productVariantId===t.productVariantId&&JSON.stringify(n.customFields)===JSON.stringify(r)}removeAddedItem(n){this.modifyOrderInput.addItems.splice(n,1),-1<n&&this.addItemCustomFieldsFormArray.removeAt(n)}getSurchargePrices(n){const t=n.priceIncludesTax?n.price:Math.round(n.price*((100+(n.taxRate||0))/100));return{price:n.priceIncludesTax?Math.round(n.price/((100+(n.taxRate||0))/100)):n.price,priceWithTax:t}}addSurcharge(n){this.modifyOrderInput.surcharges?.push(n),this.surchargeForm.reset({price:0,priceIncludesTax:!0,taxRate:0})}removeSurcharge(n){this.modifyOrderInput.surcharges?.splice(n,1)}previewAndModify(n){const r={...{...this.modifyOrderInput,adjustOrderLines:this.modifyOrderInput.adjustOrderLines.map(l=>(0,a.EJQ)((0,Be.I)(l),this.orderLineCustomFields))},...this.billingAddressForm.dirty?{updateBillingAddress:this.billingAddressForm.value}:{},...this.shippingAddressForm.dirty?{updateShippingAddress:this.shippingAddressForm.value}:{},dryRun:!0,couponCodes:this.couponCodesControl.dirty?this.couponCodesControl.value:void 0,note:this.note??"",options:{recalculateShipping:this.recalculateShipping}},i=n.totalWithTax;this.dataService.order.modifyOrder(r).pipe((0,_.w)(({modifyOrder:l})=>{switch(l.__typename){case"Order":return this.modalService.fromComponent(_e,{size:"xl",closable:!1,locals:{originalTotalWithTax:i,order:l,orderLineCustomFields:this.orderLineCustomFields,modifyOrderInput:r}});case"InsufficientStockError":case"NegativeQuantityError":case"NoChangesSpecifiedError":case"OrderLimitError":case"OrderModificationStateError":case"PaymentMethodMissingError":case"RefundPaymentIdMissingError":case"CouponCodeLimitError":case"CouponCodeExpiredError":case"CouponCodeInvalidError":return this.notificationService.error(l.message),(0,v.of)(!1);case null:case void 0:return(0,v.of)(!1);default:(0,x.assertNever)(l)}}),(0,_.w)(l=>{if(!l||l.result===b.Cancel)return this.dataService.order.getOrder(this.id).mapSingle(()=>!1);{const c={...r,dryRun:!1};return l.result===b.Refund&&(c.refund={paymentId:l.refundPaymentId,reason:l.refundNote}),this.dataService.order.modifyOrder(c).pipe((0,_.w)(({modifyOrder:f})=>{if("Order"===f.__typename){const ya=0<f.totalWithTax-i?"ArrangingAdditionalPayment":this.previousState;return this.dataService.order.transitionToState(n.id,ya).pipe((0,we.h)(!0))}return this.notificationService.error(f.message),O.E}))}})).subscribe(l=>{l&&this.router.navigate(["../"],{relativeTo:this.route})})}addAddressCustomFieldsFormGroup(n,t){if(t&&this.addressCustomFields.length){const r=new d.nJ({});for(const i of this.addressCustomFields){const l=i.name,c=t.customFields?.[l];r.addControl(l,new d.p4(c))}n.addControl("customFields",r)}}setFormValues(n,t){}static#e=this.\u0275fac=function(t){return new(t||fe)(e.Y36(h.F0),e.Y36(h.gz),e.Y36(a.iHG),e.Y36(e.sBO),e.Y36(a.DoR),e.Y36(a.gqp),e.Y36(a.Z7U),e.Y36(Z))};static#t=this.\u0275cmp=e.Xpm({type:fe,selectors:[["vdr-order-editor"]],features:[e.qOj],decls:7,vars:6,consts:[[4,"ngIf"],[1,"flex","clr-align-items-center"],[3,"state"],[1,"btn","btn-secondary",3,"click"],[1,"clr-row"],[1,"clr-col-lg-8"],[1,"order-table","table"],["class","order-line",3,"is-cancelled","modified",4,"ngFor","ngForOf"],["class","modified",4,"ngFor","ngForOf","ngForTrackBy"],["class","surcharge",4,"ngFor","ngForOf"],["class","surcharge modified",4,"ngFor","ngForOf"],[1,"shipping"],[1,"left","clr-align-middle"],[1,"clr-align-middle"],["colspan","3"],[1,"net-price",3,"title"],[1,"mb-2"],[4,"clrIfExpanded"],[1,"clr-col-lg-4","order-cards"],[1,"card"],[1,"card-header"],[1,"card-block"],[1,"clr-control-label"],["name","note","clrTextarea","","required","",3,"ngModel","ngModelChange"],[1,""],["type","checkbox","clrCheckbox","",3,"ngModel","ngModelChange"],[1,"card-footer"],[1,"btn","btn-primary",3,"disabled","click"],[1,"order-line"],[1,"align-middle","thumb"],[3,"src",4,"ngIf"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","unit-price"],[1,"align-middle","quantity"],["type","number","min","0",3,"value","input"],[3,"line","payments"],[3,"line","allOrderFulfillments","orderState"],["class","order-line-custom-field align-middle",4,"ngIf"],[1,"align-middle","total"],[3,"src"],[1,"order-line-custom-field","align-middle"],["entityName","OrderLine",3,"customFields","customFieldsFormGroup","compact"],[1,"modified"],[1,"icon-button",3,"click"],["shape","trash"],[4,"ngFor","ngForOf"],["entityName","OrderLine",3,"customField","customFieldsFormGroup","compact"],[1,"surcharge"],["colspan","2",1,"align-middle","name","left"],[1,"align-middle"],[1,"surcharge","modified"],[1,"mb-4",3,"productSelected"],["class","flex mb-4",4,"ngIf"],[1,"btn","btn-secondary",3,"disabled","click"],[1,"flex","mb-4"],["class","mr-4 add-item-thumb",3,"src",4,"ngIf"],[1,"mr-4"],[1,"mr-4","add-item-thumb",3,"src"],["entityName","OrderLine",3,"readonly","customField","customFieldsFormGroup","compact"],[3,"control"],[3,"formGroup","submit"],["for","description",3,"label"],["id","description","type","text","formControlName","description"],["for","sku",3,"label"],["id","sku","type","text","formControlName","sku"],["for","price",3,"label"],["id","price","formControlName","price",3,"currencyCode"],["for","priceIncludesTax",3,"label"],["id","priceIncludesTax","type","checkbox","clrCheckbox","","formControlName","priceIncludesTax"],["for","taxRate",3,"label"],["suffix","%"],["id","taxRate","type","number","min","0","max","100","formControlName","taxRate"],["for","taxDescription",3,"label"],["id","taxDescription","type","text","formControlName","taxDescription"],[1,"btn","btn-secondary",3,"disabled"],[3,"formGroup","availableCountries","customFields"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-page-block"),e.YNc(1,xi,8,4,"vdr-action-bar",0),e.ALo(2,"async"),e.qZA(),e.TgZ(3,"vdr-page-block"),e.YNc(4,Vi,98,75,"div",0),e.ALo(5,"async"),e._UZ(6,"vdr-page-block"),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,r.entity$)),e.xp6(3),e.Q6J("ngIf",e.lcZ(5,4,r.entity$)))},dependencies:[p.q0d,p.Nz$,p.qvL,p.DbV,p.MgK,p.KKC,p.PEh,p.XE5,p.bZL,p.GmI,p.UJ5,p.r6y,p.dxz,p.twP,s.sg,s.O5,d._Y,d.Fj,d.wV,d.Wl,d.JJ,d.JL,d.Q7,d.qQ,d.Fd,d.On,d.sg,d.u,a.KkL,a.BND,a.mz,a.KH1,a.KQz,a.M1s,a.hgI,a.y_K,a.GXt,a.elg,a.CY4,a.yc0,a.zJY,q,I,D,s.Ov,s.H9,g.X$,a.Mgf,a.kgx],styles:[".order-table[_ngcontent-%COMP%]   .is-cancelled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-decoration:line-through;background-color:var(--color-component-bg-200)}.order-table[_ngcontent-%COMP%]   .sub-total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:1px dashed var(--color-component-border-200)}.order-table[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:700;border-top:1px dashed var(--color-component-border-200)}.order-table[_ngcontent-%COMP%]   td.custom-fields-row[_ngcontent-%COMP%]{border-top-style:dashed;border-top-color:var(--color-grey-200)}.order-table[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:var(--border-radius-img)}.order-table[_ngcontent-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.order-table[_ngcontent-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]   .custom-field[_ngcontent-%COMP%]{text-align:start;max-width:200px;overflow:hidden;text-overflow:ellipsis;margin-bottom:6px;margin-inline-end:18px}.order-table[_ngcontent-%COMP%]   .draft-qty[_ngcontent-%COMP%]{max-width:48px}.order-table[_ngcontent-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100)}.order-table[_ngcontent-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]   .custom-field-ellipsis[_ngcontent-%COMP%]{color:var(--color-text-300)}.order-table[_ngcontent-%COMP%]   .net-price[_ngcontent-%COMP%]{font-size:11px;color:var(--color-text-300);line-height:14px}.order-table[_ngcontent-%COMP%]   .promotions-label[_ngcontent-%COMP%]{-webkit-text-decoration:underline dotted var(--color-text-200);text-decoration:underline dotted var(--color-text-200);font-size:11px;margin-top:6px;cursor:pointer;text-transform:lowercase}.order-table[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px}.order-table[_ngcontent-%COMP%]   .shipping-method-name[_ngcontent-%COMP%]{font-size:var(--font-size-xs);margin-inline-end:2px}.order-table[_ngcontent-%COMP%]   .order-placed-quantity[_ngcontent-%COMP%]{text-decoration:line-through;color:var(--color-text-300);margin-inline-end:2px}.order-table[_ngcontent-%COMP%]   tr.modified[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--color-warning-100)}.order-table[_ngcontent-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]{text-align:start}.add-item-thumb[_ngcontent-%COMP%]{max-width:50px}"],changeDetection:0})}class he extends a.$ms{constructor(n,t){super(),this.serverConfigService=n,this.channelService=t,this.orderStates=this.serverConfigService.getOrderProcessStates().map(r=>r.name),this.OrderType=a.mrS,this.customFields=this.getCustomFieldConfig("Order"),this.filters=this.createFilterCollection().addIdFilter().addDateFilters().addFilter({name:"active",type:{kind:"boolean"},label:(0,u.J)("order.filter-is-active"),filterField:"active"}).addFilter({name:"totalWithTax",type:{kind:"number",inputType:"currency",currencyCode:"USD"},label:(0,u.J)("order.total"),filterField:"totalWithTax"}).addFilter({name:"state",type:{kind:"select",options:this.orderStates.map(r=>({value:r,label:(0,a.yr0)(r)}))},label:(0,u.J)("order.state"),filterField:"state"}).addFilter({name:"type",type:{kind:"select",options:[{value:a.mrS.Regular,label:(0,u.J)("order.order-type-regular")},{value:a.mrS.Aggregate,label:(0,u.J)("order.order-type-aggregate")},{value:a.mrS.Seller,label:(0,u.J)("order.order-type-seller")}]},label:(0,u.J)("order.order-type"),filterField:"type"}).addFilter({name:"orderPlacedAt",type:{kind:"dateRange"},label:(0,u.J)("order.placed-at"),filterField:"orderPlacedAt"}).addFilter({name:"customerLastName",type:{kind:"text"},label:(0,u.J)("customer.last-name"),filterField:"customerLastName"}).addFilter({name:"transactionId",type:{kind:"text"},label:(0,u.J)("order.transaction-id"),filterField:"transactionId"}).addCustomFieldFilters(this.customFields).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("updatedAt","DESC").addSort({name:"id"}).addSort({name:"createdAt"}).addSort({name:"updatedAt"}).addSort({name:"orderPlacedAt"}).addSort({name:"customerLastName"}).addSort({name:"state"}).addSort({name:"totalWithTax"}).addCustomFieldSorts(this.customFields).connectToRoute(this.route),this.canCreateDraftOrder=!1,this.activeChannelIsDefaultChannel=!1,super.configure({document:a.a4G,getItems:r=>r.orders,setVariables:(r,i)=>this.createQueryOptions(r,i,this.searchTermControl.value),refreshListOnChanges:[this.filters.valueChanges,this.sorts.valueChanges]}),this.canCreateDraftOrder=!!this.serverConfigService.getOrderProcessStates().find(r=>"Created"===r.name)?.to.includes("Draft")}ngOnInit(){super.ngOnInit();const n=this.channelService.defaultChannelIsActive$.pipe((0,j.b)(t=>this.activeChannelIsDefaultChannel=t));super.refreshListOnChanges(this.filters.valueChanges,this.sorts.valueChanges,n)}createQueryOptions(n,t,r){let i=this.filters.createFilterInput();return this.activeChannelIsDefaultChannel&&(i={...i??{}}),r&&(i={code:{contains:r},customerLastName:{contains:r},transactionId:{contains:r}}),{options:{skip:n,take:t,filter:{...i??{}},filterOperator:r?a.FnJ.OR:a.FnJ.AND,sort:this.sorts.createSortInput()}}}getShippingNames(n){return n.shippingLines.length?n.shippingLines.map(t=>t.shippingMethod.name).join(", "):""}static#e=this.\u0275fac=function(t){return new(t||he)(e.Y36(a.iHG),e.Y36(a.Tjy))};static#t=this.\u0275cmp=e.Xpm({type:he,selectors:[["vdr-order-list"]],features:[e.qOj],decls:44,vars:60,consts:[["locationId","order-list"],[4,"ngIf"],["id","order-list",1,"mt-2",3,"items","itemsPerPage","totalItems","currentPage","filters","pageChange","itemsPerPageChange"],["locationId","order-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],["id","id",3,"heading","hiddenByDefault","sort"],["id","created-at",3,"heading","hiddenByDefault"],["id","code",3,"heading","optional"],["id","customer",3,"heading","sort"],["id","order-type",3,"heading","hiddenByDefault"],["id","state",3,"heading","sort"],["id","total",3,"heading","sort"],["id","updated-at",3,"heading"],["id","placed-at",3,"heading","sort"],["id","shipping",3,"heading"],[3,"customField","sorts",4,"ngFor","ngForOf"],["class","btn",3,"routerLink",4,"vdrIfPermissions"],[1,"btn",3,"routerLink"],["shape","plus"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],[3,"customer","click"],[3,"state"],[3,"customField","sorts"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-right"),e._UZ(3,"vdr-action-bar-items",0),e.YNc(4,Xi,2,2,"ng-container",1),e.qZA()()(),e.TgZ(5,"vdr-data-table-2",2),e.NdJ("pageChange",function(l){return r.setPageNumber(l)})("itemsPerPageChange",function(l){return r.setItemsPerPage(l)}),e.ALo(6,"async"),e.ALo(7,"async"),e.ALo(8,"async"),e.ALo(9,"async"),e._UZ(10,"vdr-bulk-action-menu",3)(11,"vdr-dt2-search",4),e.ALo(12,"translate"),e.TgZ(13,"vdr-dt2-column",5),e.ALo(14,"translate"),e.YNc(15,ea,1,1,"ng-template"),e.qZA(),e.TgZ(16,"vdr-dt2-column",6),e.ALo(17,"translate"),e.YNc(18,ta,2,4,"ng-template"),e.qZA(),e.TgZ(19,"vdr-dt2-column",7),e.ALo(20,"translate"),e.YNc(21,oa,4,6,"ng-template"),e.qZA(),e.TgZ(22,"vdr-dt2-column",8),e.ALo(23,"translate"),e.YNc(24,ia,1,1,"ng-template"),e.qZA(),e.TgZ(25,"vdr-dt2-column",9),e.ALo(26,"translate"),e.YNc(27,ca,3,3,"ng-template"),e.qZA(),e.TgZ(28,"vdr-dt2-column",10),e.ALo(29,"translate"),e.YNc(30,sa,1,1,"ng-template"),e.qZA(),e.TgZ(31,"vdr-dt2-column",11),e.ALo(32,"translate"),e.YNc(33,pa,2,4,"ng-template"),e.qZA(),e.TgZ(34,"vdr-dt2-column",12),e.ALo(35,"translate"),e.YNc(36,ua,2,3,"ng-template"),e.qZA(),e.TgZ(37,"vdr-dt2-column",13),e.ALo(38,"translate"),e.YNc(39,ma,2,4,"ng-template"),e.qZA(),e.TgZ(40,"vdr-dt2-column",14),e.ALo(41,"translate"),e.YNc(42,ga,1,1,"ng-template"),e.qZA(),e.YNc(43,_a,1,2,"vdr-dt2-custom-field-column",15),e.qZA()),2&t&&(e.xp6(4),e.Q6J("ngIf",r.canCreateDraftOrder),e.xp6(1),e.Q6J("items",e.lcZ(6,30,r.items$))("itemsPerPage",e.lcZ(7,32,r.itemsPerPage$))("totalItems",e.lcZ(8,34,r.totalItems$))("currentPage",e.lcZ(9,36,r.currentPage$))("filters",r.filters),e.xp6(5),e.Q6J("hostComponent",r)("selectionManager",r.selectionManager),e.xp6(1),e.Q6J("searchTermControl",r.searchTermControl)("searchTermPlaceholder",e.lcZ(12,38,"order.search-by-order-filters")),e.xp6(2),e.Q6J("heading",e.lcZ(14,40,"common.id"))("hiddenByDefault",!0)("sort",r.sorts.get("id")),e.xp6(3),e.Q6J("heading",e.lcZ(17,42,"common.created-at"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(20,44,"common.code"))("optional",!1),e.xp6(3),e.Q6J("heading",e.lcZ(23,46,"order.customer"))("sort",r.sorts.get("customerLastName")),e.xp6(3),e.Q6J("heading",e.lcZ(26,48,"order.order-type"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(29,50,"order.state"))("sort",r.sorts.get("state")),e.xp6(3),e.Q6J("heading",e.lcZ(32,52,"order.total"))("sort",r.sorts.get("totalWithTax")),e.xp6(3),e.Q6J("heading",e.lcZ(35,54,"common.updated-at")),e.xp6(3),e.Q6J("heading",e.lcZ(38,56,"order.placed-at"))("sort",r.sorts.get("orderPlacedAt")),e.xp6(3),e.Q6J("heading",e.lcZ(41,58,"order.shipping")),e.xp6(3),e.Q6J("ngForOf",r.customFields))},dependencies:[p.qvL,s.sg,s.O5,h.rH,a.KkL,a.mz,a.Ywx,a.d$,a.GXt,a.HAh,a.WWO,a.cuf,a.eJ5,a.Up6,a.JBy,a.jrk,a.zJY,s.Ov,g.X$,a.eGd,a.HbD,a.kgx],styles:[".search-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:baseline;width:100%;max-width:100vw;margin-bottom:6px}.filter-presets[_ngcontent-%COMP%]{max-width:90vw;overflow-x:auto}.search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}.custom-filters[_ngcontent-%COMP%]{overflow:hidden;max-height:0;padding-bottom:6px}.custom-filters.expanded[_ngcontent-%COMP%]{max-height:initial}.custom-filters[_ngcontent-%COMP%] > form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.custom-filters[_ngcontent-%COMP%] > form[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%}ng-select[_ngcontent-%COMP%]{flex:1;min-width:200px;height:36px}ng-select[_ngcontent-%COMP%]     .ng-select-container{height:36px}"],changeDetection:0})}const va=R.Ps`
    query GetCustomerAddresses($customerId: ID!) {
        customer(id: $customerId) {
            id
            addresses {
                ...Address
            }
        }
    }
    ${a.UYy}
`;class E{constructor(n,t){this.router=n,this.dataService=t}resolve(n,t){const r=n.paramMap.get("id"),i=this.router.events.pipe((0,Me.h)(c=>c instanceof h.wM)),l=this.dataService.order.getOrder(r).mapStream(c=>c.order).pipe((0,_.w)(c=>"Draft"===c?.state&&n.component!==J?(this.router.navigate(["/orders/draft",r]),O.E):[c]),(0,ve.R)(i),(0,Me.h)(x.notNullOrUndefined),(0,Fe.d)(1));return l.pipe((0,T.q)(1),(0,y.U)(()=>l))}static#e=this.\u0275fac=function(t){return new(t||E)(e.LFG(h.F0),e.LFG(a.DoR))};static#t=this.\u0275prov=e.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"})}class A{constructor(n,t){this.dataService=n,this.router=t}canActivate(n,t){const r=t.url.includes("orders/draft"),i=n.paramMap.get("id");return!r||"create"!==i||this.dataService.order.createDraftOrder().pipe((0,y.U)(({createDraftOrder:l})=>this.router.parseUrl(`/orders/draft/${l.id}`)))}static#e=this.\u0275fac=function(t){return new(t||A)(e.LFG(a.DoR),e.LFG(h.F0))};static#t=this.\u0275prov=e.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"})}const ke=o=>[{path:"",component:a.IIO,pathMatch:"full",data:{locationId:"order-list",breadcrumb:(0,u.J)("breadcrumb.orders")},children:o.getPageTabRoutes("order-list")},{path:"draft/:id",component:a.IIO,canActivate:[A],data:{locationId:"draft-order-detail",breadcrumb:{label:(0,u.J)("breadcrumb.orders"),link:["../"]}},children:o.getPageTabRoutes("draft-order-detail")},{path:":id",component:a.IIO,canActivate:[A],data:{locationId:"order-detail",breadcrumb:{label:(0,u.J)("breadcrumb.orders"),link:["../"]}},children:o.getPageTabRoutes("order-detail")},{path:":aggregateOrderId/seller-orders/:id",component:a.IIO,canActivate:[A],data:{locationId:"order-detail",breadcrumb:{label:(0,u.J)("breadcrumb.orders"),link:["../"]}},children:o.getPageTabRoutes("order-detail")},{path:":id/modify",component:fe,resolve:{entity:E},data:{breadcrumb:Ne}}];function Je(o,n){return o.entity.pipe((0,y.U)(t=>t.aggregateOrder?[{label:"breadcrumb.orders",link:["../"]},{label:t.aggregateOrder.code,link:["../",t.aggregateOrder.id]},{label:(0,u.J)("breadcrumb.seller-orders"),link:["../",t.aggregateOrder.id]},{label:t.code,link:[t.id]}]:[{label:"breadcrumb.orders",link:["../"]},{label:t.code,link:[t.id]}]))}function Ne(o,n){return Je(o).pipe((0,y.U)(t=>{const r=t.slice();return r[1].link=["../",t[1].link[0]],r.concat({label:(0,u.J)("breadcrumb.modifying"),link:[""]})}))}class Y{static#e=this.hasRegisteredTabsAndBulkActions=!1;constructor(n){Y.hasRegisteredTabsAndBulkActions||(n.registerPageTab({priority:0,location:"order-list",tab:(0,u.J)("order.orders"),route:"",component:he}),n.registerPageTab({priority:0,location:"order-detail",tab:(0,u.J)("order.order"),route:"",component:(0,a.IX9)({component:ge,query:a.jCp,entityKey:"order",getBreadcrumbs:t=>t?.type===a.mrS.Seller&&t?.aggregateOrder?[{label:`${t?.aggregateOrder?.code}`,link:["/orders/",t?.aggregateOrder?.id]},{label:(0,u.J)("breadcrumb.seller-orders"),link:["/orders/",t?.aggregateOrder?.id]},{label:`${t?.code}`,link:[t?.id]}]:[{label:`${t?.code}`,link:[t?.id]}]})}),n.registerPageTab({priority:0,location:"draft-order-detail",tab:(0,u.J)("order.order"),route:"",component:(0,a.IX9)({component:J,query:a.jCp,entityKey:"order",getBreadcrumbs:t=>[{label:(0,u.J)("order.draft-order"),link:[t?.id]}]})}),Y.hasRegisteredTabsAndBulkActions=!0)}static#t=this.\u0275fac=function(t){return new(t||Y)(e.LFG(a.PhL))};static#n=this.\u0275mod=e.oAB({type:Y});static#r=this.\u0275inj=e.cJS({providers:[{provide:h.Z6,useFactory:n=>ke(n),multi:!0,deps:[a.PhL]}],imports:[a.m81,h.Bz.forChild([])]})}}}]);
//# sourceMappingURL=646.04bb8b92c46849d3.js.map