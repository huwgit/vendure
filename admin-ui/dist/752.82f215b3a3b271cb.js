"use strict";(self.webpackChunkvendure_admin=self.webpackChunkvendure_admin||[]).push([[752],{1752:(cc,Qe,h)=>{h.r(Qe),h.d(Qe,{ASSET_DETAIL_QUERY:()=>Hl,ApplyFacetDialogComponent:()=>j,AssetDetailComponent:()=>le,AssetListComponent:()=>ce,AssetsComponent:()=>G,AssignProductsToChannelDialogComponent:()=>Q,BulkAddFacetValuesDialogComponent:()=>se,COLLECTION_DETAIL_QUERY:()=>Kl,CatalogModule:()=>Ce,CollectionBreadcrumbPipe:()=>K,CollectionContentsComponent:()=>R,CollectionDataTableComponent:()=>H,CollectionDetailComponent:()=>de,CollectionListComponent:()=>ue,CollectionTreeComponent:()=>Pe,CollectionTreeNodeComponent:()=>B,CollectionTreeService:()=>Y,ConfirmVariantDeletionDialogComponent:()=>Te,CreateProductOptionGroupDialogComponent:()=>re,CreateProductVariantDialogComponent:()=>oe,FACET_DETAIL_QUERY:()=>Wl,FACET_LIST_QUERY:()=>ec,FacetDetailComponent:()=>me,FacetListComponent:()=>ge,GET_PRODUCTS_WITH_FACET_VALUES_BY_IDS:()=>tt,GET_PRODUCT_DETAIL:()=>tc,GET_VARIANTS_WITH_FACET_VALUES_BY_IDS:()=>nt,GenerateProductVariantsComponent:()=>_e,GeneratedVariant:()=>Rl,MoveCollectionsDialogComponent:()=>pe,OPTION_VALUE_INPUT_VALUE_ACCESSOR:()=>We,OptionValueInputComponent:()=>S,PRODUCT_LIST_QUERY:()=>rc,PRODUCT_VARIANT_DETAIL_QUERY:()=>oc,PRODUCT_VARIANT_DETAIL_QUERY_PRODUCT_VARIANT_FRAGMENT:()=>Ue,PRODUCT_VARIANT_LIST_QUERY:()=>lc,PRODUCT_VARIANT_UPDATE_MUTATION:()=>ac,ProductDetailComponent:()=>W,ProductDetailService:()=>q,ProductListComponent:()=>fe,ProductOptionsEditorComponent:()=>ne,ProductVariantDetailComponent:()=>be,ProductVariantListComponent:()=>z,ProductVariantQuickJumpComponent:()=>ve,ProductVariantsEditorComponent:()=>ae,ProductVariantsResolver:()=>ie,ProductVariantsTableComponent:()=>Ae,UPDATE_PRODUCTS_BULK:()=>rt,UPDATE_VARIANTS_BULK:()=>ot,UpdateProductOptionDialogComponent:()=>Ze,VariantPriceDetailComponent:()=>he,arrayToTree:()=>st,assignCollectionsToChannelBulkAction:()=>lt,assignFacetValuesToProductsBulkAction:()=>ft,assignFacetsToChannelBulkAction:()=>pt,assignProductVariantsToChannelBulkAction:()=>ht,assignProductsToChannelBulkAction:()=>gt,createRoutes:()=>Xe,deleteCollectionsBulkAction:()=>at,deleteFacetsBulkAction:()=>dt,deleteProductVariantsBulkAction:()=>bt,deleteProductsBulkAction:()=>mt,moveCollectionsBulkAction:()=>it,productOptionsEditorBreadcrumb:()=>et,removeCollectionsFromChannelBulkAction:()=>ct,removeFacetsFromChannelBulkAction:()=>ut,removeFacetsFromChannelBulkAction2:()=>Xl,removeProductVariantsFromChannelBulkAction:()=>vt,removeProductsFromChannelBulkAction:()=>_t,replaceLast:()=>Ve});var Ct=h(741),e=h(4386),P=h(2583),p=h(8570),i=h(6058),xe=h(2664),J=h(4893),f=h(4369),b=h(4558),N=h(2774),$=h(3311),V=h(1788),X=h(7738),ke=h(9883),Se=h(633),O=h(5624),De=h(7341),xt=h(7402),yt=h(4389),Pt=h(5793),Tt=h(9330);var d=h(9348),ee=h(9481),F=h(4624),Zt=h(2480),T=h(9857),te=h(8540),Z=h(4162),D=h(8714),Je=h(725),Ge=h(4872),It=h(5246),kt=h(4255),Ye=h(8369),U=h(6),Fe=h(1930),_=h(6193),g=h(3740),C=h(7062),L=h(1873),Le=h(5074),A=h(6528),we=h(3888),k=h(4510),Ft=h(307),Lt=h(5846);function wt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",6),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.detailForm.pristine||t.detailForm.invalid),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}function Ot(o,n){if(1&o&&(e.ynx(0,19),e._UZ(1,"vdr-tabbed-custom-fields",20),e.ALo(2,"hasPermission"),e.BQk()),2&o){const t=e.oxw().$implicit,r=e.oxw(2);e.xp6(1),e.Q6J("customFields",r.optionGroupCustomFields)("customFieldsFormGroup",t.get("customFields"))("readonly",!e.lcZ(2,3,r.updatePermission))}}function Dt(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.value.id," ")}}function Jt(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.value.createdAt,"short")," ")}}function Mt(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.value.updatedAt,"short")," ")}}function Nt(o,n){if(1&o&&(e._UZ(0,"input",28),e.ALo(1,"hasPermission")),2&o){const t=n.item,r=e.oxw(4);e.Q6J("formControl",t.get("name"))("readonly",!e.lcZ(1,2,r.updatePermission))}}function Vt(o,n){if(1&o&&e._UZ(0,"input",29),2&o){const t=n.item;e.Q6J("formControl",t.get("code"))}}function $t(o,n){if(1&o&&(e._UZ(0,"vdr-tabbed-custom-fields",30),e.ALo(1,"hasPermission")),2&o){const t=n.item,r=e.oxw(4);e.Q6J("customFields",r.optionCustomFields)("compact",!0)("customFieldsFormGroup",t.get("customFields"))("readonly",!e.lcZ(1,4,r.updatePermission))}}function Ut(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-data-table-2",21),e.NdJ("pageChange",function(a){e.CHM(t);const l=e.oxw().$implicit,c=e.oxw(2);return e.KtG(c.paginationSettings[l.value.id].currentPage=a)}),e.TgZ(1,"vdr-dt2-column",22),e.ALo(2,"translate"),e.YNc(3,Dt,1,1,"ng-template"),e.qZA(),e.TgZ(4,"vdr-dt2-column",23),e.ALo(5,"translate"),e.YNc(6,Jt,2,4,"ng-template"),e.qZA(),e.TgZ(7,"vdr-dt2-column",24),e.ALo(8,"translate"),e.YNc(9,Mt,2,4,"ng-template"),e.qZA(),e.TgZ(10,"vdr-dt2-column",25),e.ALo(11,"translate"),e.YNc(12,Nt,2,4,"ng-template"),e.qZA(),e.TgZ(13,"vdr-dt2-column",26),e.ALo(14,"translate"),e.YNc(15,Vt,1,1,"ng-template"),e.qZA(),e.TgZ(16,"vdr-dt2-column",27),e.ALo(17,"translate"),e.YNc(18,$t,2,6,"ng-template"),e.qZA()()}if(2&o){const t=n.ngIf,r=e.oxw().$implicit,a=e.oxw(2);e.Q6J("items",t)("itemsPerPage",null==a.paginationSettings[r.value.id]?null:a.paginationSettings[r.value.id].itemsPerPage)("currentPage",null==a.paginationSettings[r.value.id]?null:a.paginationSettings[r.value.id].currentPage)("totalItems",t.length),e.xp6(1),e.Q6J("heading",e.lcZ(2,16,"common.id"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(5,18,"common.created-at"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(8,20,"common.updated-at"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(11,22,"common.name"))("optional",!1),e.xp6(3),e.Q6J("heading",e.lcZ(14,24,"common.code"))("optional",!1),e.xp6(3),e.Q6J("heading",e.lcZ(17,26,"common.custom-fields"))("hiddenByDefault",0===a.optionCustomFields.length)}}function qt(o,n){if(1&o&&(e.TgZ(0,"vdr-card",10),e._UZ(1,"vdr-page-entity-info",11),e.TgZ(2,"div",12)(3,"vdr-form-field",13),e.ALo(4,"translate"),e._UZ(5,"input",14),e.ALo(6,"hasPermission"),e.qZA(),e.TgZ(7,"vdr-form-field",15),e.ALo(8,"translate"),e._UZ(9,"input",16),e.ALo(10,"hasPermission"),e.qZA()(),e.YNc(11,Ot,3,5,"ng-container",17),e.YNc(12,Ut,19,28,"vdr-data-table-2",18),e.qZA()),2&o){const t=n.$implicit,r=n.index,a=e.oxw(2);e.Q6J("formArrayName",r)("title",t.value.code),e.xp6(1),e.Q6J("entity",t.value),e.xp6(2),e.Q6J("label",e.lcZ(4,11,"common.name")),e.xp6(2),e.Q6J("id","name-"+r)("readonly",!e.lcZ(6,13,a.updatePermission)),e.xp6(2),e.Q6J("label",e.lcZ(8,15,"common.code")),e.xp6(2),e.Q6J("id","code-"+r)("readonly",!e.lcZ(10,17,a.updatePermission)),e.xp6(2),e.Q6J("ngIf",a.optionGroupCustomFields.length),e.xp6(1),e.Q6J("ngIf",a.getOptions(t))}}function Qt(o,n){if(1&o&&(e.TgZ(0,"form",7)(1,"div",8),e.YNc(2,qt,13,19,"vdr-card",9),e.qZA()()),2&o){const t=e.oxw();e.Q6J("formGroup",t.detailForm),e.xp6(2),e.Q6J("ngForOf",t.getOptionGroups())}}function St(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.hij(" ",e.lcZ(1,1,"catalog.create-product-option-group"),"\n")}function Gt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",8),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.confirm())}),e._uU(4),e.ALo(5,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,3,"common.cancel")),e.xp6(2),e.Q6J("disabled",t.form.invalid),e.xp6(1),e.hij(" ",e.lcZ(5,5,"common.confirm")," ")}}function Yt(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.hij(" ",e.lcZ(1,1,"catalog.create-product-variant"),"\n")}function Bt(o,n){if(1&o&&(e.TgZ(0,"vdr-form-field",7),e._UZ(1,"ng-select",12),e.qZA()),2&o){const t=n.$implicit;e.Q6J("label",t.name),e.xp6(1),e.Q6J("items",t.options)("formControlName",t.code)}}function Et(o,n){1&o&&(e.TgZ(0,"clr-alert",13)(1,"clr-alert-item")(2,"span",14),e._uU(3),e.ALo(4,"translate"),e.qZA()()()),2&o&&(e.Q6J("clrAlertClosable",!1),e.xp6(3),e.hij(" ",e.lcZ(4,2,"catalog.cannot-create-variants-without-options")," "))}function jt(o,n){if(1&o&&(e.TgZ(0,"div",15)(1,"clr-alert",16)(2,"clr-alert-item")(3,"span",14),e._uU(4),e.ALo(5,"translate"),e.qZA()()()()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("clrAlertClosable",!1),e.xp6(3),e.lnq(" ",e.lcZ(5,4,"catalog.product-variant-exists"),": ",t.existingVariant.name," (",t.existingVariant.sku,") ")}}function Rt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",18),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.confirm())}),e._uU(4),e.ALo(5,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,3,"common.cancel")),e.xp6(2),e.Q6J("disabled",t.form.invalid||t.existingVariant||0===t.product.optionGroups.length),e.xp6(1),e.hij(" ",e.lcZ(5,5,"common.confirm")," ")}}const Ht=["textArea"],Kt=["editNameInput"];function zt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-chip",6),e.NdJ("iconClick",function(){const l=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.removeOption(l))}),e.TgZ(1,"span",7)(2,"input",8,9),e.NdJ("blur",function(a){const c=e.CHM(t).index,s=e.oxw(2);return e.KtG(s.updateOption(c,a))})("click",function(a){return a.cancelBubble=!0}),e.qZA()(),e.TgZ(4,"span",10),e.NdJ("click",function(a){const c=e.CHM(t).index,s=e.oxw(2);return e.KtG(s.editName(c,a))}),e._uU(5),e.qZA()()}if(2&o){const t=n.$implicit,r=n.last,a=n.index,l=e.oxw(2);e.ekj("selected",r&&l.lastSelected)("locked",t.locked),e.Q6J("icon",t.locked?"lock":"times")("colorFrom",l.groupName),e.xp6(1),e.Q6J("hidden",l.editingIndex!==a),e.xp6(1),e.Q6J("ngModel",t.name),e.xp6(2),e.ekj("editable",!t.locked&&!t.id),e.Q6J("hidden",l.editingIndex===a),e.xp6(1),e.Oqu(t.name)}}function Wt(o,n){if(1&o&&(e.TgZ(0,"div",4),e.YNc(1,zt,6,12,"vdr-chip",5),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.optionValues)}}function Xt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",17)(1,"vdr-form-field",18),e.ALo(2,"translate"),e.TgZ(3,"input",19),e.NdJ("ngModelChange",function(a){const c=e.CHM(t).$implicit;return e.KtG(c.name=a)}),e.qZA()(),e.TgZ(4,"vdr-form-field",20),e.ALo(5,"translate"),e.TgZ(6,"vdr-option-value-input",21,22),e.NdJ("add",function(a){const c=e.CHM(t).index,s=e.oxw();return e.KtG(s.addOption(c,a.name))})("remove",function(a){const c=e.CHM(t).index,s=e.oxw();return e.KtG(s.removeOption(c,a))}),e.qZA()(),e.TgZ(8,"div")(9,"button",23),e.NdJ("click",function(){const l=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.removeOptionGroup(l))}),e._UZ(10,"clr-icon",24),e.qZA()()()}if(2&o){const t=n.$implicit;e.xp6(1),e.Q6J("label",e.lcZ(2,7,"catalog.option")),e.xp6(2),e.Q6J("ngModel",t.name)("readonly",!t.isNew),e.xp6(1),e.Q6J("label",e.lcZ(5,9,"catalog.option-values")),e.xp6(2),e.Q6J("options",t.values)("groupName",t.name)("disabled",""===t.name)}}function en(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function tn(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function nn(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.updatedAt,"short")," ")}}function rn(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.name," ")}}function on(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.sku," ")}}function an(o,n){if(1&o&&(e.TgZ(0,"vdr-chip",28),e._uU(1),e.qZA()),2&o){const t=n.ngIf,r=e.oxw(2).$implicit;e.Q6J("colorFrom",r.code),e.xp6(1),e.Oqu(t.name)}}function ln(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",29)(1,"ng-select",30),e.NdJ("change",function(a){e.CHM(t);const l=e.oxw().item,c=e.oxw().$implicit,s=e.oxw();return e.KtG(s.setOptionToAddToVariant(l.id,c.id,null==a?null:a.id))}),e.qZA(),e.TgZ(2,"button",31),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().item,l=e.oxw(2);return e.KtG(l.addOptionToVariant(a))}),e._UZ(3,"clr-icon",32),e.qZA()()}if(2&o){const t=e.oxw().item,r=e.oxw().$implicit,a=e.oxw();e.xp6(1),e.Q6J("items",r.options),e.xp6(1),e.ekj("primary",!(null==a.optionsToAddToVariant[t.id]||!a.optionsToAddToVariant[t.id][r.id])),e.Q6J("disabled",!(null!=a.optionsToAddToVariant[t.id]&&a.optionsToAddToVariant[t.id][r.id]))}}function cn(o,n){if(1&o&&(e.YNc(0,an,2,2,"vdr-chip",26),e.YNc(1,ln,4,4,"ng-template",null,27,e.W1O)),2&o){const t=n.item,r=e.MAs(2),a=e.oxw().$implicit,l=e.oxw();e.Q6J("ngIf",l.getOption(t,a.id))("ngIfElse",r)}}function sn(o,n){if(1&o&&(e.TgZ(0,"vdr-dt2-column",25),e.YNc(1,cn,3,2,"ng-template"),e.qZA()),2&o){const t=n.$implicit;e.Q6J("heading",t.name)("id",t.code)}}function dn(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeCurrency")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.price,t.currencyCode)," ")}}function pn(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeCurrency")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.priceWithTax,t.currencyCode)," ")}}function un(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",33),e.NdJ("click",function(){const l=e.CHM(t).item,c=e.oxw();return e.KtG(c.deleteVariant(l))}),e._UZ(1,"clr-icon",34),e.qZA()}}function mn(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"catalog.add-facets"))}function gn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",3),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",4),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.selectValues())}),e._uU(4),e.ALo(5,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,3,"common.cancel")),e.xp6(2),e.Q6J("disabled",0===t.selectedValues.length),e.xp6(1),e.hij(" ",e.lcZ(5,5,"catalog.add-facets")," ")}}function _n(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",3),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.detailForm.invalid||t.detailForm.pristine),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}const fn=function(){return["UpdateCatalog","UpdateAsset"]},hn=function(){return{}},vn=function(){return["DeleteCatalog","DeleteAsset"]};function bn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"img",10),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.previewAsset(a.featuredAsset))}),e.ALo(1,"assetPreview"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("src",e.xi3(1,1,t.featuredAsset,"small"),e.LSH)}}function Cn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",11),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.selectAssets())}),e._UZ(1,"clr-icon",12),e.TgZ(2,"div"),e._uU(3),e.ALo(4,"translate"),e.qZA()()}2&o&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"catalog.no-featured-asset")))}function xn(o,n){1&o&&e.GkF(0)}function yn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.selectAssets())}),e._UZ(2,"clr-icon",14),e._uU(3),e.ALo(4,"translate"),e.qZA()()}2&o&&(e.xp6(3),e.hij(" ",e.lcZ(4,1,"asset.add-asset")," "))}function Pn(o,n){if(1&o&&(e.TgZ(0,"div",3)(1,"div",4),e.YNc(2,bn,2,4,"img",5),e.YNc(3,Cn,5,3,"div",6),e.qZA(),e.TgZ(4,"div",7),e.YNc(5,xn,1,0,"ng-container",8),e.YNc(6,yn,5,3,"div",9),e.qZA()()),2&o){const t=e.oxw(),r=e.MAs(4);e.xp6(2),e.Q6J("ngIf",t.featuredAsset),e.xp6(1),e.Q6J("ngIf",!t.featuredAsset),e.xp6(2),e.Q6J("ngTemplateOutlet",r),e.xp6(1),e.Q6J("vdrIfPermissions",t.updatePermissions)}}function Tn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"img",10),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.previewAsset(a.featuredAsset))}),e.ALo(1,"assetPreview"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("src",e.xi3(1,1,t.featuredAsset,"thumb"),e.LSH)}}function An(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",11),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.selectAssets())}),e._UZ(1,"clr-icon",17),e.qZA()}}function Zn(o,n){1&o&&e.GkF(0)}function In(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.selectAssets())}),e.ALo(1,"translate"),e._UZ(2,"clr-icon",14),e._uU(3),e.ALo(4,"translate"),e.qZA()}2&o&&(e.Q6J("title",e.lcZ(1,2,"asset.add-asset")),e.xp6(3),e.hij(" ",e.lcZ(4,4,"asset.add-asset")," "))}function kn(o,n){if(1&o&&(e.TgZ(0,"div",15),e.YNc(1,Tn,2,4,"img",5),e.YNc(2,An,2,0,"div",6),e.qZA(),e.YNc(3,Zn,1,0,"ng-container",8),e.YNc(4,In,5,6,"button",16)),2&o){const t=e.oxw(),r=e.MAs(4);e.xp6(1),e.Q6J("ngIf",t.featuredAsset),e.xp6(1),e.Q6J("ngIf",!t.featuredAsset),e.xp6(1),e.Q6J("ngTemplateOutlet",r),e.xp6(1),e.Q6J("vdrIfPermissions",t.updatePermissions)}}function Fn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",21),e.NdJ("cdkDropListDropped",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.dropListDropped(a))}),e.ALo(1,"hasPermission"),e.TgZ(2,"vdr-dropdown",22)(3,"div",23),e._UZ(4,"img",24),e.ALo(5,"assetPreview"),e.qZA(),e.TgZ(6,"vdr-dropdown-menu",25)(7,"button",26),e.NdJ("click",function(){const l=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.previewAsset(l))}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",27),e.NdJ("click",function(){const l=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.setAsFeatured(l))}),e.ALo(11,"hasPermission"),e._uU(12),e.ALo(13,"translate"),e.qZA(),e._UZ(14,"div",28),e.TgZ(15,"button",29),e.NdJ("click",function(){const l=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.removeAsset(l))}),e.ALo(16,"hasPermission"),e._uU(17),e.ALo(18,"translate"),e.qZA()()()()}if(2&o){const t=n.$implicit,r=n.index,a=e.oxw(2);e.Q6J("cdkDropListData",r)("cdkDropListDisabled",!e.lcZ(1,10,a.updatePermissions)),e.xp6(3),e.ekj("featured",a.isFeatured(t)),e.xp6(1),e.Q6J("src",e.xi3(5,12,t,"tiny"),e.LSH),e.xp6(4),e.hij(" ",e.lcZ(9,15,"asset.preview")," "),e.xp6(2),e.Q6J("disabled",a.isFeatured(t)||!e.lcZ(11,17,a.updatePermissions)),e.xp6(2),e.hij(" ",e.lcZ(13,19,"asset.set-as-featured-asset")," "),e.xp6(3),e.Q6J("disabled",!e.lcZ(16,21,a.updatePermissions)),e.xp6(2),e.hij(" ",e.lcZ(18,23,"asset.remove-asset")," ")}}function Ln(o,n){if(1&o&&(e.TgZ(0,"div",19),e.YNc(1,Fn,19,25,"div",20),e.qZA()),2&o){const t=e.oxw();e.ekj("compact",t.compact),e.xp6(1),e.Q6J("ngForOf",t.assets)}}function wn(o,n){1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"catalog.assign-variants-to-channel")))}function On(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"catalog.assign-products-to-channel"))}function Dn(o,n){if(1&o&&(e.YNc(0,wn,3,3,"ng-container",12),e.YNc(1,On,2,3,"ng-template",null,13,e.W1O)),2&o){const t=e.MAs(2),r=e.oxw();e.Q6J("ngIf",r.isProductVariantMode)("ngIfElse",t)}}const Be=function(o){return{channel:o}};function Jn(o,n){if(1&o&&(e._uU(0),e.ALo(1,"translate")),2&o){const t=e.oxw();e.hij(" ",e.xi3(1,1,"catalog.price-in-channel",e.VKq(4,Be,null==t.selectedChannel?null:t.selectedChannel.code))," ")}}function Mn(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.hij(" ",e.lcZ(1,1,"catalog.no-channel-selected")," ")}function Nn(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeCurrency")),2&o){const t=e.oxw().$implicit,r=e.oxw();e.hij(" ",e.xi3(1,1,t.pricePreview,null==r.selectedChannel?null:r.selectedChannel.defaultCurrencyCode)," ")}}function Vn(o,n){1&o&&e._uU(0," - ")}function $n(o,n){if(1&o&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"localeCurrency"),e.qZA(),e.TgZ(6,"td"),e.YNc(7,Nn,2,4,"ng-template",8),e.YNc(8,Vn,1,0,"ng-template",null,14,e.W1O),e.qZA()()),2&o){const t=n.$implicit,r=e.MAs(9),a=e.oxw();e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(e.xi3(5,4,t.price,null==a.currentChannel?null:a.currentChannel.defaultCurrencyCode)),e.xp6(3),e.Q6J("ngIf",a.selectedChannel)("ngIfElse",r)}}const Un=function(o){return{channelCode:o}};function qn(o,n){if(1&o&&(e._uU(0),e.ALo(1,"translate")),2&o){const t=e.oxw(2);e.hij(" ",e.xi3(1,1,"catalog.assign-to-named-channel",e.VKq(4,Un,null==t.selectedChannel?null:t.selectedChannel.code))," ")}}function Qn(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.hij(" ",e.lcZ(1,1,"catalog.no-channel-selected")," ")}function Sn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",16),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.assign())}),e.YNc(4,qn,2,6,"ng-template",8),e.YNc(5,Qn,2,3,"ng-template",null,9,e.W1O),e.qZA()}if(2&o){const t=e.MAs(6),r=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,4,"common.cancel")),e.xp6(2),e.Q6J("disabled",!r.selectedChannel),e.xp6(1),e.Q6J("ngIf",r.selectedChannel)("ngIfElse",t)}}function Gn(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.hij(" ",e.lcZ(1,1,"catalog.edit-facet-values"),"\n")}function Yn(o,n){if(1&o&&(e.TgZ(0,"div",14),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.sku)}}function Bn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-facet-value-chip",15),e.NdJ("remove",function(){const l=e.CHM(t).$implicit,c=e.oxw().$implicit,s=e.oxw(2);return e.KtG(s.removeFacetValue(c,l.id))}),e.qZA()}if(2&o){const t=n.$implicit;e.Q6J("facetValue",t)}}function En(o,n){if(1&o&&(e.TgZ(0,"tr")(1,"td",10)(2,"div"),e._uU(3),e.qZA(),e.YNc(4,Yn,2,1,"div",11),e.qZA(),e.TgZ(5,"td",12),e.YNc(6,Bn,1,1,"vdr-facet-value-chip",13),e.qZA()()),2&o){const t=n.$implicit;e.xp6(3),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",t.sku),e.xp6(2),e.Q6J("ngForOf",t.facetValues)}}function jn(o,n){if(1&o&&(e.TgZ(0,"table",8)(1,"tbody"),e.YNc(2,En,7,3,"tr",9),e.qZA()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.items)}}function Rn(o,n){1&o&&(e.TgZ(0,"div",16),e._UZ(1,"clr-spinner"),e.qZA())}function Hn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",18),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.addFacetValues())}),e._uU(4),e.ALo(5,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,3,"common.cancel")),e.xp6(2),e.Q6J("disabled",0===t.selectedValues.length&&!1===t.facetValuesRemoved),e.xp6(1),e.hij(" ",e.lcZ(5,5,"common.update")," ")}}function Kn(o,n){1&o&&e.GkF(0)}function zn(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function Wn(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function Xn(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.updatedAt,"short")," ")}}const er=function(o){return["/catalog/products",o]};function tr(o,n){if(1&o&&(e.TgZ(0,"a",11)(1,"span"),e._uU(2),e.qZA(),e._UZ(3,"clr-icon",12),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink",e.VKq(2,er,t.productId)),e.xp6(2),e.Oqu(t.name)}}function nr(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.sku," ")}}const rr=function(o){return{$implicit:o}},or=["collectionRow"];function ar(o,n){if(1&o&&e._UZ(0,"vdr-data-table-filter-presets",17),2&o){const t=e.oxw();e.Q6J("filters",t.filters)("dataTableId",t.id)}}function ir(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"th",18)(1,"div",19),e._UZ(2,"div",20),e.TgZ(3,"input",21),e.NdJ("change",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onToggleAllClick())}),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(3),e.Q6J("checked",null==t.selectionManager?null:t.selectionManager.areAllCurrentItemsSelected())}}function lr(o,n){1&o&&e._UZ(0,"clr-icon",31)}function cr(o,n){1&o&&e._UZ(0,"clr-icon",32)}function sr(o,n){1&o&&e._UZ(0,"clr-icon",33)}function dr(o,n){if(1&o&&(e.TgZ(0,"div",34),e._uU(1),e.qZA()),2&o){const t=e.oxw().ngIf;e.xp6(1),e.Oqu(t.sortOrder)}}function pr(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",25)(1,"button",26),e.NdJ("click",function(){const l=e.CHM(t).ngIf;return e.KtG(l.toggleSortOrder())}),e.YNc(2,lr,1,0,"clr-icon",27),e.YNc(3,cr,1,0,"clr-icon",28),e.YNc(4,sr,1,0,"clr-icon",29),e.qZA(),e.YNc(5,dr,2,1,"div",30),e.qZA()}if(2&o){const t=n.ngIf;e.xp6(1),e.ekj("active",t.sortOrder),e.xp6(1),e.Q6J("ngIf",!t.sortOrder),e.xp6(1),e.Q6J("ngIf","ASC"===t.sortOrder),e.xp6(1),e.Q6J("ngIf","DESC"===t.sortOrder),e.xp6(1),e.Q6J("ngIf",t.sortOrder)}}function ur(o,n){if(1&o&&(e.TgZ(0,"th")(1,"div",22)(2,"vdr-ui-extension-point",23)(3,"span"),e._uU(4),e.qZA()(),e.YNc(5,pr,6,6,"div",24),e.qZA()()),2&o){const t=n.$implicit,r=e.oxw();e.ekj("expand",t.expand),e.xp6(1),e.Q6J("ngClass",t.align),e.xp6(1),e.Q6J("locationId",r.id)("metadata",t.id)("topPx",-6)("leftPx",-24),e.xp6(2),e.Oqu(t.heading),e.xp6(1),e.Q6J("ngIf",t.sort)}}function mr(o,n){1&o&&e.GkF(0)}function gr(o,n){1&o&&e.GkF(0)}function _r(o,n){if(1&o&&e._UZ(0,"vdr-data-table-filters",43),2&o){const t=n.$implicit,r=e.oxw(3);e.Q6J("filterWithValue",t)("filters",r.filters)}}function fr(o,n){if(1&o&&e._UZ(0,"vdr-data-table-filters",44),2&o){const t=e.oxw(3);e.Q6J("filters",t.filters)}}function hr(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",40),e.YNc(2,_r,1,2,"vdr-data-table-filters",41),e.YNc(3,fr,1,1,"vdr-data-table-filters",42),e._UZ(4,"vdr-add-filter-preset-button",17),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.filters.activeFilters),e.xp6(1),e.Q6J("ngIf",t.filters.length),e.xp6(1),e.Q6J("filters",t.filters)("dataTableId",t.id)}}function vr(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"th",35)(2,"button",36),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.toggleSearchFilterRow())}),e.ALo(3,"translate"),e._UZ(4,"clr-icon",37),e.qZA(),e.TgZ(5,"div",38),e.YNc(6,mr,1,0,"ng-container",39),e.YNc(7,gr,1,0,"ng-container",39),e.YNc(8,hr,5,4,"ng-container",9),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(1),e.ekj("active",t.showSearchFilterRow),e.uIk("colspan",t.visibleSortedColumns.length+(t.selectionManager?2:1)),e.xp6(1),e.ekj("active",t.showSearchFilterRow),e.Q6J("title",e.lcZ(3,11,"common.search-and-filter-list")),e.xp6(3),e.ekj("hidden",!t.showSearchFilterRow),e.xp6(1),e.Q6J("ngTemplateOutlet",null==t.searchComponent?null:t.searchComponent.template),e.xp6(1),e.Q6J("ngTemplateOutlet",t.customSearchTemplate),e.xp6(1),e.Q6J("ngIf",t.filters)}}const br=function(o,n){return{item:o,i:n,depth:0}};function Cr(o,n){if(1&o&&(e.ynx(0),e.GkF(1,45),e.BQk()),2&o){const t=n.$implicit,r=n.index;e.oxw();const a=e.MAs(24);e.xp6(1),e.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",e.WLB(2,br,t,r))}}function xr(o,n){if(1&o&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"vdr-empty-placeholder",46),e.qZA()()),2&o){const t=e.oxw();e.xp6(1),e.uIk("colspan",t.visibleSortedColumns.length+(t.selectionManager?2:1)),e.xp6(1),e.Q6J("emptyStateLabel",t.emptyStateLabel)}}function yr(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-items-per-page-controls",47),e.NdJ("itemsPerPageChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.itemsPerPageChange.emit(a))}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("itemsPerPage",t.itemsPerPage)}}const Pr=function(o,n,t){return{currentStart:o,currentEnd:n,totalItems:t}};function Tr(o,n){if(1&o&&(e.TgZ(0,"div",48),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",e.xi3(2,1,"common.total-items",e.kEZ(4,Pr,t.currentStart,t.currentEnd,t.totalItems))," ")}}function Ar(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-pagination-controls",49),e.NdJ("pageChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.pageChange.emit(a))}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("id",t.id)("currentPage",t.currentPage)("itemsPerPage",t.itemsPerPage)("totalItems",t.totalItems)}}function Zr(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"td",18)(1,"div",19)(2,"div",55),e.ALo(3,"translate"),e._UZ(4,"clr-icon",56),e.qZA(),e.TgZ(5,"input",57),e.NdJ("click",function(a){e.CHM(t);const l=e.oxw().item,c=e.oxw();return e.KtG(c.onRowClick(l,a))}),e.qZA()()()}if(2&o){const t=e.oxw().item,r=e.oxw();e.ekj("active",r.activeIndex===r.absoluteIndex[t.id]),e.xp6(2),e.Q6J("title",e.lcZ(3,4,"catalog.reorder-collection")),e.xp6(3),e.Q6J("checked",null==r.selectionManager?null:r.selectionManager.isSelected(t))}}function Ir(o,n){1&o&&e.GkF(0)}const kr=function(o){return{rowItem:o}};function Fr(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Ir,1,0,"ng-container",60),e.BQk()),2&o){const t=n.ngIf,r=e.oxw(2).item;e.xp6(1),e.Q6J("ngComponentOutlet",t.config.component)("ngComponentOutletInputs",e.VKq(3,kr,r))("ngComponentOutletInjector",t.injector)}}function Lr(o,n){1&o&&e.GkF(0)}const Ee=function(o,n){return{item:o,depth:n}};function wr(o,n){if(1&o&&e.YNc(0,Lr,1,0,"ng-container",61),2&o){const t=e.oxw().$implicit,r=e.oxw(),a=r.item,l=r.depth;e.Q6J("ngTemplateOutlet",t.template)("ngTemplateOutletContext",e.WLB(2,Ee,a,l))}}function Or(o,n){if(1&o&&(e.TgZ(0,"td")(1,"div",22),e.YNc(2,Fr,2,5,"ng-container",58),e.YNc(3,wr,1,5,"ng-template",null,59,e.W1O),e.qZA()()),2&o){const t=n.$implicit,r=e.MAs(4),a=e.oxw().item,l=e.oxw();e.ekj("active",l.activeIndex===l.absoluteIndex[a.id]),e.xp6(1),e.Q6J("ngClass",t.align),e.xp6(1),e.Q6J("ngIf",l.customComponents.get(t.id))("ngIfElse",r)}}function Dr(o,n){1&o&&e.GkF(0)}function Jr(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Dr,1,0,"ng-container",61),e.BQk()),2&o){const t=n.$implicit,r=e.oxw().depth;e.oxw();const a=e.MAs(24);e.xp6(1),e.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",e.WLB(2,Ee,t,r+1))}}const Mr=function(o,n){return{depth:o,collection:n}};function Nr(o,n){if(1&o&&(e.TgZ(0,"tr",50,51),e.YNc(2,Zr,6,6,"td",52),e.YNc(3,Or,5,5,"td",53),e._UZ(4,"td"),e.qZA(),e.YNc(5,Jr,2,5,"ng-container",54)),2&o){const t=n.item,r=n.depth,a=e.oxw();e.Q6J("cdkDragData",e.WLB(6,Mr,r,t)),e.xp6(2),e.Q6J("ngIf",a.selectionManager),e.xp6(1),e.Q6J("ngForOf",a.visibleSortedColumns),e.xp6(1),e.ekj("active",a.activeIndex===a.absoluteIndex[t.id]),e.xp6(1),e.Q6J("ngForOf",a.getSubcollections(t))}}const Vr=[[["vdr-bulk-action-menu"]]],$r=function(o,n,t,r){return{itemsPerPage:o,currentPage:n,totalItems:t,id:r}},Ur=["vdr-bulk-action-menu"],qr=["collectionContents"];function Qr(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.detailForm.invalid||t.detailForm.pristine),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.create")," ")}}function Sr(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",(t.detailForm.invalid||t.detailForm.pristine)&&!t.assetsChanged()),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}function Gr(o,n){if(1&o&&e.YNc(0,Sr,3,4,"button",32),2&o){const t=e.oxw();e.Q6J("vdrIfPermissions",t.updatePermission)}}function Yr(o,n){1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"catalog.public")))}function Br(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"catalog.private"))}function Er(o,n){if(1&o&&(e.TgZ(0,"vdr-card"),e._UZ(1,"vdr-page-entity-info",33),e.qZA()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("entity",t)}}const jr=function(){return["/catalog/collections"]};function Rr(o,n){1&o&&(e.TgZ(0,"a",38),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,jr)),e.xp6(1),e.Oqu(e.lcZ(2,2,"catalog.root-collection")))}const Hr=function(o){return["/catalog/collections",o]};function Kr(o,n){if(1&o&&(e.TgZ(0,"a",38),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(4,Hr,t.id)),e.xp6(1),e.Oqu(e.lcZ(2,2,t.name))}}function zr(o,n){if(1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,t.name))}}function Wr(o,n){if(1&o&&(e.TgZ(0,"li"),e.YNc(1,Rr,3,5,"a",37),e.YNc(2,Kr,3,6,"a",37),e.YNc(3,zr,3,3,"ng-container",10),e.qZA()),2&o){const t=n.first,r=n.last;e.xp6(1),e.Q6J("ngIf",t),e.xp6(1),e.Q6J("ngIf",!t&&!r),e.xp6(1),e.Q6J("ngIf",r)}}function Xr(o,n){if(1&o&&(e.TgZ(0,"vdr-page-block")(1,"nav",34)(2,"ul",35),e.YNc(3,Wr,4,3,"li",36),e.qZA()()()),2&o){const t=n.ngIf;e.xp6(3),e.Q6J("ngForOf",t.breadcrumbs)}}function eo(o,n){if(1&o&&(e.TgZ(0,"vdr-card",39),e.ALo(1,"translate"),e._UZ(2,"vdr-tabbed-custom-fields",40),e.ALo(3,"hasPermission"),e.qZA()),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,4,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.detailForm.get("customFields"))("readonly",!e.lcZ(3,6,t.updatePermission))}}function to(o,n){1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"catalog.inherit-filters-from-parent")))}function no(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"catalog.do-not-inherit-filters"))}function ro(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"vdr-configurable-input",41),e.NdJ("remove",function(){const l=e.CHM(t).index,c=e.oxw();return e.KtG(c.removeFilter(l))}),e.ALo(2,"hasPermission"),e.qZA(),e.BQk()}if(2&o){const t=n.$implicit,r=n.index,a=e.oxw();e.xp6(1),e.Q6J("position",r)("operation",t)("operationDefinition",a.getFilterDefinition(t))("formControlName",r)("readonly",!e.lcZ(2,5,a.updatePermission))}}function oo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",47),e.NdJ("click",function(){const l=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.addFilter(l))}),e._uU(1),e.qZA()}if(2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.description," ")}}function ao(o,n){if(1&o&&(e.TgZ(0,"div")(1,"vdr-dropdown")(2,"button",42),e._UZ(3,"clr-icon",43),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e._UZ(7,"clr-icon",44),e.qZA(),e.TgZ(8,"vdr-dropdown-menu",45),e.YNc(9,oo,2,1,"button",46),e.qZA()()()),2&o){const t=e.oxw();e.xp6(5),e.Oqu(e.lcZ(6,2,"marketing.add-condition")),e.xp6(4),e.Q6J("ngForOf",t.allFilters)}}const je=function(o){return{count:o}},io=function(){return{standalone:!0}};function lo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",48)(1,"div",49),e._uU(2),e.ALo(3,"translate"),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"clr-checkbox-wrapper")(6,"input",50),e.NdJ("ngModelChange",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.toggleLivePreview())}),e.qZA(),e.TgZ(7,"label"),e._uU(8),e.ALo(9,"translate"),e.qZA()()()}if(2&o){const t=n.$implicit,r=e.oxw();let a,l;e.xp6(2),e.AsE(" ",e.lcZ(3,8,"catalog.collection-contents")," (",e.xi3(4,10,"common.results-count",e.VKq(15,je,t)),") "),e.xp6(3),e.ekj("disabled",null==(a=r.detailForm.get("filters"))?null:a.pristine),e.xp6(1),e.Q6J("ngModelOptions",e.DdM(17,io))("disabled",null==(l=r.detailForm.get("filters"))?null:l.pristine)("ngModel",r.livePreview),e.xp6(2),e.Oqu(e.lcZ(9,13,"catalog.live-preview-contents"))}}const Me=function(o){return{pattern:o}};function co(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.hij(" ",e.lcZ(1,1,"catalog.move-collections"),"\n")}function so(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function po(o,n){if(1&o&&e._UZ(0,"clr-icon",12),2&o){const t=e.oxw().depth;e.ekj("transparent",0===t)}}function uo(o,n){1&o&&e._UZ(0,"clr-icon",16)}function mo(o,n){1&o&&e._UZ(0,"clr-icon",17)}function go(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().item,l=e.oxw();return e.KtG(l.toggleExpanded(a))}),e.YNc(1,uo,1,0,"clr-icon",14),e.YNc(2,mo,1,0,"clr-icon",15),e.qZA()}if(2&o){const t=e.oxw().item,r=e.oxw();e.xp6(1),e.Q6J("ngIf",!r.expandedIds.includes(t.id)),e.xp6(1),e.Q6J("ngIf",r.expandedIds.includes(t.id))}}function _o(o,n){1&o&&(e.TgZ(0,"button",18),e._UZ(1,"clr-icon",19),e.qZA())}const fo=function(o){return{name:o}};function ho(o,n){if(1&o){const t=e.EpF();e._UZ(0,"div",7),e.YNc(1,po,1,2,"clr-icon",8),e.YNc(2,go,3,2,"button",9),e.YNc(3,_o,2,0,"button",10),e.TgZ(4,"button",11),e.NdJ("click",function(){const l=e.CHM(t).item,c=e.oxw();return e.KtG(c.resolveWith(l))}),e.TgZ(5,"span"),e._uU(6),e.ALo(7,"translate"),e.qZA()()}if(2&o){const t=n.item,r=n.depth;e.Q6J("ngClass","indent-"+r),e.xp6(1),e.Q6J("ngIf",!(null!=t.children&&t.children.length)&&"__"!==t.parentId),e.xp6(1),e.Q6J("ngIf",null==t.children?null:t.children.length),e.xp6(1),e.Q6J("ngIf","__"===t.parentId),e.xp6(3),e.Oqu(e.xi3(7,5,"catalog.move-collection-to",e.VKq(8,fo,t.name)))}}function vo(o,n){if(1&o&&(e.TgZ(0,"div")(1,"span",24),e._uU(2,"/"),e.qZA(),e._uU(3),e.qZA()),2&o){const t=n.$implicit;e.xp6(3),e.hij("",t.name," ")}}function bo(o,n){if(1&o&&(e.ynx(0),e.YNc(1,vo,4,1,"div",23),e.BQk()),2&o){const t=e.oxw().ngIf;e.xp6(1),e.Q6J("ngForOf",t)}}function Co(o,n){1&o&&(e.TgZ(0,"span",24),e._uU(1,"/"),e.qZA())}function xo(o,n){if(1&o&&(e.ynx(0),e.YNc(1,bo,2,1,"ng-container",21),e.YNc(2,Co,2,0,"span",22),e.BQk()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("ngIf",t.length),e.xp6(1),e.Q6J("ngIf",!t.length)}}function yo(o,n){if(1&o&&(e.TgZ(0,"div",20),e.YNc(1,xo,3,2,"ng-container",21),e.ALo(2,"collectionBreadcrumb"),e.qZA()),2&o){const t=n.item;e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,t))}}function Po(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.slug," ")}}const Ne=function(){return["./create"]};function To(o,n){1&o&&(e.TgZ(0,"a",6),e._UZ(1,"clr-icon",7),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,Ne)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"catalog.create-new-collection")," "))}function Ao(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function Zo(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function Io(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.updatedAt,"short")," ")}}function ko(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.position," ")}}function Fo(o,n){if(1&o&&e._UZ(0,"clr-icon",26),2&o){const t=e.oxw().depth;e.ekj("transparent",0===t)}}function Lo(o,n){1&o&&e._UZ(0,"clr-icon",30)}function wo(o,n){1&o&&e._UZ(0,"clr-icon",31)}function Oo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().item,l=e.oxw(2);return e.KtG(l.toggleExpanded(a))}),e.YNc(1,Lo,1,0,"clr-icon",28),e.YNc(2,wo,1,0,"clr-icon",29),e.qZA()}if(2&o){const t=e.oxw().item,r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!r.expandedIds.includes(t.id)),e.xp6(1),e.Q6J("ngIf",r.expandedIds.includes(t.id))}}const ye=function(o){return["./",o]};function Do(o,n){if(1&o&&(e._UZ(0,"div",21),e.YNc(1,Fo,1,2,"clr-icon",22),e.YNc(2,Oo,3,2,"button",23),e.TgZ(3,"a",24)(4,"span"),e._uU(5),e.qZA(),e._UZ(6,"clr-icon",25),e.qZA()),2&o){const t=n.item,r=n.depth;e.Q6J("ngClass","indent-"+r),e.xp6(1),e.Q6J("ngIf",!(null!=t.children&&t.children.length)),e.xp6(1),e.Q6J("ngIf",null==t.children?null:t.children.length),e.xp6(1),e.Q6J("routerLink",e.VKq(5,ye,t.id)),e.xp6(2),e.Oqu(t.name)}}function Jo(o,n){if(1&o&&(e.TgZ(0,"div")(1,"span",36),e._uU(2,"/"),e.qZA(),e._uU(3),e.qZA()),2&o){const t=n.$implicit;e.xp6(3),e.hij("",t.name," ")}}function Mo(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Jo,4,1,"div",35),e.BQk()),2&o){const t=e.oxw().ngIf;e.xp6(1),e.Q6J("ngForOf",t)}}function No(o,n){1&o&&(e.TgZ(0,"span",36),e._uU(1,"/"),e.qZA())}function Vo(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Mo,2,1,"ng-container",33),e.YNc(2,No,2,0,"span",34),e.BQk()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("ngIf",t.length),e.xp6(1),e.Q6J("ngIf",!t.length)}}function $o(o,n){if(1&o&&(e.TgZ(0,"div",32),e.YNc(1,Vo,3,2,"ng-container",33),e.ALo(2,"collectionBreadcrumb"),e.qZA()),2&o){const t=n.item;e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,t))}}function Uo(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.slug," ")}}function qo(o,n){1&o&&(e.TgZ(0,"vdr-chip",39),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.private")))}function Qo(o,n){1&o&&(e.TgZ(0,"vdr-chip",40),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.public")))}function So(o,n){if(1&o&&(e.YNc(0,qo,3,3,"vdr-chip",37),e.YNc(1,Qo,3,3,"vdr-chip",38)),2&o){const t=n.item;e.Q6J("ngIf",t.isPrivate),e.xp6(1),e.Q6J("ngIf",!t.isPrivate)}}const Re=function(o){return{contents:o}};function Go(o,n){if(1&o&&(e.TgZ(0,"a",41)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"clr-icon",42),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink",e.VKq(6,ye,e.VKq(4,Re,t.id))),e.xp6(2),e.Oqu(e.lcZ(3,2,"common.view-contents"))}}function Yo(o,n){if(1&o&&e._UZ(0,"vdr-dt2-custom-field-column",43),2&o){const t=n.$implicit,r=e.oxw(2);e.Q6J("customField",t)("sorts",r.sorts)}}function Bo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-collection-data-table",8),e.NdJ("pageChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.setPageNumber(a))})("itemsPerPageChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.setItemsPerPage(a))})("changeOrder",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onRearrange(a))}),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async"),e.ALo(4,"async"),e.ALo(5,"async"),e.ALo(6,"async"),e._UZ(7,"vdr-bulk-action-menu",9)(8,"vdr-dt2-search",10),e.ALo(9,"translate"),e.TgZ(10,"vdr-dt2-column",11),e.ALo(11,"translate"),e.YNc(12,Ao,1,1,"ng-template"),e.qZA(),e.TgZ(13,"vdr-dt2-column",12),e.ALo(14,"translate"),e.YNc(15,Zo,2,4,"ng-template"),e.qZA(),e.TgZ(16,"vdr-dt2-column",13),e.ALo(17,"translate"),e.YNc(18,Io,2,4,"ng-template"),e.qZA(),e.TgZ(19,"vdr-dt2-column",14),e.ALo(20,"translate"),e.YNc(21,ko,1,1,"ng-template"),e.qZA(),e.TgZ(22,"vdr-dt2-column",15),e.ALo(23,"translate"),e.YNc(24,Do,7,7,"ng-template"),e.qZA(),e.TgZ(25,"vdr-dt2-column",16),e.ALo(26,"translate"),e.YNc(27,$o,3,3,"ng-template"),e.qZA(),e.TgZ(28,"vdr-dt2-column",17),e.ALo(29,"translate"),e.YNc(30,Uo,1,1,"ng-template"),e.qZA(),e.TgZ(31,"vdr-dt2-column",18),e.ALo(32,"translate"),e.YNc(33,So,2,2,"ng-template"),e.qZA(),e.TgZ(34,"vdr-dt2-column",19),e.ALo(35,"translate"),e.YNc(36,Go,5,8,"ng-template"),e.qZA(),e.YNc(37,Yo,1,2,"vdr-dt2-custom-field-column",20),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("items",e.lcZ(1,32,t.items$))("subCollections",e.lcZ(2,34,t.subCollections$))("itemsPerPage",e.lcZ(3,36,t.itemsPerPage$))("totalItems",e.lcZ(4,38,t.totalItems$))("currentPage",e.lcZ(5,40,t.currentPage$))("filters",t.filters)("activeIndex",e.lcZ(6,42,t.activeCollectionIndex$)),e.xp6(7),e.Q6J("hostComponent",t)("selectionManager",t.selectionManager),e.xp6(1),e.Q6J("searchTermControl",t.searchTermControl)("searchTermPlaceholder",e.lcZ(9,44,"common.search-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(11,46,"common.id"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(14,48,"common.created-at"))("hiddenByDefault",!0)("sort",t.sorts.get("createdAt")),e.xp6(3),e.Q6J("heading",e.lcZ(17,50,"common.updated-at"))("hiddenByDefault",!0)("sort",t.sorts.get("updatedAt")),e.xp6(3),e.Q6J("heading",e.lcZ(20,52,"common.position"))("hiddenByDefault",!0)("sort",t.sorts.get("position")),e.xp6(3),e.Q6J("heading",e.lcZ(23,54,"common.name"))("optional",!1)("sort",t.sorts.get("name")),e.xp6(3),e.Q6J("heading",e.lcZ(26,56,"common.breadcrumb")),e.xp6(3),e.Q6J("heading",e.lcZ(29,58,"common.slug"))("sort",t.sorts.get("slug")),e.xp6(3),e.Q6J("heading",e.lcZ(32,60,"common.visibility")),e.xp6(3),e.Q6J("heading",e.lcZ(35,62,"common.view-contents"))("optional",!1),e.xp6(3),e.Q6J("ngForOf",t.customFields)}}function Eo(o,n){if(1&o&&(e.ynx(0),e._UZ(1,"vdr-collection-contents",44),e.ALo(2,"async"),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("collectionId",e.lcZ(2,1,t.activeCollectionId$))}}function jo(o,n){if(1&o&&(e.YNc(0,Eo,3,3,"ng-container",33),e.ALo(1,"async")),2&o){const t=e.oxw();e.Q6J("ngIf",e.lcZ(1,1,t.activeCollectionId$))}}const He=function(){return["CreateCatalog","CreateCollection"]};function Ho(o,n){1&o&&e._UZ(0,"clr-icon",32)}function Ko(o,n){1&o&&e._UZ(0,"clr-icon",33)}function zo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",29),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw();return e.KtG(l.toggleExpanded(a))}),e.YNc(1,Ho,1,0,"clr-icon",30),e.YNc(2,Ko,1,0,"clr-icon",31),e.qZA()}if(2&o){const t=e.oxw().$implicit,r=e.oxw();e.Q6J("disabled",r.expandAll),e.xp6(1),e.Q6J("ngIf",!t.expanded&&!r.expandAll),e.xp6(1),e.Q6J("ngIf",t.expanded||r.expandAll)}}function Wo(o,n){1&o&&e._UZ(0,"div",34)}function Xo(o,n){1&o&&(e.TgZ(0,"vdr-chip"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"catalog.private")))}function ea(o,n){1&o&&(e.TgZ(0,"div",35),e._UZ(1,"clr-icon",36),e.qZA())}const ta=function(o){return{parentId:o}},na=function(o){return["./","create",o]};function ra(o,n){if(1&o&&(e.TgZ(0,"a",37),e._UZ(1,"clr-icon",38),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(6,na,e.VKq(4,ta,t.id))),e.xp6(2),e.hij(" ",e.lcZ(3,2,"catalog.create-new-collection")," ")}}function oa(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){const l=e.CHM(t).$implicit,c=e.oxw().$implicit,s=e.oxw();return e.KtG(s.move(c,l.id))}),e.ALo(1,"async"),e.TgZ(2,"div",39)(3,"div",40),e._UZ(4,"clr-icon",41),e.qZA(),e.TgZ(5,"div",42),e._uU(6),e.qZA()()()}if(2&o){const t=n.$implicit,r=e.oxw(2);e.Q6J("disabled",!e.lcZ(1,2,r.hasUpdatePermission$)),e.xp6(6),e.hij(" ",t.path," ")}}function aa(o,n){if(1&o&&e._UZ(0,"vdr-collection-tree-node",43),2&o){const t=e.oxw().$implicit,r=e.oxw();e.Q6J("expandAll",r.expandAll)("collectionTree",t)("activeCollectionId",r.activeCollectionId)("selectionManager",r.selectionManager)}}const ia=function(o){return["/catalog/collections/",o]},la=function(){return["UpdateCatalog","UpdateCollection"]};function ca(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",4)(2,"div")(3,"input",5),e.NdJ("click",function(a){const c=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.selectionManager.toggleSelection(c,a))}),e.qZA()(),e.TgZ(4,"div",6),e.YNc(5,zo,3,3,"button",7),e.YNc(6,Wo,1,0,"ng-template",null,8,e.W1O),e._uU(8),e.qZA(),e._UZ(9,"div",9),e.YNc(10,Xo,3,3,"vdr-chip",10),e.TgZ(11,"a",11),e._UZ(12,"clr-icon",12),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"a",13),e._UZ(16,"clr-icon",14),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.YNc(19,ea,2,0,"div",15),e.TgZ(20,"vdr-dropdown")(21,"button",16),e.NdJ("click",function(){const l=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.getMoveListItems(l))}),e._UZ(22,"clr-icon",17),e.qZA(),e.TgZ(23,"vdr-dropdown-menu",18),e.YNc(24,ra,4,8,"a",19),e._UZ(25,"div",20),e.TgZ(26,"button",21),e.NdJ("click",function(){const a=e.CHM(t),l=a.$implicit,c=a.index,s=e.oxw();return e.KtG(s.moveUp(l,c))}),e.ALo(27,"async"),e._UZ(28,"clr-icon",22),e._uU(29),e.ALo(30,"translate"),e.qZA(),e.TgZ(31,"button",21),e.NdJ("click",function(){const a=e.CHM(t),l=a.$implicit,c=a.index,s=e.oxw();return e.KtG(s.moveDown(l,c))}),e.ALo(32,"async"),e._UZ(33,"clr-icon",23),e._uU(34),e.ALo(35,"translate"),e.qZA(),e.TgZ(36,"h4",24),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.YNc(39,oa,7,4,"button",25),e._UZ(40,"div",20),e.TgZ(41,"button",26),e.NdJ("click",function(){const l=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.delete(l.id))}),e.ALo(42,"async"),e._UZ(43,"clr-icon",27),e._uU(44),e.ALo(45,"translate"),e.qZA()()()(),e.YNc(46,aa,1,4,"vdr-collection-tree-node",28),e.qZA()}if(2&o){const t=n.$implicit,r=n.index,a=e.MAs(7),l=e.oxw();e.ekj("private",t.isPrivate),e.Q6J("cdkDragData",t),e.xp6(1),e.ekj("active",t.id===l.activeCollectionId),e.Q6J("ngClass","depth-"+l.depth),e.xp6(2),e.Q6J("checked",l.selectionManager.isSelected(t)),e.xp6(2),e.Q6J("ngIf",null==t.children?null:t.children.length)("ngIfElse",a),e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("ngIf",t.isPrivate),e.xp6(1),e.Q6J("routerLink",e.VKq(46,ye,e.VKq(44,Re,t.id))),e.xp6(2),e.hij(" ",e.lcZ(14,26,"catalog.view-contents")," "),e.xp6(2),e.Q6J("routerLink",e.VKq(48,ia,t.id)),e.xp6(2),e.hij(" ",e.lcZ(18,28,"common.edit")," "),e.xp6(2),e.Q6J("vdrIfPermissions",e.DdM(50,la)),e.xp6(5),e.Q6J("vdrIfPermissions",e.DdM(51,He)),e.xp6(2),e.Q6J("disabled",0===r||!e.lcZ(27,30,l.hasUpdatePermission$)),e.xp6(3),e.hij(" ",e.lcZ(30,32,"catalog.move-up")," "),e.xp6(2),e.Q6J("disabled",r===l.collectionTree.children.length-1||!e.lcZ(32,34,l.hasUpdatePermission$)),e.xp6(3),e.hij(" ",e.lcZ(35,36,"catalog.move-down")," "),e.xp6(3),e.Oqu(e.lcZ(38,38,"catalog.move-to")),e.xp6(2),e.Q6J("ngForOf",l.moveListItems),e.xp6(2),e.Q6J("disabled",!e.lcZ(42,40,l.hasDeletePermission$)),e.xp6(3),e.hij(" ",e.lcZ(45,42,"common.delete")," "),e.xp6(2),e.Q6J("ngIf",t.expanded||l.expandAll)}}function sa(o,n){if(1&o&&e._UZ(0,"vdr-collection-tree-node",1),2&o){const t=e.oxw();e.Q6J("expandAll",t.expandAll)("collectionTree",t.collectionTree)("selectionManager",t.selectionManager)("activeCollectionId",t.activeCollectionId)}}function da(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.hij(" ",e.lcZ(1,1,"catalog.confirm-deletion-of-unused-variants-title"),"\n")}function pa(o,n){if(1&o&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.AsE("",t.name," (",t.sku,")")}}function ua(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",3),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",4),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.confirm())}),e._uU(4),e.ALo(5,"translate"),e.qZA()}2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,2,"common.cancel")),e.xp6(3),e.hij(" ",e.lcZ(5,4,"common.confirm")," "))}function ma(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.detailForm.invalid||t.detailForm.pristine),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.create")," ")}}function ga(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",t.detailForm.invalid||t.detailForm.pristine),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}function _a(o,n){if(1&o&&e.YNc(0,ga,3,4,"button",21),2&o){const t=e.oxw();e.Q6J("vdrIfPermissions",t.updatePermission)}}function fa(o,n){1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"catalog.public")))}function ha(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"catalog.private"))}function va(o,n){if(1&o&&e._UZ(0,"vdr-page-entity-info",22),2&o){const t=n.ngIf;e.Q6J("entity",t)}}function ba(o,n){if(1&o&&(e.TgZ(0,"vdr-card",23),e.ALo(1,"translate"),e._UZ(2,"vdr-tabbed-custom-fields",24),e.ALo(3,"hasPermission"),e.qZA()),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,4,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.detailForm.get("facet.customFields"))("readonly",!e.lcZ(3,6,t.updatePermission))}}function Ca(o,n){if(1&o&&(e._UZ(0,"input",29),e.ALo(1,"translate")),2&o){const t=e.oxw(2);e.Q6J("formControl",t.filterControl)("placeholder",e.lcZ(1,2,"catalog.filter-by-name"))}}function xa(o,n){1&o&&(e.ynx(0),e.TgZ(1,"th"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.BQk()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"common.custom-fields")))}const ya=function(o){return["values",o,"customFields"]};function Pa(o,n){if(1&o&&(e.TgZ(0,"td",45),e._UZ(1,"vdr-tabbed-custom-fields",46),e.ALo(2,"hasPermission"),e.qZA()),2&o){const t=e.oxw().$implicit,r=e.oxw(3);e.xp6(1),e.Q6J("customFields",r.customValueFields)("compact",!0)("customFieldsFormGroup",r.detailForm.get(e.VKq(6,ya,t.id)))("readonly",!e.lcZ(2,4,r.updatePermission))}}const Ta=function(o){return["values",o]};function Aa(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"tr",35)(1,"td",36),e._UZ(2,"vdr-entity-info",22),e.qZA(),e.TgZ(3,"td",36)(4,"input",37),e.NdJ("input",function(a){const c=e.CHM(t).$implicit,s=e.oxw(3);return e.KtG(s.updateValueCode(c.code,a.target.value,c.id))}),e.ALo(5,"hasPermission"),e.qZA()(),e.TgZ(6,"td",36),e._UZ(7,"input",38),e.qZA(),e.YNc(8,Pa,3,8,"td",39),e.TgZ(9,"td",36)(10,"vdr-dropdown")(11,"button",40),e._UZ(12,"clr-icon",41),e.qZA(),e.TgZ(13,"vdr-dropdown-menu",42)(14,"button",43),e.NdJ("click",function(){const l=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.deleteFacetValue(l.id))}),e.ALo(15,"hasPermission"),e._UZ(16,"clr-icon",44),e._uU(17),e.ALo(18,"translate"),e.qZA()()()()()}if(2&o){const t=n.$implicit,r=e.oxw(3);e.Q6J("formGroup",r.detailForm.get(e.VKq(12,Ta,t.id))),e.xp6(2),e.Q6J("entity",t),e.xp6(2),e.Q6J("readonly",!e.lcZ(5,6,r.updatePermission)),e.xp6(4),e.Q6J("ngIf",r.customValueFields.length),e.xp6(6),e.Q6J("disabled",!e.lcZ(15,8,r.updatePermission)),e.xp6(3),e.hij(" ",e.lcZ(18,10,"common.delete")," ")}}const Za=function(o,n,t){return{currentPage:o,itemsPerPage:n,totalItems:t}};function Ia(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"table",30)(2,"thead")(3,"tr"),e._UZ(4,"th"),e.TgZ(5,"th"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"th"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.YNc(11,xa,4,3,"ng-container",27),e._UZ(12,"th"),e.qZA()(),e.TgZ(13,"tbody"),e.YNc(14,Aa,19,14,"tr",31),e.ALo(15,"paginate"),e.qZA()(),e.TgZ(16,"div",32)(17,"vdr-items-per-page-controls",33),e.NdJ("itemsPerPageChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.itemsPerPage=a)}),e.qZA(),e.TgZ(18,"vdr-pagination-controls",34),e.NdJ("pageChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.currentPage=a)}),e.qZA()(),e.BQk()}if(2&o){const t=n.ngIf,r=e.oxw(2);e.xp6(6),e.Oqu(e.lcZ(7,8,"common.name")),e.xp6(3),e.Oqu(e.lcZ(10,10,"common.code")),e.xp6(2),e.Q6J("ngIf",r.customValueFields.length),e.xp6(3),e.Q6J("ngForOf",e.xi3(15,12,t,e.kEZ(15,Za,r.currentPage,r.itemsPerPage,t.length))),e.xp6(3),e.Q6J("itemsPerPage",r.itemsPerPage),e.xp6(1),e.Q6J("currentPage",r.currentPage)("itemsPerPage",r.itemsPerPage)("totalItems",t.length)}}function ka(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",47),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.addFacetValue())}),e._UZ(1,"clr-icon",48),e._uU(2),e.ALo(3,"translate"),e.qZA()}2&o&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"catalog.add-facet-value")," "))}const Ke=function(){return["CreateCatalog","CreateFacet"]};function Fa(o,n){if(1&o&&(e.TgZ(0,"vdr-card",25),e.ALo(1,"translate"),e.YNc(2,Ca,2,4,"ng-template",26),e.YNc(3,Ia,19,19,"ng-container",27),e.ALo(4,"async"),e.TgZ(5,"div"),e.YNc(6,ka,4,3,"button",28),e.qZA()()),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,4,"catalog.facet-values"))("paddingX",!1),e.xp6(3),e.Q6J("ngIf",e.lcZ(4,6,t.filteredValues$)),e.xp6(3),e.Q6J("vdrIfPermissions",e.DdM(8,Ke))}}function La(o,n){1&o&&(e.TgZ(0,"a",14),e._UZ(1,"clr-icon",15),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,Ne)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"catalog.create-new-facet")," "))}function wa(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function Oa(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function Da(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.updatedAt,"short")," ")}}function Ja(o,n){if(1&o&&(e.TgZ(0,"a",16)(1,"span"),e._uU(2),e.qZA(),e._UZ(3,"clr-icon",17),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink",e.VKq(2,ye,t.id)),e.xp6(2),e.Oqu(t.name)}}function Ma(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.code," ")}}function Na(o,n){1&o&&(e.TgZ(0,"vdr-chip",20),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.private")))}function Va(o,n){1&o&&(e.TgZ(0,"vdr-chip",21),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.public")))}function $a(o,n){if(1&o&&(e.YNc(0,Na,3,3,"vdr-chip",18),e.YNc(1,Va,3,3,"vdr-chip",19)),2&o){const t=n.item;e.Q6J("ngIf",t.isPrivate),e.xp6(1),e.Q6J("ngIf",!t.isPrivate)}}function Ua(o,n){if(1&o&&e._UZ(0,"vdr-facet-value-chip",26),2&o){const t=n.$implicit;e.Q6J("facetValue",t)("removable",!1)("displayFacetName",!1)}}function qa(o,n){if(1&o&&(e.TgZ(0,"vdr-chip"),e._uU(1),e.qZA()),2&o){const t=e.oxw().item;e.xp6(1),e.hij(" ... + ",t.valueList.totalItems-t.valueList.items.length," ")}}function Qa(o,n){if(1&o&&(e.ynx(0),e._UZ(1,"clr-icon",15),e._uU(2),e.BQk()),2&o){const t=e.oxw(2).item,r=e.oxw();e.xp6(2),e.hij(" ",t.valueList.totalItems-r.initialLimit," ")}}function Sa(o,n){1&o&&e._UZ(0,"clr-icon",30)}function Ga(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().item,l=e.oxw();return e.KtG(l.toggleDisplayLimit(a))}),e.YNc(1,Qa,3,1,"ng-container",28),e.YNc(2,Sa,1,0,"ng-template",null,29,e.W1O),e.qZA()}if(2&o){const t=e.MAs(3),r=e.oxw().item,a=e.oxw();e.xp6(1),e.Q6J("ngIf",(a.displayLimit[r.id]||0)<r.valueList.items.length)("ngIfElse",t)}}function Ya(o,n){if(1&o&&(e.TgZ(0,"div",22),e.YNc(1,Ua,1,3,"vdr-facet-value-chip",23),e.ALo(2,"slice"),e.YNc(3,qa,2,1,"vdr-chip",24),e.YNc(4,Ga,4,2,"button",25),e.qZA()),2&o){const t=n.item,r=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.Dn7(2,3,t.valueList.items,0,r.displayLimit[t.id]||3)),e.xp6(2),e.Q6J("ngIf",r.displayLimit[t.id]<t.valueList.totalItems&&(r.displayLimit[t.id]||0)===t.valueList.items.length),e.xp6(1),e.Q6J("ngIf",t.valueList.items.length>r.initialLimit)}}function Ba(o,n){if(1&o&&e._UZ(0,"vdr-dt2-custom-field-column",31),2&o){const t=n.$implicit,r=e.oxw();e.Q6J("customField",t)("sorts",r.sorts)}}const Ea=["optionGroupName"];function ja(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"label"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"input",6,7),e.NdJ("ngModelChange",function(a){const c=e.CHM(t).$implicit;return e.KtG(c.name=a)})("keydown.enter",function(a){e.CHM(t);const l=e.MAs(12),c=e.oxw();return e.KtG(c.handleEnter(a,l))}),e.qZA()(),e.TgZ(7,"div",8)(8,"label"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"vdr-option-value-input",9,10),e.NdJ("ngModelChange",function(a){const c=e.CHM(t).$implicit;return e.KtG(c.values=a)})("ngModelChange",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.generateVariants())})("edit",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.generateVariants())}),e.qZA()(),e.TgZ(13,"div",11)(14,"button",12),e.NdJ("click",function(){const l=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.removeOption(l.name))}),e.ALo(15,"translate"),e._UZ(16,"clr-icon",13),e.qZA()()()}if(2&o){const t=n.$implicit;e.xp6(3),e.Oqu(e.lcZ(4,7,"catalog.option")),e.xp6(2),e.Q6J("ngModel",t.name),e.xp6(4),e.Oqu(e.lcZ(10,9,"catalog.option-values")),e.xp6(2),e.Q6J("ngModel",t.values)("groupName",t.name)("disabled",""===t.name),e.xp6(3),e.Q6J("title",e.lcZ(15,11,"catalog.remove-option"))}}function Ra(o,n){1&o&&(e.TgZ(0,"clr-alert",18)(1,"clr-alert-item")(2,"span",19),e._uU(3),e.ALo(4,"translate"),e.qZA()()()),2&o&&(e.Q6J("clrAlertClosable",!1),e.xp6(3),e.hij(" ",e.lcZ(4,2,"catalog.no-stock-locations-available-on-current-channel")," "))}function Ha(o,n){if(1&o&&(e.TgZ(0,"option",23),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function Ka(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-form-field",20),e.ALo(1,"translate"),e.TgZ(2,"select",21),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.selectedStockLocationId=a)}),e.YNc(3,Ha,2,2,"option",22),e.qZA()()}if(2&o){const t=e.oxw().ngIf,r=e.oxw();e.Q6J("label",e.lcZ(1,3,"catalog.add-stock-to-location")),e.xp6(2),e.Q6J("ngModel",r.selectedStockLocationId),e.xp6(1),e.Q6J("ngForOf",t)}}function za(o,n){1&o&&(e.TgZ(0,"th"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.create")))}function Wa(o,n){1&o&&(e.TgZ(0,"th"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"catalog.variant")))}function Xa(o,n){1&o&&(e.TgZ(0,"td"),e._UZ(1,"input",31),e.qZA())}function ei(o,n){if(1&o&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.values.join(" ")," ")}}function ti(o,n){if(1&o&&(e.TgZ(0,"tr",27),e.YNc(1,Xa,2,0,"td",3),e.YNc(2,ei,2,1,"td",3),e.TgZ(3,"td")(4,"vdr-form-field"),e._UZ(5,"input",28),e.ALo(6,"translate"),e.qZA()(),e.TgZ(7,"td")(8,"vdr-form-field"),e._UZ(9,"vdr-currency-input",29),e.qZA()(),e.TgZ(10,"td")(11,"vdr-form-field"),e._UZ(12,"input",30),e.qZA()()()),2&o){const t=n.$implicit,r=e.oxw(3);e.ekj("disabled",!!r.variantFormValues[t.id].value.enabled),e.Q6J("formGroup",r.variantFormValues[t.id]),e.xp6(1),e.Q6J("ngIf",1<r.variants.length),e.xp6(1),e.Q6J("ngIf",1<r.variants.length),e.xp6(3),e.Q6J("placeholder",e.lcZ(6,7,"catalog.sku")),e.xp6(4),e.Q6J("currencyCode",r.currencyCode)}}function ni(o,n){if(1&o&&(e.TgZ(0,"div",24)(1,"table",25)(2,"thead")(3,"tr"),e.YNc(4,za,3,3,"th",3),e.YNc(5,Wa,3,3,"th",3),e.TgZ(6,"th"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"th"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"th"),e._uU(13),e.ALo(14,"translate"),e.qZA()()(),e.YNc(15,ti,13,9,"tr",26),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("ngIf",1<t.variants.length),e.xp6(1),e.Q6J("ngIf",1<t.variants.length),e.xp6(2),e.Oqu(e.lcZ(8,7,"catalog.sku")),e.xp6(3),e.Oqu(e.lcZ(11,9,"catalog.price")),e.xp6(3),e.Oqu(e.lcZ(14,11,"catalog.stock-on-hand")),e.xp6(2),e.Q6J("ngForOf",t.variants)("ngForTrackBy",t.trackByFn)}}function ri(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Ra,5,4,"clr-alert",14),e.TgZ(2,"div",15),e.YNc(3,Ka,4,5,"vdr-form-field",16),e.qZA(),e.YNc(4,ni,16,13,"div",17),e.BQk()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("ngIf",0===t.length),e.xp6(2),e.Q6J("ngIf",t.length),e.xp6(1),e.Q6J("ngIf",0<t.length)}}function oi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-page-block")(1,"vdr-language-selector",15),e.NdJ("languageCodeChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.setLanguage(a))}),e.ALo(2,"async"),e.ALo(3,"async"),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("availableLanguageCodes",e.lcZ(2,2,t.availableLanguages$))("currentLanguageCode",e.lcZ(3,4,t.contentLanguage$))}}function ai(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function ii(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function li(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.updatedAt,"short")," ")}}function ci(o,n){if(1&o&&(e._UZ(0,"img",19),e.ALo(1,"assetPreview")),2&o){const t=n.ngIf;e.Q6J("src",e.xi3(1,1,t,"tiny"),e.LSH)}}function si(o,n){1&o&&(e.TgZ(0,"div",20),e._UZ(1,"clr-icon",21),e.qZA())}function di(o,n){if(1&o&&(e.TgZ(0,"div",16),e.YNc(1,ci,2,4,"img",17),e.YNc(2,si,2,0,"ng-template",null,18,e.W1O),e.qZA()),2&o){const t=n.item,r=e.MAs(3);e.xp6(1),e.Q6J("ngIf",t.featuredAsset)("ngIfElse",r)}}const pi=function(o,n){return["/catalog/products",o,"variants",n]};function ui(o,n){if(1&o&&(e.TgZ(0,"a",22)(1,"span"),e._uU(2),e.qZA(),e._UZ(3,"clr-icon",23),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink",e.WLB(2,pi,t.productId,t.id)),e.xp6(2),e.Oqu(t.name)}}function mi(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.sku," ")}}function gi(o,n){1&o&&(e.TgZ(0,"vdr-chip",26),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.enabled")))}function _i(o,n){1&o&&(e.TgZ(0,"vdr-chip",27),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.disabled")))}function fi(o,n){if(1&o&&(e.YNc(0,gi,3,3,"vdr-chip",24),e.YNc(1,_i,3,3,"vdr-chip",25)),2&o){const t=n.item;e.Q6J("ngIf",t.enabled),e.xp6(1),e.Q6J("ngIf",!t.enabled)}}function hi(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeCurrency")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.price,t.currencyCode)," ")}}function vi(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeCurrency")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.priceWithTax,t.currencyCode)," ")}}function bi(o,n){if(1&o&&(e.TgZ(0,"span",32),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij("(",t.stockAllocated," allocated)")}}function Ci(o,n){if(1&o&&(e.TgZ(0,"vdr-chip",29)(1,"div",30)(2,"div"),e._uU(3),e.YNc(4,bi,2,1,"span",31),e.qZA()()()),2&o){const t=n.$implicit;e.Q6J("title",null==t.stockLocation?null:t.stockLocation.name),e.xp6(3),e.hij(" ",t.stockOnHand,""),e.xp6(1),e.Q6J("ngIf",t.stockAllocated)}}function xi(o,n){if(1&o&&e.YNc(0,Ci,5,3,"vdr-chip",28),2&o){const t=n.item;e.Q6J("ngForOf",t.stockLevels)}}function yi(o,n){if(1&o&&e._UZ(0,"vdr-dt2-custom-field-column",33),2&o){const t=n.$implicit,r=e.oxw();e.Q6J("customField",t)("sorts",r.sorts)}}function Pi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.detailForm.invalid||t.detailForm.pristine||0===t.createVariantsConfig.variants.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.create")," ")}}function Ti(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",(t.detailForm.invalid||t.detailForm.pristine)&&!t.assetsChanged()),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}function Ai(o,n){if(1&o&&e.YNc(0,Ti,3,4,"button",29),2&o){const t=e.oxw();e.Q6J("vdrIfPermissions",t.updatePermissions)}}const ze=function(){return["enabled"]};function Zi(o,n){if(1&o&&(e.TgZ(0,"clr-toggle-wrapper"),e._UZ(1,"input",30),e.TgZ(2,"label"),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("formControl",t.detailForm.get(e.DdM(4,ze))),e.xp6(2),e.Oqu(e.lcZ(4,2,"common.enabled"))}}function Ii(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-chip",39),e.NdJ("iconClick",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(4);return e.KtG(l.removeFromChannel(a.id))}),e._UZ(1,"vdr-channel-badge",40),e._uU(2),e.ALo(3,"channelCodeToLabel"),e.qZA()}if(2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("channelCode",t.code),e.xp6(1),e.hij(" ",e.lcZ(3,2,t.code)," ")}}function ki(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Ii,4,4,"vdr-chip",38),e.BQk()),2&o){const t=n.$implicit,r=e.oxw(4);e.xp6(1),e.Q6J("ngIf",!r.isDefaultChannel(t.code))}}function Fi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-form-item")(1,"div",33)(2,"div",34),e.YNc(3,ki,2,1,"ng-container",35),e.ALo(4,"async"),e.qZA(),e.TgZ(5,"button",36),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.assignToChannel())}),e._UZ(6,"clr-icon",37),e._uU(7),e.ALo(8,"translate"),e.qZA()()()}if(2&o){const t=e.oxw(3);e.xp6(3),e.Q6J("ngForOf",e.lcZ(4,2,t.productChannels$)),e.xp6(4),e.hij(" ",e.lcZ(8,4,"catalog.assign-to-channel")," ")}}function Li(o,n){1&o&&(e.TgZ(0,"vdr-card",10),e.ALo(1,"translate"),e.YNc(2,Fi,9,6,"vdr-form-item",32),e.qZA()),2&o&&e.Q6J("title",e.lcZ(1,1,"common.channels"))}function wi(o,n){1&o&&(e.ynx(0),e.YNc(1,Li,3,3,"vdr-card",31),e.BQk())}function Oi(o,n){if(1&o&&(e.TgZ(0,"vdr-chip",44),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("colorFrom",t.code)("invert",!0),e.xp6(1),e.hij(" ",t.name," ")}}const Di=function(){return["options"]};function Ji(o,n){1&o&&(e.TgZ(0,"a",45),e._UZ(1,"clr-icon",46),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,Di)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"catalog.edit-options")," "))}function Mi(o,n){if(1&o&&(e.TgZ(0,"vdr-card",10),e.ALo(1,"translate"),e.TgZ(2,"div",41),e.YNc(3,Oi,2,3,"vdr-chip",42),e.ALo(4,"sort"),e.qZA(),e.TgZ(5,"div"),e.YNc(6,Ji,4,5,"a",43),e.qZA()()),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,3,"catalog.product-options")),e.xp6(3),e.Q6J("ngForOf",e.xi3(4,5,null==t.entity?null:t.entity.optionGroups,"id")),e.xp6(3),e.Q6J("vdrIfPermissions",t.updatePermissions)}}function Ni(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-facet-value-chip",47),e.NdJ("remove",function(){const l=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.removeProductFacetValue(l.id))}),e.ALo(1,"hasPermission"),e.qZA()}if(2&o){const t=n.$implicit,r=e.oxw();e.Q6J("facetValue",t)("removable",e.lcZ(1,2,r.updatePermissions))}}function Vi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",48),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.selectProductFacetValue())}),e._UZ(1,"clr-icon",49),e._uU(2),e.ALo(3,"translate"),e.qZA()}2&o&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"catalog.add-facets")," "))}function $i(o,n){if(1&o&&(e.TgZ(0,"vdr-card"),e._UZ(1,"vdr-page-entity-info",50),e.qZA()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("entity",t)}}function Ui(o,n){1&o&&(e.TgZ(0,"div")(1,"clr-checkbox-wrapper"),e._UZ(2,"input",51),e.TgZ(3,"label"),e._uU(4),e.ALo(5,"translate"),e.qZA()()()),2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"catalog.auto-update-product-variant-name")))}function qi(o,n){if(1&o&&(e.TgZ(0,"vdr-card",10),e.ALo(1,"translate"),e._UZ(2,"vdr-tabbed-custom-fields",52),e.ALo(3,"hasPermission"),e.qZA()),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,4,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.detailForm.get("customFields"))("readonly",!e.lcZ(3,6,t.updatePermissions))}}function Qi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"vdr-generate-product-variants",53),e.NdJ("variantsChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.createVariantsConfig=a)}),e.qZA()()}}function Si(o,n){if(1&o&&e._UZ(0,"vdr-product-variant-list",54),2&o){const t=e.oxw();e.Q6J("productId",t.id)("hideLanguageSelect",!0)}}const Gi=function(){return["manage-variants"]};function Yi(o,n){1&o&&(e.TgZ(0,"div",55)(1,"a",56),e._UZ(2,"clr-icon",57),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&o&&(e.xp6(1),e.Q6J("routerLink",e.DdM(4,Gi)),e.xp6(2),e.hij(" ",e.lcZ(4,2,"catalog.manage-variants"),""))}const Bi=function(){return["name"]};function Ei(o,n){1&o&&(e.TgZ(0,"a",20),e._UZ(1,"clr-icon",21),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,Ne)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"catalog.create-new-product")," "))}function ji(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function Ri(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function Hi(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.updatedAt,"short")," ")}}function Ki(o,n){if(1&o&&(e._UZ(0,"img",25),e.ALo(1,"assetPreview")),2&o){const t=n.ngIf;e.Q6J("src",e.xi3(1,1,t,"tiny"),e.LSH)}}function zi(o,n){1&o&&(e.TgZ(0,"div",26),e._UZ(1,"clr-icon",27),e.qZA())}function Wi(o,n){if(1&o&&(e.TgZ(0,"div",22),e.YNc(1,Ki,2,4,"img",23),e.YNc(2,zi,2,0,"ng-template",null,24,e.W1O),e.qZA()),2&o){const t=n.item,r=e.MAs(3);e.xp6(1),e.Q6J("ngIf",t.featuredAsset)("ngIfElse",r)}}function Xi(o,n){if(1&o&&(e.TgZ(0,"a",28)(1,"span"),e._uU(2),e.qZA(),e._UZ(3,"clr-icon",29),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink",e.VKq(2,ye,t.id)),e.xp6(2),e.Oqu(t.name)}}function el(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.slug," ")}}function tl(o,n){1&o&&(e.TgZ(0,"vdr-chip",32),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.enabled")))}function nl(o,n){1&o&&(e.TgZ(0,"vdr-chip",33),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.disabled")))}function rl(o,n){if(1&o&&(e.YNc(0,tl,3,3,"vdr-chip",30),e.YNc(1,nl,3,3,"vdr-chip",31)),2&o){const t=n.item;e.Q6J("ngIf",t.enabled),e.xp6(1),e.Q6J("ngIf",!t.enabled)}}function ol(o,n){if(1&o&&(e._uU(0),e.ALo(1,"translate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,"catalog.variant-count",e.VKq(4,je,null==t.variantList?null:t.variantList.totalItems))," ")}}function al(o,n){if(1&o&&e._UZ(0,"vdr-dt2-custom-field-column",34),2&o){const t=n.$implicit,r=e.oxw();e.Q6J("customField",t)("sorts",r.sorts)}}const il=function(){return["CreateCatalog","CreateProduct"]},cl=function(o){return{rate:o}};function sl(o,n){if(1&o&&(e.TgZ(0,"div",2),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"async"),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",e.xi3(2,1,"catalog.price-includes-tax-at",e.VKq(6,cl,e.lcZ(3,4,t.taxRate$))),"\n")}}const dl=function(o,n){return{price:o,rate:n}};function pl(o,n){if(1&o&&(e.TgZ(0,"div",2),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"localeCurrency"),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",e.xi3(2,1,"catalog.price-with-tax-in-default-zone",e.WLB(11,dl,e.xi3(3,4,e.lcZ(4,7,t.grossPrice$),t.currencyCode),e.lcZ(5,9,t.taxRate$))),"\n")}}function ul(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.AsE(" ",t.name," (",t.sku,") ")}}function ml(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"ng-select",1),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.selectedVariantId=a)})("change",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onSelect(a))}),e.ALo(1,"async"),e.ALo(2,"translate"),e.YNc(3,ul,1,2,"ng-template",2),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("items",e.lcZ(1,5,t.variants$))("ngModel",t.selectedVariantId)("searchFn",t.searchFn)("clearable",!1)("placeholder",e.lcZ(2,7,"catalog.quick-jump-placeholder"))}}function gl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-language-selector",8),e.NdJ("languageCodeChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.setLanguage(a))}),e.ALo(1,"async"),e.ALo(2,"async"),e.qZA()}if(2&o){const t=e.oxw().ngIf,r=e.oxw();e.Q6J("disabled",e.lcZ(1,3,r.isNew$))("availableLanguageCodes",t)("currentLanguageCode",e.lcZ(2,5,r.languageCode$))}}function _l(o,n){if(1&o&&(e.ynx(0),e.YNc(1,gl,3,7,"vdr-language-selector",7),e.BQk()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("ngIf",t.length>1)}}function fl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",(t.detailForm.invalid||t.stockLevelsForm.invalid||t.pricesForm.invalid||t.detailForm.pristine&&t.stockLevelsForm.pristine&&t.pricesForm.pristine)&&!t.assetsChanged()),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}function hl(o,n){if(1&o&&(e.TgZ(0,"clr-toggle-wrapper"),e._UZ(1,"input",38),e.TgZ(2,"label"),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("formControl",t.detailForm.get(e.DdM(4,ze))),e.xp6(2),e.Oqu(e.lcZ(4,2,"common.enabled"))}}function vl(o,n){if(1&o&&(e.TgZ(0,"vdr-chip",42)(1,"span"),e._uU(2),e.qZA(),e._uU(3),e.qZA()),2&o){const t=n.$implicit,r=e.oxw(3);e.Q6J("colorFrom",r.optionGroupCode(t.groupId))("invert",!0),e.xp6(2),e.hij("",r.optionGroupCode(t.groupId),":"),e.xp6(1),e.hij(" ",r.optionName(t)," ")}}const bl=function(){return["../../","options"]};function Cl(o,n){1&o&&(e.TgZ(0,"a",43),e._UZ(1,"clr-icon",44),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,bl)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"catalog.edit-options")," "))}function xl(o,n){if(1&o&&(e.TgZ(0,"vdr-card",14),e.ALo(1,"translate"),e.TgZ(2,"div",39),e.YNc(3,vl,4,4,"vdr-chip",40),e.ALo(4,"sort"),e.qZA(),e.TgZ(5,"div"),e.YNc(6,Cl,4,5,"a",41),e.qZA()()),2&o){const t=e.oxw().ngIf,r=e.oxw();e.Q6J("title",e.lcZ(1,3,"catalog.product-options")),e.xp6(3),e.Q6J("ngForOf",e.xi3(4,5,t.options,"groupId")),e.xp6(3),e.Q6J("vdrIfPermissions",r.updatePermissions)}}function yl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-facet-value-chip",45),e.NdJ("remove",function(){const l=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.removeFacetValue(l.id))}),e.ALo(1,"hasPermission"),e.qZA()}if(2&o){const t=n.$implicit,r=e.oxw(2);e.Q6J("facetValue",t)("removable",e.lcZ(1,2,r.updatePermissions))}}function Pl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",46),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.selectFacetValue())}),e._UZ(1,"clr-icon",47),e._uU(2),e.ALo(3,"translate"),e.qZA()}2&o&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"catalog.add-facets")," "))}function Tl(o,n){if(1&o&&e._UZ(0,"vdr-page-entity-info",48),2&o){const t=n.ngIf;e.Q6J("entity",t)}}function Al(o,n){if(1&o&&(e.TgZ(0,"vdr-card",14),e.ALo(1,"translate"),e._UZ(2,"vdr-tabbed-custom-fields",49),e.ALo(3,"hasPermission"),e.qZA()),2&o){const t=e.oxw(2);e.Q6J("title",e.lcZ(1,4,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.detailForm.get("customFields"))("readonly",!e.lcZ(3,6,t.updatePermissions))}}function Zl(o,n){if(1&o&&(e.TgZ(0,"option",33),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function Il(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"button",55),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.toggleDeletePrice(a.get("delete")))}),e._UZ(2,"clr-icon",56),e.qZA()()}if(2&o){const t=e.oxw().$implicit,r=e.oxw(2);e.xp6(1),e.Q6J("disabled",t.value.currencyCode===r.channelDefaultCurrencyCode)}}function kl(o,n){if(1&o&&(e.TgZ(0,"div",50)(1,"vdr-form-field",51),e.ALo(2,"translate"),e.ALo(3,"translate"),e.TgZ(4,"div",52),e._UZ(5,"vdr-currency-input",53),e.ALo(6,"hasPermission"),e.YNc(7,Il,3,1,"div",2),e.qZA()(),e._UZ(8,"vdr-variant-price-detail",54),e.ALo(9,"async"),e.qZA()),2&o){const t=n.$implicit,r=e.oxw(2);e.Q6J("formGroup",t),e.xp6(1),e.Q6J("label",e.lcZ(2,12,"catalog.price")+(1<r.pricesForm.length?" ("+t.value.currencyCode+")":""))("tooltip",1<r.pricesForm.length&&t.value.currencyCode===r.channelDefaultCurrencyCode?e.lcZ(3,14,"catalog.default-currency"):void 0),e.xp6(3),e.ekj("pending-deletion",!0===t.value.delete),e.xp6(1),e.Q6J("currencyCode",t.value.currencyCode)("readonly",!e.lcZ(6,16,r.updatePermissions)||!0===t.value.delete),e.xp6(2),e.Q6J("ngIf",1<r.pricesForm.controls.length),e.xp6(1),e.Q6J("price",t.value.price)("currencyCode",t.value.currencyCode)("priceIncludesTax",e.lcZ(9,18,r.channelPriceIncludesTax$))("taxCategoryId",r.detailForm.get("taxCategoryId").value)}}function Fl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",60),e.NdJ("click",function(){const l=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.addPriceInCurrency(l))}),e._uU(1),e.ALo(2,"localeCurrencyName"),e.qZA()}if(2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t)," ")}}function Ll(o,n){if(1&o&&(e.TgZ(0,"div")(1,"vdr-dropdown")(2,"button",57),e._UZ(3,"clr-icon",47),e._uU(4),e.ALo(5,"translate"),e._UZ(6,"clr-icon",58),e.qZA(),e.TgZ(7,"vdr-dropdown-menu"),e.YNc(8,Fl,3,3,"button",59),e.qZA()()()),2&o){const t=e.oxw().ngIf;e.xp6(4),e.hij(" ",e.lcZ(5,2,"catalog.add-price-in-another-currency")," "),e.xp6(4),e.Q6J("ngForOf",t)}}function wl(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Ll,9,4,"div",2),e.BQk()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("ngIf",t.length)}}function Ol(o,n){if(1&o&&(e.TgZ(0,"div",61)(1,"vdr-form-field",62),e.ALo(2,"translate"),e._UZ(3,"input",63),e.ALo(4,"hasPermission"),e.qZA(),e.TgZ(5,"vdr-form-item",64),e.ALo(6,"translate"),e._uU(7),e.qZA()()),2&o){const t=n.$implicit,r=e.oxw(2);let a,l,c,s,u;e.Q6J("formGroup",t),e.xp6(1),e.Q6J("label",(null==(a=t.get("stockLocationName"))?null:a.value)+": "+e.lcZ(2,7,"catalog.stock-on-hand"))("for","stockOnHand_"+(null==(l=t.get("stockLocationId"))?null:l.value)),e.xp6(2),e.Q6J("id","stockOnHand_"+(null==(c=t.get("stockLocationId"))?null:c.value))("readonly",!e.lcZ(4,9,r.updatePermissions)),e.xp6(2),e.Q6J("label",(null==(s=t.get("stockLocationName"))?null:s.value)+": "+e.lcZ(6,11,"catalog.stock-allocated")),e.xp6(2),e.hij(" ",null==(u=t.get("stockAllocated"))?null:u.value," ")}}function Dl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",60),e.NdJ("click",function(){const l=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.addStockLocation(l))}),e._UZ(1,"clr-icon",65),e._uU(2),e.qZA()}if(2&o){const t=n.$implicit;e.xp6(2),e.hij(" ",t.name," ")}}function Jl(o,n){if(1&o&&(e.TgZ(0,"div")(1,"vdr-dropdown")(2,"button",57),e._UZ(3,"clr-icon",47),e._uU(4),e.ALo(5,"translate"),e._UZ(6,"clr-icon",58),e.qZA(),e.TgZ(7,"vdr-dropdown-menu"),e.YNc(8,Dl,3,1,"button",59),e.qZA()()()),2&o){const t=e.oxw().ngIf;e.xp6(4),e.hij(" ",e.lcZ(5,2,"catalog.add-stock-location")," "),e.xp6(4),e.Q6J("ngForOf",t)}}function Ml(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Jl,9,4,"div",2),e.BQk()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("ngIf",t.length)}}const Oe=function(){return["UpdateCatalog","UpdateProduct"]};function Nl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"form",10)(1,"vdr-page-detail-layout")(2,"vdr-page-detail-sidebar")(3,"vdr-card")(4,"vdr-form-field",11),e.ALo(5,"translate"),e.YNc(6,hl,5,5,"clr-toggle-wrapper",12),e.qZA()(),e.YNc(7,xl,7,8,"vdr-card",13),e.TgZ(8,"vdr-card",14),e.ALo(9,"translate"),e.TgZ(10,"div",15),e.YNc(11,yl,2,4,"vdr-facet-value-chip",16),e.ALo(12,"async"),e.qZA(),e.TgZ(13,"div"),e.YNc(14,Pl,4,3,"button",17),e.qZA()(),e.TgZ(15,"vdr-card"),e.YNc(16,Tl,1,1,"vdr-page-entity-info",18),e.ALo(17,"async"),e.qZA()(),e.TgZ(18,"vdr-page-block"),e._UZ(19,"button",19),e.TgZ(20,"vdr-card")(21,"div",20)(22,"vdr-form-field",21),e.ALo(23,"translate"),e._UZ(24,"input",22),e.ALo(25,"hasPermission"),e.qZA(),e.TgZ(26,"vdr-form-field",23),e.ALo(27,"translate"),e._UZ(28,"input",24),e.ALo(29,"hasPermission"),e.qZA()()(),e.YNc(30,Al,4,8,"vdr-card",13),e._UZ(31,"vdr-custom-detail-component-host",25),e.TgZ(32,"vdr-card",14),e.ALo(33,"translate"),e.TgZ(34,"vdr-assets",26),e.NdJ("change",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.assetChanges=a)}),e.qZA()(),e.TgZ(35,"vdr-card",14),e.ALo(36,"translate"),e.TgZ(37,"div",20)(38,"vdr-form-field",27),e.ALo(39,"translate"),e.TgZ(40,"select",28),e.YNc(41,Zl,2,2,"option",29),e.ALo(42,"async"),e.qZA()()(),e.YNc(43,kl,10,20,"div",30),e.YNc(44,wl,2,1,"ng-container",2),e.ALo(45,"async"),e.qZA(),e.TgZ(46,"vdr-card",14),e.ALo(47,"translate"),e.TgZ(48,"div",20)(49,"vdr-form-field",31),e.ALo(50,"translate"),e.ALo(51,"translate"),e.TgZ(52,"select",32),e.ALo(53,"hasPermission"),e.TgZ(54,"option",33),e._uU(55),e.ALo(56,"translate"),e.qZA(),e.TgZ(57,"option",33),e._uU(58),e.ALo(59,"translate"),e.qZA(),e.TgZ(60,"option",33),e._uU(61),e.ALo(62,"translate"),e.qZA()()(),e.TgZ(63,"vdr-form-item",34),e.ALo(64,"translate"),e.ALo(65,"translate"),e._UZ(66,"input",35),e.ALo(67,"hasPermission"),e.TgZ(68,"clr-toggle-wrapper"),e._UZ(69,"input",36),e.ALo(70,"hasPermission"),e.TgZ(71,"label"),e._uU(72),e.ALo(73,"translate"),e.qZA()()()(),e.YNc(74,Ol,8,13,"div",37),e.YNc(75,Ml,2,1,"ng-container",2),e.ALo(76,"async"),e.qZA()()()()}if(2&o){const t=n.ngIf,r=e.oxw();let a;e.Q6J("formGroup",r.detailForm),e.xp6(4),e.Q6J("label",e.lcZ(5,43,"catalog.visibility")),e.xp6(2),e.Q6J("vdrIfPermissions",e.DdM(95,Oe)),e.xp6(1),e.Q6J("ngIf",t.options.length),e.xp6(1),e.Q6J("title",e.lcZ(9,45,"catalog.facets")),e.xp6(3),e.Q6J("ngForOf",e.lcZ(12,47,r.facetValues$)),e.xp6(3),e.Q6J("vdrIfPermissions",r.updatePermissions),e.xp6(2),e.Q6J("ngIf",e.lcZ(17,49,r.entity$)),e.xp6(6),e.Q6J("label",e.lcZ(23,51,"common.name")),e.xp6(2),e.Q6J("readonly",!e.lcZ(25,53,e.DdM(96,Oe))),e.xp6(2),e.Q6J("label",e.lcZ(27,55,"catalog.sku")),e.xp6(2),e.Q6J("readonly",!e.lcZ(29,57,r.updatePermissions)),e.xp6(2),e.Q6J("ngIf",r.customFields.length),e.xp6(1),e.Q6J("entity$",r.entity$)("detailForm",r.detailForm),e.xp6(1),e.Q6J("title",e.lcZ(33,59,"catalog.assets")),e.xp6(2),e.Q6J("assets",r.assetChanges.assets||t.assets)("featuredAsset",r.assetChanges.featuredAsset||t.featuredAsset)("updatePermissions",r.updatePermissions),e.xp6(1),e.Q6J("title",e.lcZ(36,61,"catalog.price-and-tax")),e.xp6(3),e.Q6J("label",e.lcZ(39,63,"catalog.tax-category")),e.xp6(3),e.Q6J("ngForOf",e.lcZ(42,65,r.taxCategories$)),e.xp6(2),e.Q6J("ngForOf",r.pricesForm.controls),e.xp6(1),e.Q6J("ngIf",e.lcZ(45,67,r.unusedCurrencyCodes$)),e.xp6(2),e.Q6J("title",e.lcZ(47,69,"catalog.stock-levels")),e.xp6(3),e.Q6J("label",e.lcZ(50,71,"catalog.track-inventory"))("tooltip",e.lcZ(51,73,"catalog.track-inventory-tooltip")),e.xp6(3),e.Q6J("disabled",!e.lcZ(53,75,r.updatePermissions)),e.xp6(2),e.Q6J("value",r.GlobalFlag.TRUE),e.xp6(1),e.hij(" ",e.lcZ(56,77,"catalog.track-inventory-true")," "),e.xp6(2),e.Q6J("value",r.GlobalFlag.FALSE),e.xp6(1),e.hij(" ",e.lcZ(59,79,"catalog.track-inventory-false")," "),e.xp6(2),e.Q6J("value",r.GlobalFlag.INHERIT),e.xp6(1),e.hij(" ",e.lcZ(62,81,"catalog.track-inventory-inherit")," "),e.xp6(2),e.Q6J("label",e.lcZ(64,83,"catalog.out-of-stock-threshold"))("tooltip",e.lcZ(65,85,"catalog.out-of-stock-threshold-tooltip")),e.xp6(3),e.Q6J("readonly",!e.lcZ(67,87,r.updatePermissions))("vdrDisabled",!1!==(null==(a=r.detailForm.get("useGlobalOutOfStockThreshold"))?null:a.value)||r.inventoryIsNotTracked(r.detailForm)),e.xp6(3),e.Q6J("vdrDisabled",!e.lcZ(70,89,r.updatePermissions)||r.inventoryIsNotTracked(r.detailForm)),e.xp6(3),e.AsE("",e.lcZ(73,91,"catalog.use-global-value")," (",r.globalOutOfStockThreshold,")"),e.xp6(2),e.Q6J("ngForOf",r.stockLevelsForm.controls),e.xp6(1),e.Q6J("ngIf",e.lcZ(76,93,r.unusedStockLocation$))}}function Vl(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"th"),e._uU(2),e.qZA(),e.BQk()),2&o){const t=n.$implicit;e.xp6(2),e.Oqu(t.name)}}function $l(o,n){if(1&o&&(e._UZ(0,"img",18),e.ALo(1,"assetPreview")),2&o){const t=n.ngIf;e.Q6J("src",e.xi3(1,1,t,"tiny"),e.LSH)}}function Ul(o,n){1&o&&(e.TgZ(0,"div",19),e._UZ(1,"clr-icon",20),e.qZA())}function ql(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"td",5),e.ALo(2,"stringToColor"),e._uU(3),e.qZA(),e.BQk()),2&o){const t=n.$implicit,r=e.oxw().ngIf,a=e.oxw(2);e.xp6(1),e.Udp("color",e.lcZ(2,5,a.optionGroupName(t.groupId))),e.ekj("disabled",!r.get("enabled").value),e.xp6(2),e.hij(" ",t.name," ")}}function Ql(o,n){if(1&o&&(e._UZ(0,"vdr-currency-input",21),e.ALo(1,"hasPermission")),2&o){const t=e.oxw(2).$implicit,r=e.oxw();e.Q6J("currencyCode",t.currencyCode)("readonly",!e.lcZ(1,2,r.updatePermission))}}function Sl(o,n){if(1&o&&(e._UZ(0,"vdr-currency-input",22),e.ALo(1,"hasPermission")),2&o){const t=e.oxw(2).$implicit,r=e.oxw();e.Q6J("currencyCode",t.currencyCode)("readonly",!e.lcZ(1,2,r.updatePermission))}}function Gl(o,n){if(1&o&&(e.ynx(0,4),e.TgZ(1,"td",5)(2,"div",6)(3,"div",7),e.YNc(4,$l,2,4,"img",8),e.YNc(5,Ul,2,0,"ng-template",null,9,e.W1O),e.qZA()()(),e.TgZ(7,"td",5)(8,"clr-input-container"),e._UZ(9,"input",10),e.ALo(10,"hasPermission"),e.ALo(11,"translate"),e.qZA()(),e.TgZ(12,"td",5)(13,"clr-input-container"),e._UZ(14,"input",11),e.ALo(15,"hasPermission"),e.ALo(16,"translate"),e.qZA()(),e.YNc(17,ql,4,7,"ng-container",1),e.ALo(18,"sort"),e.TgZ(19,"td",12)(20,"clr-input-container"),e.YNc(21,Ql,2,4,"vdr-currency-input",13),e.YNc(22,Sl,2,4,"vdr-currency-input",14),e.qZA()(),e.TgZ(23,"td",15)(24,"clr-input-container"),e._UZ(25,"input",16),e.ALo(26,"hasPermission"),e.qZA()(),e.TgZ(27,"td",15)(28,"clr-toggle-wrapper"),e._UZ(29,"input",17),e.ALo(30,"hasPermission"),e.qZA()(),e.BQk()),2&o){const t=n.ngIf,r=e.MAs(6),a=e.oxw().$implicit,l=e.oxw();e.Q6J("formGroup",t),e.xp6(1),e.ekj("disabled",!t.get("enabled").value),e.xp6(3),e.Q6J("ngIf",l.getFeaturedAsset(a))("ngIfElse",r),e.xp6(3),e.ekj("disabled",!t.get("enabled").value),e.xp6(2),e.Q6J("readonly",!e.lcZ(10,24,l.updatePermission))("placeholder",e.lcZ(11,26,"common.name")),e.xp6(3),e.ekj("disabled",!t.get("enabled").value),e.xp6(2),e.Q6J("readonly",!e.lcZ(15,28,l.updatePermission))("placeholder",e.lcZ(16,30,"catalog.sku")),e.xp6(3),e.Q6J("ngForOf",e.xi3(18,32,a.options,"groupId")),e.xp6(2),e.ekj("disabled",!t.get("enabled").value),e.xp6(2),e.Q6J("ngIf",!l.channelPriceIncludesTax),e.xp6(1),e.Q6J("ngIf",l.channelPriceIncludesTax),e.xp6(1),e.ekj("disabled",!t.get("enabled").value),e.xp6(2),e.Q6J("readonly",!e.lcZ(26,35,l.updatePermission)),e.xp6(2),e.ekj("disabled",!t.get("enabled").value),e.xp6(2),e.Q6J("vdrDisabled",!e.lcZ(30,37,l.updatePermission))}}function Yl(o,n){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,Gl,31,39,"ng-container",3),e.qZA()),2&o){const t=n.$implicit,r=e.oxw();e.xp6(1),e.Q6J("ngIf",r.formGroupMap.get(t.id))}}function Bl(o,n){1&o&&(e._uU(0),e.ALo(1,"translate")),2&o&&e.Oqu(e.lcZ(1,1,"catalog.update-product-option"))}function El(o,n){if(1&o&&(e.TgZ(0,"section")(1,"label"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"vdr-tabbed-custom-fields",10),e.ALo(5,"hasPermission"),e.qZA()),2&o){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,4,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.customFieldsForm)("readonly",!e.lcZ(5,6,e.DdM(8,Oe)))}}function jl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",12),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.update())}),e._uU(4),e.ALo(5,"translate"),e.qZA()}if(2&o){const t=e.oxw(),r=e.MAs(4),a=e.MAs(8);e.xp6(1),e.Oqu(e.lcZ(2,3,"common.cancel")),e.xp6(2),e.Q6J("disabled",r.invalid||a.invalid||r.pristine&&a.pristine&&t.customFieldsForm.pristine),e.xp6(1),e.hij(" ",e.lcZ(5,5,"catalog.update-product-option")," ")}}function Ve(o,n,t){if(!o)return"";const r=o.lastIndexOf(n);if(-1===r)return o;return o.substr(0,r)+o.substr(r).replace(n,t)}class q{constructor(n){this.dataService=n}getTaxCategories(){return this.dataService.settings.getTaxCategories().mapSingle(n=>n.taxCategories.items).pipe((0,xe.d)(1))}createProductWithVariants(n,t,r){const a=this.dataService.product.createProduct(n),l=t.groups.filter(s=>0<s.values.length),c=this.createProductOptionGroups(l,r);return(0,ee.D)(a,c).pipe((0,J.z)(([{createProduct:s},u])=>(u.length?(0,ee.D)(u.map(v=>this.dataService.product.addOptionGroupToProduct({productId:s.id,optionGroupId:v.id}))):(0,F.of)([])).pipe((0,f.U)(()=>({createProduct:s,optionGroups:u})))),(0,J.z)(({createProduct:s,optionGroups:u})=>{const m=t.variants.map(x=>{const y=u.length?x.optionValues.map((I,M)=>{const w=u[M].options.find(E=>E.name===I);if(!w)throw new Error(`Could not find a matching ProductOption "${I}" when creating variant`);return w.id}):[];return{...x,optionIds:y}}),v=u.map(x=>x.options).reduce((x,y)=>[...x,...y],[]);return this.createProductVariants(s,m,v,r,t.stockLocationId)}))}createProductOptionGroups(n,t){return n.length?(0,ee.D)(n.map(r=>this.dataService.product.createProductOptionGroups({code:(0,U.U)(r.name,"-"),translations:[{languageCode:t,name:r.name}],options:r.values.map(a=>({code:(0,U.U)(a,"-"),translations:[{languageCode:t,name:a}]}))}).pipe((0,f.U)(a=>a.createProductOptionGroup)))):(0,F.of)([])}createProductVariants(n,t,r,a,l){const c=t.map(s=>{const u=r.length?`${n.name} ${s.optionIds.map(m=>r.find(v=>v.id===m)).filter(Fe.notNullOrUndefined).map(m=>m.name).join(" ")}`:n.name;return{productId:n.id,price:s.price,sku:s.sku,translations:[{languageCode:a,name:u}],stockLevels:[{stockLocationId:l,stockOnHand:s.stock}],optionIds:s.optionIds}});return this.dataService.product.createProductVariants(c).pipe((0,f.U)(({createProductVariants:s})=>({createProductVariants:s,productId:n.id})))}updateProduct(n){const{product:t,languageCode:r,autoUpdate:a,productInput:l,variantsInput:c}=n,s=[],u=c||[];return(a?this.dataService.product.getProductVariantsForProduct({},t.id).mapSingle(({productVariants:v})=>v.items):(0,F.of)([])).pipe((0,J.z)(v=>{if(l){s.push(this.dataService.product.updateProduct(l));const x=(0,i.ZIM)(t,r)?.name??"",y=(0,i.ZIM)(l,r)?.name;if(y&&x!==y&&a)for(const I of v){const M=(0,i.ZIM)(I,r)?.name||"";let w;const E=u.find(qe=>qe.id===I.id);E?w=E:(w={id:I.id,translations:[{languageCode:r,name:M}]},u.push(w));const Ie=(0,i.ZIM)(w,r);Ie&&(Ie.name?Ie.name=Ve(Ie.name,x,y):Ie.name=[y,...I.options.map(qe=>qe.name)].join(" "))}}return u.length&&s.push(this.dataService.product.updateProductVariants(u)),(0,ee.D)(s)}))}updateProductOption(n,t,r){return(n.autoUpdate?this.dataService.product.getProductVariantsForProduct({},t.id).mapSingle(({productVariants:l})=>l.items):(0,F.of)([])).pipe((0,J.z)(l=>{let c=(0,F.of)([]);if(n.autoUpdate){let s;const u=(0,i.ZIM)(n,r)?.name;u||(c=(0,F.of)([]));const m=[];for(const v of l)if(v.options.map(x=>x.id).includes(n.id)){s||(s=(0,i.ZIM)(v.options.find(y=>y.id===n.id),r)?.name);const x=(0,i.ZIM)(v,r)?.name||"";s&&u&&x.includes(s)&&m.push({id:v.id,translations:[{languageCode:r,name:Ve(x,s,u)}]})}m.length&&(c=this.dataService.product.updateProductVariants(m))}return this.dataService.product.updateProductOption(n).pipe((0,J.z)(()=>c))}))}deleteProductVariant(n,t){return this.dataService.product.deleteProductVariant(n).pipe((0,b.w)(r=>r.deleteProductVariant.result===i.PcR.DELETED?this.dataService.product.getProduct(t).single$:(0,Zt._)(r.deleteProductVariant.message)))}static#e=this.\u0275fac=function(t){return new(t||q)(e.LFG(i.DoR))};static#t=this.\u0275prov=e.Yz7({token:q,factory:q.\u0275fac,providedIn:"root"})}class ne extends i.UT_{constructor(n,t,r,a,l,c,s,u){super(n,t,r,a),this.route=n,this.router=t,this.serverConfigService=r,this.dataService=a,this.productDetailService=l,this.formBuilder=c,this.changeDetector=s,this.notificationService=u,this.autoUpdateVariantNames=!0,this.paginationSettings={},this.updatePermission=[i.y3$.UpdateCatalog,i.y3$.UpdateProduct],this.optionGroupCustomFields=this.getCustomFieldConfig("ProductOptionGroup"),this.optionCustomFields=this.getCustomFieldConfig("ProductOption")}ngOnInit(){this.optionGroups$=this.route.snapshot.data.entity.pipe((0,f.U)(n=>n.optionGroups),(0,N.b)(n=>{for(const t of n)this.paginationSettings[t.id]={currentPage:1,itemsPerPage:10}})),this.detailForm=new d.nJ({optionGroups:new d.vC([])}),super.init()}getOptionGroups(){return this.detailForm.get("optionGroups").controls}getOptions(n){return n.get("options").controls}save(){if(this.detailForm.invalid||this.detailForm.pristine)return;const n=this.dataService.product.getProduct(this.id).mapSingle(t=>t.product);(0,T.a)(this.entity$,this.languageCode$,n).pipe((0,$.q)(1),(0,J.z)(([{optionGroups:t},r,a])=>{const l=[];for(const c of this.getOptionGroups()){if(c.dirty){const s=t.find(u=>u.id===c.value.id);if(s){const u=this.getUpdatedOptionGroup(s,c,r);l.push(this.dataService.product.updateProductOptionGroup(u))}}for(const s of this.getOptions(c))if(s.dirty){const u=t.find(m=>m.id===c.value.id)?.options.find(m=>m.id===s.value.id);if(u){const m=this.getUpdatedOption(u,s,r);l.push(this.productDetailService.updateProductOption({...m,autoUpdate:this.autoUpdateVariantNames},a,r))}}}return(0,ee.D)(l)})).subscribe(()=>{this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.notificationService.success((0,p.J)("common.notify-update-success"),{entity:"ProductOptionGroup"})},t=>{this.notificationService.error((0,p.J)("common.notify-update-error"),{entity:"ProductOptionGroup"})})}getUpdatedOptionGroup(n,t,r){return(0,i.iSy)({translatable:n,updatedFields:t.value,customFieldConfig:this.optionGroupCustomFields,languageCode:r,defaultTranslation:{languageCode:r,name:n.name||""}})}getUpdatedOption(n,t,r){return(0,i.iSy)({translatable:n,updatedFields:t.value,customFieldConfig:this.optionCustomFields,languageCode:r,defaultTranslation:{languageCode:r,name:n.name||""}})}setFormValues(n,t){const r=this.detailForm.get("optionGroups");for(const a of n.optionGroups){const l=(0,i.ZIM)(a,t),c=this.setOptionGroupForm(a,r,l);this.setCustomFieldsForm(this.optionGroupCustomFields,c,a,l);let s=c.get("options");s||(s=this.formBuilder.array([]),c.addControl("options",s));for(const u of a.options){const m=(0,i.ZIM)(u,t),v=this.setOptionForm(u,s,m);this.setCustomFieldsForm(this.optionCustomFields,v,u,m)}}}setCustomFieldsForm(n,t,r,a){if(n.length){let l=t.get(["customFields"]);l||(l=this.formBuilder.group(n.reduce((c,s)=>({...c,[s.name]:""}),{})),t.addControl("customFields",l)),this.setCustomFieldFormValues(n,l,r,a)}}setOptionGroupForm(n,t,r){const a={id:n.id,createdAt:n.createdAt,updatedAt:n.updatedAt,code:n.code,name:r?.name??""};let l=t.controls.find(c=>c.value.id===n.id);return l?(l.get("id")?.setValue(a.id),l.get("code")?.setValue(a.code),l.get("name")?.setValue(a.name),l.get("createdAt")?.setValue(a.createdAt),l.get("updatedAt")?.setValue(a.updatedAt)):(l=this.formBuilder.group(a),t.push(l)),l}setOptionForm(n,t,r){const a={id:n.id,createdAt:n.createdAt,updatedAt:n.updatedAt,code:n.code,name:r?.name??""};let l=t.controls.find(c=>c.value.id===n.id);return l?(l.get("id")?.setValue(a.id),l.get("code")?.setValue(a.code),l.get("name")?.setValue(a.name),l.get("createdAt")?.setValue(a.createdAt),l.get("updatedAt")?.setValue(a.updatedAt)):(l=this.formBuilder.group(a),t.push(l)),l}static#e=this.\u0275fac=function(t){return new(t||ne)(e.Y36(P.gz),e.Y36(P.F0),e.Y36(i.iHG),e.Y36(i.DoR),e.Y36(q),e.Y36(d.QS),e.Y36(e.sBO),e.Y36(i.gqp))};static#t=this.\u0275cmp=e.Xpm({type:ne,selectors:[["vdr-product-options-editor"]],features:[e.qOj],decls:24,vars:17,consts:[[3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],[1,"flex","center"],[1,"mr-2"],["clrCheckbox","","type","checkbox","id","auto-update",3,"ngModel","ngModelChange"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],["class","form",3,"formGroup",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[1,"form",3,"formGroup"],["formGroupName","optionGroups"],[3,"formArrayName","title",4,"ngFor","ngForOf"],[3,"formArrayName","title"],[3,"entity"],[1,"form-grid"],["for","name",3,"label"],["type","text","formControlName","name",3,"id","readonly"],["for","code",3,"label"],["type","text","formControlName","code",3,"id","readonly"],["formGroupName","customFields",4,"ngIf"],["id","edit-options-list",3,"items","itemsPerPage","currentPage","totalItems","pageChange",4,"ngIf"],["formGroupName","customFields"],["entityName","ProductOptionGroup",3,"customFields","customFieldsFormGroup","readonly"],["id","edit-options-list",3,"items","itemsPerPage","currentPage","totalItems","pageChange"],["id","id",3,"heading","hiddenByDefault"],["id","created-at",3,"heading","hiddenByDefault"],["id","updated-at",3,"heading","hiddenByDefault"],["id","name",3,"heading","optional"],["id","code",3,"heading","optional"],["id","custom-fields",3,"heading","hiddenByDefault"],["type","text",3,"formControl","readonly"],["type","text",3,"formControl"],["entityName","ProductOption",3,"customFields","compact","customFieldsFormGroup","readonly"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-page-header"),e._UZ(1,"vdr-page-title"),e.TgZ(2,"vdr-page-header-description"),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"vdr-page-body")(6,"vdr-page-block")(7,"vdr-action-bar")(8,"vdr-ab-left")(9,"vdr-language-selector",0),e.NdJ("languageCodeChange",function(l){return r.setLanguage(l)}),e.ALo(10,"async"),e.ALo(11,"async"),e.qZA()(),e.TgZ(12,"vdr-ab-right")(13,"div",1)(14,"div",2)(15,"clr-checkbox-wrapper")(16,"input",3),e.NdJ("ngModelChange",function(l){return r.autoUpdateVariantNames=l}),e.qZA(),e.TgZ(17,"label"),e._uU(18),e.ALo(19,"translate"),e.qZA()()(),e.YNc(20,wt,3,4,"button",4),e.qZA()()()(),e.TgZ(21,"vdr-page-block"),e.YNc(22,Qt,3,2,"form",5),e.ALo(23,"async"),e.qZA()()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,7,"catalog.page-description-options-editor")),e.xp6(6),e.Q6J("availableLanguageCodes",e.lcZ(10,9,r.availableLanguages$))("currentLanguageCode",e.lcZ(11,11,r.languageCode$)),e.xp6(7),e.Q6J("ngModel",r.autoUpdateVariantNames),e.xp6(2),e.Oqu(e.lcZ(19,13,"catalog.auto-update-product-variant-name")),e.xp6(2),e.Q6J("vdrIfPermissions",r.updatePermission),e.xp6(2),e.Q6J("ngIf",e.lcZ(23,15,r.optionGroups$)))},dependencies:[_.MgK,_.KKC,_.PEh,g.sg,g.O5,d._Y,d.Fj,d.Wl,d.JJ,d.JL,d.On,d.oH,d.sg,d.u,d.x0,d.CE,i.KkL,i.BND,i.mz,i.hgI,i.y_K,i.SdP,i.HAh,i.yc0,i.eJ5,i.Up6,i.qA0,i.TMj,i._Qn,i.HF2,i.zJY,i.DME,i.AkF,g.Ov,C.X$,i.j$k,i.HbD],styles:[".option-group-header[_ngcontent-%COMP%]{display:flex;align-items:baseline}"],changeDetection:0})}class re{constructor(n){this.formBuilder=n,this.form=this.formBuilder.group({name:["",d.kI.required],code:["",d.kI.required]})}updateCode(){const n=this.form.get("name"),t=this.form.get("code");n&&t&&t.pristine&&t.setValue((0,U.U)(`${n.value}`,"-"))}confirm(){const{name:n,code:t}=this.form.value;!n||!t||this.resolveWith({code:t,options:[],translations:[{languageCode:this.languageCode,name:n}]})}cancel(){this.resolveWith()}static#e=this.\u0275fac=function(t){return new(t||re)(e.Y36(d.qu))};static#t=this.\u0275cmp=e.Xpm({type:re,selectors:[["vdr-create-product-option-group-dialog"]],decls:9,vars:7,consts:[["vdrDialogTitle",""],[1,"form-grid",3,"formGroup"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"input"],["for","code",3,"label"],["id","code","type","text","formControlName","code"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,r){1&t&&(e.YNc(0,St,2,3,"ng-template",0),e.TgZ(1,"div",1)(2,"vdr-form-field",2),e.ALo(3,"translate"),e.TgZ(4,"input",3),e.NdJ("input",function(){return r.updateCode()}),e.qZA()(),e.TgZ(5,"vdr-form-field",4),e.ALo(6,"translate"),e._UZ(7,"input",5),e.qZA()(),e.YNc(8,Gt,6,7,"ng-template",6)),2&t&&(e.xp6(1),e.Q6J("formGroup",r.form),e.xp6(1),e.Q6J("label",e.lcZ(3,3,"common.name")),e.xp6(3),e.Q6J("label",e.lcZ(6,5,"common.code")))},dependencies:[d.Fj,d.JJ,d.JL,d.sg,d.u,i.hgI,i.y_K,i.nPI,i.q6K,C.X$],changeDetection:0})}class oe{constructor(n){this.formBuilder=n,this.form=this.formBuilder.group({name:["",d.kI.required],sku:["",d.kI.required],price:["",d.kI.required],options:this.formBuilder.record({})})}ngOnInit(){this.currencyCode=this.product.variants[0]?.currencyCode;for(const t of this.product.optionGroups)this.form.get("options").addControl(t.code,new d.NI("",d.kI.required));this.form.get("options").valueChanges.subscribe(t=>{const r=this.form.get("name");if(!Object.values(t).every(c=>null==c)&&t&&r&&!r.dirty){const c=Object.entries(t).map(([s,u])=>this.product.optionGroups.find(m=>m.code===s)?.options.find(m=>m.id===u)?.name).join(" ");r.setValue(`${this.product.name} ${c}`)}Object.values(t).every(c=>null!=c)&&(this.existingVariant=this.product.variants.find(c=>Object.entries(t).every(([s,u])=>c.options.find(m=>m.groupId===this.getGroupIdFromCode(s))?.id===u)))})}confirm(){const{name:n,sku:t,options:r,price:a}=this.form.value;if(!(n&&t&&r&&a))return;const l=Object.values(r).filter(Fe.notNullOrUndefined);this.resolveWith({productId:this.product.id,sku:t,price:Number(a),optionIds:l,translations:[{languageCode:this.product.languageCode,name:n}]})}cancel(){this.resolveWith()}getGroupCodeFromId(n){return this.product.optionGroups.find(t=>t.id===n)?.code??""}getGroupIdFromCode(n){return this.product.optionGroups.find(t=>t.code===n)?.id??""}static#e=this.\u0275fac=function(t){return new(t||oe)(e.Y36(d.qu))};static#t=this.\u0275cmp=e.Xpm({type:oe,selectors:[["vdr-create-product-variant-dialog"]],decls:17,vars:14,consts:[["vdrDialogTitle",""],[3,"formGroup"],["formGroupName","options",1,"form-grid"],[3,"label",4,"ngFor","ngForOf"],["clrAlertType","warning","class","form-grid-span",3,"clrAlertClosable",4,"ngIf"],["class","mt-2",4,"ngIf"],[1,"form-grid","mt-2"],[3,"label"],["type","text","formControlName","name"],["type","text","formControlName","sku"],["name","price","formControlName","price",3,"currencyCode"],["vdrDialogButtons",""],["bindLabel","name","bindValue","id","appendTo","body",3,"items","formControlName"],["clrAlertType","warning",1,"form-grid-span",3,"clrAlertClosable"],[1,"alert-text"],[1,"mt-2"],["clrAlertType","warning",1,"",3,"clrAlertClosable"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,r){1&t&&(e.YNc(0,Yt,2,3,"ng-template",0),e.TgZ(1,"form",1)(2,"div",2),e.YNc(3,Bt,2,3,"vdr-form-field",3),e.YNc(4,Et,5,4,"clr-alert",4),e.qZA(),e.YNc(5,jt,6,6,"div",5),e.TgZ(6,"div",6)(7,"vdr-form-field",7),e.ALo(8,"translate"),e._UZ(9,"input",8),e.qZA(),e.TgZ(10,"vdr-form-field",7),e.ALo(11,"translate"),e._UZ(12,"input",9),e.qZA(),e.TgZ(13,"vdr-form-field",7),e.ALo(14,"translate"),e._UZ(15,"vdr-currency-input",10),e.qZA()()(),e.YNc(16,Rt,6,7,"ng-template",11)),2&t&&(e.xp6(1),e.Q6J("formGroup",r.form),e.xp6(2),e.Q6J("ngForOf",r.product.optionGroups),e.xp6(1),e.Q6J("ngIf",0===r.product.optionGroups.length),e.xp6(1),e.Q6J("ngIf",r.existingVariant),e.xp6(2),e.Q6J("label",e.lcZ(8,8,"common.name")),e.xp6(3),e.Q6J("label",e.lcZ(11,10,"catalog.sku")),e.xp6(3),e.Q6J("label",e.lcZ(14,12,"catalog.price")),e.xp6(2),e.Q6J("currencyCode",r.currencyCode))},dependencies:[_.TIm,_.CyW,_.I9z,g.sg,g.O5,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,d.x0,Le.w9,i.KQz,i.hgI,i.y_K,i.nPI,i.q6K,C.X$],changeDetection:0})}const We={provide:d.JU,useExisting:(0,e.Gpc)(()=>S),multi:!0};class S{get optionValues(){return this.formValue??this.options??[]}constructor(n){this.changeDetector=n,this.groupName="",this.add=new e.vpe,this.remove=new e.vpe,this.edit=new e.vpe,this.disabled=!1,this.input="",this.isFocussed=!1,this.lastSelected=!1,this.editingIndex=-1}registerOnChange(n){this.onChangeFn=n}registerOnTouched(n){this.onTouchFn=n}setDisabledState(n){this.disabled=n,this.changeDetector.markForCheck()}writeValue(n){this.formValue=n||[]}focus(){this.textArea.nativeElement.focus()}editName(n,t){const r=this.optionValues[n];if(!r.locked&&!r.id){t.cancelBubble=!0,this.editingIndex=n;const a=this.nameInputs.get(n)?.nativeElement;setTimeout(()=>a?.focus())}}updateOption(n,t){const r=this.optionValues[n],a=t.target.value;r&&(a&&(r.name=a,this.edit.emit({index:n,option:r})),this.editingIndex=-1)}removeOption(n){n.locked||(this.formValue?(this.formValue=this.formValue?.filter(t=>t.name!==n.name),this.onChangeFn(this.formValue)):this.remove.emit(n))}handleKey(n){switch(n.key){case",":case"Enter":this.addOptionValue(),n.preventDefault();break;case"Backspace":this.lastSelected?(this.removeLastOption(),this.lastSelected=!1):""===this.input&&(this.lastSelected=!0);break;default:this.lastSelected=!1}}handleBlur(){this.isFocussed=!1,this.addOptionValue()}addOptionValue(){const n=this.parseInputIntoOptions(this.input).filter(t=>!(this.options??this.formValue)?.find(a=>a?.name===t.name));if(!this.formValue&&this.options)for(const t of n)this.add.emit(t);else this.formValue=(0,L.T)([...this.formValue,...n]),this.onChangeFn(this.formValue);this.input=""}parseInputIntoOptions(n){return n.split(/[,\n]/).map(t=>t.trim()).filter(t=>""!==t).map(t=>({name:t,locked:!1}))}removeLastOption(){if(this.optionValues.length){const n=this.optionValues[this.optionValues.length-1];this.removeOption(n)}}static#e=this.\u0275fac=function(t){return new(t||S)(e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:S,selectors:[["vdr-option-value-input"]],viewQuery:function(t,r){if(1&t&&(e.Gf(Ht,7),e.Gf(Kt,5,e.SBq)),2&t){let a;e.iGM(a=e.CRH())&&(r.textArea=a.first),e.iGM(a=e.CRH())&&(r.nameInputs=a)}},inputs:{groupName:"groupName",options:"options",disabled:"disabled"},outputs:{add:"add",remove:"remove",edit:"edit"},features:[e._Bn([We])],decls:4,vars:5,consts:[[1,"input-wrapper",3,"click"],["class","chips",4,"ngIf"],[3,"ngModel","disabled","keyup","focus","blur","ngModelChange"],["textArea",""],[1,"chips"],[3,"icon","selected","locked","colorFrom","iconClick",4,"ngFor","ngForOf"],[3,"icon","colorFrom","iconClick"],[3,"hidden"],["type","text",3,"ngModel","blur","click"],["editNameInput",""],[1,"option-name",3,"hidden","click"]],template:function(t,r){if(1&t){const a=e.EpF();e.TgZ(0,"div",0),e.NdJ("click",function(){e.CHM(a);const c=e.MAs(3);return e.KtG(c.focus())}),e.YNc(1,Wt,2,1,"div",1),e.TgZ(2,"textarea",2,3),e.NdJ("keyup",function(c){return r.handleKey(c)})("focus",function(){return r.isFocussed=!0})("blur",function(){return r.handleBlur()})("ngModelChange",function(c){return r.input=c}),e.qZA()()}2&t&&(e.ekj("focus",r.isFocussed),e.xp6(1),e.Q6J("ngIf",0<r.optionValues.length),e.xp6(1),e.Q6J("ngModel",r.input)("disabled",r.disabled))},dependencies:[g.sg,g.O5,d.Fj,d.JJ,d.On,i.Ywx,i.y_K],styles:[".input-wrapper[_ngcontent-%COMP%]{background-color:var(--color-form-input-bg);border-radius:3px!important;border:1px solid var(--color-grey-300)!important;cursor:text}.input-wrapper.focus[_ngcontent-%COMP%]{border-color:var(--color-primary-500)!important;box-shadow:0 0 1px 1px var(--color-primary-100)}.input-wrapper[_ngcontent-%COMP%]   .chips[_ngcontent-%COMP%]{padding:5px}.input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{border:none;width:100%;height:24px;margin-top:3px;padding:0 6px}.input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;box-shadow:none}.input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:disabled{background-color:var(--color-component-bg-100)}vdr-chip[_ngcontent-%COMP%]     .wrapper{margin:0 3px}vdr-chip.locked[_ngcontent-%COMP%]{opacity:.8}vdr-chip.selected[_ngcontent-%COMP%]     .wrapper{border-color:var(--color-warning-500)!important;box-shadow:0 0 1px 1px var(--color-warning-400);opacity:.6}vdr-chip[_ngcontent-%COMP%]   .option-name.editable[_ngcontent-%COMP%]:hover{outline:1px solid var(--color-component-bg-300);outline-offset:1px;border-radius:1px}vdr-chip[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:0!important;margin-top:-2px;margin-bottom:-2px}"]})}class Rl{constructor(n){for(const t of Object.keys(n))this[t]=n[t]}}class ae{constructor(n,t,r,a,l,c){this.route=n,this.dataService=t,this.productDetailService=r,this.notificationService=a,this.modalService=l,this.changeDetector=c,this.formValueChanged=!1,this.optionsChanged=!1,this.itemsPerPage=100,this.currentPage=1,this.searchTermControl=new d.NI(""),this.selectionManager=new i.ZE0({multiSelect:!0,itemsAreEqual:(s,u)=>s.id===u.id,additiveMode:!0}),this.optionsToAddToVariant={},this.refresh$=new te.x}ngOnInit(){this.languageCode=this.route.snapshot.paramMap.get("lang")||(0,i.kAh)(),this.dataService.settings.getActiveChannel().single$.subscribe(t=>{this.currencyCode=t.activeChannel.defaultCurrencyCode});const n=this.refresh$.pipe((0,b.w)(()=>this.dataService.product.getProductVariantsOptions(this.route.parent?.snapshot.paramMap.get("id")).mapSingle(t=>t.product)),(0,V.O)(this.route.snapshot.data.product));this.variants$=n.pipe((0,b.w)(t=>this.searchTermControl.valueChanges.pipe((0,V.O)(""),(0,f.U)(r=>r?t.variants.filter(a=>a.name.toLowerCase().includes(r.toLowerCase())):t.variants)))),this.optionGroups$=n.pipe((0,f.U)(t=>t.optionGroups)),this.totalItems$=this.variants$.pipe((0,f.U)(t=>t.length)),n.subscribe(t=>{this.product=t;const r=t.variants.map(l=>l.options.map(c=>c.id)).flat(),a=t.variants.map(l=>l.options.map(c=>c.groupId)).flat();this.optionGroups=t.optionGroups.map(l=>({id:l.id,isNew:!1,name:l.name,locked:a.includes(l.id),values:l.options.map(c=>({id:c.id,name:c.name,locked:r.includes(c.id)}))}))})}setItemsPerPage(n){this.itemsPerPage=n,this.currentPage=1}setPageNumber(n){this.currentPage=n}onFormChanged(n){this.formValueChanged=!0,n.enabled=!0}canDeactivate(){return!this.formValueChanged}addOptionGroup(){this.modalService.fromComponent(re,{locals:{languageCode:this.languageCode}}).pipe((0,b.w)(n=>n?this.dataService.product.createProductOptionGroups(n).pipe((0,b.w)(({createProductOptionGroup:t})=>this.dataService.product.addOptionGroupToProduct({optionGroupId:t.id,productId:this.product.id}))):Z.E)).subscribe(n=>{this.notificationService.success((0,p.J)("common.notify-create-success"),{entity:"ProductOptionGroup"}),this.refresh$.next(),this.changeDetector.markForCheck()})}removeOptionGroup(n){const t=n.id,r=this.product.variants.filter(a=>a.options.map(l=>l.groupId).includes(t)).length;this.modalService.dialog({title:(0,p.J)("catalog.confirm-delete-product-option-group"),body:r?(0,p.J)("catalog.confirm-delete-product-option-group-body"):"",translationVars:{name:n.name,count:r},buttons:[{type:"secondary",label:(0,p.J)("common.cancel")},{type:"danger",label:(0,p.J)("common.delete"),returnValue:!0}]}).pipe((0,b.w)(a=>a?this.dataService.product.removeOptionGroupFromProduct({optionGroupId:t,productId:this.product.id,force:!0}):Z.E)).subscribe(({removeOptionGroupFromProduct:a})=>{"Product"===a.__typename?(this.notificationService.success((0,p.J)("common.notify-delete-success"),{entity:"ProductOptionGroup"}),this.refresh$.next()):"ProductOptionInUseError"===a.__typename&&this.notificationService.error(a.message??"")})}addOption(n,t){const r=this.optionGroups[n];r&&r.id&&this.dataService.product.addOptionToGroup({productOptionGroupId:r.id,code:(0,U.U)(t,"-"),translations:[{name:t,languageCode:this.languageCode}]}).subscribe(({createProductOption:a})=>{this.notificationService.success((0,p.J)("common.notify-create-success"),{entity:"ProductOption"}),this.refresh$.next()})}removeOption(n,{id:t,name:r}){const a=this.optionGroups[n];a&&this.modalService.dialog({title:(0,p.J)("catalog.confirm-delete-product-option"),translationVars:{name:r},buttons:[{type:"secondary",label:(0,p.J)("common.cancel")},{type:"danger",label:(0,p.J)("common.delete"),returnValue:!0}]}).pipe((0,b.w)(l=>l?this.dataService.product.deleteProductOption(t):Z.E)).subscribe(({deleteProductOption:l})=>{l.result===i.PcR.DELETED?(this.notificationService.success((0,p.J)("common.notify-delete-success"),{entity:"ProductOption"}),a.values=a.values.filter(c=>c.id!==t),this.refresh$.next()):this.notificationService.error(l.message??"")})}setOptionToAddToVariant(n,t,r){this.optionsToAddToVariant[n]||(this.optionsToAddToVariant[n]={}),r?this.optionsToAddToVariant[n][t]=r:delete this.optionsToAddToVariant[n][t]}addOptionToVariant(n){const t=[...n.options.map(r=>r.id),...Object.values(this.optionsToAddToVariant[n.id])];this.dataService.product.updateProductVariants([{id:n.id,optionIds:(0,L.T)(t)}]).subscribe(({updateProductVariants:r})=>{this.refresh$.next()})}deleteVariant(n){this.modalService.dialog({title:(0,p.J)("catalog.confirm-delete-product-variant"),translationVars:{name:n.name},buttons:[{type:"secondary",label:(0,p.J)("common.cancel")},{type:"danger",label:(0,p.J)("common.delete"),returnValue:!0}]}).pipe((0,b.w)(t=>t?this.productDetailService.deleteProductVariant(n.id,this.product.id):Z.E)).subscribe(()=>{this.notificationService.success((0,p.J)("common.notify-delete-success"),{entity:"ProductVariant"}),this.refresh$.next()},t=>{this.notificationService.error((0,p.J)("common.notify-delete-error"),{entity:"ProductVariant"})})}createNewVariant(){this.modalService.fromComponent(oe,{locals:{product:this.product}}).pipe((0,b.w)(n=>n?this.dataService.product.createProductVariants([n]):Z.E)).subscribe(n=>{this.notificationService.success((0,p.J)("common.notify-create-success"),{entity:"ProductVariant"}),this.refresh$.next()})}getOption(n,t){return n.options.find(r=>r.groupId===t)}static#e=this.\u0275fac=function(t){return new(t||ae)(e.Y36(P.gz),e.Y36(i.DoR),e.Y36(q),e.Y36(i.gqp),e.Y36(i.Z7U),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:ae,selectors:[["vdr-product-variants-editor"]],decls:44,vars:55,consts:[["class","option-groups",4,"ngFor","ngForOf"],[1,"button","mt-1",3,"click"],["shape","plus"],[3,"paddingX"],[1,"mx-3"],[1,"button",3,"click"],["id","manage-product-variant-list",3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[3,"searchTermControl","searchTermPlaceholder"],["id","id",3,"heading","hiddenByDefault"],["id","created-at",3,"heading","hiddenByDefault"],["id","updated-at",3,"heading","hiddenByDefault"],["id","name",3,"heading","optional"],["id","sku",3,"heading","optional"],[3,"heading","id",4,"ngFor","ngForOf"],["id","price",3,"heading","hiddenByDefault"],["id","price-with-tax",3,"heading","hiddenByDefault"],["id","delete",3,"heading","optional"],[1,"option-groups"],[3,"label"],["clrInput","","name","name",3,"ngModel","readonly","ngModelChange"],[1,"flex-spacer",3,"label"],[3,"options","groupName","disabled","add","remove"],["optionValueInputComponent",""],[1,"button-small","mt-4",3,"click"],["shape","trash"],[3,"heading","id"],[3,"colorFrom",4,"ngIf","ngIfElse"],["selectOption",""],[3,"colorFrom"],[1,"flex","center"],["bindLabel","name","bindValue","id","appendTo","body",3,"items","change"],[1,"button-small","ml-1",3,"disabled","click"],["shape","floppy"],[1,"button-small",3,"click"],["shape","trash is-danger"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-page-block")(1,"vdr-card"),e.YNc(2,Xt,11,11,"div",0),e.TgZ(3,"button",1),e.NdJ("click",function(){return r.addOptionGroup()}),e._UZ(4,"clr-icon",2),e._uU(5),e.ALo(6,"translate"),e.qZA()(),e.TgZ(7,"vdr-card",3)(8,"div",4)(9,"button",5),e.NdJ("click",function(){return r.createNewVariant()}),e._UZ(10,"clr-icon",2),e._uU(11),e.ALo(12,"translate"),e.qZA()(),e.TgZ(13,"vdr-data-table-2",6),e.NdJ("pageChange",function(l){return r.setPageNumber(l)})("itemsPerPageChange",function(l){return r.setItemsPerPage(l)}),e.ALo(14,"async"),e.ALo(15,"async"),e._UZ(16,"vdr-dt2-search",7),e.ALo(17,"translate"),e.TgZ(18,"vdr-dt2-column",8),e.ALo(19,"translate"),e.YNc(20,en,1,1,"ng-template"),e.qZA(),e.TgZ(21,"vdr-dt2-column",9),e.ALo(22,"translate"),e.YNc(23,tn,2,4,"ng-template"),e.qZA(),e.TgZ(24,"vdr-dt2-column",10),e.ALo(25,"translate"),e.YNc(26,nn,2,4,"ng-template"),e.qZA(),e.TgZ(27,"vdr-dt2-column",11),e.ALo(28,"translate"),e.YNc(29,rn,1,1,"ng-template"),e.qZA(),e.TgZ(30,"vdr-dt2-column",12),e.ALo(31,"translate"),e.YNc(32,on,1,1,"ng-template"),e.qZA(),e.YNc(33,sn,2,2,"vdr-dt2-column",13),e.ALo(34,"async"),e.TgZ(35,"vdr-dt2-column",14),e.ALo(36,"translate"),e.YNc(37,dn,2,4,"ng-template"),e.qZA(),e.TgZ(38,"vdr-dt2-column",15),e.ALo(39,"translate"),e.YNc(40,pn,2,4,"ng-template"),e.qZA(),e.TgZ(41,"vdr-dt2-column",16),e.ALo(42,"translate"),e.YNc(43,un,2,0,"ng-template"),e.qZA()()()()),2&t&&(e.xp6(2),e.Q6J("ngForOf",r.optionGroups),e.xp6(3),e.hij(" ",e.lcZ(6,27,"catalog.create-product-option-group")," "),e.xp6(2),e.Q6J("paddingX",!1),e.xp6(4),e.hij(" ",e.lcZ(12,29,"catalog.create-product-variant")," "),e.xp6(2),e.Q6J("items",e.lcZ(14,31,r.variants$))("itemsPerPage",r.itemsPerPage)("totalItems",e.lcZ(15,33,r.totalItems$))("currentPage",r.currentPage),e.xp6(3),e.Q6J("searchTermControl",r.searchTermControl)("searchTermPlaceholder",e.lcZ(17,35,"catalog.filter-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(19,37,"common.id"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(22,39,"common.created-at"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(25,41,"common.updated-at"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(28,43,"catalog.name"))("optional",!1),e.xp6(3),e.Q6J("heading",e.lcZ(31,45,"catalog.sku"))("optional",!1),e.xp6(3),e.Q6J("ngForOf",e.lcZ(34,47,r.optionGroups$)),e.xp6(2),e.Q6J("heading",e.lcZ(36,49,"common.price"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(39,51,"common.price-with-tax"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(42,53,"common.delete"))("optional",!1))},dependencies:[_.qvL,_.xRP,g.sg,g.O5,d.Fj,d.JJ,d.On,Le.w9,i.Ywx,i.hgI,i.y_K,i.eJ5,i.Up6,i.JBy,i.zJY,i.AkF,S,g.Ov,C.X$,i.HbD,i.kgx],styles:[".option-groups[_ngcontent-%COMP%]{display:flex;width:100%;gap:var(--space-unit)}.values[_ngcontent-%COMP%]{flex:1;margin:0 6px}.variants-preview[_ngcontent-%COMP%]   tr.disabled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100);color:var(--color-grey-400)}"]})}class ie extends i.p_9{constructor(n,t){super(n,{__typename:"Product",id:"",createdAt:"",updatedAt:"",name:"",languageCode:"",optionGroups:[],variants:[]},r=>t.product.getProductVariantsOptions(r).mapStream(a=>a.product))}static#e=this.\u0275fac=function(t){return new(t||ie)(e.LFG(P.F0),e.LFG(i.DoR))};static#t=this.\u0275prov=e.Yz7({token:ie,factory:ie.\u0275fac,providedIn:"root"})}const Xe=o=>[{path:"products",component:i.IIO,data:{locationId:"product-list",breadcrumb:(0,p.J)("breadcrumb.products")},children:o.getPageTabRoutes("product-list")},{path:"inventory",redirectTo:"products"},{path:"products/:id",component:i.IIO,data:{locationId:"product-detail",breadcrumb:{label:(0,p.J)("breadcrumb.products"),link:["../","products"]}},children:[{path:"manage-variants",component:ae,canDeactivate:[i.TSp],data:{breadcrumb:({product:n})=>[{label:`${n.name}`,link:["../"]},{label:(0,p.J)("breadcrumb.manage-variants"),link:["manage-variants"]}]},resolve:{product:n=>(0,e.f3M)(i.DoR).product.getProductVariantsOptions(n.parent?.params.id).mapSingle(t=>t.product)}},...o.getPageTabRoutes("product-detail")]},{path:"products/:productId/variants/:id",component:i.IIO,data:{locationId:"product-variant-detail",breadcrumb:{label:(0,p.J)("breadcrumb.products"),link:["../","products"]}},children:o.getPageTabRoutes("product-variant-detail")},{path:"products/:id/options",component:ne,resolve:(0,i.Po4)(ie),canDeactivate:[i.TSp],data:{breadcrumb:et}},{path:"facets",component:i.IIO,data:{locationId:"facet-list",breadcrumb:(0,p.J)("breadcrumb.facets")},children:o.getPageTabRoutes("facet-list")},{path:"facets/:id",component:i.IIO,data:{locationId:"facet-detail",breadcrumb:{label:(0,p.J)("breadcrumb.facets"),link:["../","facets"]}},children:o.getPageTabRoutes("facet-detail")},{path:"collections",component:i.IIO,data:{locationId:"collection-list",breadcrumb:(0,p.J)("breadcrumb.collections")},children:o.getPageTabRoutes("collection-list")},{path:"collections/:id",component:i.IIO,data:{locationId:"collection-detail",breadcrumb:{label:(0,p.J)("breadcrumb.collections"),link:["../","collections"]}},children:o.getPageTabRoutes("collection-detail")},{path:"assets",component:i.IIO,data:{locationId:"asset-list",breadcrumb:(0,p.J)("breadcrumb.assets")},children:o.getPageTabRoutes("asset-list")},{path:"assets/:id",component:i.IIO,data:{locationId:"asset-detail",breadcrumb:{label:(0,p.J)("breadcrumb.assets"),link:["../","assets"]}},children:o.getPageTabRoutes("asset-detail")}];function et(o,n){return o.entity.pipe((0,f.U)(t=>[{label:(0,p.J)("breadcrumb.products"),link:["../","products"]},{label:`${t.name}`,link:["../","products",n.id]},{label:(0,p.J)("breadcrumb.product-options"),link:["options"]}]))}class j{constructor(n){this.changeDetector=n,this.selectedValues=[]}ngAfterViewInit(){setTimeout(()=>this.selector.focus(),0)}selectValues(){this.resolveWith(this.selectedValues)}cancel(){this.resolveWith()}static#e=this.\u0275fac=function(t){return new(t||j)(e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:j,selectors:[["vdr-apply-facet-dialog"]],viewQuery:function(t,r){if(1&t&&e.Gf(i.$MF,5),2&t){let a;e.iGM(a=e.CRH())&&(r.selector=a.first)}},decls:3,vars:0,consts:[["vdrDialogTitle",""],[3,"selectedValuesChange"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,r){1&t&&(e.YNc(0,mn,2,3,"ng-template",0),e.TgZ(1,"vdr-facet-value-selector",1),e.NdJ("selectedValuesChange",function(l){return r.selectedValues=l}),e.qZA(),e.YNc(2,gn,6,7,"ng-template",2))},dependencies:[i.$MF,i.nPI,i.q6K,C.X$],changeDetection:0})}const Hl=A.Ps`
    query AssetDetailQuery($id: ID!) {
        asset(id: $id) {
            ...Asset
            tags {
                ...Tag
            }
        }
    }
    ${i.fed}
    ${i.i4$}
`;class le extends i.VE7{constructor(n,t,r){super(),this.notificationService=n,this.dataService=t,this.formBuilder=r,this.customFields=this.getCustomFieldConfig("Asset"),this.detailForm=new d.cw({name:new d.NI(""),tags:new d.NI([]),customFields:this.formBuilder.group((0,i.Lrj)(this.customFields))})}ngOnInit(){this.init()}ngOnDestroy(){this.destroy()}onAssetChange(n){this.detailForm.get("name")?.setValue(n.name),this.detailForm.get("tags")?.setValue(n.tags),this.detailForm.markAsDirty()}save(){this.dataService.product.updateAsset({id:this.id,name:this.detailForm.value.name,tags:this.detailForm.value.tags,customFields:this.detailForm.value.customFields}).subscribe(()=>{this.notificationService.success((0,p.J)("common.notify-update-success"),{entity:"Asset"})},n=>{this.notificationService.error((0,p.J)("common.notify-update-error"),{entity:"Asset"})})}setFormValues(n,t){this.detailForm.get("name")?.setValue(n.name),this.detailForm.get("tags")?.setValue(n.tags.map(r=>r.id)),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["customFields"]),n)}static#e=this.\u0275fac=function(t){return new(t||le)(e.Y36(i.gqp),e.Y36(i.DoR),e.Y36(d.QS))};static#t=this.\u0275cmp=e.Xpm({type:le,selectors:[["vdr-asset-detail"]],features:[e.qOj],decls:9,vars:8,consts:[["locationId","asset-detail"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"asset","editable","customFields","customFieldsForm","assetChange"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar"),e._UZ(2,"vdr-ab-left"),e.TgZ(3,"vdr-ab-right"),e._UZ(4,"vdr-action-bar-items",0),e.YNc(5,_n,3,4,"button",1),e.qZA()()(),e.TgZ(6,"vdr-page-block")(7,"vdr-asset-preview",2),e.NdJ("assetChange",function(l){return r.onAssetChange(l)}),e.ALo(8,"async"),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("vdrIfPermissions",e.DdM(7,fn)),e.xp6(2),e.Q6J("asset",e.lcZ(8,5,r.entity$))("editable",!0)("customFields",r.customFields)("customFieldsForm",r.detailForm.get("customFields")))},dependencies:[i.KkL,i.BND,i.mz,i.Agc,i.HAh,i.WWO,i.zJY,g.Ov,C.X$],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}"],changeDetection:0})}class ce extends i.t7C{constructor(n,t,r,a,l){super(a,l),this.notificationService=n,this.modalService=t,this.dataService=r,this.searchTerm$=new D.X(void 0),this.filterByTags$=new D.X(void 0),this.uploading=!1,super.setQueryFn((...c)=>this.dataService.product.getAssetList(...c).refetchOnChannelChange(),c=>c.assets,(c,s)=>{const u=this.searchTerm$.value,m=this.filterByTags$.value?.map(v=>v.value);return{options:{skip:c,take:s,...u?{filter:{name:{contains:u}}}:{},sort:{createdAt:i.Asd.DESC},tags:m,tagsOperator:i.FnJ.AND}}},{take:25,skip:0})}ngOnInit(){super.ngOnInit(),this.paginationConfig$=(0,T.a)(this.itemsPerPage$,this.currentPage$,this.totalItems$).pipe((0,f.U)(([n,t,r])=>({itemsPerPage:n,currentPage:t,totalItems:r}))),this.searchTerm$.pipe((0,X.b)(250),(0,ke.R)(this.destroy$)).subscribe(()=>this.refresh()),this.filterByTags$.pipe((0,ke.R)(this.destroy$)).subscribe(()=>this.refresh()),this.allTags$=this.dataService.product.getTagList().mapStream(n=>n.tags.items)}filesSelected(n){n.length&&(this.uploading=!0,this.dataService.product.createAssets(n).pipe((0,Se.x)(()=>this.uploading=!1)).subscribe(({createAssets:t})=>{let r=0;for(const a of t)switch(a.__typename){case"Asset":r++;break;case"MimeTypeError":this.notificationService.error(a.message)}0<r&&(super.refresh(),this.notificationService.success((0,p.J)("asset.notify-create-assets-success"),{count:r}))}))}deleteAssets(n){this.showModalAndDelete(n.map(t=>t.id)).pipe((0,b.w)(t=>t.result===i.PcR.DELETED?[!0]:this.showModalAndDelete(n.map(r=>r.id),t.message||"").pipe((0,f.U)(r=>r.result===i.PcR.DELETED)))).subscribe(()=>{this.notificationService.success((0,p.J)("common.notify-delete-success"),{entity:"Assets"}),this.refresh()},t=>{this.notificationService.error((0,p.J)("common.notify-delete-error"),{entity:"Assets"})})}showModalAndDelete(n,t){return this.modalService.dialog({title:(0,p.J)("catalog.confirm-delete-assets"),translationVars:{count:n.length},body:t,buttons:[{type:"secondary",label:(0,p.J)("common.cancel")},{type:"danger",label:(0,p.J)("common.delete"),returnValue:!0}]}).pipe((0,b.w)(r=>r?this.dataService.product.deleteAssets(n,!!t):Z.E),(0,f.U)(r=>r.deleteAssets))}static#e=this.\u0275fac=function(t){return new(t||ce)(e.Y36(i.gqp),e.Y36(i.Z7U),e.Y36(i.DoR),e.Y36(P.F0),e.Y36(P.gz))};static#t=this.\u0275cmp=e.Xpm({type:ce,selectors:[["vdr-asset-list"]],features:[e.qOj],decls:17,vars:30,consts:[[1,"my-2"],[3,"tags","searchTermChange","tagsChange"],["dropZoneTarget",".content-area",3,"uploading","selectFiles"],[3,"assets","multiSelect","canDelete","deleteAssets"],[1,"paging-controls"],[3,"itemsPerPage","itemsPerPageChange"],[3,"currentPage","itemsPerPage","totalItems","pageChange"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-page-block")(1,"div",0)(2,"vdr-asset-search-input",1),e.NdJ("searchTermChange",function(l){return r.searchTerm$.next(l)})("tagsChange",function(l){return r.filterByTags$.next(l)}),e.ALo(3,"async"),e.TgZ(4,"vdr-asset-file-input",2),e.NdJ("selectFiles",function(l){return r.filesSelected(l)}),e.qZA()()(),e.TgZ(5,"vdr-asset-gallery",3),e.NdJ("deleteAssets",function(l){return r.deleteAssets(l)}),e.ALo(6,"paginate"),e.ALo(7,"async"),e.ALo(8,"async"),e.ALo(9,"hasPermission"),e.qZA(),e.TgZ(10,"div",4)(11,"vdr-items-per-page-controls",5),e.NdJ("itemsPerPageChange",function(l){return r.setItemsPerPage(l)}),e.ALo(12,"async"),e.qZA(),e.TgZ(13,"vdr-pagination-controls",6),e.NdJ("pageChange",function(l){return r.setPageNumber(l)}),e.ALo(14,"async"),e.ALo(15,"async"),e.ALo(16,"async"),e.qZA()()()),2&t&&(e.xp6(2),e.Q6J("tags",e.lcZ(3,9,r.allTags$)),e.xp6(2),e.Q6J("uploading",r.uploading),e.xp6(1),e.Q6J("assets",e.xi3(6,11,e.lcZ(7,14,r.items$),e.lcZ(8,16,r.paginationConfig$)||e.DdM(28,hn)))("multiSelect",!0)("canDelete",e.lcZ(9,18,e.DdM(29,vn))),e.xp6(6),e.Q6J("itemsPerPage",e.lcZ(12,20,r.itemsPerPage$)),e.xp6(2),e.Q6J("currentPage",e.lcZ(14,22,r.currentPage$))("itemsPerPage",e.lcZ(15,24,r.itemsPerPage$))("totalItems",e.lcZ(16,26,r.totalItems$)))},dependencies:[i.Vrp,i.wAH,i.LSK,i.eru,i.K8o,i.zJY,g.Ov,we._s,i.j$k],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}vdr-asset-gallery[_ngcontent-%COMP%]{flex:1}.paging-controls[_ngcontent-%COMP%]{padding-top:6px;border-top:1px solid var(--color-component-border-100);display:flex;justify-content:space-between}.search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"]})}class G{set assetsSetter(n){this.assets=(n||[]).slice()}constructor(n,t){this.modalService=n,this.changeDetector=t,this.compact=!1,this.change=new e.vpe,this.assets=[]}selectAssets(){this.modalService.fromComponent(i.V61,{size:"xl"}).subscribe(n=>{n&&n.length&&(this.assets=(0,L.T)(this.assets.concat(n),"id"),this.featuredAsset||(this.featuredAsset=n[0]),this.emitChangeEvent(this.assets,this.featuredAsset),this.changeDetector.markForCheck())})}setAsFeatured(n){this.featuredAsset=n,this.emitChangeEvent(this.assets,n)}isFeatured(n){return!!this.featuredAsset&&this.featuredAsset.id===n.id}previewAsset(n){this.modalService.fromComponent(i.IW,{size:"xl",closable:!0,locals:{asset:n,assets:this.assets}}).subscribe()}removeAsset(n){this.assets=this.assets.filter(t=>t.id!==n.id),this.featuredAsset&&this.featuredAsset.id===n.id&&(this.featuredAsset=this.assets.length>0?this.assets[0]:void 0),this.emitChangeEvent(this.assets,this.featuredAsset)}emitChangeEvent(n,t){this.change.emit({assets:n,featuredAsset:t})}dropListDropped(n){(0,k.bA)(this.assets,n.previousContainer.data,n.container.data),this.emitChangeEvent(this.assets,this.featuredAsset)}static#e=this.\u0275fac=function(t){return new(t||G)(e.Y36(i.Z7U),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:G,selectors:[["vdr-assets"]],hostVars:2,hostBindings:function(t,r){2&t&&e.ekj("compact",r.compact)},inputs:{assetsSetter:["assets","assetsSetter"],featuredAsset:"featuredAsset",compact:"compact",updatePermissions:"updatePermissions"},outputs:{change:"change"},decls:5,vars:2,consts:[["class","standard-view-container",4,"ngIf","ngIfElse"],["compactView",""],["assetList",""],[1,"standard-view-container"],[1,"featured-asset"],[3,"src","click",4,"ngIf"],["class","placeholder",3,"click",4,"ngIf"],[1,"all-assets-container"],[4,"ngTemplateOutlet"],[4,"vdrIfPermissions"],[3,"src","click"],[1,"placeholder",3,"click"],["shape","image","size","128"],[1,"btn",3,"click"],["shape","attachment"],[1,"featured-asset","compact"],["class","compact-select btn btn-icon btn-sm btn-block",3,"title","click",4,"vdrIfPermissions"],["shape","image","size","150"],[1,"compact-select","btn","btn-icon","btn-sm","btn-block",3,"title","click"],["cdkDropListGroup","",1,"all-assets"],["class","drop-list","cdkDropList","","cdkDropListOrientation","horizontal",3,"cdkDropListData","cdkDropListDisabled","cdkDropListDropped",4,"ngFor","ngForOf"],["cdkDropList","","cdkDropListOrientation","horizontal",1,"drop-list",3,"cdkDropListData","cdkDropListDisabled","cdkDropListDropped"],["cdkDrag",""],["vdrDropdownTrigger","","tabindex","0",1,"asset-thumb",3,"title"],[3,"src"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",3,"click"],["type","button","vdrDropdownItem","",3,"disabled","click"],[1,"dropdown-divider"],["type","button","vdrDropdownItem","",1,"remove-asset",3,"disabled","click"]],template:function(t,r){if(1&t&&(e.YNc(0,Pn,7,4,"div",0),e.YNc(1,kn,5,4,"ng-template",null,1,e.W1O),e.YNc(3,Ln,2,3,"ng-template",null,2,e.W1O)),2&t){const a=e.MAs(2);e.Q6J("ngIf",!r.compact)("ngIfElse",a)}},dependencies:[_.qvL,g.sg,g.O5,g.tP,k.Wj,k.Fd,k.Zt,i.JOL,i.N9E,i.UaT,i.HH4,i.HAh,C.X$,i.j$k,i.Mgf],styles:["[_nghost-%COMP%]{display:block;container-type:inline-size}.compact[_nghost-%COMP%]{width:162px}.standard-view-container[_ngcontent-%COMP%]{display:flex;gap:calc(var(--space-unit) * 2)}.all-assets-container[_ngcontent-%COMP%]{display:flex;max-width:50%;flex-direction:column;justify-content:space-between}@container (max-width: 500px){.standard-view-container[_ngcontent-%COMP%]{flex-direction:column}.all-assets-container[_ngcontent-%COMP%]{max-width:100%}}.placeholder[_ngcontent-%COMP%]{text-align:center;color:var(--color-grey-300)}.featured-asset[_ngcontent-%COMP%]{text-align:center;background:var(--color-component-bg-200);padding:6px;cursor:pointer;border-radius:var(--border-radius-img)}.featured-asset[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:var(--border-radius-img);max-height:400px;max-width:100%;object-fit:contain}.featured-asset.compact[_ngcontent-%COMP%]{width:100%;min-height:40px;position:relative;padding:6px}.featured-asset[_ngcontent-%COMP%]   .compact-select[_ngcontent-%COMP%]{position:absolute;bottom:6px;right:6px;margin:0}.all-assets[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.all-assets[_ngcontent-%COMP%]   .drop-list[_ngcontent-%COMP%]{min-width:60px}.all-assets[_ngcontent-%COMP%]   .asset-thumb[_ngcontent-%COMP%]{margin:3px;padding:0;border:2px solid var(--color-component-border-100);border-radius:var(--border-radius-img);cursor:pointer}.all-assets[_ngcontent-%COMP%]   .asset-thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:var(--border-radius-img)}.all-assets[_ngcontent-%COMP%]   .asset-thumb.featured[_ngcontent-%COMP%]{border-color:var(--color-primary-500);border-radius:calc(var(--border-radius-img) + 2px)}.all-assets[_ngcontent-%COMP%]   .remove-asset[_ngcontent-%COMP%]{color:var(--color-warning-500)}.all-assets.compact[_ngcontent-%COMP%]   .drop-list[_ngcontent-%COMP%]{min-width:54px}.all-assets.compact[_ngcontent-%COMP%]   .asset-thumb[_ngcontent-%COMP%]{margin:1px;border-width:1px}.all-assets.compact[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%], .all-assets.compact[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]   .asset-thumb[_ngcontent-%COMP%]{width:50px}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.all-assets.cdk-drop-list-dragging[_ngcontent-%COMP%]   vdr-dropdown[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){display:none}"],changeDetection:0})}class Q{get isProductVariantMode(){return null!=this.productVariantIds}constructor(n,t){this.dataService=n,this.notificationService=t,this.priceFactorControl=new d.p4(1),this.selectedChannelIdControl=new d.p4}ngOnInit(){const n=this.dataService.client.userStatus().mapSingle(({userStatus:r})=>r.activeChannelId),t=this.dataService.settings.getChannels().mapSingle(r=>r.channels);(0,T.a)(n,t).subscribe(([r,a])=>{this.currentChannel=a.items.find(l=>l.id===r),this.availableChannels=a.items}),this.selectedChannelIdControl.valueChanges.subscribe(r=>{this.selectChannel(r)}),this.variantsPreview$=(0,T.a)((0,Je.D)(this.getTopVariants(10)),this.priceFactorControl.valueChanges.pipe((0,V.O)(1))).pipe((0,f.U)(([r,a])=>r.map(l=>({id:l.id,name:l.name,price:l.price,pricePreview:l.price*+a}))))}selectChannel(n){this.selectedChannel=this.availableChannels.find(t=>t.id===n[0])}assign(){const n=this.selectedChannel;n&&(this.isProductVariantMode?this.productVariantIds&&this.dataService.product.assignVariantsToChannel({channelId:n.id,productVariantIds:this.productVariantIds,priceFactor:+this.priceFactorControl.value}).subscribe(()=>{this.notificationService.success((0,p.J)("catalog.assign-variant-to-channel-success"),{channel:n.code,count:this.productVariantIds.length}),this.resolveWith(!0)}):this.dataService.product.assignProductsToChannel({channelId:n.id,productIds:this.productIds,priceFactor:+this.priceFactorControl.value}).subscribe(()=>{this.notificationService.success((0,p.J)("catalog.assign-product-to-channel-success"),{channel:n.code,count:this.productIds.length}),this.resolveWith(!0)}))}cancel(){this.resolveWith()}getTopVariants(n){var t=this;return(0,Ct.Z)(function*(){return(yield(0,Ge.n)(t.dataService.product.getProductVariants({filterOperator:i.FnJ.OR,filter:{productId:{in:t.productIds},id:{in:t.productVariantIds}},take:n}).single$)).productVariants.items})()}static#e=this.\u0275fac=function(t){return new(t||Q)(e.Y36(i.DoR),e.Y36(i.gqp))};static#t=this.\u0275cmp=e.Xpm({type:Q,selectors:[["vdr-assign-products-to-channel-dialog"]],decls:36,vars:32,consts:[["vdrDialogTitle",""],[1,"flex"],["clrInput","",3,"multiple","includeDefaultChannel","disableChannelIds","formControl"],[1,"flex-spacer"],["clrInput","","type","number","min","0","max","99999",3,"formControl"],[1,"channel-price-preview"],[1,"clr-control-label"],[1,"table"],[3,"ngIf","ngIfElse"],["noSelection",""],[4,"ngFor","ngForOf"],["vdrDialogButtons",""],[4,"ngIf","ngIfElse"],["productModeTitle",""],["noChannelSelected",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,r){if(1&t&&(e.YNc(0,Dn,3,2,"ng-template",0),e.TgZ(1,"div",1)(2,"clr-input-container")(3,"label"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"vdr-channel-assignment-control",2),e.qZA(),e._UZ(7,"div",3),e.TgZ(8,"clr-input-container")(9,"label"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e._UZ(12,"input",4),e.qZA()(),e.TgZ(13,"div",5)(14,"label",6),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"table",7)(18,"thead")(19,"tr")(20,"th"),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"th"),e._uU(24),e.ALo(25,"translate"),e.ALo(26,"translate"),e.ALo(27,"channelCodeToLabel"),e.qZA(),e.TgZ(28,"th"),e.YNc(29,Jn,2,6,"ng-template",8),e.YNc(30,Mn,2,3,"ng-template",null,9,e.W1O),e.qZA()()(),e.TgZ(32,"tbody"),e.YNc(33,$n,10,7,"tr",10),e.ALo(34,"async"),e.qZA()()(),e.YNc(35,Sn,7,6,"ng-template",11)),2&t){const a=e.MAs(31);e.xp6(4),e.Oqu(e.lcZ(5,13,"common.channel")),e.xp6(2),e.Q6J("multiple",!1)("includeDefaultChannel",!1)("disableChannelIds",r.currentChannelIds)("formControl",r.selectedChannelIdControl),e.xp6(4),e.Oqu(e.lcZ(11,15,"catalog.price-conversion-factor")),e.xp6(2),e.Q6J("formControl",r.priceFactorControl),e.xp6(3),e.Oqu(e.lcZ(16,17,"catalog.channel-price-preview")),e.xp6(6),e.Oqu(e.lcZ(22,19,"common.name")),e.xp6(3),e.hij(" ",e.xi3(25,21,"catalog.price-in-channel",e.VKq(30,Be,e.lcZ(26,24,e.lcZ(27,26,null==r.currentChannel?null:r.currentChannel.code))))," "),e.xp6(5),e.Q6J("ngIf",r.selectedChannel)("ngIfElse",a),e.xp6(4),e.Q6J("ngForOf",e.lcZ(34,28,r.variantsPreview$))}},dependencies:[_.MgK,_.xRP,_.G55,g.sg,g.O5,d.Fj,d.wV,d.JJ,d.qQ,d.Fd,d.oH,i.y_K,i.nPI,i.q6K,i.SGu,g.Ov,C.X$,i.E6B,i.kgx],styles:["vdr-channel-assignment-control[_ngcontent-%COMP%]{min-width:200px}.channel-price-preview[_ngcontent-%COMP%]{margin-top:24px}.channel-price-preview[_ngcontent-%COMP%]   table.table[_ngcontent-%COMP%]{margin-top:6px}"],changeDetection:0})}const tt=A.Ps`
    query GetProductsWithFacetValuesByIds($ids: [String!]!) {
        products(options: { filter: { id: { in: $ids } } }) {
            items {
                id
                name
                facetValues {
                    id
                    name
                    code
                    facet {
                        id
                        name
                        code
                    }
                }
            }
        }
    }
`,nt=A.Ps`
    query GetVariantsWithFacetValuesByIds($ids: [String!]!) {
        productVariants(options: { filter: { id: { in: $ids } } }) {
            items {
                id
                name
                sku
                facetValues {
                    id
                    name
                    code
                    facet {
                        id
                        name
                        code
                    }
                }
            }
        }
    }
`,rt=A.Ps`
    mutation UpdateProductsBulk($input: [UpdateProductInput!]!) {
        updateProducts(input: $input) {
            id
            name
            facetValues {
                id
                name
                code
            }
        }
    }
`,ot=A.Ps`
    mutation UpdateVariantsBulk($input: [UpdateProductVariantInput!]!) {
        updateProductVariants(input: $input) {
            id
            name
            facetValues {
                id
                name
                code
            }
        }
    }
`;class se{constructor(n,t){this.dataService=n,this.changeDetectorRef=t,this.mode="product",this.state="loading",this.selectedValues=[],this.items=[],this.facetValuesRemoved=!1}ngOnInit(){const n="product"===this.mode?this.dataService.query(tt,{ids:this.ids??[]}).mapSingle(({products:t})=>t.items.map(r=>({...r,facetValues:[...r.facetValues]}))):this.dataService.query(nt,{ids:this.ids??[]}).mapSingle(({productVariants:t})=>t.items.map(r=>({...r,facetValues:[...r.facetValues]})));this.subscription=n.subscribe({next:t=>{this.items=t,this.state="ready",this.changeDetectorRef.markForCheck()}})}ngOnDestroy(){this.subscription?.unsubscribe()}cancel(){this.resolveWith()}removeFacetValue(n,t){n.facetValues=n.facetValues.filter(r=>r.id!==t),this.facetValuesRemoved=!0}addFacetValues(){const n=this.selectedValues.map(r=>r.id);return this.state="saving",("product"===this.mode?this.dataService.mutate(rt,{input:this.items?.map(r=>({id:r.id,facetValueIds:(0,L.T)([...r.facetValues.map(a=>a.id),...n])}))}):this.dataService.mutate(ot,{input:this.items?.map(r=>({id:r.id,facetValueIds:(0,L.T)([...r.facetValues.map(a=>a.id),...n])}))})).subscribe(r=>{this.resolveWith(this.selectedValues)})}static#e=this.\u0275fac=function(t){return new(t||se)(e.Y36(i.DoR),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:se,selectors:[["vdr-bulk-add-facet-values-dialog"]],decls:11,vars:5,consts:[["vdrDialogTitle",""],[1,"flex"],[1,"flex","center"],[1,"mr2"],[3,"selectedValuesChange"],["class","table",4,"ngIf","ngIfElse"],["placeholder",""],["vdrDialogButtons",""],[1,"table"],[4,"ngFor","ngForOf"],[1,"left","align-middle"],["class","sku",4,"ngIf"],[1,"left"],[3,"facetValue","remove",4,"ngFor","ngForOf"],[1,"sku"],[3,"facetValue","remove"],[1,"loading"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,r){if(1&t&&(e.YNc(0,Gn,2,3,"ng-template",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"vdr-facet-value-selector",4),e.NdJ("selectedValuesChange",function(l){return r.selectedValues=l}),e.qZA()()(),e.YNc(7,jn,3,1,"table",5),e.YNc(8,Rn,2,0,"ng-template",null,6,e.W1O),e.YNc(10,Hn,6,7,"ng-template",7)),2&t){const a=e.MAs(9);e.xp6(4),e.hij(" ",e.lcZ(5,3,"catalog.add-facet-value")," "),e.xp6(3),e.Q6J("ngIf","loading"!==r.state)("ngIfElse",a)}},dependencies:[_.vNO,g.sg,g.O5,i.$MF,i.qt4,i.nPI,i.q6K,C.X$],styles:[".loading[_ngcontent-%COMP%]{min-height:25vh;display:flex;justify-content:center;align-items:center}.sku[_ngcontent-%COMP%]{color:var(--color-text-300)}"],changeDetection:0})}class R{constructor(n,t,r){this.route=n,this.router=t,this.dataService=r,this.previewUpdatedFilters=!1,this.filterTermControl=new d.p4(""),this.isLoading=!1,this.collectionIdChange$=new D.X(""),this.parentIdChange$=new D.X(""),this.filterChanges$=new D.X([]),this.inheritFiltersChanges$=new D.X(!0),this.refresh$=new D.X(!0),this.destroy$=new te.x}ngOnInit(){this.contentsCurrentPage$=this.route.queryParamMap.pipe((0,f.U)(c=>c.get("contentsPage")),(0,f.U)(c=>c?+c:1),(0,V.O)(1),(0,O.x)()),this.contentsItemsPerPage$=this.route.queryParamMap.pipe((0,f.U)(c=>c.get("contentsPerPage")),(0,f.U)(c=>c?+c:10),(0,V.O)(10),(0,O.x)());const n=this.filterTermControl.valueChanges.pipe((0,X.b)(250),(0,N.b)(()=>this.setContentsPageNumber(1)),(0,V.O)("")),t=this.filterChanges$.asObservable().pipe((0,De.h)(()=>this.previewUpdatedFilters),(0,N.b)(()=>this.setContentsPageNumber(1)),(0,V.O)([])),r=this.inheritFiltersChanges$.asObservable().pipe((0,De.h)(()=>null!=this.inheritFilters),(0,O.x)(),(0,N.b)(()=>this.setContentsPageNumber(1)),(0,V.O)(!0)),l=(0,T.a)(this.collectionIdChange$,this.parentIdChange$,this.contentsCurrentPage$,this.contentsItemsPerPage$,n,t,r,this.refresh$).pipe((0,ke.R)(this.destroy$),(0,N.b)(()=>this.isLoading=!0),(0,X.b)(50),(0,b.w)(([c,s,u,m,v,x,y])=>{const I=m,M=(u-1)*m;if(x.length&&this.previewUpdatedFilters){const w=v?{name:{contains:v}}:void 0;return this.dataService.collection.previewCollectionVariants({parentId:s,filters:x,inheritFilters:y},{take:I,skip:M,filter:w}).mapSingle(E=>E.previewCollectionVariants).pipe((0,xt.K)(()=>(0,F.of)({items:[],totalItems:0})))}return c?this.dataService.collection.getCollectionContents(c,I,M,v).mapSingle(w=>w.collection?.productVariants):(0,F.of)(null)}),(0,N.b)(()=>this.isLoading=!1),(0,Se.x)(()=>this.isLoading=!1));this.contents$=l.pipe((0,f.U)(c=>c?c.items:[])),this.contentsTotalItems$=l.pipe((0,f.U)(c=>c?c.totalItems:0))}ngOnChanges(n){"collectionId"in n&&this.collectionIdChange$.next(n.collectionId.currentValue),"parentId"in n&&this.parentIdChange$.next(n.parentId.currentValue),"inheritFilters"in n&&this.inheritFiltersChanges$.next(n.inheritFilters.currentValue),"updatedFilters"in n&&this.updatedFilters&&this.filterChanges$.next(this.updatedFilters)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setContentsPageNumber(n){this.setParam("contentsPage",n)}setContentsItemsPerPage(n){this.setParam("contentsPerPage",n)}refresh(){this.refresh$.next(!0)}setParam(n,t){this.router.navigate(["./"],{relativeTo:this.route,queryParams:{[n]:t},queryParamsHandling:"merge",replaceUrl:!0})}static#e=this.\u0275fac=function(t){return new(t||R)(e.Y36(P.gz),e.Y36(P.F0),e.Y36(i.DoR))};static#t=this.\u0275cmp=e.Xpm({type:R,selectors:[["vdr-collection-contents"]],contentQueries:function(t,r,a){if(1&t&&e.Suo(a,e.Rgc,7),2&t){let l;e.iGM(l=e.CRH())&&(r.headerTemplate=l.first)}},inputs:{collectionId:"collectionId",parentId:"parentId",inheritFilters:"inheritFilters",updatedFilters:"updatedFilters",previewUpdatedFilters:"previewUpdatedFilters"},features:[e.TTD],decls:27,vars:46,consts:[[1,"table-wrapper"],[1,"progress","loop"],[1,"header-title-row"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["id","collection-contents",3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[3,"searchTermControl","searchTermPlaceholder"],["id","id",3,"heading","hiddenByDefault"],["id","created-at",3,"heading","hiddenByDefault"],["id","updated-at",3,"heading","hiddenByDefault"],["id","name",3,"heading","optional"],["id","sku",3,"heading","optional"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.TgZ(2,"div",2),e.YNc(3,Kn,1,0,"ng-container",3),e.ALo(4,"async"),e.qZA(),e.TgZ(5,"vdr-data-table-2",4),e.NdJ("pageChange",function(l){return r.setContentsPageNumber(l)})("itemsPerPageChange",function(l){return r.setContentsItemsPerPage(l)}),e.ALo(6,"async"),e.ALo(7,"async"),e.ALo(8,"async"),e.ALo(9,"async"),e._UZ(10,"vdr-dt2-search",5),e.ALo(11,"translate"),e.TgZ(12,"vdr-dt2-column",6),e.ALo(13,"translate"),e.YNc(14,zn,1,1,"ng-template"),e.qZA(),e.TgZ(15,"vdr-dt2-column",7),e.ALo(16,"translate"),e.YNc(17,Wn,2,4,"ng-template"),e.qZA(),e.TgZ(18,"vdr-dt2-column",8),e.ALo(19,"translate"),e.YNc(20,Xn,2,4,"ng-template"),e.qZA(),e.TgZ(21,"vdr-dt2-column",9),e.ALo(22,"translate"),e.YNc(23,tr,4,4,"ng-template"),e.qZA(),e.TgZ(24,"vdr-dt2-column",10),e.ALo(25,"translate"),e.YNc(26,nr,1,1,"ng-template"),e.qZA()()()),2&t&&(e.xp6(1),e.ekj("visible",r.isLoading),e.xp6(2),e.Q6J("ngTemplateOutlet",r.headerTemplate)("ngTemplateOutletContext",e.VKq(44,rr,e.lcZ(4,22,r.contentsTotalItems$))),e.xp6(2),e.ekj("loading",r.isLoading),e.Q6J("items",e.lcZ(6,24,r.contents$))("itemsPerPage",e.lcZ(7,26,r.contentsItemsPerPage$))("totalItems",e.lcZ(8,28,r.contentsTotalItems$))("currentPage",e.lcZ(9,30,r.contentsCurrentPage$)),e.xp6(5),e.Q6J("searchTermControl",r.filterTermControl)("searchTermPlaceholder",e.lcZ(11,32,"catalog.filter-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(13,34,"common.id"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(16,36,"common.created-at"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(19,38,"common.updated-at"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(22,40,"common.name"))("optional",!1),e.xp6(3),e.Q6J("heading",e.lcZ(25,42,"catalog.sku"))("optional",!1))},dependencies:[_.qvL,g.tP,P.rH,i.eJ5,i.Up6,i.JBy,g.Ov,C.X$,i.HbD],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     table{margin-top:-1px}vdr-data-table[_ngcontent-%COMP%]{opacity:1;transition:opacity .3s}vdr-data-table.loading[_ngcontent-%COMP%]{opacity:.5}.table-wrapper[_ngcontent-%COMP%]{position:relative}.progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;overflow:hidden;height:6px;opacity:0;transition:opacity .1s}.progress.visible[_ngcontent-%COMP%]{opacity:1}.sku[_ngcontent-%COMP%]{color:var(--color-text-200)}"],changeDetection:0})}class H extends i.eJ5{constructor(n,t,r,a){super(n,t,r),this.changeDetectorRef=n,this.localStorageService=t,this.dataService=r,this.dragDrop=a,this.changeOrder=new e.vpe,this.dragRefs=[],this.absoluteIndex={},this.sortPredicate=(l,c)=>this.dropList.getSortedItems()[l]?.data.collection.parentId===c.data.collection.parentId}ngOnChanges(n){if(super.ngOnChanges(n),n.subCollections||n.items){const t=[];for(const r of this.items??[]){t.push(r);const a=this.getSubcollections(r);t.push(...a.flat())}t.forEach((r,a)=>this.absoluteIndex[r.id]=a)}}ngAfterViewInit(){this.collectionRowList.changes.subscribe(n=>{this.dropList.getSortedItems().forEach(t=>this.dropList.removeItem(t));for(const t of n.toArray())t.dropContainer=this.dropList,t._dragRef._withDropContainer(this.dropList._dropListRef),this.dropList.addItem(t)})}getSubcollections(n){return this.subCollections?.filter(t=>t.parentId===n.id)??[]}onDrop(n){const t=2===n.item.data.collection.breadcrumbs.length,r=t?(this.currentPage-1)*this.itemsPerPage:0,a=n.item.data.collection.parentId,l=this.items.findIndex(s=>s.id===a),c=r+n.currentIndex-l-1;if(this.changeOrder.emit({collectionId:n.item.data.collection.id,index:c,parentId:n.item.data.collection.parentId}),t)this.items=[...this.items],this.items.splice(n.previousIndex,1),this.items.splice(n.currentIndex,0,n.item.data.collection);else{const s=this.items.find(u=>u.id===a);if(s){const u=this.getSubcollections(s),m=r+n.previousIndex-l-1;u.splice(m,1),u.splice(n.currentIndex,0,n.item.data.collection)}}this.changeDetectorRef.markForCheck()}static#e=this.\u0275fac=function(t){return new(t||H)(e.Y36(e.sBO),e.Y36(i.n2A),e.Y36(i.DoR),e.Y36(k.v0))};static#t=this.\u0275cmp=e.Xpm({type:H,selectors:[["vdr-collection-data-table"]],viewQuery:function(t,r){if(1&t&&(e.Gf(k.Wj,7),e.Gf(or,5,k.Zt)),2&t){let a;e.iGM(a=e.CRH())&&(r.dropList=a.first),e.iGM(a=e.CRH())&&(r.collectionRowList=a)}},inputs:{subCollections:"subCollections"},outputs:{changeOrder:"changeOrder"},features:[e.qOj,e.TTD],ngContentSelectors:Ur,decls:25,vars:27,consts:[[3,"filters","dataTableId",4,"ngIf"],[1,"table-wrapper"],[1,"bulk-actions"],[1,""],[1,"heading-row"],["class","selection-col",4,"ngIf"],[3,"expand",4,"ngFor","ngForOf"],[1,"column-picker"],[3,"uiLanguage","columns","reorder","resetColumns"],[4,"ngIf"],["cdkDropList","","cdkDropListLockAxis","y",3,"cdkDropListSortPredicate","cdkDropListDropped"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"table-footer"],[3,"itemsPerPage","itemsPerPageChange",4,"ngIf"],["class","p5 total-items-count",4,"ngIf"],[3,"id","currentPage","itemsPerPage","totalItems","pageChange",4,"ngIf"],["collectionRowTmp",""],[3,"filters","dataTableId"],[1,"selection-col"],[1,"flex"],[1,"drag-handle-spacer"],["type","checkbox","clrCheckbox","",3,"checked","change"],[1,"cell-content",3,"ngClass"],["api","dataTable","display","block",3,"locationId","metadata","topPx","leftPx"],["class","sort-toggle",4,"ngIf"],[1,"sort-toggle"],[3,"click"],["shape","two-way-arrows left",4,"ngIf"],["shape","arrow up",4,"ngIf"],["shape","arrow down",4,"ngIf"],["class","sort-label",4,"ngIf"],["shape","two-way-arrows left"],["shape","arrow up"],["shape","arrow down"],[1,"sort-label"],[1,"filter-row"],[1,"button-ghost","toggle-search-filter-row",3,"title","click"],["shape","search"],[1,"filter-row-wrapper"],[4,"ngTemplateOutlet"],[1,"filters"],["class","mt-1",3,"filterWithValue","filters",4,"ngFor","ngForOf"],["class","mt-1",3,"filters",4,"ngIf"],[1,"mt-1",3,"filterWithValue","filters"],[1,"mt-1",3,"filters"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"emptyStateLabel"],[3,"itemsPerPage","itemsPerPageChange"],[1,"p5","total-items-count"],[3,"id","currentPage","itemsPerPage","totalItems","pageChange"],["cdkDrag","","cdkDragBoundary","tbody",3,"cdkDragData"],["collectionRow",""],["class","selection-col",3,"active",4,"ngIf"],[3,"active",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["cdkDragHandle","",1,"drag-handle",3,"title"],["shape","drag-handle"],["type","checkbox","clrCheckbox","",3,"checked","click"],[4,"ngIf","ngIfElse"],["defaultComponent",""],[4,"ngComponentOutlet","ngComponentOutletInputs","ngComponentOutletInjector"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,r){1&t&&(e.F$t(Vr),e.YNc(0,ar,1,2,"vdr-data-table-filter-presets",0),e.TgZ(1,"div",1)(2,"div",2),e.Hsn(3),e.qZA(),e.TgZ(4,"table",3)(5,"thead")(6,"tr",4),e.YNc(7,ir,4,1,"th",5),e.YNc(8,ur,6,9,"th",6),e.TgZ(9,"th")(10,"div",7)(11,"vdr-data-table-colum-picker",8),e.NdJ("reorder",function(l){return r.onColumnReorder(l)})("resetColumns",function(){return r.onColumnsReset()}),e.ALo(12,"async"),e.qZA()()()(),e.YNc(13,vr,9,13,"tr",9),e.qZA(),e.TgZ(14,"tbody",10),e.NdJ("cdkDropListDropped",function(l){return r.onDrop(l)}),e.YNc(15,Cr,2,5,"ng-container",11),e.ALo(16,"paginate"),e.ynx(17),e.YNc(18,xr,3,2,"tr",9),e.BQk(),e.qZA()()(),e.TgZ(19,"div",12),e.YNc(20,yr,1,1,"vdr-items-per-page-controls",13),e.YNc(21,Tr,3,8,"div",14),e.YNc(22,Ar,1,4,"vdr-pagination-controls",15),e.qZA(),e.YNc(23,Nr,6,9,"ng-template",null,16,e.W1O)),2&t&&(e.Q6J("ngIf",r.filters),e.xp6(4),e.ekj("no-select",r.disableSelect),e.xp6(1),e.ekj("items-selected",null==r.selectionManager?null:r.selectionManager.selection.length),e.xp6(2),e.Q6J("ngIf",r.selectionManager),e.xp6(1),e.Q6J("ngForOf",r.visibleSortedColumns),e.xp6(3),e.Q6J("uiLanguage",e.lcZ(12,17,r.uiLanguage$))("columns",r.sortedColumns),e.xp6(2),e.Q6J("ngIf",r.searchComponent||r.customSearchTemplate||(null==r.filters?null:r.filters.length)),e.xp6(1),e.Q6J("cdkDropListSortPredicate",r.sortPredicate),e.xp6(1),e.Q6J("ngForOf",e.xi3(16,19,r.items,e.l5B(22,$r,r.itemsPerPage,r.currentPage,r.totalItems,r.id)))("ngForTrackBy",r.trackByFn),e.xp6(3),e.Q6J("ngIf",!(null!=r.items&&r.items.length)),e.xp6(2),e.Q6J("ngIf",r.totalItems),e.xp6(1),e.Q6J("ngIf",r.totalItems),e.xp6(1),e.Q6J("ngIf",r.totalItems))},dependencies:[_.q0d,_.qvL,_.KKC,g.mk,g.$G,g.sg,g.O5,g.tP,k.Wj,k.Zt,k.Bh,i.wAH,i.LSK,i.y_K,i.jw0,i.rak,i.IYn,i.Lo_,i.RYB,i.tRr,g.Ov,we._s,C.X$],styles:["[_nghost-%COMP%]{display:block;max-width:100%;position:relative;margin-bottom:calc(var(--space-unit) * 4);container-type:inline-size}th[_ngcontent-%COMP%]{border-bottom:1px solid var(--color-table-header-border);font-size:var(--font-size-xs);font-weight:600;text-transform:uppercase;position:relative;white-space:nowrap}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:calc(var(--space-unit) * 1.5) calc(var(--space-unit) * 1)}tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-of-type, tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-of-type{text-align:center}@media screen and (min-width: 992px){tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-of-type, tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-of-type{padding-inline-start:var(--surface-margin-left);text-align:start}}th[_ngcontent-%COMP%]:last-of-type, td[_ngcontent-%COMP%]:last-of-type{border-inline-end:1px solid var(--color-table-header-border)}tr[_ngcontent-%COMP%]:first-of-type   th[_ngcontent-%COMP%]:last-of-type{border-image:linear-gradient(0deg,var(--color-table-header-border),transparent) 1}tr[_ngcontent-%COMP%]:last-of-type   td[_ngcontent-%COMP%]:last-of-type{border-image:linear-gradient(180deg,var(--color-table-header-border),transparent) 1}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid var(--color-table-row-separator)}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:var(--color-table-row-hover-bg)}.bulk-actions[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * 5);background-color:var(--color-surface-bg);z-index:10;display:flex;position:absolute;top:5px;height:40px}@media screen and (min-width: 992px){.bulk-actions[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * 8.5)}}@media screen and (min-width: 1280px){.bulk-actions[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * 10.5)}}.table-wrapper[_ngcontent-%COMP%]{display:block;overflow-y:hidden;overflow-x:auto;position:relative;width:100%;max-width:var(--surface-width)}table[_ngcontent-%COMP%]{width:100%}table.no-select[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.column-picker[_ngcontent-%COMP%]{width:24px}.sort-toggle[_ngcontent-%COMP%]{display:flex;align-items:center;margin-inline-start:calc(var(--space-unit) * .5)}.sort-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;border-radius:var(--border-radius-lg);color:var(--color-weight-500);padding:0 2px;cursor:pointer;background-color:transparent}.sort-toggle[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{color:var(--color-primary-700)}.sort-toggle[_ngcontent-%COMP%]   .sort-label[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * .5);font-size:10px;color:var(--color-primary-600);font-weight:400}.toggle-search-filter-row[_ngcontent-%COMP%]{position:absolute;top:-12px;left:4px}@media screen and (min-width: 1280px){.toggle-search-filter-row[_ngcontent-%COMP%]{left:8px}}.toggle-search-filter-row.active[_ngcontent-%COMP%]{background-color:var(--color-primary-700);color:var(--color-primary-100);border-color:var(--color-primary-700)}th.filter-row[_ngcontent-%COMP%]{position:relative;font-size:var(--font-size-base);font-weight:400;background-color:var(--color-weight-100);box-shadow:var(--data-table-filter-box-shadow);border-left-width:0;border-right-width:0;text-align:initial;padding:0}th.filter-row[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}th.filter-row.active[_ngcontent-%COMP%]{border-bottom:1px solid var(--color-table-header-border)}th.filter-row[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{margin-top:calc(var(--space-unit) * 1);display:flex;flex-wrap:wrap;gap:calc(var(--space-unit) * .5)}.filter-row-wrapper[_ngcontent-%COMP%]{padding:calc(var(--space-unit) * 4);padding-inline-start:0;max-height:150px;transition:max-height .2s,padding .2s,opacity .2s}.filter-row-wrapper.hidden[_ngcontent-%COMP%]{max-height:0px;padding-top:0;padding-bottom:0;overflow:hidden;opacity:0}.cell-link[_ngcontent-%COMP%]{display:block;width:100%;height:100%}td.active[_ngcontent-%COMP%]{background-color:var(--color-table-row-active-bg)}.cell-content[_ngcontent-%COMP%]{display:flex;align-items:center;line-height:var(--font-size-sm);color:var(--color-weight-700)}.cell-content.left[_ngcontent-%COMP%]{justify-content:flex-start}.cell-content.center[_ngcontent-%COMP%]{justify-content:center}.cell-content.right[_ngcontent-%COMP%]{justify-content:flex-end}.selection-col[_ngcontent-%COMP%]{width:calc(var(--space-unit) * 8)}vdr-empty-placeholder[_ngcontent-%COMP%]{width:100%}.table-footer[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:space-between;margin-top:var(--space-unit);margin-inline-start:var(--surface-margin-left);margin-inline-end:var(--space-unit)}.total-items-count[_ngcontent-%COMP%]{font-size:var(--font-size-xs)}@container (max-width: 500px){.total-items-count[_ngcontent-%COMP%]{display:none}}",".bulk-actions[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * 6);background-color:var(--color-surface-bg)}@media screen and (min-width: 992px){.bulk-actions[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * 9.5)}}@media screen and (min-width: 1280px){.bulk-actions[_ngcontent-%COMP%]{margin-inline-start:calc(var(--space-unit) * 11.5)}}.drag-handle[_ngcontent-%COMP%]{cursor:grab}.drag-handle-spacer[_ngcontent-%COMP%]{width:16px}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .cdk-drag[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .3s cubic-bezier(0,0,.2,1)}.cdk-drag-preview[_ngcontent-%COMP%]{opacity:0}.cdk-drag-placeholder[_ngcontent-%COMP%]{background-color:var(--color-primary-100)!important}"],changeDetection:0})}const Kl=A.Ps`
    query CollectionDetailQuery($id: ID!) {
        collection(id: $id) {
            ...Collection
        }
    }
    ${i.vWg}
`;class de extends i.VE7{constructor(n,t,r,a,l,c){super(),this.changeDetector=n,this.dataService=t,this.formBuilder=r,this.notificationService=a,this.modalService=l,this.localStorageService=c,this.customFields=this.getCustomFieldConfig("Collection"),this.detailForm=this.formBuilder.group({name:["",d.kI.required],slug:["",(0,i.Foo)(/^[\p{Letter}0-9._-]+$/)],description:"",visible:!1,inheritFilters:!0,filters:this.formBuilder.array([]),customFields:this.formBuilder.group((0,i.Lrj)(this.customFields))}),this.assetChanges={},this.filters=[],this.allFilters=[],this.livePreview=!1,this.updatePermission=[i.y3$.UpdateCatalog,i.y3$.UpdateCollection],this.filterRemoved$=new te.x,this.livePreview=this.localStorageService.get("livePreviewCollectionContents")??!1}ngOnInit(){this.init(),this.dataService.collection.getCollectionFilters().single$.subscribe(r=>{this.allFilters=r.collectionFilters});const n=this.detailForm.get("filters"),t=this.detailForm.get("inheritFilters");this.inheritFilters$=t.valueChanges.pipe((0,O.x)()),this.updatedFilters$=(0,It.T)(n.statusChanges,this.filterRemoved$).pipe((0,X.b)(200),(0,De.h)(()=>n.touched),(0,f.U)(()=>this.mapOperationsToInputs(this.filters,n.value).filter(r=>{for(const a of r.arguments)if(""===a.value)return!1;return!0}))),this.parentId$=this.route.paramMap.pipe((0,f.U)(r=>r.get("parentId")||void 0),(0,b.w)(r=>r?(0,F.of)(r):this.entity$.pipe((0,f.U)(a=>a.parent?.id))))}ngOnDestroy(){this.destroy()}getFilterDefinition(n){return this.allFilters.find(t=>t.code===n.code)}assetsChanged(){return!!Object.values(this.assetChanges).length}updateSlug(n){const t=this.detailForm.get(["slug"]),r=this.entity?(0,i.ZIM)(this.entity,this.languageCode):void 0,a=!r||!r.slug;t&&t.pristine&&a&&t.setValue((0,U.U)(`${n}`,"-"))}addFilter(n){const t=this.detailForm.get("filters"),r=n.args.reduce((a,l)=>({...a,[l.name]:(0,i.sux)(l.value)}),{});t.push(this.formBuilder.control({code:n.code,args:r})),this.filters.push({code:n.code,args:n.args.map(a=>({name:a.name,value:(0,i.sux)(a.value)}))})}removeFilter(n){const t=this.detailForm.get("filters");-1!==n&&(t.removeAt(n),t.markAsDirty(),t.markAsTouched(),this.filters.splice(n,1),this.filterRemoved$.next())}create(){if(!this.detailForm.dirty)return;const n=this.getUpdatedCollection({id:"",createdAt:"",updatedAt:"",languageCode:this.languageCode,name:"",slug:"",isPrivate:!1,breadcrumbs:[],description:"",featuredAsset:null,assets:[],translations:[],inheritFilters:!0,filters:[],parent:{},children:null},this.detailForm,this.languageCode),t=this.route.snapshot.paramMap.get("parentId");t&&(n.parentId=t),this.dataService.collection.createCollection(n).subscribe(r=>{this.notificationService.success((0,p.J)("common.notify-create-success"),{entity:"Collection"}),this.assetChanges={},this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",r.createCollection.id],{relativeTo:this.route})},r=>{this.notificationService.error((0,p.J)("common.notify-create-error"),{entity:"Collection"})})}save(){(0,T.a)(this.entity$,this.languageCode$).pipe((0,$.q)(1),(0,J.z)(([n,t])=>{const r=this.getUpdatedCollection(n,this.detailForm,t);return this.dataService.collection.updateCollection(r)})).subscribe(()=>{this.assetChanges={},this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.notificationService.success((0,p.J)("common.notify-update-success"),{entity:"Collection"}),this.contentsComponent.refresh()},n=>{this.notificationService.error((0,p.J)("common.notify-update-error"),{entity:"Collection"})})}canDeactivate(){return super.canDeactivate()&&!this.assetChanges.assets&&!this.assetChanges.featuredAsset}toggleLivePreview(){this.livePreview=!this.livePreview,this.localStorageService.set("livePreviewCollectionContents",this.livePreview)}trackByFn(n,t){return JSON.stringify(t)}setFormValues(n,t){const r=(0,i.ZIM)(n,t);this.detailForm.patchValue({name:r?r.name:"",slug:r?r.slug:"",description:r?r.description:"",visible:!n.isPrivate,inheritFilters:n.inheritFilters});const a=this.detailForm.get("filters");a.length!==n.filters.length&&(a.clear(),this.filters=[],n.filters.forEach(l=>this.addFilter(l))),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["customFields"]),n,r)}getUpdatedCollection(n,t,r){return{...(0,i.iSy)({translatable:n,updatedFields:t.value,customFieldConfig:this.customFields,languageCode:r,defaultTranslation:{languageCode:r,name:n.name||"",slug:n.slug||"",description:n.description||""}}),assetIds:this.assetChanges.assets?.map(l=>l.id),featuredAssetId:this.assetChanges.featuredAsset?.id,isPrivate:!t.value.visible,filters:this.mapOperationsToInputs(this.filters,this.detailForm.value.filters)}}mapOperationsToInputs(n,t){return n.map((r,a)=>({code:r.code,arguments:Object.entries(t[a].args).map(([l,c],s)=>({name:l,value:(0,i.qrw)(c)}))}))}static#e=this.\u0275fac=function(t){return new(t||de)(e.Y36(e.sBO),e.Y36(i.DoR),e.Y36(d.qu),e.Y36(i.gqp),e.Y36(i.Z7U),e.Y36(i.n2A))};static#t=this.\u0275cmp=e.Xpm({type:de,selectors:[["vdr-collection-detail"]],viewQuery:function(t,r){if(1&t&&e.Gf(qr,5),2&t){let a;e.iGM(a=e.CRH())&&(r.contentsComponent=a.first)}},features:[e.qOj],decls:73,vars:89,consts:[[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","collection-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","visibility",3,"label"],["type","checkbox","clrToggle","","formControlName","visible","id","visibility",3,"vdrDisabled"],[1,"visible-toggle"],[4,"ngIf","ngIfElse"],["private",""],[4,"ngIf"],[1,"form-grid"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly","input"],["for","slug",3,"label","errors"],["id","slug","type","text","formControlName","slug",3,"readonly"],["for","slug",1,"form-grid-span",3,"label"],["formControlName","description",3,"readonly"],["formGroupName","customFields",3,"title",4,"ngIf"],["locationId","collection-detail",3,"entity$","detailForm"],[3,"title"],[3,"assets","featuredAsset","updatePermissions","change"],["for","inheritFilters",3,"label"],["type","checkbox","clrToggle","","formControlName","inheritFilters","id","inheritFilters",3,"vdrDisabled"],["noInherit",""],["formArrayName","filters"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"vdrIfPermissions"],[3,"title","paddingX"],[3,"collectionId","parentId","updatedFilters","inheritFilters","previewUpdatedFilters"],["collectionContents",""],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"entity"],["role","navigation"],[1,"collection-breadcrumbs"],[4,"ngFor","ngForOf"],[3,"routerLink",4,"ngIf"],[3,"routerLink"],["formGroupName","customFields",3,"title"],["entityName","Collection",3,"customFields","customFieldsFormGroup","readonly"],[3,"position","operation","operationDefinition","formControlName","readonly","remove"],["vdrDropdownTrigger","",1,"btn","btn-outline"],["shape","plus"],["shape","ellipsis-vertical"],["vdrPosition","bottom-left"],["type","button","vdrDropdownItem","",3,"click",4,"ngFor","ngForOf"],["type","button","vdrDropdownItem","",3,"click"],[1,"ml-3"],[1,"contents-title"],["type","checkbox","clrCheckbox","",3,"ngModelOptions","disabled","ngModel","ngModelChange"]],template:function(t,r){if(1&t&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-left")(3,"vdr-language-selector",0),e.NdJ("languageCodeChange",function(l){return r.setLanguage(l)}),e.ALo(4,"async"),e.ALo(5,"async"),e.ALo(6,"async"),e.qZA()(),e.TgZ(7,"vdr-ab-right"),e._UZ(8,"vdr-action-bar-items",1),e.YNc(9,Qr,3,4,"button",2),e.ALo(10,"async"),e.YNc(11,Gr,1,1,"ng-template",null,3,e.W1O),e.qZA()()(),e.TgZ(13,"form",4)(14,"vdr-page-detail-layout")(15,"vdr-page-detail-sidebar")(16,"vdr-card")(17,"vdr-form-field",5),e.ALo(18,"translate"),e.TgZ(19,"clr-toggle-wrapper"),e._UZ(20,"input",6),e.ALo(21,"hasPermission"),e.TgZ(22,"label",7),e.YNc(23,Yr,3,3,"ng-container",8),e.YNc(24,Br,2,3,"ng-template",null,9,e.W1O),e.qZA()()()(),e.YNc(26,Er,2,1,"vdr-card",10),e.ALo(27,"async"),e.qZA(),e.YNc(28,Xr,4,1,"vdr-page-block",10),e.ALo(29,"async"),e.TgZ(30,"vdr-page-block")(31,"vdr-card")(32,"div",11)(33,"vdr-form-field",12),e.ALo(34,"translate"),e.TgZ(35,"input",13),e.NdJ("input",function(l){return r.updateSlug(l.target.value)}),e.ALo(36,"hasPermission"),e.qZA()(),e.TgZ(37,"vdr-form-field",14),e.ALo(38,"translate"),e.ALo(39,"translate"),e._UZ(40,"input",15),e.ALo(41,"hasPermission"),e.qZA(),e.TgZ(42,"vdr-form-field",16),e.ALo(43,"translate"),e._UZ(44,"vdr-rich-text-editor",17),e.ALo(45,"hasPermission"),e.qZA()()(),e.YNc(46,eo,4,8,"vdr-card",18),e._UZ(47,"vdr-custom-detail-component-host",19),e.TgZ(48,"vdr-card",20),e.ALo(49,"translate"),e.TgZ(50,"vdr-assets",21),e.NdJ("change",function(l){return r.assetChanges=l}),e.qZA()(),e.TgZ(51,"vdr-card",20),e.ALo(52,"translate"),e.TgZ(53,"vdr-form-field",22),e.ALo(54,"translate"),e.TgZ(55,"clr-toggle-wrapper"),e._UZ(56,"input",23),e.ALo(57,"hasPermission"),e.TgZ(58,"label",7),e.YNc(59,to,3,3,"ng-container",8),e.YNc(60,no,2,3,"ng-template",null,24,e.W1O),e.qZA()()(),e.TgZ(62,"div",25),e.YNc(63,ro,3,7,"ng-container",26),e.qZA(),e.YNc(64,ao,10,4,"div",27),e.qZA(),e.TgZ(65,"vdr-card",28),e.ALo(66,"translate"),e.TgZ(67,"vdr-collection-contents",29,30),e.ALo(69,"async"),e.ALo(70,"async"),e.ALo(71,"async"),e.YNc(72,lo,10,18,"ng-template"),e.qZA()()()()()),2&t){const a=e.MAs(12),l=e.MAs(25),c=e.MAs(61);e.xp6(3),e.Q6J("disabled",e.lcZ(4,41,r.isNew$))("availableLanguageCodes",e.lcZ(5,43,r.availableLanguages$))("currentLanguageCode",e.lcZ(6,45,r.languageCode$)),e.xp6(6),e.Q6J("ngIf",e.lcZ(10,47,r.isNew$))("ngIfElse",a),e.xp6(4),e.Q6J("formGroup",r.detailForm),e.xp6(4),e.Q6J("label",e.lcZ(18,49,"catalog.visibility")),e.xp6(3),e.Q6J("vdrDisabled",!e.lcZ(21,51,r.updatePermission)),e.xp6(3),e.Q6J("ngIf",r.detailForm.value.visible)("ngIfElse",l),e.xp6(3),e.Q6J("ngIf",e.lcZ(27,53,r.entity$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(29,55,r.entity$)),e.xp6(5),e.Q6J("label",e.lcZ(34,57,"common.name")),e.xp6(2),e.Q6J("readonly",!e.lcZ(36,59,r.updatePermission)),e.xp6(2),e.Q6J("label",e.lcZ(38,61,"catalog.slug"))("errors",e.VKq(87,Me,e.lcZ(39,63,"catalog.slug-pattern-error"))),e.xp6(3),e.Q6J("readonly",!e.lcZ(41,65,r.updatePermission)),e.xp6(2),e.Q6J("label",e.lcZ(43,67,"common.description")),e.xp6(2),e.Q6J("readonly",!e.lcZ(45,69,r.updatePermission)),e.xp6(2),e.Q6J("ngIf",r.customFields.length),e.xp6(1),e.Q6J("entity$",r.entity$)("detailForm",r.detailForm),e.xp6(1),e.Q6J("title",e.lcZ(49,71,"catalog.assets")),e.xp6(2),e.Q6J("assets",null==r.entity?null:r.entity.assets)("featuredAsset",null==r.entity?null:r.entity.featuredAsset)("updatePermissions",r.updatePermission),e.xp6(1),e.Q6J("title",e.lcZ(52,73,"catalog.filters")),e.xp6(2),e.Q6J("label",e.lcZ(54,75,"catalog.filter-inheritance")),e.xp6(3),e.Q6J("vdrDisabled",!e.lcZ(57,77,r.updatePermission)),e.xp6(3),e.Q6J("ngIf",r.detailForm.value.inheritFilters)("ngIfElse",c),e.xp6(4),e.Q6J("ngForOf",r.filters)("ngForTrackBy",r.trackByFn),e.xp6(1),e.Q6J("vdrIfPermissions",r.updatePermission),e.xp6(1),e.Q6J("title",e.lcZ(66,79,"common.contents"))("paddingX",!1),e.xp6(2),e.Q6J("collectionId",r.id)("parentId",e.lcZ(69,81,r.parentId$))("updatedFilters",e.lcZ(70,83,r.updatedFilters$))("inheritFilters",e.lcZ(71,85,r.inheritFilters$))("previewUpdatedFilters",r.livePreview)}},dependencies:[_.q0d,_.qvL,_.MgK,_.KKC,_.PEh,g.sg,g.O5,d._Y,d.Fj,d.Wl,d.JJ,d.JL,d.On,d.sg,d.u,d.x0,d.CE,P.rH,i.KkL,i.BND,i.mz,i.qq8,i.hgI,i.y_K,i.SdP,i.YI,i.JOL,i.N9E,i.UaT,i.HH4,i.HAh,i.WWO,i.x3T,i.yc0,i.CWh,i.zJY,i.DME,i.TeL,i.W1W,i.AkF,G,R,g.Ov,C.X$,i.j$k],styles:['@charset "UTF-8";.visible-toggle[_ngcontent-%COMP%]{margin-top:-3px!important}clr-checkbox-wrapper[_ngcontent-%COMP%]{transition:opacity .3s}clr-checkbox-wrapper.disabled[_ngcontent-%COMP%]{opacity:.5}.collection-breadcrumbs[_ngcontent-%COMP%]{list-style-type:none;background-color:var(--color-component-bg-200);padding:2px 6px;margin-bottom:6px;border-radius:var(--clr-global-borderradius)}.collection-breadcrumbs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:.65rem;display:inline-block;margin-inline-end:10px}.collection-breadcrumbs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:not(:last-child):after{content:"\\203a";top:0;color:var(--color-grey-400);margin-inline-start:10px}'],changeDetection:0})}class K{transform(n){return n?.breadcrumbs.slice(1,-1)}static#e=this.\u0275fac=function(t){return new(t||K)};static#t=this.\u0275pipe=e.Yjl({name:"collectionBreadcrumb",type:K,pure:!0})}class pe{constructor(n,t){this.dataService=n,this.i18nService=t,this.searchTermControl=new d.NI(""),this.currentPage$=new D.X(1),this.itemsPerPage$=new D.X(10),this.expandedIds$=new te.x,this.expandedIds=[]}ngOnInit(){const n=this.dataService.collection.getCollections(),t=this.searchTermControl.valueChanges.pipe((0,X.b)(250),(0,O.x)(),(0,V.O)("")),r=this.currentPage$.pipe((0,O.x)()),a=this.itemsPerPage$.pipe((0,O.x)());(0,T.a)(t,r,a).subscribe(([c,s,u])=>{const m=""===c;n.ref.refetch({options:{skip:(s-1)*u,take:u,filter:{name:{contains:c}},topLevelOnly:m}})});const l=this.dataService.collection.getCollections({take:1,topLevelOnly:!0}).mapSingle(c=>c.collections.items[0].parentId);this.items$=(0,T.a)(n.mapStream(({collections:c})=>c),l).pipe((0,f.U)(([c,s])=>[...s?[{id:s,name:this.i18nService.translate("catalog.root-collection"),slug:"",parentId:"__",position:0,featuredAsset:null,children:[],breadcrumbs:[],isPrivate:!1,createdAt:"",updatedAt:""}]:[],...c.items])),this.totalItems$=n.mapStream(c=>c.collections.totalItems),this.subCollections$=this.expandedIds$.pipe((0,N.b)(c=>this.expandedIds=c),(0,b.w)(c=>c.length?this.dataService.collection.getCollections({take:999,filter:{parentId:{in:c}}}).mapStream(s=>s.collections.items):(0,F.of)([])))}toggleExpanded(n){let t=this.expandedIds;t.includes(n.id)?t=t.filter(r=>r!==n.id):t.push(n.id),this.expandedIds$.next(t)}static#e=this.\u0275fac=function(t){return new(t||pe)(e.Y36(i.DoR),e.Y36(i.Dp7))};static#t=this.\u0275cmp=e.Xpm({type:pe,selectors:[["vdr-move-collections-dialog"]],decls:21,vars:33,consts:[["vdrDialogTitle",""],["id","move-collection-list",1,"mt-2",3,"items","subCollections","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[3,"searchTermControl","searchTermPlaceholder"],["id","id",3,"heading","hiddenByDefault"],["id","name",3,"heading","optional"],["id","breadcrumb",3,"heading"],["id","slug",3,"heading"],[3,"ngClass"],["class","child-arrow","shape","child-arrow",3,"transparent",4,"ngIf"],["class","icon-button folder-button",3,"click",4,"ngIf"],["class","icon-button folder-button","disabled","",4,"ngIf"],[1,"button-ghost",3,"click"],["shape","child-arrow",1,"child-arrow"],[1,"icon-button","folder-button",3,"click"],["shape","folder",4,"ngIf"],["shape","folder-open",4,"ngIf"],["shape","folder"],["shape","folder-open"],["disabled","",1,"icon-button","folder-button"],["shape","folder",1,"is-solid"],[1,"breadcrumb"],[4,"ngIf"],["class","separator",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"separator"]],template:function(t,r){1&t&&(e.YNc(0,co,2,3,"ng-template",0),e.TgZ(1,"vdr-collection-data-table",1),e.NdJ("pageChange",function(l){return r.currentPage$.next(l)})("itemsPerPageChange",function(l){return r.itemsPerPage$.next(l)}),e.ALo(2,"async"),e.ALo(3,"async"),e.ALo(4,"async"),e.ALo(5,"async"),e.ALo(6,"async"),e._UZ(7,"vdr-dt2-search",2),e.ALo(8,"translate"),e.TgZ(9,"vdr-dt2-column",3),e.ALo(10,"translate"),e.YNc(11,so,1,1,"ng-template"),e.qZA(),e.TgZ(12,"vdr-dt2-column",4),e.ALo(13,"translate"),e.YNc(14,ho,8,10,"ng-template"),e.qZA(),e.TgZ(15,"vdr-dt2-column",5),e.ALo(16,"translate"),e.YNc(17,yo,3,3,"ng-template"),e.qZA(),e.TgZ(18,"vdr-dt2-column",6),e.ALo(19,"translate"),e.YNc(20,Po,1,1,"ng-template"),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("items",e.lcZ(2,13,r.items$))("subCollections",e.lcZ(3,15,r.subCollections$))("itemsPerPage",e.lcZ(4,17,r.itemsPerPage$))("totalItems",e.lcZ(5,19,r.totalItems$))("currentPage",e.lcZ(6,21,r.currentPage$)),e.xp6(6),e.Q6J("searchTermControl",r.searchTermControl)("searchTermPlaceholder",e.lcZ(8,23,"common.search-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(10,25,"common.id"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(13,27,"common.name"))("optional",!1),e.xp6(3),e.Q6J("heading",e.lcZ(16,29,"common.breadcrumb")),e.xp6(3),e.Q6J("heading",e.lcZ(19,31,"common.slug")))},dependencies:[_.qvL,g.mk,g.sg,g.O5,i.q6K,i.Up6,i.JBy,H,g.Ov,C.X$,K],styles:["[_nghost-%COMP%]{--indent-spacing: 18px}.indent-1[_ngcontent-%COMP%]{padding-inline-start:var(--indent-spacing)}.indent-2[_ngcontent-%COMP%]{padding-inline-start:calc(var(--indent-spacing) * 2)}.indent-3[_ngcontent-%COMP%]{padding-inline-start:calc(var(--indent-spacing) * 3)}.indent-4[_ngcontent-%COMP%], .indent-5[_ngcontent-%COMP%], .indent-6[_ngcontent-%COMP%], .indent-7[_ngcontent-%COMP%], .indent-8[_ngcontent-%COMP%], .indent-9[_ngcontent-%COMP%]{padding-inline-start:calc(var(--indent-spacing) * 4)}.child-arrow[_ngcontent-%COMP%]{margin:1px 6px}.child-arrow.transparent[_ngcontent-%COMP%]{opacity:0}.breadcrumb[_ngcontent-%COMP%]{display:flex}.separator[_ngcontent-%COMP%]{color:var(--color-weight-500);margin:0 3px}"],changeDetection:0})}const at=(0,i.wwB)({location:"collection-list",requiresPermission:o=>o.includes(i.y3$.DeleteCollection)||o.includes(i.y3$.DeleteCatalog),getItemName:o=>o.name,bulkDelete:(o,n)=>o.collection.deleteCollections(n).pipe((0,f.U)(t=>t.deleteCollections))}),it={location:"collection-list",label:(0,p.J)("catalog.move-collections"),icon:"drag-handle",requiresPermission:o=>o.includes(i.y3$.UpdateCatalog)||o.includes(i.y3$.UpdateCollection),onClick:({injector:o,selection:n,hostComponent:t,clearSelection:r})=>{const a=o.get(i.Z7U),l=o.get(i.DoR),c=o.get(i.gqp);a.fromComponent(pe,{size:"xl",closable:!0}).pipe((0,b.w)(s=>{if(s){const u=n.map(m=>({collectionId:m.id,parentId:s.id,index:0}));return l.collection.moveCollection(u)}return Z.E})).subscribe(s=>{c.success((0,p.J)("catalog.move-collections-success"),{count:n.length}),r(),t.refresh()})}},lt=(0,i.z1G)({location:"collection-list",requiresPermission:o=>o.includes(i.y3$.UpdateCatalog)||o.includes(i.y3$.UpdateCollection),getItemName:o=>o.name,bulkAssignToChannel:(o,n,t)=>o.collection.assignCollectionsToChannel({collectionIds:n,channelId:t}).pipe((0,f.U)(r=>r.assignCollectionsToChannel))}),ct=(0,i.RBx)({location:"collection-list",requiresPermission:o=>o.includes(i.y3$.DeleteCatalog)||o.includes(i.y3$.DeleteCollection),getItemName:o=>o.name,bulkRemoveFromChannel:(o,n,t)=>o.collection.removeCollectionsFromChannel({channelId:t,collectionIds:n}).pipe((0,f.U)(r=>r.removeCollectionsFromChannel))});class ue extends i.$ms{constructor(n,t){super(),this.dataService=n,this.notificationService=t,this.expandedIds=[],this.customFields=this.getCustomFieldConfig("Collection"),this.filters=this.createFilterCollection().addIdFilter().addDateFilters().addFilter({name:"slug",label:(0,p.J)("common.slug"),type:{kind:"text"},filterField:"slug"}).addFilter({name:"visibility",type:{kind:"boolean"},label:(0,p.J)("common.visibility"),toFilterInput:r=>({isPrivate:{eq:!r}})}).addCustomFieldFilters(this.customFields).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("position","ASC").addSort({name:"createdAt"}).addSort({name:"updatedAt"}).addSort({name:"name"}).addSort({name:"slug"}).addSort({name:"position"}).addCustomFieldSorts(this.customFields).connectToRoute(this.route),super.configure({document:i.rcS,getItems:r=>r.collections,setVariables:(r,a)=>{const l=""===this.searchTermControl.value&&0===this.filters.activeFilters.length||void 0;return{options:{skip:r,take:a,filter:{name:{contains:this.searchTermControl.value},...this.filters.createFilterInput()},topLevelOnly:l,sort:this.sorts.createSortInput()}}},refreshListOnChanges:[this.filters.valueChanges,this.sorts.valueChanges]})}ngOnInit(){super.ngOnInit(),this.activeCollectionId$=this.route.paramMap.pipe((0,f.U)(t=>t.get("contents")),(0,O.x)());const n=this.route.queryParamMap.pipe((0,f.U)(t=>t.get("expanded")),(0,O.x)(),(0,f.U)(t=>t?t.split(","):[]));n.pipe((0,ke.R)(this.destroy$)).subscribe(t=>{this.expandedIds=t}),this.subCollections$=(0,T.a)(n,this.refresh$).pipe((0,b.w)(([t])=>t.length?this.dataService.collection.getCollections({take:999,filter:{parentId:{in:t}}}).mapStream(r=>r.collections.items):(0,F.of)([]))),this.activeCollectionTitle$=(0,T.a)(this.activeCollectionId$,this.items$,this.subCollections$).pipe((0,f.U)(([t,r,a])=>{if(t){const l=[...r,...a].find(c=>c.id===t);return l?l.name:""}return""})),this.activeCollectionIndex$=(0,T.a)(this.activeCollectionId$,this.items$,this.subCollections$).pipe((0,f.U)(([t,r,a])=>{if(t){const l=[];for(const c of r){l.push(c);const s=a.filter(u=>u.parentId&&u.parentId===c.id);l.push(...s)}return l.findIndex(c=>c.id===t)}return-1}))}onRearrange(n){this.dataService.collection.moveCollection([n]).subscribe({next:()=>{this.notificationService.success((0,p.J)("common.notify-saved-changes")),this.refresh()},error:t=>{this.notificationService.error((0,p.J)("common.notify-save-changes-error"))}})}closeContents(){const n={...this.route.snapshot.params};delete n.contents,this.router.navigate(["./",n],{relativeTo:this.route,queryParamsHandling:"preserve"})}setLanguage(n){this.dataService.client.setContentLanguage(n).subscribe()}toggleExpanded(n){let t=this.expandedIds;t.includes(n.id)?t=t.filter(r=>r!==n.id):t.push(n.id),this.router.navigate(["./"],{queryParams:{expanded:t.filter(r=>!!r).join(",")},queryParamsHandling:"merge",relativeTo:this.route})}static#e=this.\u0275fac=function(t){return new(t||ue)(e.Y36(i.DoR),e.Y36(i.gqp))};static#t=this.\u0275cmp=e.Xpm({type:ue,selectors:[["vdr-collection-list"]],features:[e.qOj],decls:14,vars:14,consts:[[3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","collection-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"rightPanelOpen","closeClicked"],["vdrSplitViewLeft",""],["vdrSplitViewRight","",3,"splitViewTitle"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],["id","collection-list",1,"mt-2",3,"items","subCollections","itemsPerPage","totalItems","currentPage","filters","activeIndex","pageChange","itemsPerPageChange","changeOrder"],["locationId","collection-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],["id","id",3,"heading","hiddenByDefault"],["id","created-at",3,"heading","hiddenByDefault","sort"],["id","updated-at",3,"heading","hiddenByDefault","sort"],["id","position",3,"heading","hiddenByDefault","sort"],["id","name",3,"heading","optional","sort"],["id","breadcrumb",3,"heading"],["id","slug",3,"heading","sort"],["id","visibility",3,"heading"],["id","view-contents",3,"heading","optional"],[3,"customField","sorts",4,"ngFor","ngForOf"],[3,"ngClass"],["class","child-arrow","shape","child-arrow",3,"transparent",4,"ngIf"],["class","icon-button folder-button",3,"click",4,"ngIf"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],["shape","child-arrow",1,"child-arrow"],[1,"icon-button","folder-button",3,"click"],["shape","folder",4,"ngIf"],["shape","folder-open",4,"ngIf"],["shape","folder"],["shape","folder-open"],[1,"breadcrumb"],[4,"ngIf"],["class","separator",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"separator"],["colorType","warning",4,"ngIf"],["colorType","success",4,"ngIf"],["colorType","warning"],["colorType","success"],["queryParamsHandling","preserve",1,"button-small","bg-weight-150",3,"routerLink"],["shape","file-group"],[3,"customField","sorts"],[3,"collectionId"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-left")(3,"vdr-language-selector",0),e.NdJ("languageCodeChange",function(l){return r.setLanguage(l)}),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA()(),e.TgZ(6,"vdr-ab-right"),e._UZ(7,"vdr-action-bar-items",1),e.YNc(8,To,4,5,"a",2),e.qZA()()(),e.TgZ(9,"vdr-split-view",3),e.NdJ("closeClicked",function(){return r.closeContents()}),e.ALo(10,"async"),e.YNc(11,Bo,38,64,"ng-template",4),e.YNc(12,jo,2,3,"ng-template",5),e.ALo(13,"async"),e.qZA()),2&t&&(e.xp6(3),e.Q6J("availableLanguageCodes",e.lcZ(4,5,r.availableLanguages$))("currentLanguageCode",e.lcZ(5,7,r.contentLanguage$)),e.xp6(5),e.Q6J("vdrIfPermissions",e.DdM(13,He)),e.xp6(1),e.Q6J("rightPanelOpen",e.lcZ(10,9,r.activeCollectionId$)),e.xp6(3),e.Q6J("splitViewTitle",e.lcZ(13,11,r.activeCollectionTitle$)))},dependencies:[_.qvL,g.mk,g.sg,g.O5,P.rH,i.KkL,i.BND,i.mz,i.Ywx,i.SdP,i.HAh,i.WWO,i.cuf,i.Up6,i.JBy,i.jrk,i._fG,i.L7I,i.LjY,i.zJY,R,H,g.Ov,C.X$,i.HbD,K],styles:["[_nghost-%COMP%]{--indent-spacing: 18px}.indent-1[_ngcontent-%COMP%]{padding-inline-start:var(--indent-spacing)}.indent-2[_ngcontent-%COMP%]{padding-inline-start:calc(var(--indent-spacing) * 2)}.indent-3[_ngcontent-%COMP%]{padding-inline-start:calc(var(--indent-spacing) * 3)}.indent-4[_ngcontent-%COMP%], .indent-5[_ngcontent-%COMP%], .indent-6[_ngcontent-%COMP%], .indent-7[_ngcontent-%COMP%], .indent-8[_ngcontent-%COMP%], .indent-9[_ngcontent-%COMP%]{padding-inline-start:calc(var(--indent-spacing) * 4)}.child-arrow[_ngcontent-%COMP%]{margin:1px 6px}.child-arrow.transparent[_ngcontent-%COMP%]{opacity:0}.breadcrumb[_ngcontent-%COMP%]{display:flex}.separator[_ngcontent-%COMP%]{color:var(--color-weight-500);margin:0 3px}"],changeDetection:0})}class Y{constructor(){this.allMoveListItems=[],this._rearrange$=new te.x,this._delete$=new te.x,this.rearrange$=this._rearrange$.asObservable(),this.delete$=this._delete$.asObservable()}ngOnDestroy(){this._rearrange$.complete(),this._delete$.complete()}setCollectionTree(n){this.collectionTree=n}resetMoveList(){this.allMoveListItems=[]}getMoveListItems(n){return 0===this.allMoveListItems.length&&(this.allMoveListItems=this.calculateAllMoveListItems()),this.allMoveListItems.filter(t=>t.id!==n.id&&!t.ancestorIdPath.has(n.id)&&t.id!==n.parent?.id)}onDrop(n){const t=n.item.data,a=n.container.data.id;if(null==a)throw new Error("Could not determine the ID of the root Collection");this._rearrange$.next({collectionId:t.id,parentId:a,index:n.currentIndex})}onMove(n){this._rearrange$.next(n)}onDelete(n){this._delete$.next(n)}calculateAllMoveListItems(){const n=(t,r,a,l)=>{const c=r.concat(t.name);return l.push({path:c.slice(1).join(" / ")||"root",id:t.id,ancestorIdPath:a}),t.children.forEach(s=>n(s,c,new Set([...a,t.id]),l)),l};return n(this.collectionTree,[],new Set,[])}static#e=this.\u0275fac=function(t){return new(t||Y)};static#t=this.\u0275prov=e.Yz7({token:Y,factory:Y.\u0275fac})}class B{constructor(n,t,r,a,l,c){this.parent=n,this.dataService=t,this.collectionTreeService=r,this.router=a,this.route=l,this.changeDetectorRef=c,this.depth=0,this.expandAll=!1,this.moveListItems=[],n&&(this.depth=n.depth+1)}ngOnInit(){this.parentName=this.collectionTree.name||"<root>";const n=this.dataService.client.userStatus().mapStream(t=>t.userStatus.permissions).pipe((0,xe.d)(1));this.hasUpdatePermission$=n.pipe((0,f.U)(t=>t.includes(i.y3$.UpdateCatalog)||t.includes(i.y3$.UpdateCollection))),this.hasDeletePermission$=n.pipe((0,f.U)(t=>t.includes(i.y3$.DeleteCatalog)||t.includes(i.y3$.DeleteCollection))),this.subscription=this.selectionManager?.selectionChanges$.subscribe(()=>this.changeDetectorRef.markForCheck())}ngOnChanges(n){const t=n.expandAll;t&&!0===t.previousValue&&!1===t.currentValue&&this.collectionTree.children.forEach(r=>r.expanded=!1)}ngOnDestroy(){this.subscription?.unsubscribe()}trackByFn(n,t){return t.id}toggleExpanded(n){n.expanded=!n.expanded;let t=this.route.snapshot.queryParamMap.get("expanded")?.split(",")??[];n.expanded?t.push(n.id):t=t.filter(r=>r!==n.id),this.router.navigate(["./"],{queryParams:{expanded:t.filter(r=>!!r).join(",")},queryParamsHandling:"merge",relativeTo:this.route})}getMoveListItems(n){this.moveListItems=this.collectionTreeService.getMoveListItems(n)}move(n,t){this.collectionTreeService.onMove({index:0,parentId:t,collectionId:n.id})}moveUp(n,t){n.parent&&this.collectionTreeService.onMove({index:t-1,parentId:n.parent.id,collectionId:n.id})}moveDown(n,t){n.parent&&this.collectionTreeService.onMove({index:t+1,parentId:n.parent.id,collectionId:n.id})}drop(n){(0,k.bA)(this.collectionTree.children,n.previousIndex,n.currentIndex),this.collectionTreeService.onDrop(n)}delete(n){this.collectionTreeService.onDelete(n)}static#e=this.\u0275fac=function(t){return new(t||B)(e.Y36(B,12),e.Y36(i.DoR),e.Y36(Y),e.Y36(P.F0),e.Y36(P.gz),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:B,selectors:[["vdr-collection-tree-node"]],inputs:{collectionTree:"collectionTree",activeCollectionId:"activeCollectionId",expandAll:"expandAll",selectionManager:"selectionManager"},features:[e.TTD],decls:4,vars:6,consts:[["cdkDropList","",1,"tree-node",3,"cdkDropListData","cdkDropListDisabled","cdkDropListDropped"],["dropList",""],["class","collection","cdkDrag","",3,"private","cdkDragData",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",1,"collection",3,"cdkDragData"],[1,"collection-detail",3,"ngClass"],["type","checkbox","clrCheckbox","",3,"checked","click"],[1,"name"],["class","icon-button folder-button",3,"disabled","click",4,"ngIf","ngIfElse"],["folderSpacer",""],[1,"flex-spacer"],[4,"ngIf"],["queryParamsHandling","preserve",1,"btn","btn-link","btn-sm",3,"routerLink"],["shape","view-list"],[1,"btn","btn-link","btn-sm",3,"routerLink"],["shape","edit"],["class","drag-handle","cdkDragHandle","",4,"vdrIfPermissions"],["vdrDropdownTrigger","",1,"icon-button",3,"click"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["class","dropdown-item",3,"routerLink",4,"vdrIfPermissions"],[1,"dropdown-divider"],["type","button","vdrDropdownItem","",3,"disabled","click"],["shape","caret up"],["shape","caret down"],[1,"dropdown-header"],["type","button","vdrDropdownItem","",3,"disabled","click",4,"ngFor","ngForOf"],["vdrDropdownItem","",1,"button",3,"disabled","click"],["shape","trash",1,"is-danger"],[3,"expandAll","collectionTree","activeCollectionId","selectionManager",4,"ngIf"],[1,"icon-button","folder-button",3,"disabled","click"],["shape","folder",4,"ngIf"],["shape","folder-open",4,"ngIf"],["shape","folder"],["shape","folder-open"],[1,"folder-button-spacer"],["cdkDragHandle","",1,"drag-handle"],["shape","drag-handle","size","24"],[1,"dropdown-item",3,"routerLink"],["shape","plus"],[1,"move-to-item"],[1,"move-icon"],["shape","child-arrow"],[1,"path"],[3,"expandAll","collectionTree","activeCollectionId","selectionManager"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0,1),e.NdJ("cdkDropListDropped",function(l){return r.drop(l)}),e.ALo(2,"async"),e.YNc(3,ca,47,52,"div",2),e.qZA()),2&t&&(e.Q6J("cdkDropListData",r.collectionTree)("cdkDropListDisabled",!e.lcZ(2,4,r.hasUpdatePermission$)),e.xp6(3),e.Q6J("ngForOf",r.collectionTree.children)("ngForTrackBy",r.trackByFn))},dependencies:[_.q0d,_.qvL,_.KKC,g.mk,g.sg,g.O5,P.rH,k.Wj,k.Zt,k.Bh,i.Ywx,i.y_K,i.JOL,i.N9E,i.UaT,i.HH4,i.HAh,B,g.Ov,C.X$],styles:["[_nghost-%COMP%]{display:block}.collection[_ngcontent-%COMP%]{background-color:var(--clr-table-bgcolor);border-radius:var(--clr-global-borderradius);font-size:.65rem;transition:transform .25s cubic-bezier(0,0,.2,1);margin-bottom:2px;border-inline-start:2px solid transparent;transition:border-left-color .2s}.collection.private[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}.collection[_ngcontent-%COMP%]   .collection-detail[_ngcontent-%COMP%]{padding:6px 12px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--color-component-border-100)}.collection[_ngcontent-%COMP%]   .collection-detail.active[_ngcontent-%COMP%]{background-color:var(--clr-global-selection-color)}.collection[_ngcontent-%COMP%]   .collection-detail.depth-1[_ngcontent-%COMP%]{padding-inline-start:36px}.collection[_ngcontent-%COMP%]   .collection-detail.depth-2[_ngcontent-%COMP%]{padding-inline-start:60px}.collection[_ngcontent-%COMP%]   .collection-detail.depth-3[_ngcontent-%COMP%]{padding-inline-start:84px}.collection[_ngcontent-%COMP%]   .collection-detail.depth-4[_ngcontent-%COMP%]{padding-inline-start:108px}.collection[_ngcontent-%COMP%]   .collection-detail[_ngcontent-%COMP%]   .folder-button-spacer[_ngcontent-%COMP%]{display:inline-block;width:28px}.tree-node[_ngcontent-%COMP%]{display:block;background-color:var(--clr-table-bgcolor);border-radius:var(--clr-global-borderradius);overflow:hidden}.tree-node.cdk-drop-list-dragging[_ngcontent-%COMP%] > .collection[_ngcontent-%COMP%]{border-left-color:var(--color-primary-300)}.drag-placeholder[_ngcontent-%COMP%]{min-height:120px;background-color:var(--color-component-bg-300);transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .tree-node[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.move-to-item[_ngcontent-%COMP%]{display:flex;white-space:normal;align-items:baseline}.move-to-item[_ngcontent-%COMP%]   .move-icon[_ngcontent-%COMP%]{flex:none;margin-inline-end:3px}.move-to-item[_ngcontent-%COMP%]   .path[_ngcontent-%COMP%]{line-height:18px}"],changeDetection:0})}function st(o,n,t=[]){const r=[],a={},l=function zl(o){const n=new Map;function t(r){n.set(r.id,r),r.children.forEach(t)}return o&&t(o),n}(n);for(const s of o)a[s.id]={...s,children:[]};for(const s of o.map(u=>u.id))if(a.hasOwnProperty(s)){const u=a[s];u.expanded=l.get(s)?.expanded??t.includes(s);const m=u.parent;if(!m)continue;a[m.id]?a[m.id]?a[m.id].children.push(u):a[m.id]={children:[u]}:r.push(u)}return{id:r.length?r[0].parent.id:void 0,children:r}}class Pe{constructor(n){this.collectionTreeService=n,this.expandAll=!1,this.expandedIds=[],this.rearrange=new e.vpe,this.deleteCollection=new e.vpe}ngOnChanges(n){"collections"in n&&this.collections&&(this.collectionTree=st(this.collections,this.collectionTree,this.expandedIds),this.collectionTreeService.setCollectionTree(this.collectionTree),this.collectionTreeService.resetMoveList())}ngOnInit(){this.collectionTreeService.rearrange$.subscribe(n=>this.rearrange.emit(n)),this.collectionTreeService.delete$.subscribe(n=>this.deleteCollection.emit(n))}static#e=this.\u0275fac=function(t){return new(t||Pe)(e.Y36(Y))};static#t=this.\u0275cmp=e.Xpm({type:Pe,selectors:[["vdr-collection-tree"]],inputs:{collections:"collections",activeCollectionId:"activeCollectionId",expandAll:"expandAll",expandedIds:"expandedIds",selectionManager:"selectionManager"},outputs:{rearrange:"rearrange",deleteCollection:"deleteCollection"},features:[e._Bn([Y]),e.TTD],decls:1,vars:1,consts:[["cdkDropListGroup","",3,"expandAll","collectionTree","selectionManager","activeCollectionId",4,"ngIf"],["cdkDropListGroup","",3,"expandAll","collectionTree","selectionManager","activeCollectionId"]],template:function(t,r){1&t&&e.YNc(0,sa,1,4,"vdr-collection-tree-node",0),2&t&&e.Q6J("ngIf",r.collectionTree)},dependencies:[g.O5,k.Fd,B],changeDetection:0})}class Te{constructor(){this.variants=[]}confirm(){this.resolveWith(!0)}cancel(){this.resolveWith()}static#e=this.\u0275fac=function(t){return new(t||Te)};static#t=this.\u0275cmp=e.Xpm({type:Te,selectors:[["vdr-confirm-variant-deletion-dialog"]],decls:6,vars:4,consts:[["vdrDialogTitle",""],[4,"ngFor","ngForOf"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(t,r){1&t&&(e.YNc(0,da,2,3,"ng-template",0),e._uU(1),e.ALo(2,"translate"),e.TgZ(3,"ul"),e.YNc(4,pa,2,2,"li",1),e.qZA(),e.YNc(5,ua,6,6,"ng-template",2)),2&t&&(e.xp6(1),e.hij("\n",e.lcZ(2,2,"catalog.confirm-deletion-of-unused-variants-body"),"\n"),e.xp6(3),e.Q6J("ngForOf",r.variants))},dependencies:[g.sg,i.nPI,i.q6K,C.X$],changeDetection:0})}const Wl=A.Ps`
    query GetFacetDetail($id: ID!) {
        facet(id: $id) {
            ...FacetWithValues
        }
    }
    ${i.nMi}
`;class me extends i.VE7{constructor(n,t,r,a,l){super(),this.changeDetector=n,this.dataService=t,this.formBuilder=r,this.notificationService=a,this.modalService=l,this.customFields=this.getCustomFieldConfig("Facet"),this.customValueFields=this.getCustomFieldConfig("FacetValue"),this.detailForm=this.formBuilder.group({facet:this.formBuilder.group({code:["",d.kI.required],name:"",visible:!0,customFields:this.formBuilder.group((0,i.Lrj)(this.customFields))}),values:this.formBuilder.record({})}),this.currentPage=1,this.itemsPerPage=10,this.filterControl=new d.NI(""),this.values$=new D.X([]),this.filteredValues$=new kt.y,this.updatePermission=[i.y3$.UpdateCatalog,i.y3$.UpdateFacet]}ngOnInit(){this.init(),this.filteredValues$=(0,T.a)([this.values$,this.filterControl.valueChanges.pipe((0,V.O)(""))]).pipe((0,f.U)(([n,t])=>{const r=t?.toLowerCase().trim();return r?n.filter(a=>a.name.toLowerCase().includes(r)||a.code.toLowerCase().includes(r)):n}),(0,N.b)(()=>{this.currentPage=1}))}ngOnDestroy(){this.destroy()}updateCode(n,t){if(!n){const r=this.detailForm.get(["facet","code"]);r&&r.pristine&&r.setValue((0,U.U)(t,"-"))}}updateValueCode(n,t,r){if(!n){const a=this.detailForm.get(["values",r,"code"]);a&&a.pristine&&a.setValue((0,U.U)(t,"-"))}}customValueFieldIsSet(n,t){return!!this.detailForm.get(["values",n,"customFields",t])}addFacetValue(){const n=this.detailForm.get("values");if(n){const t=this.createTempId(),r=this.formBuilder.group({id:t,name:["",d.kI.required],code:"",customFields:this.formBuilder.group({})}),a={id:t,name:"",code:""};if(this.customValueFields.length){const s=new d.nJ({});a.customFields={};for(const u of this.customValueFields){const m=u.name;s.addControl(m,new d.p4)}r.addControl("customFields",s)}n.addControl(t,r);const l=this.values$.value,c=this.currentPage*this.itemsPerPage-1;l.splice(c,0,a),this.values$.next(l)}}create(){const n=this.detailForm.get("facet");if(!n||!n.dirty)return;const t=this.getUpdatedFacet({id:"",createdAt:"",updatedAt:"",isPrivate:!1,languageCode:this.languageCode,name:"",code:"",translations:[],values:[]},n,this.languageCode);this.dataService.facet.createFacet(t).subscribe(r=>{this.notificationService.success((0,p.J)("common.notify-create-success"),{entity:"Facet"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",r.createFacet.id],{relativeTo:this.route})},r=>{this.notificationService.error((0,p.J)("common.notify-create-error"),{entity:"Facet"})})}save(){const n=this.detailForm.get("values");(0,T.a)(this.entity$,this.languageCode$).pipe((0,$.q)(1),(0,J.z)(([t,r])=>{const a=this.detailForm.get("facet"),l=[];if(a&&a.dirty){const c=this.getUpdatedFacet(t,a,r);c&&l.push(this.dataService.facet.updateFacet(c))}if(n&&n.dirty){const c=this.getCreatedFacetValues(t,n,r);c.length&&l.push(this.dataService.facet.createFacetValues(c).pipe((0,b.w)(()=>this.dataService.query(i.m_w,{id:this.id}).single$)));const s=this.getUpdatedFacetValues(t,n,r);s.length&&l.push(this.dataService.facet.updateFacetValues(s))}return(0,ee.D)(l)})).subscribe(()=>{this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.notificationService.success((0,p.J)("common.notify-update-success"),{entity:"Facet"})},t=>{this.notificationService.error((0,p.J)("common.notify-update-error"),{entity:"Facet"})})}deleteFacetValue(n){if(this.isTempId(n)){const t=this.detailForm.get("values");t&&t.removeControl(n);const r=this.values$.value;this.values$.next(r.filter(a=>a.id!==n))}else this.showModalAndDelete(n).pipe((0,b.w)(t=>t.result===i.PcR.DELETED?[!0]:this.showModalAndDelete(n,t.message||"").pipe((0,f.U)(r=>r.result===i.PcR.DELETED))),(0,b.w)(t=>t?this.dataService.query(i.m_w,{id:this.id}).single$:[])).subscribe(()=>{const t=this.detailForm.get("values");t&&t.removeControl(n),this.notificationService.success((0,p.J)("common.notify-delete-success"),{entity:"FacetValue"})},t=>{this.notificationService.error((0,p.J)("common.notify-delete-error"),{entity:"FacetValue"})})}showModalAndDelete(n,t){return this.modalService.dialog({title:(0,p.J)("catalog.confirm-delete-facet-value"),body:t,buttons:[{type:"secondary",label:(0,p.J)("common.cancel")},{type:"danger",label:(0,p.J)("common.delete"),returnValue:!0}]}).pipe((0,b.w)(r=>r?this.dataService.facet.deleteFacetValues([n],!!t):Z.E),(0,f.U)(r=>r.deleteFacetValues[0]))}setFormValues(n,t){const r=(0,i.ZIM)(n,t);this.detailForm.patchValue({facet:{code:n.code,visible:!n.isPrivate,name:r?.name??""}}),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["facet","customFields"]),n,r);const a=this.detailForm.get("values");this.values$.next([...n.values]),n.values.forEach(l=>{const c=(0,i.ZIM)(l,t),s={id:l.id,code:l.code,name:c?c.name:""};let u=a.get(l.id);if(u?(u.get("id")?.setValue(s.id),u.get("code")?.setValue(s.code),u.get("name")?.setValue(s.name)):(u=this.formBuilder.group(s),a.addControl(l.id,u)),this.customValueFields.length){let m=u.get(["customFields"]);if(m||(m=new d.nJ({}),u.addControl("customFields",m)),m)for(const v of this.customValueFields){const x=v.name,y="localeString"===v.type?c?.customFields?.[x]:l.customFields[x],I=m.get(x);I?I.setValue(y):m.addControl(x,new d.p4(y))}}})}getUpdatedFacet(n,t,r){const a=(0,i.iSy)({translatable:n,updatedFields:t.value,customFieldConfig:this.customFields,languageCode:r,defaultTranslation:{languageCode:r,name:n.name||""}});return a.isPrivate=!t.value.visible,a}getCreatedFacetValues(n,t,r){return Object.values(t.controls).filter(a=>a.value.id&&this.isTempId(a.value.id)).map(a=>a.value).map(a=>(0,i.iSy)({translatable:{...a,translations:[]},updatedFields:a??{},customFieldConfig:this.customValueFields,languageCode:r,defaultTranslation:{languageCode:r,name:""}})).map(a=>({facetId:n.id,code:a.code??"",...a,id:void 0}))}getUpdatedFacetValues(n,t,r){const a=n.values.filter(c=>{const s=t.get(c.id);return s&&s.dirty&&s.value.id}),l=Object.values(t.controls).filter(c=>c.dirty&&!this.isTempId(c.value.id)).map(c=>c.value);if(a.length!==l.length)throw new Error((0,p.J)("error.facet-value-form-values-do-not-match"));return a.map((c,s)=>(0,i.iSy)({translatable:c,updatedFields:l[s],customFieldConfig:this.customValueFields,languageCode:r,defaultTranslation:{languageCode:r,name:""}})).filter(Fe.notNullOrUndefined)}createTempId(){return`temp-${Math.random().toString(36).substr(2,9)}`}isTempId(n){return n.startsWith("temp-")}static#e=this.\u0275fac=function(t){return new(t||me)(e.Y36(e.sBO),e.Y36(i.DoR),e.Y36(d.qu),e.Y36(i.gqp),e.Y36(i.Z7U))};static#t=this.\u0275cmp=e.Xpm({type:me,selectors:[["vdr-facet-detail"]],features:[e.qOj],decls:44,vars:43,consts:[[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","facet-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["formGroupName","facet"],["for","visibility",3,"label"],["type","checkbox","clrToggle","","formControlName","visible","id","visibility",3,"vdrDisabled"],[1,"visible-toggle"],[4,"ngIf","ngIfElse"],["private",""],[3,"entity",4,"ngIf"],[1,"form-grid"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly","input"],["for","code",3,"label"],["id","code","type","text","formControlName","code",3,"readonly"],[3,"title",4,"ngIf"],["locationId","facet-detail",3,"entity$","detailForm"],[3,"title","paddingX",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"entity"],[3,"title"],["entityName","Facet",3,"customFields","customFieldsFormGroup","readonly"],[3,"title","paddingX"],["vdrCardControls",""],[4,"ngIf"],["type","button","class","button m-3",3,"click",4,"vdrIfPermissions"],["type","text",1,"mr-3",3,"formControl","placeholder"],["formArrayName","values",1,"facet-values-list","table"],["class","facet-value",3,"formGroup",4,"ngFor","ngForOf"],[1,"pagination-wrapper"],[3,"itemsPerPage","itemsPerPageChange"],[3,"currentPage","itemsPerPage","totalItems","pageChange"],[1,"facet-value",3,"formGroup"],[1,"align-middle"],["type","text","formControlName","name",3,"readonly","input"],["type","text","formControlName","code"],["class","",4,"ngIf"],["type","button","vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"],[1,""],["entityName","FacetValue",3,"customFields","compact","customFieldsFormGroup","readonly"],["type","button",1,"button","m-3",3,"click"],["shape","add"]],template:function(t,r){if(1&t&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-left")(3,"vdr-language-selector",0),e.NdJ("languageCodeChange",function(l){return r.setLanguage(l)}),e.ALo(4,"async"),e.ALo(5,"async"),e.ALo(6,"async"),e.qZA()(),e.TgZ(7,"vdr-ab-right"),e._UZ(8,"vdr-action-bar-items",1),e.YNc(9,ma,3,4,"button",2),e.ALo(10,"async"),e.YNc(11,_a,1,1,"ng-template",null,3,e.W1O),e.qZA()()(),e.TgZ(13,"form",4)(14,"vdr-page-detail-layout")(15,"vdr-page-detail-sidebar",5)(16,"vdr-card")(17,"vdr-form-field",6),e.ALo(18,"translate"),e.TgZ(19,"clr-toggle-wrapper"),e._UZ(20,"input",7),e.ALo(21,"hasPermission"),e.TgZ(22,"label",8),e.YNc(23,fa,3,3,"ng-container",9),e.YNc(24,ha,2,3,"ng-template",null,10,e.W1O),e.qZA()()()(),e.TgZ(26,"vdr-card"),e.YNc(27,va,1,1,"vdr-page-entity-info",11),e.ALo(28,"async"),e.qZA()(),e.TgZ(29,"vdr-page-block")(30,"vdr-card",5)(31,"div",12)(32,"vdr-form-field",13),e.ALo(33,"translate"),e.TgZ(34,"input",14),e.NdJ("input",function(l){return r.updateCode(null==r.entity?null:r.entity.code,l.target.value)}),e.ALo(35,"hasPermission"),e.qZA()(),e.TgZ(36,"vdr-form-field",15),e.ALo(37,"translate"),e._UZ(38,"input",16),e.ALo(39,"hasPermission"),e.qZA()()(),e.YNc(40,ba,4,8,"vdr-card",17),e._UZ(41,"vdr-custom-detail-component-host",18),e.YNc(42,Fa,7,9,"vdr-card",19),e.ALo(43,"async"),e.qZA()()()),2&t){const a=e.MAs(12),l=e.MAs(25);e.xp6(3),e.Q6J("disabled",e.lcZ(4,19,r.isNew$))("availableLanguageCodes",e.lcZ(5,21,r.availableLanguages$))("currentLanguageCode",e.lcZ(6,23,r.languageCode$)),e.xp6(6),e.Q6J("ngIf",e.lcZ(10,25,r.isNew$))("ngIfElse",a),e.xp6(4),e.Q6J("formGroup",r.detailForm),e.xp6(4),e.Q6J("label",e.lcZ(18,27,"catalog.visibility")),e.xp6(3),e.Q6J("vdrDisabled",!e.lcZ(21,29,r.updatePermission)),e.xp6(3),e.Q6J("ngIf",null==r.detailForm.value.facet?null:r.detailForm.value.facet.visible)("ngIfElse",l),e.xp6(4),e.Q6J("ngIf",e.lcZ(28,31,r.entity$)),e.xp6(5),e.Q6J("label",e.lcZ(33,33,"common.name")),e.xp6(2),e.Q6J("readonly",!e.lcZ(35,35,r.updatePermission)),e.xp6(2),e.Q6J("label",e.lcZ(37,37,"common.code")),e.xp6(2),e.Q6J("readonly",!e.lcZ(39,39,r.updatePermission)),e.xp6(2),e.Q6J("ngIf",r.customFields.length),e.xp6(1),e.Q6J("entity$",r.entity$)("detailForm",r.detailForm),e.xp6(1),e.Q6J("ngIf",!e.lcZ(43,41,r.isNew$))}},dependencies:[_.qvL,_.MgK,_.KKC,_.PEh,g.sg,g.O5,d._Y,d.Fj,d.Wl,d.JJ,d.JL,d.oH,d.sg,d.u,d.x0,d.CE,i.KkL,i.BND,i.mz,i.wAH,i.LSK,i.hgI,i.y_K,i.SdP,i.JOL,i.N9E,i.UaT,i.HH4,i.HAh,i.WWO,i.x3T,i.Vqt,i.yc0,i.CWh,i.zJY,i.DME,i.TeL,i.W1W,i.AkF,i.D23,g.Ov,we._s,C.X$,i.j$k],styles:[".visible-toggle[_ngcontent-%COMP%]{margin-top:-3px!important}tr.facet-value[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.pagination-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:var(--card-padding)}"],changeDetection:0})}const dt=(0,i.wwB)({location:"facet-list",requiresPermission:o=>o.includes(i.y3$.DeleteFacet)||o.includes(i.y3$.DeleteCatalog),getItemName:o=>o.name,shouldRetryItem:(o,n)=>!!o.message,bulkDelete:(o,n,t)=>o.facet.deleteFacets(n,t).pipe((0,f.U)(r=>r.deleteFacets))}),pt=(0,i.z1G)({location:"facet-list",requiresPermission:o=>o.includes(i.y3$.UpdateCatalog)||o.includes(i.y3$.UpdateFacet),getItemName:o=>o.name,bulkAssignToChannel:(o,n,t)=>o.facet.assignFacetsToChannel({facetIds:n,channelId:t}).pipe((0,f.U)(r=>r.assignFacetsToChannel))}),ut=(0,i.RBx)({location:"facet-list",requiresPermission:o=>o.includes(i.y3$.DeleteCatalog)||o.includes(i.y3$.DeleteFacet),getItemName:o=>o.name,bulkRemoveFromChannel:(o,n,t,r)=>o.facet.removeFacetsFromChannel({channelId:t,facetIds:n,force:r}).pipe((0,f.U)(a=>a.removeFacetsFromChannel)),isErrorResult:o=>"FacetInUseError"===o.__typename?o.message:void 0}),Xl={location:"facet-list",label:(0,p.J)("catalog.remove-from-channel"),getTranslationVars:({injector:o})=>(0,i.PDO)(o.get(i.DoR)),icon:"layers",iconClass:"is-warning",requiresPermission:o=>o.includes(i.y3$.UpdateFacet)||o.includes(i.y3$.UpdateCatalog),isVisible:({injector:o})=>(0,i._Nz)(o.get(i.DoR)),onClick:({injector:o,selection:n,hostComponent:t,clearSelection:r})=>{const a=o.get(i.Z7U),l=o.get(i.DoR),c=o.get(i.gqp),s=l.client.userStatus().mapSingle(({userStatus:m})=>m.activeChannelId);function u(m,v){return a.dialog({title:(0,p.J)("catalog.remove-from-channel"),translationVars:{count:n.length},size:v?"lg":"md",body:v,buttons:[{type:"secondary",label:(0,p.J)("common.cancel")},{type:"danger",label:v?(0,p.J)("common.force-remove"):(0,p.J)("common.remove"),returnValue:!0}]}).pipe((0,b.w)(x=>x?s.pipe((0,b.w)(y=>y?l.facet.removeFacetsFromChannel({channelId:y,facetIds:m,force:!!v}):Z.E),(0,f.U)(y=>y.removeFacetsFromChannel)):Z.E))}u((0,L.T)(n.map(m=>m.id))).pipe((0,b.w)(m=>{let v=n.length;const x=[],y=[];let I=0;for(const M of m)"FacetInUseError"===M.__typename&&(x.push(M.message),y.push(n[I]?.id),v--),I++;return 0<y.length?u(y,x.join("\n")).pipe((0,f.U)(M=>{const w=M.filter(E=>"FacetInUseError"===E.__typename).length;return n.length-w})):(0,F.of)(v)}),(0,b.w)(m=>m?(0,i.PDO)(l).then(({channelCode:v})=>({channelCode:v,removedCount:m})):Z.E)).subscribe(({removedCount:m,channelCode:v})=>{m&&(t.refresh(),r(),c.success((0,p.J)("catalog.notify-remove-facets-from-channel-success"),{count:m,channelCode:v}))})}},ec=A.Ps`
    query GetFacetList($options: FacetListOptions) {
        facets(options: $options) {
            items {
                ...FacetWithValueList
            }
            totalItems
        }
    }
    ${i.$ip}
`;class ge extends i.$ms{constructor(n){super(),this.dataService=n,this.initialLimit=3,this.displayLimit={},this.customFields=this.getCustomFieldConfig("Facet"),this.filters=this.createFilterCollection().addIdFilter().addDateFilters().addFilter({name:"visibility",type:{kind:"boolean"},label:(0,p.J)("common.visibility"),toFilterInput:t=>({isPrivate:{eq:!t}})}).addCustomFieldFilters(this.customFields).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("createdAt","DESC").addSort({name:"id"}).addSort({name:"createdAt"}).addSort({name:"updatedAt"}).addSort({name:"name"}).addSort({name:"code"}).addCustomFieldSorts(this.customFields).connectToRoute(this.route),super.configure({document:i.JJ4,getItems:t=>t.facets,setVariables:(t,r)=>({options:{skip:t,take:r,filter:{name:{contains:this.searchTermControl.value},...this.filters.createFilterInput()},sort:this.sorts.createSortInput()}}),refreshListOnChanges:[this.filters.valueChanges,this.sorts.valueChanges]})}toggleDisplayLimit(n){this.displayLimit[n.id]===n.valueList.items.length?this.displayLimit[n.id]=this.initialLimit:this.displayLimit[n.id]=n.valueList.items.length}setLanguage(n){this.dataService.client.setContentLanguage(n).subscribe()}static#e=this.\u0275fac=function(t){return new(t||ge)(e.Y36(i.DoR))};static#t=this.\u0275cmp=e.Xpm({type:ge,selectors:[["vdr-facet-list"]],features:[e.qOj],decls:39,vars:57,consts:[[3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","facet-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],["id","facet-list",1,"mt-2",3,"items","itemsPerPage","totalItems","currentPage","filters","pageChange","itemsPerPageChange"],["locationId","facet-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],["id","id",3,"heading","hiddenByDefault","sort"],["id","created-at",3,"heading","hiddenByDefault","sort"],["id","updated-at",3,"heading","hiddenByDefault","sort"],["id","name",3,"heading","optional","sort"],["id","code",3,"heading"],["id","visibility",3,"heading"],["id","values",3,"heading"],[3,"customField","sorts",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],["colorType","warning",4,"ngIf"],["colorType","success",4,"ngIf"],["colorType","warning"],["colorType","success"],[1,"facet-values-list"],[3,"facetValue","removable","displayFacetName",4,"ngFor","ngForOf"],[4,"ngIf"],["class","button-small",3,"click",4,"ngIf"],[3,"facetValue","removable","displayFacetName"],[1,"button-small",3,"click"],[4,"ngIf","ngIfElse"],["collapse",""],["shape","minus"],[3,"customField","sorts"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-left")(3,"vdr-language-selector",0),e.NdJ("languageCodeChange",function(l){return r.setLanguage(l)}),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA()(),e.TgZ(6,"vdr-ab-right"),e._UZ(7,"vdr-action-bar-items",1),e.YNc(8,La,4,5,"a",2),e.qZA()()(),e.TgZ(9,"vdr-data-table-2",3),e.NdJ("pageChange",function(l){return r.setPageNumber(l)})("itemsPerPageChange",function(l){return r.setItemsPerPage(l)}),e.ALo(10,"async"),e.ALo(11,"async"),e.ALo(12,"async"),e.ALo(13,"async"),e._UZ(14,"vdr-bulk-action-menu",4)(15,"vdr-dt2-search",5),e.ALo(16,"translate"),e.TgZ(17,"vdr-dt2-column",6),e.ALo(18,"translate"),e.YNc(19,wa,1,1,"ng-template"),e.qZA(),e.TgZ(20,"vdr-dt2-column",7),e.ALo(21,"translate"),e.YNc(22,Oa,2,4,"ng-template"),e.qZA(),e.TgZ(23,"vdr-dt2-column",8),e.ALo(24,"translate"),e.YNc(25,Da,2,4,"ng-template"),e.qZA(),e.TgZ(26,"vdr-dt2-column",9),e.ALo(27,"translate"),e.YNc(28,Ja,4,4,"ng-template"),e.qZA(),e.TgZ(29,"vdr-dt2-column",10),e.ALo(30,"translate"),e.YNc(31,Ma,1,1,"ng-template"),e.qZA(),e.TgZ(32,"vdr-dt2-column",11),e.ALo(33,"translate"),e.YNc(34,$a,2,2,"ng-template"),e.qZA(),e.TgZ(35,"vdr-dt2-column",12),e.ALo(36,"translate"),e.YNc(37,Ya,5,7,"ng-template"),e.qZA(),e.YNc(38,Ba,1,2,"vdr-dt2-custom-field-column",13),e.qZA()),2&t&&(e.xp6(3),e.Q6J("availableLanguageCodes",e.lcZ(4,28,r.availableLanguages$))("currentLanguageCode",e.lcZ(5,30,r.contentLanguage$)),e.xp6(5),e.Q6J("vdrIfPermissions",e.DdM(56,Ke)),e.xp6(1),e.Q6J("items",e.lcZ(10,32,r.items$))("itemsPerPage",e.lcZ(11,34,r.itemsPerPage$))("totalItems",e.lcZ(12,36,r.totalItems$))("currentPage",e.lcZ(13,38,r.currentPage$))("filters",r.filters),e.xp6(5),e.Q6J("hostComponent",r)("selectionManager",r.selectionManager),e.xp6(1),e.Q6J("searchTermControl",r.searchTermControl)("searchTermPlaceholder",e.lcZ(16,40,"catalog.filter-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(18,42,"common.id"))("hiddenByDefault",!0)("sort",r.sorts.get("id")),e.xp6(3),e.Q6J("heading",e.lcZ(21,44,"common.created-at"))("hiddenByDefault",!0)("sort",r.sorts.get("createdAt")),e.xp6(3),e.Q6J("heading",e.lcZ(24,46,"common.updated-at"))("hiddenByDefault",!0)("sort",r.sorts.get("updatedAt")),e.xp6(3),e.Q6J("heading",e.lcZ(27,48,"common.name"))("optional",!1)("sort",r.sorts.get("name")),e.xp6(3),e.Q6J("heading",e.lcZ(30,50,"common.code")),e.xp6(3),e.Q6J("heading",e.lcZ(33,52,"common.visibility")),e.xp6(3),e.Q6J("heading",e.lcZ(36,54,"catalog.values")),e.xp6(3),e.Q6J("ngForOf",r.customFields))},dependencies:[_.qvL,g.sg,g.O5,P.rH,i.KkL,i.BND,i.mz,i.Ywx,i.qt4,i.SdP,i.HAh,i.WWO,i.cuf,i.eJ5,i.Up6,i.JBy,i.jrk,i.zJY,g.Ov,g.OU,C.X$,i.HbD],styles:[".facet-values-list[_ngcontent-%COMP%]{max-width:500px;display:flex;flex-wrap:wrap;align-items:center;gap:4px}"]})}const $e="__DEFAULT_VARIANT__";class _e{constructor(n,t){this.dataService=n,this.formBuilder=t,this.variantsChange=new e.vpe,this.optionGroups=[],this.variantFormValues={},this.selectedStockLocationId=null}ngOnInit(){this.dataService.settings.getActiveChannel().single$.subscribe(n=>{this.currencyCode=n.activeChannel.defaultCurrencyCode}),this.stockLocations$=this.dataService.query(i.uQH,{options:{take:999}}).refetchOnChannelChange().mapStream(({stockLocations:n})=>n.items).pipe((0,N.b)(n=>{n.length&&(this.selectedStockLocationId=n[0].id)})),this.generateVariants()}addOption(){this.optionGroups.push({name:"",values:[]});const n=this.optionGroups.length-1;setTimeout(()=>{this.groupNameInputs.get(n)?.nativeElement?.focus()})}removeOption(n){this.optionGroups=this.optionGroups.filter(t=>t.name!==n),this.generateVariants()}generateVariants(){const t=this.optionGroups.reduce((r,a)=>r+a.values.length,0)?this.optionGroups.map(r=>r.values.map(a=>a.name)):[[$e]];this.variants=(0,Fe.generateAllCombinations)(t).map(r=>({id:r.join("|"),values:r})),this.variants.forEach((r,a)=>{if(!this.variantFormValues[r.id]){const l=this.formBuilder.nonNullable.group({optionValues:[r.values],enabled:!0,price:this.copyFromDefault(r.id,"price",0),sku:this.copyFromDefault(r.id,"sku",""),stock:this.copyFromDefault(r.id,"stock",0)});l.valueChanges.subscribe(()=>this.onFormChange()),0===a&&(l.get("price")?.valueChanges.subscribe(c=>{this.copyValuesToPristine("price",l.get("price"))}),l.get("sku")?.valueChanges.subscribe(c=>{this.copyValuesToPristine("sku",l.get("sku"))}),l.get("stock")?.valueChanges.subscribe(c=>{this.copyValuesToPristine("stock",l.get("stock"))})),this.variantFormValues[r.id]=l}})}trackByFn(n,t){return t.values.join("|")}handleEnter(n,t){n.preventDefault(),n.stopPropagation(),t.focus()}copyValuesToPristine(n,t){t&&Object.values(this.variantFormValues).forEach(r=>{const a=r.get(n);a&&a.pristine&&a.setValue(t.value,{emitEvent:!1})})}onFormChange(){const n=this.variants.map(t=>this.variantFormValues[t.id].value).filter(t=>t.enabled);this.variantsChange.emit({groups:this.optionGroups.map(t=>({name:t.name,values:t.values.map(r=>r.name)})),variants:n,stockLocationId:this.selectedStockLocationId})}copyFromDefault(n,t,r){return n!==$e?this.variantFormValues[$e].get(t)?.value:r}static#e=this.\u0275fac=function(t){return new(t||_e)(e.Y36(i.DoR),e.Y36(d.qu))};static#t=this.\u0275cmp=e.Xpm({type:_e,selectors:[["vdr-generate-product-variants"]],viewQuery:function(t,r){if(1&t&&e.Gf(Ea,5,e.SBq),2&t){let a;e.iGM(a=e.CRH())&&(r.groupNameInputs=a)}},outputs:{variantsChange:"variantsChange"},decls:7,vars:7,consts:[["class","option-groups",4,"ngFor","ngForOf"],[1,"button","mb-2",3,"click"],["shape","plus"],[4,"ngIf"],[1,"option-groups"],[1,"name"],["placeholder","e.g. Size","clrInput","","name","name","required","",3,"ngModel","ngModelChange","keydown.enter"],["optionGroupName",""],[1,"values"],[3,"ngModel","groupName","disabled","ngModelChange","edit"],["optionValueInputComponent",""],[1,"remove-group"],[1,"button-small","mt-2",3,"title","click"],["shape","trash"],["clrAlertType","warning","class","",3,"clrAlertClosable",4,"ngIf"],[1,"form-grid","mb-2"],[3,"label",4,"ngIf"],["class","variants-preview",4,"ngIf"],["clrAlertType","warning",1,"",3,"clrAlertClosable"],[1,"alert-text"],[3,"label"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"variants-preview"],[1,"table"],[3,"disabled","formGroup",4,"ngFor","ngForOf","ngForTrackBy"],[3,"formGroup"],["type","text","formControlName","sku",3,"placeholder"],["formControlName","price",3,"currencyCode"],["type","number","formControlName","stock","min","0","step","1"],["type","checkbox","formControlName","enabled","clrCheckbox",""]],template:function(t,r){1&t&&(e.YNc(0,ja,17,13,"div",0),e.TgZ(1,"button",1),e.NdJ("click",function(){return r.addOption()}),e._UZ(2,"clr-icon",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,ri,5,3,"ng-container",3),e.ALo(6,"async")),2&t&&(e.Q6J("ngForOf",r.optionGroups),e.xp6(3),e.hij(" ",e.lcZ(4,3,"catalog.add-option"),"\n"),e.xp6(2),e.Q6J("ngIf",e.lcZ(6,5,r.stockLocations$)))},dependencies:[_.TIm,_.CyW,_.I9z,_.q0d,_.qvL,_.MgK,_.KKC,_.xRP,g.sg,g.O5,d.YN,d.Kr,d.Fj,d.wV,d.Wl,d.EJ,d.JJ,d.JL,d.Q7,d.qQ,d.On,d.sg,d.u,i.KQz,i.hgI,i.y_K,S,g.Ov,C.X$],styles:["[_nghost-%COMP%]{display:block;margin-bottom:120px}.option-groups[_ngcontent-%COMP%]{display:flex}.values[_ngcontent-%COMP%]{flex:1;margin:0 6px}.remove-group[_ngcontent-%COMP%]{padding-top:18px}.variants-preview[_ngcontent-%COMP%]   tr.disabled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100);color:var(--color-grey-400)}"]})}class z extends i.$ms{constructor(){super(),this.hideLanguageSelect=!1,this.customFields=this.getCustomFieldConfig("ProductVariant"),this.filters=this.createFilterCollection().addIdFilter().addDateFilters().addFilters([{name:"name",type:{kind:"text"},label:(0,p.J)("common.name"),filterField:"name"},{name:"enabled",type:{kind:"boolean"},label:(0,p.J)("common.enabled"),filterField:"enabled"},{name:"sku",type:{kind:"text"},label:(0,p.J)("catalog.sku"),filterField:"sku"},{name:"price",type:{kind:"number",inputType:"currency"},label:(0,p.J)("common.price"),filterField:"price"},{name:"priceWithTax",type:{kind:"number",inputType:"currency"},label:(0,p.J)("common.price-with-tax"),filterField:"priceWithTax"}]).addCustomFieldFilters(this.customFields).connectToRoute(this.route),this.sorts=this.createSortCollection().addSorts([{name:"id"},{name:"createdAt"},{name:"updatedAt"},{name:"name"},{name:"sku"},{name:"price"},{name:"priceWithTax"}]).addCustomFieldSorts(this.customFields).connectToRoute(this.route),this.configure({document:i.NKc,getItems:n=>n.productVariants,setVariables:(n,t)=>({options:{skip:n,take:t,filter:{sku:{contains:this.searchTermControl.value},...this.filters.createFilterInput(),...this.productId?{productId:{eq:this.productId}}:{}},sort:this.sorts.createSortInput()}}),refreshListOnChanges:[this.sorts.valueChanges,this.filters.valueChanges]})}static#e=this.\u0275fac=function(t){return new(t||z)};static#t=this.\u0275cmp=e.Xpm({type:z,selectors:[["vdr-product-variant-list"]],inputs:{productId:"productId",hideLanguageSelect:"hideLanguageSelect",dataTableId:"dataTableId"},features:[e.qOj],decls:40,vars:65,consts:[[4,"ngIf"],[1,"mt-2",3,"id","items","itemsPerPage","totalItems","currentPage","filters","pageChange","itemsPerPageChange"],["locationId","product-variant-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],["id","id",3,"heading","hiddenByDefault","sort"],["id","created-at",3,"heading","hiddenByDefault","sort"],["id","updated-at",3,"heading","hiddenByDefault","sort"],["id","image",3,"heading"],["id","name",3,"heading","optional","sort"],["id","sku",3,"heading","sort"],["id","enabled",3,"heading"],["id","price",3,"heading","hiddenByDefault","sort"],["id","price-with-tax",3,"heading","sort"],["id","stock-on-hand",3,"heading","hiddenByDefault"],[3,"customField","sorts",4,"ngFor","ngForOf"],[3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],[1,"image-placeholder"],[3,"src",4,"ngIf","ngIfElse"],["imagePlaceholder",""],[3,"src"],[1,"placeholder"],["shape","image","size","48"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],["colorType","success",4,"ngIf"],["colorType","warning",4,"ngIf"],["colorType","success"],["colorType","warning"],[3,"title",4,"ngFor","ngForOf"],[3,"title"],[1,"flex","center"],["class","ml-1",4,"ngIf"],[1,"ml-1"],[3,"customField","sorts"]],template:function(t,r){1&t&&(e.YNc(0,oi,4,6,"vdr-page-block",0),e.TgZ(1,"vdr-data-table-2",1),e.NdJ("pageChange",function(l){return r.setPageNumber(l)})("itemsPerPageChange",function(l){return r.setItemsPerPage(l)}),e.ALo(2,"async"),e.ALo(3,"async"),e.ALo(4,"async"),e.ALo(5,"async"),e._UZ(6,"vdr-bulk-action-menu",2)(7,"vdr-dt2-search",3),e.ALo(8,"translate"),e.TgZ(9,"vdr-dt2-column",4),e.ALo(10,"translate"),e.YNc(11,ai,1,1,"ng-template"),e.qZA(),e.TgZ(12,"vdr-dt2-column",5),e.ALo(13,"translate"),e.YNc(14,ii,2,4,"ng-template"),e.qZA(),e.TgZ(15,"vdr-dt2-column",6),e.ALo(16,"translate"),e.YNc(17,li,2,4,"ng-template"),e.qZA(),e.TgZ(18,"vdr-dt2-column",7),e.ALo(19,"translate"),e.YNc(20,di,4,2,"ng-template"),e.qZA(),e.TgZ(21,"vdr-dt2-column",8),e.ALo(22,"translate"),e.YNc(23,ui,4,5,"ng-template"),e.qZA(),e.TgZ(24,"vdr-dt2-column",9),e.ALo(25,"translate"),e.YNc(26,mi,1,1,"ng-template"),e.qZA(),e.TgZ(27,"vdr-dt2-column",10),e.ALo(28,"translate"),e.YNc(29,fi,2,2,"ng-template"),e.qZA(),e.TgZ(30,"vdr-dt2-column",11),e.ALo(31,"translate"),e.YNc(32,hi,2,4,"ng-template"),e.qZA(),e.TgZ(33,"vdr-dt2-column",12),e.ALo(34,"translate"),e.YNc(35,vi,2,4,"ng-template"),e.qZA(),e.TgZ(36,"vdr-dt2-column",13),e.ALo(37,"translate"),e.YNc(38,xi,1,1,"ng-template"),e.qZA(),e.YNc(39,yi,1,2,"vdr-dt2-custom-field-column",14),e.qZA()),2&t&&(e.Q6J("ngIf",!r.hideLanguageSelect),e.xp6(1),e.Q6J("id",r.dataTableId||"product-variant-list")("items",e.lcZ(2,35,r.items$))("itemsPerPage",e.lcZ(3,37,r.itemsPerPage$))("totalItems",e.lcZ(4,39,r.totalItems$))("currentPage",e.lcZ(5,41,r.currentPage$))("filters",r.filters),e.xp6(5),e.Q6J("hostComponent",r)("selectionManager",r.selectionManager),e.xp6(1),e.Q6J("searchTermControl",r.searchTermControl)("searchTermPlaceholder",e.lcZ(8,43,"catalog.filter-by-sku")),e.xp6(2),e.Q6J("heading",e.lcZ(10,45,"common.id"))("hiddenByDefault",!0)("sort",r.sorts.get("id")),e.xp6(3),e.Q6J("heading",e.lcZ(13,47,"common.created-at"))("hiddenByDefault",!0)("sort",r.sorts.get("createdAt")),e.xp6(3),e.Q6J("heading",e.lcZ(16,49,"common.updated-at"))("hiddenByDefault",!0)("sort",r.sorts.get("updatedAt")),e.xp6(3),e.Q6J("heading",e.lcZ(19,51,"common.image")),e.xp6(3),e.Q6J("heading",e.lcZ(22,53,"catalog.name"))("optional",!1)("sort",r.sorts.get("name")),e.xp6(3),e.Q6J("heading",e.lcZ(25,55,"catalog.sku"))("sort",r.sorts.get("sku")),e.xp6(3),e.Q6J("heading",e.lcZ(28,57,"common.enabled")),e.xp6(3),e.Q6J("heading",e.lcZ(31,59,"common.price"))("hiddenByDefault",!0)("sort",r.sorts.get("price")),e.xp6(3),e.Q6J("heading",e.lcZ(34,61,"common.price-with-tax"))("sort",r.sorts.get("priceWithTax")),e.xp6(3),e.Q6J("heading",e.lcZ(37,63,"catalog.stock-on-hand"))("hiddenByDefault",!1),e.xp6(3),e.Q6J("ngForOf",r.customFields))},dependencies:[_.qvL,g.sg,g.O5,P.rH,i.Ywx,i.SdP,i.cuf,i.eJ5,i.Up6,i.JBy,i.jrk,i.zJY,g.Ov,C.X$,i.Mgf,i.HbD,i.kgx],styles:[".image-col[_ngcontent-%COMP%]{width:70px}.image-placeholder[_ngcontent-%COMP%]{width:50px;height:50px;margin-top:calc(var(--space-unit) * -1);margin-bottom:calc(var(--space-unit) * -1);background-color:var(--color-component-bg-200)}.image-placeholder[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:var(--border-radius-img)}.image-placeholder[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{text-align:center;color:var(--color-grey-300)}.search-form[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}vdr-product-search-input[_ngcontent-%COMP%]{min-width:300px}@media screen and (max-width: 768px){vdr-product-search-input[_ngcontent-%COMP%]{min-width:100px}}.search-settings-menu[_ngcontent-%COMP%]{margin:0 12px}td.disabled[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}.search-index-button[_ngcontent-%COMP%]{position:relative}.search-index-button[_ngcontent-%COMP%]   vdr-status-badge[_ngcontent-%COMP%]{right:0;top:0}.run-updates-button[_ngcontent-%COMP%]{position:relative}.run-updates-button[_ngcontent-%COMP%]   vdr-status-badge[_ngcontent-%COMP%]{left:10px;top:10px}.edit-button[_ngcontent-%COMP%]{margin-inline-end:24px}.sku[_ngcontent-%COMP%]{color:var(--color-text-300)}"]})}const tc=A.Ps`
    query GetProductDetail($id: ID!) {
        product(id: $id) {
            ...ProductDetail
        }
    }
    ${i.c4F}
`;class W extends i.VE7{constructor(n,t,r,a,l,c){super(),this.productDetailService=n,this.formBuilder=t,this.modalService=r,this.notificationService=a,this.dataService=l,this.changeDetector=c,this.customFields=this.getCustomFieldConfig("Product"),this.detailForm=this.formBuilder.group({enabled:!0,name:["",d.kI.required],autoUpdateVariantNames:!0,slug:["",(0,i.Foo)(/^[\p{Letter}0-9._-]+$/)],description:"",facetValueIds:[[]],customFields:this.formBuilder.group((0,i.Lrj)(this.customFields))}),this.assetChanges={},this.createVariantsConfig={groups:[],variants:[],stockLocationId:""},this.updatePermissions=[i.y3$.UpdateCatalog,i.y3$.UpdateProduct]}ngOnInit(){this.init();const n=this.isNew$.pipe((0,b.w)(a=>a?(0,F.of)([]):this.entity$.pipe((0,f.U)(l=>l.facetValues)))),r=this.detailForm.get("facetValueIds").valueChanges.pipe((0,O.x)(),(0,b.w)(a=>this.dataService.facet.getFacetValues({filter:{id:{in:a}}}).mapSingle(({facetValues:l})=>l.items)),(0,xe.d)(1));this.facetValues$=(0,Ye.z)(n.pipe((0,$.q)(1)),n.pipe((0,b.w)(()=>r))),this.productChannels$=this.entity$.pipe((0,f.U)(a=>a.channels))}ngOnDestroy(){this.destroy()}isDefaultChannel(n){return n===Ft.z$}assignToChannel(){this.productChannels$.pipe((0,$.q)(1),(0,b.w)(n=>this.modalService.fromComponent(Q,{size:"lg",locals:{productIds:[this.id],currentChannelIds:n.map(t=>t.id)}}))).subscribe()}removeFromChannel(n){(0,Je.D)((0,i.PDO)(this.dataService,n)).pipe((0,b.w)(({channelCode:t})=>this.modalService.dialog({title:(0,p.J)("catalog.remove-product-from-channel"),buttons:[{type:"secondary",label:(0,p.J)("common.cancel")},{type:"danger",label:(0,p.J)("catalog.remove-from-channel"),translationVars:{channelCode:t},returnValue:!0}]})),(0,b.w)(t=>t?this.dataService.product.removeProductsFromChannel({channelId:n,productIds:[this.id]}):Z.E)).subscribe(()=>{this.notificationService.success((0,p.J)("catalog.notify-remove-product-from-channel-success"))},t=>{this.notificationService.error((0,p.J)("catalog.notify-remove-product-from-channel-error"))})}assignVariantToChannel(n){return this.modalService.fromComponent(Q,{size:"lg",locals:{productIds:[this.id],productVariantIds:[n.id],currentChannelIds:n.channels.map(t=>t.id)}}).subscribe()}removeVariantFromChannel({channelId:n,variant:t}){(0,Je.D)((0,i.PDO)(this.dataService,n)).pipe((0,b.w)(({channelCode:r})=>this.modalService.dialog({title:(0,p.J)("catalog.remove-product-variant-from-channel"),buttons:[{type:"secondary",label:(0,p.J)("common.cancel")},{type:"danger",label:(0,p.J)("catalog.remove-from-channel"),translationVars:{channelCode:r},returnValue:!0}]})),(0,b.w)(r=>r?this.dataService.product.removeVariantsFromChannel({channelId:n,productVariantIds:[t.id]}):Z.E)).subscribe(()=>{this.notificationService.success((0,p.J)("catalog.notify-remove-variant-from-channel-success"))},r=>{this.notificationService.error((0,p.J)("catalog.notify-remove-variant-from-channel-error"))})}assetsChanged(){return!!Object.values(this.assetChanges).length}updateSlug(n){const t=this.detailForm.get("slug"),r=this.entity?(0,i.ZIM)(this.entity,this.languageCode):void 0,a=!r||!r.slug;t&&t.pristine&&a&&t.setValue((0,U.U)(`${n}`,"-"))}selectProductFacetValue(){this.displayFacetValueModal().subscribe(n=>{if(n){const t=this.detailForm,r=t.value.facetValueIds??[];t.patchValue({facetValueIds:(0,L.T)([...r,...n])}),t.markAsDirty(),this.changeDetector.markForCheck()}})}updateProductOption(n){(0,T.a)(this.entity$,this.languageCode$).pipe((0,$.q)(1),(0,J.z)(([t,r])=>this.productDetailService.updateProductOption(n,t,r))).subscribe(()=>{this.notificationService.success((0,p.J)("common.notify-update-success"),{entity:"ProductOption"})},t=>{this.notificationService.error((0,p.J)("common.notify-update-error"),{entity:"ProductOption"})})}removeProductFacetValue(n){const t=this.detailForm,r=t.value.facetValueIds??[];t.patchValue({facetValueIds:r.filter(a=>a!==n)}),t.markAsDirty()}displayFacetValueModal(){return this.modalService.fromComponent(j,{size:"md",closable:!0}).pipe((0,f.U)(n=>n&&n.map(t=>t.id)))}create(){const n=this.detailForm;if(!n.dirty)return;const t=this.getUpdatedProduct({id:"",createdAt:"",updatedAt:"",enabled:!0,languageCode:this.languageCode,name:"",slug:"",featuredAsset:null,assets:[],description:"",translations:[],optionGroups:[],facetValues:[],channels:[]},n,this.languageCode);this.productDetailService.createProductWithVariants(t,this.createVariantsConfig,this.languageCode).subscribe(({createProductVariants:r,productId:a})=>{this.notificationService.success((0,p.J)("common.notify-create-success"),{entity:"Product"}),this.assetChanges={},this.detailForm.markAsPristine(),this.router.navigate(["../",a],{relativeTo:this.route})},r=>{console.error(r),this.notificationService.error((0,p.J)("common.notify-create-error"),{entity:"Product"})})}save(){(0,T.a)(this.entity$,this.languageCode$).pipe((0,$.q)(1),(0,J.z)(([n,t])=>{const r=this.detailForm;let a;return(r.dirty||this.assetsChanged())&&(a=this.getUpdatedProduct(n,r,t)),this.productDetailService.updateProduct({product:n,languageCode:t,autoUpdate:this.detailForm.get(["product","autoUpdateVariantNames"])?.value??!1,productInput:a,variantsInput:undefined})})).subscribe(n=>{this.updateSlugAfterSave(n),this.detailForm.markAsPristine(),this.assetChanges={},this.notificationService.success((0,p.J)("common.notify-update-success"),{entity:"Product"}),this.changeDetector.markForCheck()},n=>{this.notificationService.error((0,p.J)("common.notify-update-error"),{entity:"Product"})})}canDeactivate(){return super.canDeactivate()&&!this.assetChanges.assets&&!this.assetChanges.featuredAsset}setFormValues(n,t){const r=(0,i.ZIM)(n,t);this.detailForm.patchValue({enabled:n.enabled,name:r?r.name:"",slug:r?r.slug:"",description:r?r.description:"",facetValueIds:n.facetValues.map(a=>a.id)}),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["customFields"]),n,r)}getUpdatedProduct(n,t,r){return{...(0,i.iSy)({translatable:n,updatedFields:t.value,customFieldConfig:this.customFields,languageCode:r,defaultTranslation:{languageCode:r,name:n.name||"",slug:n.slug||"",description:n.description||""}}),assetIds:this.assetChanges.assets?.map(l=>l.id),featuredAssetId:this.assetChanges.featuredAsset?.id,facetValueIds:t.value.facetValueIds}}updateSlugAfterSave(n){const t=n[0],r=this.detailForm.get(["product","slug"]);r&&function a(l){return l.hasOwnProperty("updateProduct")}(t)&&r.setValue(t.updateProduct.slug,{emitEvent:!1})}static#e=this.\u0275fac=function(t){return new(t||W)(e.Y36(q),e.Y36(d.qu),e.Y36(i.Z7U),e.Y36(i.gqp),e.Y36(i.DoR),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:W,selectors:[["vdr-product-detail2"]],features:[e.qOj],decls:68,vars:86,consts:[[1,"flex","clr-flex-row"],[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","product-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","visibility",3,"label"],[4,"vdrIfPermissions"],[4,"ngIf"],[3,"title",4,"ngIf"],[3,"title"],[1,"facets"],[3,"facetValue","removable","remove",4,"ngFor","ngForOf"],["class","button-small mt-2",3,"click",4,"vdrIfPermissions"],["type","submit","hidden","","x-data","prevents enter key from triggering other buttons"],[1,"form-grid"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly","input"],["for","slug",3,"label","errors"],["id","slug","type","text","formControlName","slug",3,"readonly"],["for","slug",1,"form-grid-span",3,"label","errors"],["formControlName","description",3,"readonly"],["locationId","product-detail",3,"entity$","detailForm"],[3,"assets","featuredAsset","updatePermissions","change"],[3,"title","paddingX"],[4,"ngIf","ngIfElse"],["variantList",""],["class","mx-3",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],["type","checkbox","clrToggle","","name","enabled",3,"formControl"],[3,"title",4,"vdrIfMultichannel"],[4,"vdrIfDefaultChannelActive"],[1,"flex","channel-assignment"],[1,"mb-2"],[4,"ngFor","ngForOf"],[1,"button-small",3,"click"],["shape","layers"],["icon","times-circle",3,"iconClick",4,"ngIf"],["icon","times-circle",3,"iconClick"],[3,"channelCode"],[1,"options"],[3,"colorFrom","invert",4,"ngFor","ngForOf"],["class","button-small mt-2",3,"routerLink",4,"vdrIfPermissions"],[3,"colorFrom","invert"],[1,"button-small","mt-2",3,"routerLink"],["shape","pencil"],[3,"facetValue","removable","remove"],[1,"button-small","mt-2",3,"click"],["shape","plus"],[3,"entity"],["clrCheckbox","","type","checkbox","id","auto-update","formControlName","autoUpdateVariantNames"],["entityName","Product",3,"customFields","customFieldsFormGroup","readonly"],[3,"variantsChange"],["dataTableId","product-detail-variants-list",3,"productId","hideLanguageSelect"],[1,"mx-3"],[1,"button",3,"routerLink"],["shape","add-text"]],template:function(t,r){if(1&t&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-left"),e._UZ(3,"div",0),e.TgZ(4,"vdr-language-selector",1),e.NdJ("languageCodeChange",function(l){return r.setLanguage(l)}),e.ALo(5,"async"),e.ALo(6,"async"),e.ALo(7,"async"),e.qZA()(),e.TgZ(8,"vdr-ab-right"),e._UZ(9,"vdr-action-bar-items",2),e.YNc(10,Pi,3,4,"button",3),e.ALo(11,"async"),e.YNc(12,Ai,1,1,"ng-template",null,4,e.W1O),e.qZA()()(),e.TgZ(14,"form",5)(15,"vdr-page-detail-layout")(16,"vdr-page-detail-sidebar")(17,"vdr-card")(18,"vdr-form-field",6),e.ALo(19,"translate"),e.YNc(20,Zi,5,5,"clr-toggle-wrapper",7),e.qZA()(),e.YNc(21,wi,2,0,"ng-container",8),e.ALo(22,"async"),e.YNc(23,Mi,7,8,"vdr-card",9),e.TgZ(24,"vdr-card",10),e.ALo(25,"translate"),e.TgZ(26,"div",11),e.YNc(27,Ni,2,4,"vdr-facet-value-chip",12),e.ALo(28,"async"),e.qZA(),e.TgZ(29,"div"),e.YNc(30,Vi,4,3,"button",13),e.qZA()(),e.YNc(31,$i,2,1,"vdr-card",8),e.ALo(32,"async"),e.qZA(),e.TgZ(33,"vdr-page-block"),e._UZ(34,"button",14),e.TgZ(35,"vdr-card")(36,"div",15)(37,"div")(38,"vdr-form-field",16),e.ALo(39,"translate"),e.TgZ(40,"input",17),e.NdJ("input",function(l){return r.updateSlug(l.target.value)}),e.ALo(41,"hasPermission"),e.qZA()(),e.YNc(42,Ui,6,3,"div",8),e.ALo(43,"async"),e.qZA(),e.TgZ(44,"vdr-form-field",18),e.ALo(45,"translate"),e.ALo(46,"translate"),e._UZ(47,"input",19),e.ALo(48,"hasPermission"),e.qZA(),e.TgZ(49,"vdr-form-field",20),e.ALo(50,"translate"),e.ALo(51,"translate"),e._UZ(52,"vdr-rich-text-editor",21),e.ALo(53,"hasPermission"),e.qZA()()(),e.YNc(54,qi,4,8,"vdr-card",9),e._UZ(55,"vdr-custom-detail-component-host",22),e.TgZ(56,"vdr-card",10),e.ALo(57,"translate"),e.TgZ(58,"vdr-assets",23),e.NdJ("change",function(l){return r.assetChanges=l}),e.qZA()(),e.TgZ(59,"vdr-card",24),e.ALo(60,"translate"),e.ALo(61,"async"),e.YNc(62,Qi,2,0,"div",25),e.ALo(63,"async"),e.YNc(64,Si,1,2,"ng-template",null,26,e.W1O),e.YNc(66,Yi,5,5,"div",27),e.ALo(67,"async"),e.qZA()()()()),2&t){const a=e.MAs(13),l=e.MAs(65);let c;e.xp6(4),e.Q6J("disabled",e.lcZ(5,35,r.isNew$))("availableLanguageCodes",e.lcZ(6,37,r.availableLanguages$))("currentLanguageCode",e.lcZ(7,39,r.languageCode$)),e.xp6(6),e.Q6J("ngIf",e.lcZ(11,41,r.isNew$))("ngIfElse",a),e.xp6(4),e.Q6J("formGroup",r.detailForm),e.xp6(4),e.Q6J("label",e.lcZ(19,43,"catalog.visibility")),e.xp6(2),e.Q6J("vdrIfPermissions",r.updatePermissions),e.xp6(1),e.Q6J("ngIf",!e.lcZ(22,45,r.isNew$)),e.xp6(2),e.Q6J("ngIf",null==r.entity?null:r.entity.optionGroups.length),e.xp6(1),e.Q6J("title",e.lcZ(25,47,"catalog.facets")),e.xp6(3),e.Q6J("ngForOf",e.lcZ(28,49,r.facetValues$)),e.xp6(3),e.Q6J("vdrIfPermissions",r.updatePermissions),e.xp6(1),e.Q6J("ngIf",e.lcZ(32,51,r.entity$)),e.xp6(7),e.Q6J("label",e.lcZ(39,53,"catalog.product-name")),e.xp6(2),e.Q6J("readonly",!e.lcZ(41,55,r.updatePermissions)),e.xp6(2),e.Q6J("ngIf",!1===e.lcZ(43,57,r.isNew$)&&(null==(c=r.detailForm.get(e.DdM(81,Bi)))?null:c.dirty)),e.xp6(2),e.Q6J("label",e.lcZ(45,59,"catalog.slug"))("errors",e.VKq(82,Me,e.lcZ(46,61,"catalog.slug-pattern-error"))),e.xp6(3),e.Q6J("readonly",!e.lcZ(48,63,r.updatePermissions)),e.xp6(2),e.Q6J("label",e.lcZ(50,65,"common.description"))("errors",e.VKq(84,Me,e.lcZ(51,67,"catalog.slug-pattern-error"))),e.xp6(3),e.Q6J("readonly",!e.lcZ(53,69,r.updatePermissions)),e.xp6(2),e.Q6J("ngIf",r.customFields.length),e.xp6(1),e.Q6J("entity$",r.entity$)("detailForm",r.detailForm),e.xp6(1),e.Q6J("title",e.lcZ(57,71,"catalog.assets")),e.xp6(2),e.Q6J("assets",r.assetChanges.assets||(null==r.entity?null:r.entity.assets))("featuredAsset",r.assetChanges.featuredAsset||(null==r.entity?null:r.entity.featuredAsset))("updatePermissions",r.updatePermissions),e.xp6(1),e.Q6J("title",e.lcZ(60,73,"catalog.product-variants"))("paddingX",e.lcZ(61,75,r.isNew$)),e.xp6(3),e.Q6J("ngIf",e.lcZ(63,77,r.isNew$))("ngIfElse",l),e.xp6(4),e.Q6J("ngIf",!1===e.lcZ(67,79,r.isNew$))}},dependencies:[_.qvL,_.MgK,_.KKC,_.PEh,g.sg,g.O5,d._Y,d.Fj,d.Wl,d.JJ,d.JL,d.oH,d.sg,d.u,P.rH,i.KkL,i.BND,i.mz,i.Ywx,i.qt4,i.hgI,i.y_K,i.Jpf,i.SdP,i.YI,i.HAh,i.uKX,i.WWO,i.nIZ,i.Moo,i.yc0,i.CWh,i.zJY,i.DME,i.TeL,i.W1W,i.AkF,_e,G,z,g.Ov,C.X$,i.UwE,i.j$k,i.E6B],styles:["[_nghost-%COMP%]     trix-toolbar{top:24px}.facets[_ngcontent-%COMP%], .options[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:3px}vdr-action-bar[_ngcontent-%COMP%]   clr-toggle-wrapper[_ngcontent-%COMP%]{margin-top:12px}.variant-filter[_ngcontent-%COMP%]{flex:1;display:flex}.variant-filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;max-width:initial;border-radius:3px 0 0 3px!important}.variant-filter[_ngcontent-%COMP%]   .icon-button[_ngcontent-%COMP%]{border:1px solid var(--color-component-border-300);background-color:var(--color-component-bg-100);border-radius:0 3px 3px 0;border-inline-start:none}.group-name[_ngcontent-%COMP%]{padding-inline-end:6px}.view-mode[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between}@media screen and (min-width: 768px){.view-mode[_ngcontent-%COMP%]{flex-direction:row}}.edit-variants-btn[_ngcontent-%COMP%]{margin-top:0}.channel-assignment[_ngcontent-%COMP%]{flex-wrap:wrap;max-height:144px}.pagination-row[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:space-between}"],changeDetection:0})}const mt={location:"product-list",label:(0,p.J)("common.delete"),icon:"trash",iconClass:"is-danger",requiresPermission:o=>o.includes(i.y3$.DeleteProduct)||o.includes(i.y3$.DeleteCatalog),onClick:({injector:o,selection:n,hostComponent:t,clearSelection:r})=>{const a=o.get(i.Z7U),l=o.get(i.DoR),c=o.get(i.gqp);a.dialog({title:(0,p.J)("catalog.confirm-bulk-delete-products"),translationVars:{count:n.length},buttons:[{type:"secondary",label:(0,p.J)("common.cancel")},{type:"danger",label:(0,p.J)("common.delete"),returnValue:!0}]}).pipe((0,b.w)(s=>s?l.product.deleteProducts((0,L.T)(n.map(u=>u.id))):Z.E)).subscribe(s=>{let u=0;const m=[];for(const v of s.deleteProducts)v.result===i.PcR.DELETED?u++:v.message&&m.push(v.message);0<u&&c.success((0,p.J)("catalog.notify-bulk-delete-products-success"),{count:u}),0<m.length&&c.error(m.join("\n")),t.refresh(),r()})}},gt={location:"product-list",label:(0,p.J)("catalog.assign-to-channel"),icon:"layers",requiresPermission:o=>o.includes(i.y3$.UpdateCatalog)||o.includes(i.y3$.UpdateProduct),isVisible:({injector:o})=>(0,i.SDV)(o.get(i.DoR)),onClick:({injector:o,selection:n,clearSelection:t})=>{o.get(i.Z7U).fromComponent(Q,{size:"lg",locals:{productIds:(0,L.T)(n.map(a=>a.id)),currentChannelIds:[]}}).subscribe(a=>{a&&t()})}},_t=(0,i.RBx)({location:"product-list",requiresPermission:o=>o.includes(i.y3$.UpdateCatalog)||o.includes(i.y3$.UpdateProduct),getItemName:o=>o.name,bulkRemoveFromChannel:(o,n,t)=>o.product.removeProductsFromChannel({channelId:t,productIds:n}).pipe((0,f.U)(r=>r.removeProductsFromChannel))}),ft={location:"product-list",label:(0,p.J)("catalog.edit-facet-values"),icon:"tag",requiresPermission:o=>o.includes(i.y3$.UpdateCatalog)||o.includes(i.y3$.UpdateProduct),onClick:({injector:o,selection:n,hostComponent:t,clearSelection:r})=>{const a=o.get(i.Z7U),c=(o.get(i.DoR),o.get(i.gqp)),s="product",u=(0,L.T)(n.map(m=>m.id));return a.fromComponent(se,{size:"xl",locals:{mode:s,ids:u}}).subscribe(m=>{m&&(c.success((0,p.J)("common.notify-bulk-update-success"),{count:n.length,entity:"Products"}),r())})}};class fe extends i.$ms{constructor(n,t,r,a){super(),this.dataService=n,this.modalService=t,this.notificationService=r,this.jobQueueService=a,this.pendingSearchIndexUpdates=0,this.customFields=this.getCustomFieldConfig("Product"),this.filters=this.createFilterCollection().addIdFilter().addDateFilters().addFilters([{name:"enabled",type:{kind:"boolean"},label:(0,p.J)("common.enabled"),filterField:"enabled"},{name:"slug",type:{kind:"text"},label:(0,p.J)("common.slug"),filterField:"slug"}]).addFilter({name:"facetValues",type:{kind:"custom",component:i.qPP,serializeValue:l=>l.map(c=>c.id).join(","),deserializeValue:l=>l.split(",").map(c=>({id:c})),getLabel:l=>0===l.length?"":l[0].name?l.map(c=>c.name).join(", "):(0,Ge.n)(this.dataService.facet.getFacetValues({filter:{id:{in:l.map(c=>c.id)}}}).mapSingle(({facetValues:c})=>c.items.map(s=>s.name).join(", ")))},label:(0,p.J)("catalog.facet-values"),toFilterInput:l=>({facetValueId:{in:l.map(c=>c.id)}})}).addCustomFieldFilters(this.customFields).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("createdAt","DESC").addSorts([{name:"id"},{name:"createdAt"},{name:"updatedAt"},{name:"name"},{name:"slug"}]).addCustomFieldSorts(this.customFields).connectToRoute(this.route),this.configure({document:i.Qek,getItems:l=>l.products,setVariables:(l,c)=>({options:{skip:l,take:c,filter:{name:{contains:this.searchTermControl.value},...this.filters.createFilterInput()},sort:this.sorts.createSortInput()}}),refreshListOnChanges:[this.sorts.valueChanges,this.filters.valueChanges]})}rebuildSearchIndex(){this.dataService.product.reindex().subscribe(({reindex:n})=>{this.notificationService.info((0,p.J)("catalog.reindexing")),this.jobQueueService.addJob(n.id,t=>{if(t.state===i.Zyh.COMPLETED){const r=(new Intl.NumberFormat).format(t.duration||0);this.notificationService.success((0,p.J)("catalog.reindex-successful"),{count:t.result.indexedItemCount,time:r}),this.refresh()}else this.notificationService.error((0,p.J)("catalog.reindex-error"))})})}deleteProduct(n){this.modalService.dialog({title:(0,p.J)("catalog.confirm-delete-product"),buttons:[{type:"secondary",label:(0,p.J)("common.cancel")},{type:"danger",label:(0,p.J)("common.delete"),returnValue:!0}]}).pipe((0,b.w)(t=>t?this.dataService.product.deleteProduct(n):Z.E),(0,yt.g)(500)).subscribe(()=>{this.notificationService.success((0,p.J)("common.notify-delete-success"),{entity:"Product"}),this.refresh()},t=>{this.notificationService.error((0,p.J)("common.notify-delete-error"),{entity:"Product"})})}static#e=this.\u0275fac=function(t){return new(t||fe)(e.Y36(i.DoR),e.Y36(i.Z7U),e.Y36(i.gqp),e.Y36(i.u8d))};static#t=this.\u0275cmp=e.Xpm({type:fe,selectors:[["vdr-products-list"]],features:[e.qOj],decls:50,vars:64,consts:[[3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","product-list"],["class","button primary mr-1",3,"routerLink",4,"vdrIfPermissions"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",3,"click"],["shape","refresh",1,""],["id","product-list",1,"mt-2",3,"items","itemsPerPage","totalItems","currentPage","filters","pageChange","itemsPerPageChange"],["locationId","product-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],["id","id",3,"heading","hiddenByDefault","sort"],["id","created-at",3,"heading","hiddenByDefault","sort"],["id","updated-at",3,"heading","hiddenByDefault","sort"],["id","image",3,"heading"],["id","name",3,"heading","optional","sort"],["id","slug",3,"heading","sort"],["id","enabled",3,"heading"],["id","number-of-variants",3,"heading"],[3,"customField","sorts",4,"ngFor","ngForOf"],[1,"button","primary","mr-1",3,"routerLink"],["shape","plus"],[1,"image-placeholder"],[3,"src",4,"ngIf","ngIfElse"],["imagePlaceholder",""],[3,"src"],[1,"placeholder"],["shape","image","size","48"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],["colorType","success",4,"ngIf"],["colorType","warning",4,"ngIf"],["colorType","success"],["colorType","warning"],[3,"customField","sorts"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-left")(3,"vdr-language-selector",0),e.NdJ("languageCodeChange",function(l){return r.setLanguage(l)}),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA()(),e.TgZ(6,"vdr-ab-right"),e._UZ(7,"vdr-action-bar-items",1),e.YNc(8,Ei,4,5,"a",2),e.TgZ(9,"vdr-dropdown")(10,"button",3),e._UZ(11,"clr-icon",4),e.qZA(),e.TgZ(12,"vdr-dropdown-menu",5)(13,"button",6),e.NdJ("click",function(){return r.rebuildSearchIndex()}),e._UZ(14,"clr-icon",7),e._uU(15),e.ALo(16,"translate"),e.qZA()()()()()(),e.TgZ(17,"vdr-data-table-2",8),e.NdJ("pageChange",function(l){return r.setPageNumber(l)})("itemsPerPageChange",function(l){return r.setItemsPerPage(l)}),e.ALo(18,"async"),e.ALo(19,"async"),e.ALo(20,"async"),e.ALo(21,"async"),e._UZ(22,"vdr-bulk-action-menu",9)(23,"vdr-dt2-search",10),e.ALo(24,"translate"),e.TgZ(25,"vdr-dt2-column",11),e.ALo(26,"translate"),e.YNc(27,ji,1,1,"ng-template"),e.qZA(),e.TgZ(28,"vdr-dt2-column",12),e.ALo(29,"translate"),e.YNc(30,Ri,2,4,"ng-template"),e.qZA(),e.TgZ(31,"vdr-dt2-column",13),e.ALo(32,"translate"),e.YNc(33,Hi,2,4,"ng-template"),e.qZA(),e.TgZ(34,"vdr-dt2-column",14),e.ALo(35,"translate"),e.YNc(36,Wi,4,2,"ng-template"),e.qZA(),e.TgZ(37,"vdr-dt2-column",15),e.ALo(38,"translate"),e.YNc(39,Xi,4,4,"ng-template"),e.qZA(),e.TgZ(40,"vdr-dt2-column",16),e.ALo(41,"translate"),e.YNc(42,el,1,1,"ng-template"),e.qZA(),e.TgZ(43,"vdr-dt2-column",17),e.ALo(44,"translate"),e.YNc(45,rl,2,2,"ng-template"),e.qZA(),e.TgZ(46,"vdr-dt2-column",18),e.ALo(47,"translate"),e.YNc(48,ol,2,6,"ng-template"),e.qZA(),e.YNc(49,al,1,2,"vdr-dt2-custom-field-column",19),e.qZA()),2&t&&(e.xp6(3),e.Q6J("availableLanguageCodes",e.lcZ(4,31,r.availableLanguages$))("currentLanguageCode",e.lcZ(5,33,r.contentLanguage$)),e.xp6(5),e.Q6J("vdrIfPermissions",e.DdM(63,il)),e.xp6(7),e.hij(" ",e.lcZ(16,35,"catalog.rebuild-search-index")," "),e.xp6(2),e.Q6J("items",e.lcZ(18,37,r.items$))("itemsPerPage",e.lcZ(19,39,r.itemsPerPage$))("totalItems",e.lcZ(20,41,r.totalItems$))("currentPage",e.lcZ(21,43,r.currentPage$))("filters",r.filters),e.xp6(5),e.Q6J("hostComponent",r)("selectionManager",r.selectionManager),e.xp6(1),e.Q6J("searchTermControl",r.searchTermControl)("searchTermPlaceholder",e.lcZ(24,45,"catalog.filter-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(26,47,"common.id"))("hiddenByDefault",!0)("sort",r.sorts.get("id")),e.xp6(3),e.Q6J("heading",e.lcZ(29,49,"common.created-at"))("hiddenByDefault",!0)("sort",r.sorts.get("createdAt")),e.xp6(3),e.Q6J("heading",e.lcZ(32,51,"common.updated-at"))("hiddenByDefault",!0)("sort",r.sorts.get("updatedAt")),e.xp6(3),e.Q6J("heading",e.lcZ(35,53,"common.image")),e.xp6(3),e.Q6J("heading",e.lcZ(38,55,"catalog.name"))("optional",!1)("sort",r.sorts.get("name")),e.xp6(3),e.Q6J("heading",e.lcZ(41,57,"common.slug"))("sort",r.sorts.get("slug")),e.xp6(3),e.Q6J("heading",e.lcZ(44,59,"common.enabled")),e.xp6(3),e.Q6J("heading",e.lcZ(47,61,"catalog.number-of-variants")),e.xp6(3),e.Q6J("ngForOf",r.customFields))},dependencies:[_.qvL,g.sg,g.O5,P.rH,i.KkL,i.BND,i.mz,i.Ywx,i.SdP,i.JOL,i.N9E,i.UaT,i.HH4,i.HAh,i.WWO,i.cuf,i.eJ5,i.Up6,i.JBy,i.jrk,i.zJY,g.Ov,C.X$,i.Mgf,i.HbD],styles:[".image-col[_ngcontent-%COMP%]{width:70px}.image-placeholder[_ngcontent-%COMP%]{width:50px;height:50px;margin-top:calc(var(--space-unit) * -1);margin-bottom:calc(var(--space-unit) * -1);background-color:var(--color-component-bg-200)}.image-placeholder[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:var(--border-radius-img)}.image-placeholder[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{text-align:center;color:var(--color-grey-300)}.search-form[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}vdr-product-search-input[_ngcontent-%COMP%]{min-width:300px}@media screen and (max-width: 768px){vdr-product-search-input[_ngcontent-%COMP%]{min-width:100px}}.search-settings-menu[_ngcontent-%COMP%]{margin:0 12px}td.disabled[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}.search-index-button[_ngcontent-%COMP%]{position:relative}.search-index-button[_ngcontent-%COMP%]   vdr-status-badge[_ngcontent-%COMP%]{right:0;top:0}.run-updates-button[_ngcontent-%COMP%]{position:relative}.run-updates-button[_ngcontent-%COMP%]   vdr-status-badge[_ngcontent-%COMP%]{left:10px;top:10px}.edit-button[_ngcontent-%COMP%]{margin-inline-end:24px}.sku[_ngcontent-%COMP%]{color:var(--color-text-300)}"]})}class he{constructor(n){this.dataService=n,this.priceChange$=new D.X(0),this.taxCategoryIdChange$=new D.X("")}ngOnInit(){const n=this.dataService.settings.getTaxRatesSimple(999,0,"cache-first").mapStream(r=>r.taxRates.items),t=this.dataService.settings.getActiveChannel("cache-first").refetchOnChannelChange().mapStream(r=>r.activeChannel);this.taxRate$=(0,T.a)(t,n,this.taxCategoryIdChange$).pipe((0,f.U)(([r,a,l])=>{const c=r.defaultTaxZone;if(!c)return 0;const s=a.find(u=>u.zone.id===c.id&&u.category.id===l);return s?s.value:0})),this.grossPrice$=(0,T.a)(this.taxRate$,this.priceChange$).pipe((0,f.U)(([r,a])=>Math.round(a*((100+r)/100))))}ngOnChanges(n){"price"in n&&this.priceChange$.next(n.price.currentValue),"taxCategoryId"in n&&this.taxCategoryIdChange$.next(n.taxCategoryId.currentValue)}static#e=this.\u0275fac=function(t){return new(t||he)(e.Y36(i.DoR))};static#t=this.\u0275cmp=e.Xpm({type:he,selectors:[["vdr-variant-price-detail"]],inputs:{priceIncludesTax:"priceIncludesTax",price:"price",currencyCode:"currencyCode",taxCategoryId:"taxCategoryId"},features:[e.TTD],decls:5,vars:5,consts:[[1,"clr-control-label"],["class","value",4,"ngIf"],[1,"value"]],template:function(t,r){1&t&&(e.TgZ(0,"label",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.YNc(3,sl,4,8,"div",1),e.YNc(4,pl,6,14,"div",1)),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,3,"catalog.taxes")),e.xp6(2),e.Q6J("ngIf",r.priceIncludesTax),e.xp6(1),e.Q6J("ngIf",!r.priceIncludesTax))},dependencies:[_.MgK,g.O5,g.Ov,C.X$,i.kgx],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.value[_ngcontent-%COMP%]{margin-top:3px}"],changeDetection:0})}A.Ps`
    query GetProductVariantsQuickJump($id: ID!) {
        product(id: $id) {
            id
            variants {
                id
                name
                sku
            }
        }
    }
`;class ve{constructor(n,t){this.dataService=n,this.router=t,this.searchFn=(r,a)=>a.name.toLowerCase().includes(r.toLowerCase())||a.sku.toLowerCase().includes(r.toLowerCase())}ngOnInit(){this.variants$=this.dataService.query(i.aAr,{id:this.productId}).mapSingle(n=>n.product?.variants??[])}onSelect(n){n&&this.router.navigate(["catalog","products",this.productId,"variants",n.id]).then(()=>this.selectedVariantId=void 0)}static#e=this.\u0275fac=function(t){return new(t||ve)(e.Y36(i.DoR),e.Y36(P.F0))};static#t=this.\u0275cmp=e.Xpm({type:ve,selectors:[["vdr-product-variant-quick-jump"]],inputs:{productId:"productId"},decls:2,vars:3,consts:[["appendTo","body","bindValue","id",3,"items","ngModel","searchFn","clearable","placeholder","ngModelChange","change",4,"ngIf"],["appendTo","body","bindValue","id",3,"items","ngModel","searchFn","clearable","placeholder","ngModelChange","change"],["ng-option-tmp",""]],template:function(t,r){if(1&t&&(e.YNc(0,ml,4,9,"ng-select",0),e.ALo(1,"async")),2&t){let a;e.Q6J("ngIf",(null==(a=e.lcZ(1,1,r.variants$))?null:a.length)>1)}},dependencies:[g.O5,d.JJ,d.On,Le.w9,Le.ir,g.Ov,C.X$],changeDetection:0})}class be extends i.VE7{constructor(n,t,r,a,l,c){super(),this.productDetailService=n,this.formBuilder=t,this.modalService=r,this.notificationService=a,this.dataService=l,this.changeDetector=c,this.updatePermissions=[i.y3$.UpdateCatalog,i.y3$.UpdateProduct],this.customFields=this.getCustomFieldConfig("ProductVariant"),this.customOptionFields=this.getCustomFieldConfig("ProductOption"),this.detailForm=this.formBuilder.group({id:"",enabled:!1,sku:"",name:"",taxCategoryId:"",stockOnHand:0,useGlobalOutOfStockThreshold:!0,outOfStockThreshold:0,trackInventory:i.TvZ.TRUE,facetValueIds:[],customFields:this.formBuilder.group((0,i.Lrj)(this.customFields))}),this.stockLevelsForm=this.formBuilder.array([]),this.pricesForm=this.formBuilder.array([]),this.assetChanges={},this.GlobalFlag=i.TvZ}ngOnInit(){this.init(),this.dataService.settings.getGlobalSettings("cache-first").single$.subscribe(({globalSettings:l})=>{this.globalTrackInventory=l.trackInventory,this.globalOutOfStockThreshold=l.outOfStockThreshold,this.changeDetector.markForCheck()}),this.taxCategories$=this.result$.pipe((0,f.U)(l=>l.taxCategories.items));const n=this.result$.pipe((0,N.b)(l=>this.channelDefaultCurrencyCode=l.activeChannel.defaultCurrencyCode),(0,f.U)(l=>l.activeChannel.availableCurrencyCodes));this.unusedCurrencyCodes$=(0,T.a)(this.pricesForm.valueChanges,n).pipe((0,f.U)(([l,c])=>c.filter(s=>!l.map(u=>u.currencyCode).includes(s))));const t=this.result$.pipe((0,f.U)(l=>l.stockLocations.items));this.unusedStockLocation$=(0,T.a)(this.entity$,t).pipe((0,f.U)(([l,c])=>{const s=l.stockLevels.map(u=>u.stockLocation.id);return c.filter(u=>!s.includes(u.id))})),this.channelPriceIncludesTax$=this.dataService.settings.getActiveChannel("cache-first").refetchOnChannelChange().mapStream(l=>l.activeChannel.pricesIncludeTax).pipe((0,xe.d)(1)),this.stockLevels$=this.entity$.pipe((0,f.U)(l=>l?.stockLevels??[]));const r=this.entity$.pipe((0,f.U)(l=>l.facetValues??[])),a=this.detailForm.get("facetValueIds").valueChanges.pipe((0,Pt.T)(1),(0,O.x)(),(0,b.w)(l=>this.dataService.facet.getFacetValues({filter:{id:{in:l}}}).mapSingle(({facetValues:c})=>c.items)),(0,xe.d)(1));this.facetValues$=(0,Ye.z)(r.pipe((0,$.q)(1)),r.pipe(function At(o,n){return(0,Tt.m)(n)?(0,b.w)(()=>o,n):(0,b.w)(()=>o)}(a)))}ngOnDestroy(){this.destroy()}addPriceInCurrency(n){this.pricesForm.push(this.formBuilder.group({currencyCode:n,price:0,delete:!1}))}toggleDeletePrice(n){n.setValue(!n.value),n.markAsDirty()}addStockLocation(n){this.stockLevelsForm.push(this.formBuilder.group({stockLocationId:n.id,stockLocationName:n.name,stockOnHand:0,stockAllocated:0}))}save(){(0,T.a)(this.entity$,this.languageCode$).pipe((0,$.q)(1),(0,J.z)(([n,t])=>{const r=(0,Lt.e)(this.getUpdatedVariant(n,this.detailForm,t),["id","enabled","translations","sku","taxCategoryId","facetValueIds","featuredAssetId","assetIds","trackInventory","outOfStockThreshold","useGlobalOutOfStockThreshold","customFields"]);return this.stockLevelsForm.dirty&&(r.stockLevels=this.stockLevelsForm.controls.filter(a=>a.dirty).map(a=>({stockLocationId:a.value.stockLocationId,stockOnHand:a.value.stockOnHand}))),this.pricesForm.dirty&&(r.prices=this.pricesForm.controls.filter(a=>a.dirty).map(a=>({price:a.value.price,currencyCode:a.value.currencyCode,delete:!0===a.value.delete}))),this.dataService.mutate(i.YZY,{input:[r]})})).subscribe(n=>{this.detailForm.markAsPristine(),this.stockLevelsForm.markAsPristine(),this.pricesForm.markAsPristine(),this.assetChanges={},this.notificationService.success((0,p.J)("common.notify-update-success"),{entity:"ProductVariant"}),this.changeDetector.markForCheck()},n=>{this.notificationService.error((0,p.J)("common.notify-update-error"),{entity:"ProductVariant"})})}assetsChanged(){return!!Object.values(this.assetChanges).length}inventoryIsNotTracked(n){const t=n.get("trackInventory")?.value;return t===i.TvZ.FALSE||t===i.TvZ.INHERIT&&!1===this.globalTrackInventory}optionGroupCode(n){return this.entity?.product.optionGroups.find(r=>r.id===n)?.code}optionName(n){return(n.translations.find(r=>r.languageCode===this.languageCode)??n.translations[0]).name}removeFacetValue(n){const t=this.detailForm,r=t.value.facetValueIds??[];t.patchValue({facetValueIds:r.filter(a=>a!==n)}),t.markAsDirty()}selectFacetValue(){this.displayFacetValueModal().subscribe(n=>{if(n){const t=this.detailForm.value.facetValueIds??[];this.detailForm.patchValue({facetValueIds:(0,L.T)([...t,...n])}),this.detailForm.markAsDirty()}})}displayFacetValueModal(){return this.modalService.fromComponent(j,{size:"md",closable:!0}).pipe((0,f.U)(n=>n&&n.map(t=>t.id)))}setFormValues(n,t){const r=(0,i.ZIM)(n,t),a=n.facetValues.map(l=>l.id);this.detailForm.patchValue({id:n.id,enabled:n.enabled,sku:n.sku,name:r?r.name:"",taxCategoryId:n.taxCategory.id,stockOnHand:n.stockLevels[0]?.stockOnHand??0,useGlobalOutOfStockThreshold:n.useGlobalOutOfStockThreshold,outOfStockThreshold:n.outOfStockThreshold,trackInventory:n.trackInventory,facetValueIds:a}),this.stockLevelsForm.clear();for(const l of n.stockLevels)this.stockLevelsForm.push(this.formBuilder.group({stockLocationId:l.stockLocation.id,stockLocationName:l.stockLocation.name,stockOnHand:l.stockOnHand,stockAllocated:l.stockAllocated}));this.pricesForm.clear();for(const l of n.prices)this.pricesForm.push(this.formBuilder.group({price:l.price,currencyCode:l.currencyCode,delete:!1}));this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get("customFields"),n,r)}getUpdatedVariant(n,t,r){return{...(0,i.iSy)({translatable:n,updatedFields:t.value,customFieldConfig:this.customFields,languageCode:r,defaultTranslation:{languageCode:r,name:n.name||""}}),assetIds:this.assetChanges.assets?.map(l=>l.id),featuredAssetId:this.assetChanges.featuredAsset?.id,facetValueIds:t.value.facetValueIds,taxCategoryId:t.value.taxCategoryId}}static#e=this.\u0275fac=function(t){return new(t||be)(e.Y36(q),e.Y36(d.qu),e.Y36(i.Z7U),e.Y36(i.gqp),e.Y36(i.DoR),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:be,selectors:[["vdr-product-variant-detail"]],features:[e.qOj],decls:12,vars:10,consts:[[3,"grow"],[1,"flex","center"],[4,"ngIf"],[3,"productId"],["locationId","product-variant-detail"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],["class","form",3,"formGroup",4,"ngIf"],["class","mr-2",3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange",4,"ngIf"],[1,"mr-2",3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],[1,"btn","btn-primary",3,"disabled","click"],[1,"form",3,"formGroup"],["for","visibility",3,"label"],[4,"vdrIfPermissions"],[3,"title",4,"ngIf"],[3,"title"],[1,"facets"],[3,"facetValue","removable","remove",4,"ngFor","ngForOf"],["class","button-small mt-2",3,"click",4,"vdrIfPermissions"],[3,"entity",4,"ngIf"],["type","submit","hidden","","x-data","prevents enter key from triggering other buttons"],[1,"form-grid"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly"],["for","sku",3,"label"],["id","sku","type","text","formControlName","sku",3,"readonly"],["locationId","product-variant-detail",3,"entity$","detailForm"],[3,"assets","featuredAsset","updatePermissions","change"],["for","taxCategory",3,"label"],["name","taxCategory","formControlName","taxCategoryId"],[3,"value",4,"ngFor","ngForOf"],["class","form-grid prices",3,"formGroup",4,"ngFor","ngForOf"],["for","track-inventory",3,"label","tooltip"],["name","track-inventory","formControlName","trackInventory",3,"disabled"],[3,"value"],[3,"label","tooltip"],["type","number","formControlName","outOfStockThreshold",3,"readonly","vdrDisabled"],["type","checkbox","clrToggle","","name","useGlobalOutOfStockThreshold","formControlName","useGlobalOutOfStockThreshold",3,"vdrDisabled"],["class","form-grid stock-levels",3,"formGroup",4,"ngFor","ngForOf"],["type","checkbox","clrToggle","","name","enabled",3,"formControl"],[1,"options"],[3,"colorFrom","invert",4,"ngFor","ngForOf"],["class","button-small mt-2",3,"routerLink",4,"vdrIfPermissions"],[3,"colorFrom","invert"],[1,"button-small","mt-2",3,"routerLink"],["shape","pencil"],[3,"facetValue","removable","remove"],[1,"button-small","mt-2",3,"click"],["shape","plus"],[3,"entity"],["entityName","ProductVariant",3,"customFields","customFieldsFormGroup","readonly"],[1,"form-grid","prices",3,"formGroup"],["for","price",3,"label","tooltip"],[1,"price-wrapper"],["name","price","formControlName","price",3,"currencyCode","readonly"],[3,"price","currencyCode","priceIncludesTax","taxCategoryId"],[1,"button-small","delete-button",3,"disabled","click"],["shape","trash"],["vdrDropdownTrigger","",1,"button","mt-2"],["shape","ellipsis-vertical"],["vdrDropdownItem","",3,"click",4,"ngFor","ngForOf"],["vdrDropdownItem","",3,"click"],[1,"form-grid","stock-levels",3,"formGroup"],[3,"label","for"],["type","number","formControlName","stockOnHand",3,"id","readonly"],[3,"label"],["shape","map-marker"]],template:function(t,r){1&t&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-left",0)(3,"div",1),e.YNc(4,_l,2,1,"ng-container",2),e.ALo(5,"async"),e._UZ(6,"vdr-product-variant-quick-jump",3),e.qZA()(),e.TgZ(7,"vdr-ab-right"),e._UZ(8,"vdr-action-bar-items",4),e.YNc(9,fl,3,4,"button",5),e.qZA()()(),e.YNc(10,Nl,77,97,"form",6),e.ALo(11,"async")),2&t&&(e.xp6(2),e.Q6J("grow",!0),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,5,r.availableLanguages$)),e.xp6(2),e.Q6J("productId",null==r.entity?null:r.entity.product.id),e.xp6(3),e.Q6J("vdrIfPermissions",e.DdM(9,Oe)),e.xp6(1),e.Q6J("ngIf",e.lcZ(11,7,r.entity$)))},dependencies:[_.qvL,_.MgK,_.KKC,_.PEh,g.sg,g.O5,d._Y,d.YN,d.Kr,d.Fj,d.wV,d.Wl,d.EJ,d.JJ,d.JL,d.oH,d.sg,d.u,P.rH,i.KkL,i.BND,i.mz,i.Ywx,i.KQz,i.qt4,i.hgI,i.y_K,i.Jpf,i.SdP,i.JOL,i.N9E,i.UaT,i.HH4,i.HAh,i.WWO,i.x3T,i.yc0,i.CWh,i.zJY,i.DME,i.TeL,i.W1W,i.AkF,G,he,ve,g.Ov,C.X$,i.uDH,i.UwE,i.j$k],styles:[".facets[_ngcontent-%COMP%], .options[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:3px}vdr-product-variant-quick-jump[_ngcontent-%COMP%]{flex:1;margin-inline-end:calc(var(--space-unit) * 2)}.stock-levels[_ngcontent-%COMP%], .prices[_ngcontent-%COMP%]{margin-top:calc(var(--space-unit) * 2);padding-top:calc(var(--space-unit) * 2);border-top:1px solid var(--color-weight-150)}.price-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-unit);width:100%}.price-wrapper.pending-deletion[_ngcontent-%COMP%]   vdr-currency-input[_ngcontent-%COMP%]{opacity:.7}.price-wrapper.pending-deletion[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]{background-color:var(--color-error-700);color:var(--color-error-100)}"],changeDetection:0})}const ht={location:"product-variant-list",label:(0,p.J)("catalog.assign-to-channel"),icon:"layers",requiresPermission:o=>o.includes(i.y3$.UpdateCatalog)||o.includes(i.y3$.UpdateProduct),isVisible:({injector:o})=>(0,i.SDV)(o.get(i.DoR)),onClick:({injector:o,selection:n,clearSelection:t})=>{o.get(i.Z7U).fromComponent(Q,{size:"lg",locals:{productVariantIds:(0,L.T)(n.map(a=>a.id)),currentChannelIds:[]}}).subscribe(a=>{a&&t()})}},vt=(0,i.RBx)({location:"product-variant-list",requiresPermission:o=>o.includes(i.y3$.UpdateCatalog)||o.includes(i.y3$.UpdateProduct),getItemName:o=>o.name,bulkRemoveFromChannel:(o,n,t)=>o.product.removeVariantsFromChannel({channelId:t,productVariantIds:n}).pipe((0,f.U)(r=>r.removeProductVariantsFromChannel))}),bt={location:"product-variant-list",label:(0,p.J)("common.delete"),icon:"trash",iconClass:"is-danger",requiresPermission:o=>o.includes(i.y3$.DeleteProduct)||o.includes(i.y3$.DeleteCatalog),onClick:({injector:o,selection:n,hostComponent:t,clearSelection:r})=>{const a=o.get(i.Z7U),l=o.get(i.DoR),c=o.get(i.gqp);a.dialog({title:(0,p.J)("common.confirm-bulk-delete"),translationVars:{count:n.length},buttons:[{type:"secondary",label:(0,p.J)("common.cancel")},{type:"danger",label:(0,p.J)("common.delete"),returnValue:!0}]}).pipe((0,b.w)(s=>s?l.product.deleteProductVariants((0,L.T)(n.map(u=>u.id))):Z.E)).subscribe(s=>{let u=0;const m=[];for(const v of s.deleteProductVariants)v.result===i.PcR.DELETED?u++:v.message&&m.push(v.message);0<u&&c.success((0,p.J)("catalog.notify-bulk-delete-products-success"),{count:u}),0<m.length&&c.error(m.join("\n")),t.refresh(),r()})}};class Ae{constructor(n){this.changeDetector=n,this.formGroupMap=new Map,this.updatePermission=[i.y3$.UpdateCatalog,i.y3$.UpdateProduct]}ngOnInit(){this.subscription=this.formArray.valueChanges.pipe((0,f.U)(n=>n.length),(0,X.b)(1),(0,O.x)()).subscribe(()=>{this.buildFormGroupMap()}),this.buildFormGroupMap()}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}trackByFn(n,t){return null!=t.id?t.id:n}getFeaturedAsset(n){return this.pendingAssetChanges[n.id]?.featuredAsset||n.featuredAsset}optionGroupName(n){const t=this.optionGroups.find(r=>r.id===n);return t&&t.name}buildFormGroupMap(){this.formGroupMap.clear();for(const n of this.formArray.controls)this.formGroupMap.set(n.value.id,n);this.changeDetector.markForCheck()}static#e=this.\u0275fac=function(t){return new(t||Ae)(e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:Ae,selectors:[["vdr-product-variants-table"]],inputs:{formArray:["productVariantsFormArray","formArray"],variants:"variants",paginationConfig:"paginationConfig",channelPriceIncludesTax:"channelPriceIncludesTax",optionGroups:"optionGroups",pendingAssetChanges:"pendingAssetChanges"},decls:24,vars:24,consts:[[1,"table"],[4,"ngFor","ngForOf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"left","align-middle"],[1,"card-img"],[1,"featured-asset"],[3,"src",4,"ngIf","ngIfElse"],["placeholder",""],["clrInput","","type","text","formControlName","name",3,"readonly","placeholder"],["clrInput","","type","text","formControlName","sku",3,"readonly","placeholder"],[1,"left","align-middle","price"],["clrInput","","formControlName","price",3,"currencyCode","readonly",4,"ngIf"],["clrInput","","formControlName","priceWithTax",3,"currencyCode","readonly",4,"ngIf"],[1,"left","align-middle","stock"],["clrInput","","type","number","min","0","step","1","formControlName","stockOnHand",3,"readonly"],["type","checkbox","clrToggle","","name","enabled","formControlName","enabled",3,"vdrDisabled"],[3,"src"],[1,"placeholder"],["shape","image","size","48"],["clrInput","","formControlName","price",3,"currencyCode","readonly"],["clrInput","","formControlName","priceWithTax",3,"currencyCode","readonly"]],template:function(t,r){1&t&&(e.TgZ(0,"table",0)(1,"thead")(2,"tr"),e._UZ(3,"th"),e.TgZ(4,"th"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.YNc(10,Vl,3,1,"ng-container",1),e.ALo(11,"sort"),e.TgZ(12,"th"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"th"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"th"),e._uU(19),e.ALo(20,"translate"),e.qZA()()(),e.TgZ(21,"tbody"),e.YNc(22,Yl,2,1,"tr",2),e.ALo(23,"paginate"),e.qZA()()),2&t&&(e.xp6(5),e.Oqu(e.lcZ(6,8,"common.name")),e.xp6(3),e.Oqu(e.lcZ(9,10,"catalog.sku")),e.xp6(2),e.Q6J("ngForOf",e.xi3(11,12,r.optionGroups,"id")),e.xp6(3),e.Oqu(e.lcZ(14,15,"catalog.price")),e.xp6(3),e.Oqu(e.lcZ(17,17,"catalog.stock-on-hand")),e.xp6(3),e.Oqu(e.lcZ(20,19,"common.enabled")),e.xp6(3),e.Q6J("ngForOf",e.xi3(23,21,r.variants,r.paginationConfig))("ngForTrackBy",r.trackByFn))},dependencies:[_.q0d,_.qvL,_.KKC,_.PEh,_.xRP,_.G55,g.sg,g.O5,d.Fj,d.wV,d.Wl,d.JJ,d.JL,d.qQ,d.sg,d.u,i.KQz,i.y_K,i.x3T,we._s,C.X$,i.UwE,i.si9,i.j$k,i.Mgf],styles:[".placeholder[_ngcontent-%COMP%]{color:var(--color-grey-300)}.stock[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .price[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{max-width:96px}td[_ngcontent-%COMP%]{transition:background-color .2s}td.disabled[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}"],changeDetection:0})}class Ze{constructor(){this.updateVariantName=!0,this.codeInputTouched=!1}ngOnInit(){const n=this.productOption.translations.find(t=>t.languageCode===this.activeLanguage);if(this.name=n?.name??"",this.code=this.productOption.code,this.customFieldsForm=new d.nJ({}),this.customFields){const t=n&&n.customFields||{};for(const r of this.customFields){const a=r.name,l="localeString"===r.type?t[a]:this.productOption.customFields[a];this.customFieldsForm.addControl(r.name,new d.p4(l))}}}update(){const n=(0,i.iSy)({translatable:this.productOption,languageCode:this.activeLanguage,updatedFields:{code:this.code,name:this.name,customFields:this.customFieldsForm.value},customFieldConfig:this.customFields,defaultTranslation:{languageCode:this.activeLanguage,name:""}});this.resolveWith({...n,autoUpdate:this.updateVariantName})}cancel(){this.resolveWith()}updateCode(n){!this.codeInputTouched&&!this.productOption.code&&(this.code=(0,U.U)(n,"-"))}static#e=this.\u0275fac=function(t){return new(t||Ze)};static#t=this.\u0275cmp=e.Xpm({type:Ze,selectors:[["vdr-update-product-option-dialog"]],decls:16,vars:13,consts:[["vdrDialogTitle",""],["for","name",3,"label"],["id","name","type","text","required","",3,"ngModel","ngModelChange","input"],["nameInput","ngModel"],["for","code",3,"label"],["id","code","type","text","required","","pattern","[a-z0-9_-]+",3,"ngModel","ngModelChange"],["codeInput","ngModel"],["type","checkbox","clrCheckbox","",3,"ngModel","ngModelChange"],[4,"ngIf"],["vdrDialogButtons",""],["entityName","ProductOption",3,"customFields","customFieldsFormGroup","readonly"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,r){1&t&&(e.YNc(0,Bl,2,3,"ng-template",0),e.TgZ(1,"vdr-form-field",1),e.ALo(2,"translate"),e.TgZ(3,"input",2,3),e.NdJ("ngModelChange",function(l){return r.name=l})("input",function(l){return r.updateCode(l.target.value)}),e.qZA()(),e.TgZ(5,"vdr-form-field",4),e.ALo(6,"translate"),e.TgZ(7,"input",5,6),e.NdJ("ngModelChange",function(l){return r.code=l}),e.qZA()(),e.TgZ(9,"clr-checkbox-wrapper")(10,"input",7),e.NdJ("ngModelChange",function(l){return r.updateVariantName=l}),e.qZA(),e.TgZ(11,"label"),e._uU(12),e.ALo(13,"translate"),e.qZA()(),e.YNc(14,El,6,9,"section",8),e.YNc(15,jl,6,7,"ng-template",9)),2&t&&(e.xp6(1),e.Q6J("label",e.lcZ(2,7,"catalog.option-name")),e.xp6(2),e.Q6J("ngModel",r.name),e.xp6(2),e.Q6J("label",e.lcZ(6,9,"common.code")),e.xp6(2),e.Q6J("ngModel",r.code),e.xp6(3),e.Q6J("ngModel",r.updateVariantName),e.xp6(2),e.Oqu(e.lcZ(13,11,"catalog.auto-update-option-variant-name")),e.xp6(2),e.Q6J("ngIf",r.customFields.length))},dependencies:[_.MgK,_.KKC,_.PEh,g.O5,d.Fj,d.Wl,d.JJ,d.Q7,d.c5,d.On,i.hgI,i.y_K,i.nPI,i.q6K,i.yc0,C.X$,i.j$k],changeDetection:0})}class Ce{static#e=this.hasRegisteredTabsAndBulkActions=!1;constructor(n,t){Ce.hasRegisteredTabsAndBulkActions||(n.registerBulkAction(ft),n.registerBulkAction(gt),n.registerBulkAction(ht),n.registerBulkAction(_t),n.registerBulkAction(vt),n.registerBulkAction(mt),n.registerBulkAction(bt),n.registerBulkAction(pt),n.registerBulkAction(ut),n.registerBulkAction(dt),n.registerBulkAction(it),n.registerBulkAction(lt),n.registerBulkAction(ct),n.registerBulkAction(at),t.registerPageTab({priority:0,location:"product-list",tab:(0,p.J)("catalog.products"),route:"",component:fe}),t.registerPageTab({priority:0,location:"product-detail",tab:(0,p.J)("catalog.product"),route:"",component:(0,i.IX9)({component:W,query:i.R2H,entityKey:"product",getBreadcrumbs:r=>[{label:r?r.name:(0,p.J)("catalog.create-new-product"),link:[r?.id]}]})}),t.registerPageTab({priority:0,location:"product-list",tab:(0,p.J)("catalog.product-variants"),route:"variants",component:z}),t.registerPageTab({priority:0,location:"product-variant-detail",tab:(0,p.J)("catalog.product-variants"),route:"",component:(0,i.IX9)({component:be,query:i.EB8,entityKey:"productVariant",getBreadcrumbs:r=>[{label:`${r?.product.name}`,link:["/catalog","products",r?.product.id]},{label:`${r?.name} (${r?.sku})`,link:["variants",r?.id]}]})}),t.registerPageTab({priority:0,location:"facet-list",tab:(0,p.J)("catalog.facets"),route:"",component:ge}),t.registerPageTab({priority:0,location:"facet-detail",tab:(0,p.J)("catalog.facet"),route:"",component:(0,i.IX9)({component:me,query:i.m_w,entityKey:"facet",getBreadcrumbs:r=>[{label:r?r.name:(0,p.J)("catalog.create-new-facet"),link:[r?.id]}]})}),t.registerPageTab({priority:0,location:"collection-list",tab:(0,p.J)("catalog.collections"),route:"",component:ue}),t.registerPageTab({priority:0,location:"collection-detail",tab:(0,p.J)("catalog.collection"),route:"",component:(0,i.IX9)({component:de,query:i.B3M,entityKey:"collection",getBreadcrumbs:r=>[{label:r?r.name:(0,p.J)("catalog.create-new-collection"),link:[r?.id]}]})}),t.registerPageTab({priority:0,location:"asset-list",tab:(0,p.J)("catalog.assets"),route:"",component:ce}),t.registerPageTab({priority:0,location:"asset-detail",tab:(0,p.J)("catalog.asset"),route:"",component:(0,i.IX9)({component:le,query:i.SS8,entityKey:"asset",getBreadcrumbs:r=>[{label:`${r?.name}`,link:[r?.id]}]})}),Ce.hasRegisteredTabsAndBulkActions=!0)}static#t=this.\u0275fac=function(t){return new(t||Ce)(e.LFG(i._4w),e.LFG(i.PhL))};static#n=this.\u0275mod=e.oAB({type:Ce});static#r=this.\u0275inj=e.cJS({providers:[{provide:P.Z6,useFactory:n=>Xe(n),multi:!0,deps:[i.PhL]}],imports:[i.m81,P.Bz.forChild([])]})}const nc=A.Ps`
    fragment ProductListQueryProductFragment on Product {
        id
        createdAt
        updatedAt
        enabled
        languageCode
        name
        slug
        featuredAsset {
            id
            createdAt
            updatedAt
            preview
            focalPoint {
                x
                y
            }
        }
        variantList {
            totalItems
        }
    }
`,rc=A.Ps`
    query ProductListQuery($options: ProductListOptions) {
        products(options: $options) {
            items {
                ...ProductListQueryProductFragment
            }
            totalItems
        }
    }
    ${nc}
`,Ue=A.Ps`
    fragment ProductVariantDetailQueryProductVariantFragment on ProductVariant {
        id
        createdAt
        updatedAt
        enabled
        languageCode
        name
        price
        currencyCode
        prices {
            price
            currencyCode
        }
        priceWithTax
        stockOnHand
        stockAllocated
        trackInventory
        outOfStockThreshold
        useGlobalOutOfStockThreshold
        taxRateApplied {
            id
            name
            value
        }
        taxCategory {
            id
            name
        }
        sku
        options {
            ...ProductOption
        }
        stockLevels {
            id
            createdAt
            updatedAt
            stockOnHand
            stockAllocated
            stockLocationId
            stockLocation {
                id
                createdAt
                updatedAt
                name
            }
        }
        facetValues {
            id
            code
            name
            facet {
                id
                name
            }
        }
        featuredAsset {
            ...Asset
        }
        assets {
            ...Asset
        }
        translations {
            id
            languageCode
            name
        }
        channels {
            id
            code
        }
        product {
            id
            name
            optionGroups {
                id
                name
                code
                translations {
                    id
                    languageCode
                    name
                }
            }
        }
    }
`,oc=A.Ps`
    query GetProductVariantDetail($id: ID!) {
        productVariant(id: $id) {
            ...ProductVariantDetailQueryProductVariantFragment
        }
        stockLocations(options: { take: 100 }) {
            items {
                id
                createdAt
                updatedAt
                name
                description
            }
        }
        taxCategories(options: { take: 100 }) {
            items {
                id
                createdAt
                updatedAt
                name
                isDefault
            }
            totalItems
        }
        activeChannel {
            id
            availableCurrencyCodes
            defaultCurrencyCode
        }
    }
    ${Ue}
`,ac=A.Ps`
    mutation ProductVariantUpdateMutation($input: [UpdateProductVariantInput!]!) {
        updateProductVariants(input: $input) {
            ...ProductVariantDetailQueryProductVariantFragment
        }
    }
    ${Ue}
`,ic=A.Ps`
    fragment ProductVariantListQueryProductVariantFragment on ProductVariant {
        id
        createdAt
        updatedAt
        productId
        enabled
        languageCode
        name
        price
        currencyCode
        priceWithTax
        trackInventory
        outOfStockThreshold
        stockLevels {
            id
            createdAt
            updatedAt
            stockLocationId
            stockOnHand
            stockAllocated
            stockLocation {
                id
                createdAt
                updatedAt
                name
            }
        }
        useGlobalOutOfStockThreshold
        sku
        featuredAsset {
            ...Asset
        }
    }

    ${i.fed}
`,lc=A.Ps`
    query ProductVariantListQuery($options: ProductVariantListOptions!) {
        productVariants(options: $options) {
            items {
                ...ProductVariantListQueryProductVariantFragment
            }
            totalItems
        }
    }
    ${ic}
`}}]);
//# sourceMappingURL=752.82f215b3a3b271cb.js.map